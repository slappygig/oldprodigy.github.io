String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return e=e||0,this.indexOf(t,e)===e}),String.prototype.endsWith||(String.prototype.endsWith=function(t,e){var n=this.toString();(void 0===e||e>n.length)&&(e=n.length),e-=t.length;var r=n.indexOf(t,e);return r!==-1&&r===e});var Controller=function(){function t(e){this.controls=new t.ControlsCollection(null,{selector:e}),this.controlsView=new t.ControlsView({collection:this.controls}),this._data={},this._temp={}}return t.prototype=Object.create(Object.prototype),t.prototype.showQuestion=function(e,n,r,i){this._data.skill=new t.Skill(e,i),this._data.question=this._data.skill.getQuestion(n),this._temp={},i=i||{},_.isUndefined(i.controls)||this.controls.setSelectOptions(i.controls),this.swapTemplate("question",r),this._data.skill.hasManipulatives()&&this.controls.setMenuManipulatives(this._data.skill.getManipulatives())},t.prototype.getSkill=function(){return this._data.skill},t.prototype.getQuestion=function(){return this._data.question},t.prototype.isTemplate=function(t){return this._data.templateType===t},t.prototype.getTemplateType=function(){return this._data.templateType},t.prototype.swapTemplate=function(t,e){this._data.lastTemplateType=this._data.templateType,this._data.templateType=t;var n=function(){this.resize(),_.isFunction(e)&&e()}.bind(this);"question"===this._data.lastTemplateType?this._temp.questionState={input:this.getInput(),focus:this.getFocusedTextBoxIndex()}:"question"===this._data.templateType&&(n=function(){_.isUndefined(this._temp.questionState)||(this.setInput(this._temp.questionState.input),this.focusTextBox(this._temp.questionState.focus),this._temp.questionState=void 0),this.resize(),_.isFunction(e)&&e()}.bind(this)),this._showTemplate(t,n)},t.prototype.swapLastTemplate=function(t){this.swapTemplate(this._data.lastTemplateType,t)},t.prototype._showTemplate=function(t,e){var n,r,i,o=this._data.skill.getHintTemplates();switch(t){case"question":n=this._data.skill.getQuestionTemplate();break;case"hint":n=this._data.skill.getHintTemplate();break;case"answer":n=this._data.skill.getAnswerTemplate();break;default:return void console.warn("The provided template type is invalid: "+t)}_.isUndefined(this._data.question)?(i=JSON.parse(n.toString()),i.answers=[]):(r=this._data.question.flatten(n.toString()),o=o.map(function(t){return this._data.question.flatten(t.toString())}.bind(this)),i=JSON.parse(r),i.answers=this._data.question.getAnswers()),this.controls.setHintTemplates(o),this.controls.once("load-complete",function(){setTimeout(e,0)}),this.controls.reset(i,{parse:!0})},t.prototype.hasHintBubbles=function(){return!_.isEmpty(this.controlsView.$(".hint-bubble:not(:empty)"))},t.prototype.removeHintBubbles=function(){var t=this.controls.filter(function(t){return"hintBubble"===t.get("type")});this.controls.remove(t);var e=this.controls.filter(function(t){return"textBlock"===t.get("type")});e.forEach(function(t){_.isFunction(t.disableHintBubbles)&&t.disableHintBubbles()})},t.prototype.trackHintBubbleUsage=function(t){var e=this.controls.filter(function(t){return"hintBubble"===t.get("type")});e.forEach(function(e){e.set("trackCallback",t)});var n=this.controls.filter(function(t){return"textBlock"===t.get("type")});n.forEach(function(e){_.isFunction(e.setTrackCallback)&&e.setTrackCallback(t)})},t.prototype.setMenuManipulatives=function(t){this.controls.setMenuManipulatives(t)},t.prototype.eraseAllManipulatives=function(){this.controls.eraseAllManipulatives()},t.prototype._getWidth=function(){return this.controlsView.getWidth()||0},t.prototype._getHeight=function(){return this.controlsView.getHeight()},t.prototype.isValid=function(){return this.controls.isValid()},t.prototype.isCorrect=function(){return this.controls.isCorrect()},t.prototype.getInput=function(){return this.controls.getInput()},t.prototype.setInput=function(t){this.controls.setInput(t)},t.prototype.enableInput=function(){this.controls.enableInput()},t.prototype.disableInput=function(){this.controls.disableInput()},t.prototype.displayAnswer=function(){this.controls.displayAnswer()},t.prototype.displayResult=function(){this.controls.displayResult()},t.prototype.displayUnchangedHighlights=function(t){this.controls.displayUnchangedHighlights(t)},t.prototype.hasChangedIncorrect=function(t){return this.controls.hasChangedIncorrect(t)},t.prototype.clear=function(){this.controlsView.clear(),this.controlsView=null,this.controls=null},t.prototype.resize=function(){this.controlsView.resize()},t.prototype.focusTextBox=function(t){this.controlsView.focusTextBox(t)},t.prototype.getFocusedTextBox=function(){return $(this.controlsView.getFocusedTextBox())},t.prototype.getFocusedTextBoxIndex=function(){return $(this.controlsView.getFocusedTextBox()).attr("tabindex")},t.prototype.focusNextTextBox=function(){this.controlsView.focusNextTextBox()},t.prototype.showStudentErrorBubbles=function(e){var n=this.getSkill(),r=n.getStudentErrorRules(),i=this.getQuestion(),o=t.StudentError.createRuleScope(i.getAttributes(),i.getAnswers(),e);if(r.length){var r=this._flattenErrorBubbleMessages(r,i);try{this.controls.addStudentErrorBubbles(r,o,e)}catch(s){console.error("Student Error:",s)}}},t.prototype.clearStudentErrorBubbles=function(t){this.getSkill().getStudentErrorRules()&&this.controls.clearStudentErrorBubbles()},t.prototype._flattenErrorBubbleMessages=function(t,e){return _.map(t,function(t){return t=_.assign({},t),t.message=e.flatten(t.message),t})},t}();Controller.isIE=function(){var t=window.navigator.userAgent;return t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0},Controller.simulateEvent=function(t){function e(t,e){var n,r,i,a=s,l=[],h=$(o+" .control.input-control .sub-input, "+o+" .control.input-control, "+o+" .control.text-block .hint, "+o+" .control.hint-bubble .trigger");return _.each(h,function(o){n=$(o).offset(),i=o.getBoundingClientRect(),r=Controller.Math.distanceFromPoint({type:"rectangle",xMin:n.left,xMax:n.left+i.width,yMin:n.top,yMax:n.top+i.height},{x:t,y:e}),r<a?(a=r,l=[o]):r===a&&l.push(o)}),a<s?l.pop():null}var n=t.event,r=t.type,i=t.data,o=t.selector,s=t.manipulative?Number.POSITIVE_INFINITY:t.maxDistance||30,a=e(n.pageX,n.pageY);a&&$(a).trigger($.Event(r,{pageX:n.pageX,pageY:n.pageY}),$.extend(i,{isTouch:_.isUndefined(n.type)}))},Controller.showTemplate=function(t){var e=t.$container,n=t.skillData,r=parseInt(t.questionId),i=(t.callback,{isMinimal:!1,isResized:!0,template:"question",platform:"auto"}),o=_.extend(i,t.options),s=new Controller;if("auto"===o.platform){var a=900,l=500,h=e.width(),c=e.height(),u=h>=a&&c>=l;o.platform=u?"desktop":"mobile"}return s.showQuestion(n,r,function(){s.swapTemplate(o.template,function(){var t=s.controlsView.$el;setTimeout(function(){t.css({position:"relative",transform:"translateY(-50%)",top:"50%",margin:"0 auto"}).find(".input-control, .sub-input, .trigger, .hint").css({pointerEvents:"all"}),e.empty().html(t)},0)})},o),s},Controller.displayQuestion=function(t){var e=$("#"+t.containerID),n=parseInt(t.skillID),r=parseInt(t.questionID),i=t.isMinimal||!1,o=t.callback,s=new Controller("#"+t.containerID);return $.ajax({dataType:"json",url:Controller.DEPLOY_PATH+"skills/"+n+".json",success:function(t){e.off("resize"),e.empty(),s.showQuestion(t,r,function(){e.on("resize",function(){var t=Math.min(e.width()/s._getWidth(),e.height()/s._getHeight(),1),n="translate(-50%,-50%) scale("+t+")";s.controlsView.$el.css({"-webkit-transform":n,transform:n,position:"absolute"})}),setTimeout(function(){s.disableInput(),e.empty().css({"pointer-events":"none"}).trigger("resize").html(s.controlsView.$el),i&&e.find("textarea").addClass("minimal").prop("readonly",!0),_.isFunction(o)&&o()},0)})}}),s},Controller.COLORS={white:"#F9F9F9",lightgrey:"#EEEEEE",grey:"#E0E0E0",darkgrey:"#999999",black:"#696969",charcoal:"#555555",lightblue:"#9EBDD6",blue:"#3498DB",darkblue:"#2980B9",lightnavy:"#72818E",navy:"#34495E",darknavy:"#2C3E50",lightgreen:"#ABDE91",green:"#2ECC71",darkgreen:"#27AE60",lightteal:"#88D8C9",teal:"#1ABC9C",darkteal:"#16A085",lightyellow:"#FFEB97",yellow:"#F1C40F",darkyellow:"#E2691B",lightorange:"#FFCB80",orange:"#F39C12",darkorange:"#E67E22",lightpink:"#DD9BC4",pink:"#CC6AA2",darkpink:"#A84579",lightred:"#D37070",red:"#E74C3C",darkred:"#C0392B",lightpurple:"#EBD7E9",purple:"#9B59B6",darkpurple:"#8E44AD",lightbrown:"#C69B79",brown:"#BE8E67",darkbrown:"#B68155",pastel_lightgreen:"#ceecc0",pastel_green:"#c0e6ae",pastel_darkgreen:"#bae4a5",pastel_lightyellow:"#FFFFD7",pastel_yellow:"#FFFEC5",pastel_darkyellow:"#fffebb",pastel_lightpink:"#f6cfcf",pastel_pink:"#f5c7c7",pastel_darkpink:"#f3bfbf",pastel_lightorange:"#fedeab",pastel_orange:"#fee2b4",pastel_darkorange:"#fee5bd",pastel_blue1:"#c0d7e4",pastel_blue2:"#c7dbe7",pastel_blue3:"#cee0ea",pastel_blue4:"#d5e4ed",pastel_blue5:"#dce9f0",pastel_blue6:"#e3edf3",selectedColor:"#34495E",correctColor:"#2ECC71",incorrectColor:"#E74C3C"},Controller.Skill=function(){function t(t,e){t=t?t.skill||{}:{},t.template=t.template||{},this._data={id:t.ID||0,questions:(t.questions||[]).map(function(t){return new Controller.Skill.Question(t)}),studentError:t.studentError||[],questionTemplate:new Controller.Skill.QuestionTemplate(t.template||{},e),hintTemplate:new Controller.Skill.Template(t.hintTemplate||{},e),answerTemplate:new Controller.Skill.Template(t.answerTemplate||{},e),hintTemplates:_.map(t.template.hintTemplates,function(t){return new Controller.Skill.Template(t,e)})}}return t.prototype=Object.create(Object.prototype),t.prototype.getId=function(){return parseInt(this._data.id)},t.prototype.getQuestionTemplate=function(){return this._data.questionTemplate},t.prototype.getHintTemplate=function(){return this._data.hintTemplate},t.prototype.getAnswerTemplate=function(){return this._data.answerTemplate},t.prototype.getHintTemplates=function(){return this._data.hintTemplates},t.prototype.getStudentErrorRules=function(){return this._data.studentError},t.prototype.isType=function(t){return this._data.questionTemplate.isType(t)},t.prototype.getHelpMessage=function(){var t="Make sure you answer the question before pressing GO!";return this.isType("mc")&&(t+="<br>Click one of the options to select your answer."),this.isType("tb")&&(t+="<br>Click each white box and use the keyboard to enter your answer."),this.isType("dd")&&(t+="<br>Open each white box with an arrow. Click one of the options to select your answer."),this.isType("cp-1")&&(t+="<br>To put a point on the coordinate plane, click on the grid."),this.isType("cp-2")&&(t+="<br>Click the grid where you want each point. Click on the first point again to close your shape."),this.isType("cp-3")&&(t+="<br>Click the grid where you want the the line to start and end."),(this.isType("bbc-1")||this.isType("bbc-2"))&&(t+="<br>Click and drag the blocks to enter your answer."),(this.isType("bbt-1")||this.isType("bbt-2"))&&(t+="<br>Click and drag the blocks into the columns to enter your answer."),this.isType("fc")&&(t+="<br>Click on the arrows to the right of the circle to change your circle."),this.isType("nl-1")&&(t+="<br>To put a point on the number line, click on the line where you want the point to go."),this.isType("clock")&&(t+="<br>Click and drag the hands to set the time."),this.isType("hc")&&(t+="<br>Click on the number to select your answer."),(this.isType("fs-1")||this.isType("fs-2"))&&(t+="<br>Click and drag the fraction strips to enter your answer."),this.isType("nl-1")&&(t+="<br>To put a point on the number line, click on the line."),(this.isType("tf-1")||this.isType("tf-2"))&&(t+="<br>Click and drag the counters to enter your answer."),this.isType("bg")&&(t+="<br>Click above each category to set the bar heights."),(this.isType("lp")||this.isType("sp"))&&(t+="<br>Click on the graph to place your points."),this.isType("grid")&&(t+="<br>Make sure you select part of the grid before clicking GO. Tap on the grid to fill it in."),t},t.prototype.hasManipulatives=function(){return this._data.questionTemplate.hasManipulatives()},t.prototype.getManipulatives=function(){return this._data.questionTemplate.getManipulatives()},t.prototype.getTools=function(){return this._data.questionTemplate.getTools()},t.prototype.getQuestion=function(t){var e=_.find(this._data.questions,function(e){return t===e.getId()});return _.isUndefined(e)?_.first(this._data.questions):e},t.prototype.flattenString=function(t){var e=this._data.questions.map(function(e){return e.flatten(t)});return _.uniq(e)},t.prototype.getAnswerCharacters=function(t){if(this.isType("tb")){var e=this._data.questionTemplate.getControls(),n=_.filter(e,function(t){return _.includes(this.flattenString(t.type),"textBox")}.bind(this)),r=_.uniq(_.map(n,"answerIndex"));r=r.map(function(t){return _.isUndefined(t)?1:t});var i,o=_.isUndefined(t)?this._data.questions:[this.getQuestion(t)],s=[];return _.each(o,function(t){_.each(r,function(e){i=t.getIndexedAnswerCharacters(e),s=s.concat(i)})}),_.uniq(s)}return[]},t}(),Controller.Skill.Question=function(){function t(t){t=t||{},this._data={id:t.ID||0,attributes:t.attrs||[],answers:t.answers||[],tts:{question:e(t,"question"),hint:e(t,"hint"),answer:e(t,"answer")}},this._data.attributes=this._data.attributes.map(this.flatten,this),this._data.answers=this._data.answers.map(this.flatten,this)}function e(t,e){var n=t.textToSpeech;if(n&&n[e]&&n[e].hash){var r="https://prodigy-assets.s3.amazonaws.com/education/tts",i="v1",o=n[e].hash,s="mp3";return r+"/"+i+"/"+o+"."+s}return""}return t.prototype=Object.create(Object.prototype),t.prototype.getId=function(){return parseInt(this._data.id)},t.prototype.flatten=function(t){if(_.isString(t)){for(var e,n,r,i=t,o=i.match(/#attr(\d+)|#ans(\d+)/);null!==o;)e=o[0],e.startsWith("#attr")?(n=parseInt(o[1])-1,r=this._data.attributes[n]||"",i=i.replace(new RegExp(e+"(\\D|$)","g"),r.toString().replace(/\$/g,"$$$")+"$1")):e.startsWith("#ans")&&(n=parseInt(o[2])-1,r=this._data.answers[n]||"",i=i.replace(new RegExp(e+"(\\D|$)","g"),r.toString().replace(/\$/g,"$$$")+"$1")),o=i.match(/#attr(\d+)|#ans(\d+)/);return i}return t},t.prototype.getAnswers=function(){return this._data.answers.map(function(t){if(!_.isString(t))return t;t=t.replace(/([^,\]\[]+)/g,function(t){return t=t.trim(),"''"===t?'""':(t=t.substring(t.startsWith("'")?1:0,t.endsWith("'")?t.length-1:t.length),isNaN(t)?'"'+t+'"':t)});try{var e=JSON.parse(t);return _.isNumber(e)?e.toString()===t.toString()?e:t:e}catch(n){return t.toString()}})},t.prototype.getAttributes=function(){return this._data.attributes},t.prototype.getIndexedAnswerCharacters=function(t){var e=this._data.answers[t-1]||"";return _.uniq(e.toString())},t.prototype.getTtsSource=function(t){return t=t||"question",this._data.tts[t]||""},t}(),Controller.Skill.Template=function(){function t(t,e){var e=e||{},n=e.platform;t=t||{},this._data=_.cloneDeep({controls:t.controls||[],properties:t.properties||{}}),this._normalizeControls(),this._alterControlProperties(n)}return t.prototype=Object.create(Object.prototype),t.prototype.getControls=function(){return this._data.controls},t.prototype.isEmpty=function(){return _.isEmpty(this._data.controls)},t.prototype.toString=function(){return JSON.stringify(this._data)},t.prototype._normalizeControls=function(){var t=this._data.controls,e=(_.minBy(t,"x")||{x:0}).x,n=(_.minBy(t,"y")||{y:0}).y;t.forEach(function(t){t.x-=e,t.y-=n})},t.prototype._alterControlProperties=function(t){if("mobile"===t||"desktop"===t){var e=this._data.controls,n=this._data.properties||{},r=n[t]||[];r.forEach(function(t){for(var n=0;n<e.length;n++){var r=e[n];r.id===t.id&&(e[n]=_.extend(r,t))}})}},t}(),Controller.Skill.QuestionTemplate=function(){function t(t,e){Controller.Skill.Template.call(this,t,e),this._data.type=t.type||"",this._data.tools=t.tools||[],this._data.manipulatives=t.manipulatives||{}}return t.prototype=Object.create(Controller.Skill.Template.prototype),t.prototype.getTools=function(){return this._data.tools},t.prototype.hasManipulatives=function(){return!_.isEmpty(this._data.manipulatives)},t.prototype.getManipulatives=function(){return this._data.manipulatives},t.prototype.isType=function(t){var e=this._data.type.split(" ");return _.includes(e,t)},t}(),function(t,e,n){e[t]=e[t]||n(),"undefined"!=typeof module&&module.exports?module.exports=e[t]:"function"==typeof define&&define.amd&&define(function(){return e[t]})}("Promise","undefined"!=typeof global?global:this,function(){"use strict";function t(t,e){d.add(t,e),u||(u=f(d.drain))}function e(t){var e,n=typeof t;return null==t||"object"!=n&&"function"!=n||(e=t.then),"function"==typeof e&&e}function n(){for(var t=0;t<this.chain.length;t++)r(this,1===this.state?this.chain[t].success:this.chain[t].failure,this.chain[t]);this.chain.length=0}function r(t,n,r){var i,o;try{n===!1?r.reject(t.msg):(i=n===!0?t.msg:n.call(void 0,t.msg),i===r.promise?r.reject(TypeError("Promise-chain cycle")):(o=e(i))?o.call(i,r.resolve,r.reject):r.resolve(i))}catch(s){r.reject(s)}}function i(r){var s,l=this;if(!l.triggered){l.triggered=!0,l.def&&(l=l.def);try{(s=e(r))?t(function(){var t=new a(l);try{s.call(r,function(){i.apply(t,arguments)},function(){o.apply(t,arguments)})}catch(e){o.call(t,e)}}):(l.msg=r,l.state=1,l.chain.length>0&&t(n,l))}catch(h){o.call(new a(l),h)}}}function o(e){var r=this;r.triggered||(r.triggered=!0,r.def&&(r=r.def),r.msg=e,r.state=2,r.chain.length>0&&t(n,r))}function s(t,e,n,r){for(var i=0;i<e.length;i++)!function(i){t.resolve(e[i]).then(function(t){n(i,t)},r)}(i)}function a(t){this.def=t,this.triggered=!1}function l(t){this.promise=t,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function h(e){if("function"!=typeof e)throw TypeError("Not a function");if(0!==this.__NPO__)throw TypeError("Not a promise");this.__NPO__=1;var r=new l(this);this.then=function(e,i){var o={success:"function"!=typeof e||e,failure:"function"==typeof i&&i};return o.promise=new this.constructor(function(t,e){if("function"!=typeof t||"function"!=typeof e)throw TypeError("Not a function");o.resolve=t,o.reject=e}),r.chain.push(o),0!==r.state&&t(n,r),o.promise},this["catch"]=function(t){return this.then(void 0,t)};try{e.call(void 0,function(t){i.call(r,t)},function(t){o.call(r,t)})}catch(s){o.call(r,s)}}var c,u,d,p=Object.prototype.toString,f="undefined"!=typeof setImmediate?function(t){return setImmediate(t)}:setTimeout;try{Object.defineProperty({},"x",{}),c=function(t,e,n,r){return Object.defineProperty(t,e,{value:n,writable:!0,configurable:r!==!1})}}catch(g){c=function(t,e,n){return t[e]=n,t}}d=function(){function t(t,e){this.fn=t,this.self=e,this.next=void 0}var e,n,r;return{add:function(i,o){r=new t(i,o),n?n.next=r:e=r,n=r,r=void 0},drain:function(){var t=e;for(e=n=u=void 0;t;)t.fn.call(t.self),t=t.next}}}();var m=c({},"constructor",h,!1);return h.prototype=m,c(m,"__NPO__",0,!1),c(h,"resolve",function(t){var e=this;return t&&"object"==typeof t&&1===t.__NPO__?t:new e(function(e,n){if("function"!=typeof e||"function"!=typeof n)throw TypeError("Not a function");e(t)})}),c(h,"reject",function(t){return new this(function(e,n){if("function"!=typeof e||"function"!=typeof n)throw TypeError("Not a function");n(t)})}),c(h,"all",function(t){var e=this;return"[object Array]"!=p.call(t)?e.reject(TypeError("Not an array")):0===t.length?e.resolve([]):new e(function(n,r){if("function"!=typeof n||"function"!=typeof r)throw TypeError("Not a function");var i=t.length,o=Array(i),a=0;s(e,t,function(t,e){o[t]=e,++a===i&&n(o)},r)})}),c(h,"race",function(t){var e=this;return"[object Array]"!=p.call(t)?e.reject(TypeError("Not an array")):new e(function(n,r){if("function"!=typeof n||"function"!=typeof r)throw TypeError("Not a function");s(e,t,function(t,e){n(e)},r)})}),h}),function(){function t(t,e){document.addEventListener?t.addEventListener("scroll",e,!1):t.attachEvent("scroll",e)}function e(t){document.body?t():document.addEventListener?document.addEventListener("DOMContentLoaded",function e(){document.removeEventListener("DOMContentLoaded",e),t()}):document.attachEvent("onreadystatechange",function n(){"interactive"!=document.readyState&&"complete"!=document.readyState||(document.detachEvent("onreadystatechange",n),t())})}function n(t){this.a=document.createElement("div"),this.a.setAttribute("aria-hidden","true"),this.a.appendChild(document.createTextNode(t)),this.b=document.createElement("span"),this.c=document.createElement("span"),this.h=document.createElement("span"),this.f=document.createElement("span"),this.g=-1,this.b.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.c.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.f.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.h.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;",this.b.appendChild(this.h),this.c.appendChild(this.f),this.a.appendChild(this.b),this.a.appendChild(this.c)}function r(t,e){t.a.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;left:-999px;white-space:nowrap;font:"+e+";"}function i(t){var e=t.a.offsetWidth,n=e+100;return t.f.style.width=n+"px",t.c.scrollLeft=n,t.b.scrollLeft=t.b.scrollWidth+100,t.g!==e&&(t.g=e,!0)}function o(e,n){function r(){var t=o;i(t)&&null!==t.a.parentNode&&n(t.g)}var o=e;t(e.b,r),t(e.c,r),i(e)}function s(t,e){var n=e||{};this.family=t,this.style=n.style||"normal",this.weight=n.weight||"normal",this.stretch=n.stretch||"normal"}function a(){if(null===c){var t=document.createElement("div");try{t.style.font="condensed 100px sans-serif"}catch(e){}c=""!==t.style.font}return c}function l(t,e){return[t.style,t.weight,a()?t.stretch:"","100px",e].join(" ")}var h=null,c=null,u=null;s.prototype.load=function(t,i){var s=this,a=t||"BESbswy",c=i||3e3,d=(new Date).getTime();return new Promise(function(t,i){if(null===u&&(u=!!document.fonts),u){var p=new Promise(function(t,e){function n(){(new Date).getTime()-d>=c?e():document.fonts.load(l(s,'"'+s.family+'"'),a).then(function(e){1<=e.length?t():setTimeout(n,25)},function(){e()})}n()}),f=new Promise(function(t,e){setTimeout(e,c)});Promise.race([f,p]).then(function(){t(s)},function(){i(s)})}else e(function(){function e(){var e;(e=-1!=m&&-1!=x||-1!=m&&-1!=y||-1!=x&&-1!=y)&&((e=m!=x&&m!=y&&x!=y)||(null===h&&(e=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),h=!!e&&(536>parseInt(e[1],10)||536===parseInt(e[1],10)&&11>=parseInt(e[2],10))),e=h&&(m==v&&x==v&&y==v||m==C&&x==C&&y==C||m==w&&x==w&&y==w)),e=!e),e&&(null!==b.parentNode&&b.parentNode.removeChild(b),clearTimeout(M),t(s))}function u(){if((new Date).getTime()-d>=c)null!==b.parentNode&&b.parentNode.removeChild(b),i(s);else{var t=document.hidden;!0!==t&&void 0!==t||(m=p.a.offsetWidth,x=f.a.offsetWidth,y=g.a.offsetWidth,e()),M=setTimeout(u,50)}}var p=new n(a),f=new n(a),g=new n(a),m=-1,x=-1,y=-1,v=-1,C=-1,w=-1,b=document.createElement("div"),M=0;b.dir="ltr",r(p,l(s,"sans-serif")),r(f,l(s,"serif")),r(g,l(s,"monospace")),b.appendChild(p.a),b.appendChild(f.a),b.appendChild(g.a),document.body.appendChild(b),v=p.a.offsetWidth,C=f.a.offsetWidth,w=g.a.offsetWidth,u(),o(p,function(t){m=t,e()}),r(p,l(s,'"'+s.family+'",sans-serif')),o(f,function(t){x=t,e()}),r(f,l(s,'"'+s.family+'",serif')),o(g,function(t){y=t,e()}),r(g,l(s,'"'+s.family+'",monospace'))})})},"undefined"!=typeof module?module.exports=s:(window.FontFaceObserver=s,window.FontFaceObserver.prototype.load=s.prototype.load)}(),Controller.Math={gcd:function(t,e){return e?Controller.Math.gcd(e,t%e):t},lcm:function(t,e){return Math.round(t*e/Controller.Math.gcd(t,e))},euclideanDistance:function(t,e,n,r){return Math.sqrt(Math.pow(t-n,2)+Math.pow(e-r,2))},intersect:function(t,e){if(t.type===e.type)switch(t.type){case"rectangle":return!(t.x>e.x+e.w||t.x+t.w<e.x||t.y>e.y+e.h||t.y+t.h<e.y);case"circle":return this.euclideanDistance(t.x,t.y,e.x,e.y)<(t.w+e.w)/2}else switch(t.type){case"circle":var n=Math.abs(t.x-e.x),r=Math.abs(t.y-e.y);if(n>e.w/2+t.w/2||r>e.h/2+t.h/2)return!1;if(n<=e.w/2||r<=e.h/2)return!0;var i=Math.pow(n-e.w/2,2)+Math.pow(r-e.h/2,2);return i<=Math.pow(t.w/2,2)}return!1},contains:function(t,e){if(t.type===e.type)switch(t.type){case"rectangle":return t.x<=e.x&&t.y<=e.y&&t.x+t.w>=e.x+e.w&&t.y+t.h>=e.y+e.h}},overlappingArea:function(t,e){if(t.type===e.type)switch(t.type){case"rectangle":var n=Math.max(0,Math.min(t.x+t.w,e.x+e.w)-Math.max(t.x,e.x)),r=Math.max(0,Math.min(t.y+t.h,e.y+e.h)-Math.max(t.y,e.y));return n*r}},distanceFromPoint:function(t,e){switch(t.type){case"rectangle":return e.x<t.xMin?e.y<t.yMin?Controller.Math.euclideanDistance(e.x,e.y,t.xMin,t.yMin):e.y>t.yMax?Controller.Math.euclideanDistance(e.x,e.y,t.xMin,t.yMax):Math.abs(t.xMin-e.x):e.x>t.xMax?e.y<t.yMin?Controller.Math.euclideanDistance(e.x,e.y,t.xMax,t.yMin):e.y>t.yMax?Controller.Math.euclideanDistance(e.x,e.y,t.xMax,t.yMax):Math.abs(e.x-t.xMax):e.y<t.yMin?Math.abs(t.yMin-e.y):e.y>t.yMax?Math.abs(e.y-t.yMax):0}}},Controller.Math.RationalNumber=function(){function t(t,e){if(t=t.toString(),this.number=Controller.Math.RationalNumber.trim(t),this.isNegative=(t.split("-").length-1)%2===1,t=t.replace(/-/g,""),Controller.Math.RationalNumber.isFraction(t)){var n=t.split(/[ \/]/);this.coefficient=parseInt(n[n.length-3])||0,this.numerator=parseInt(n[n.length-2]),this.denominator=parseInt(n[n.length-1])}else{var r,i=t.indexOf(".");if(i!==-1){r=t.substr(i+1),this.coefficient=parseInt(t.substr(0,i))||0,this.numerator=parseInt(r),this.denominator=parseInt("1"+Array(r.length+1).join("0"));var o=Controller.Math.gcd(this.numerator,this.denominator);this.numerator=this.numerator/o,this.denominator=this.denominator/o}else this.coefficient=parseInt(t),this.numerator=0,this.denominator=1}e&&this.convert(e)}return t.prototype=Object.create(Object.prototype),t.prototype.toFloat=function(){var t=(this.coefficient*this.denominator+this.numerator)/this.denominator;return this.isNegative?-1*t:t},t.prototype.toString=function(){var t=this.numerator+"/"+this.denominator;return this.coefficient&&(t=this.coefficient+" "+t),this.isNegative&&(t="-"+t),t},t.prototype.copy=function(){return new Controller.Math.RationalNumber(this.number)},t.prototype.convert=function(t){switch(t=t||{},t.format){case"mixed":this.coefficient+=Math.floor(this.numerator/this.denominator),this.numerator=this.numerator%this.denominator;break;case"improper":this.numerator+=this.coefficient*this.denominator,this.coefficient=0}if(t.reduced){var e=Controller.Math.gcd(this.numerator,this.denominator);this.numerator=this.numerator/e,this.denominator=this.denominator/e}},t.prototype.isEqual=function(t){if(_.isString(t)||_.isNumber(t)||t instanceof Controller.Math.RationalNumber){var e=new Controller.Math.RationalNumber(this.number,{format:"improper",reduced:!0});return t=new Controller.Math.RationalNumber(t.number||t,{format:"improper",reduced:!0}),e.isNegative===t.isNegative&&e.coefficient===t.coefficient&&e.numerator===t.numerator&&e.denominator===t.denominator}return!1},t.prototype.isGreaterThan=function(t){if(_.isString(t)||_.isNumber(t)||t instanceof Controller.Math.RationalNumber){var e=new Controller.Math.RationalNumber(this.number,{format:"improper",reduced:!0});return t=new Controller.Math.RationalNumber(t.number||t,{format:"improper",reduced:!0}),(e.isNegative?-e.numerator:e.numerator)*t.denominator>(t.isNegative?-t.numerator:t.numerator)*e.denominator}return!1},t.prototype.isLessThan=function(t){if(_.isString(t)||_.isNumber(t)||t instanceof Controller.Math.RationalNumber){var e=new Controller.Math.RationalNumber(this.number,{format:"improper",reduced:!0});return t=new Controller.Math.RationalNumber(t.number||t,{format:"improper",reduced:!0}),(e.isNegative?-e.numerator:e.numerator)*t.denominator<(t.isNegative?-t.numerator:t.numerator)*e.denominator}return!1},t.prototype.isGEQ=function(t){return this.isEqual(t)||this.isGreaterThan(t)},t.prototype.isLEQ=function(t){return this.isEqual(t)||this.isLessThan(t)},t.prototype.add=function(t,e){t=new Controller.Math.RationalNumber(t.number||t,{format:"improper",reduced:!1});var n=new Controller.Math.RationalNumber(this.number,{format:"improper",reduced:!1}),r=Controller.Math.lcm(n.denominator,t.denominator),i=(t.isNegative?-t.numerator:t.numerator)*(r/t.denominator)+(n.isNegative?-n.numerator:n.numerator)*(r/n.denominator);return new Controller.Math.RationalNumber(i+"/"+r,e)},t.prototype.subtract=function(t,e){return this.add("-"+(t.number||t),e)},t.prototype.multiply=function(t,e){t=new Controller.Math.RationalNumber(t.number||t,{format:"improper",reduced:!1});var n=new Controller.Math.RationalNumber(this.number,{format:"improper",reduced:!1}),r=n.denominator*t.denominator,i=n.numerator*t.numerator,o=n.isNegative!==t.isNegative;return o&&(i=-i),new Controller.Math.RationalNumber(i+"/"+r,e)},t.prototype.divide=function(t,e){t=new Controller.Math.RationalNumber(t.number||t,{format:"improper",reduced:!1});var n=t.denominator+"/"+t.numerator;return t.isNegative&&(n="-"+n),this.multiply(n,e)},t}(),Controller.Math.RationalNumber.parse=function(t){return new Controller.Math.RationalNumber(t).toFloat()},Controller.Math.RationalNumber.isFraction=function(t){return _.isString(t)&&/^\s*(-?\s*\d+\s+)?-?\s*\d+\s*\/\s*-?\s*[1-9]\d*\s*$/.test(t)},Controller.Math.RationalNumber.trim=function(t){return Controller.Math.RationalNumber.isFraction(t)?t.replace(/^\s*(-)?\s*(\d+ )?\s*(-)?\s*(\d+)\s*\/\s*(-)?\s*([1-9]\d*)\s*$/,"$1$2$3$4/$5$6"):t},Controller.Math.RationalNumber.existsFraction=function(t){return _.some(t,function(t){return _.isArray(t)?Controller.Math.RationalNumber.existsFraction(t):Controller.Math.RationalNumber.isFraction(t)})};var math=function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){var r=n(1),i=r.create();i["import"](n(13)),window&&(window.math=i),t.exports=i},function(t,e,n){t.exports=n(2)},function(t,e,n){var r=n(3).isFactory,i=(n(3).deepExtend,n(4)),o=n(8),s=n(10),a=n(12);e.create=function(t){function e(t){if(!r(t))throw new Error("Factory object with properties `type`, `name`, and `factory` expected");var i,o=n.indexOf(t);return-1===o?(i=t.math===!0?t.factory(h.type,c,e,h.typed,h):t.factory(h.type,c,e,h.typed),n.push(t),l.push(i)):i=l[o],i}if("function"!=typeof Object.create)throw new Error("ES5 not supported by this JavaScript engine. Please load the es5-shim and es5-sham library for compatibility.");var n=[],l=[],h=o.mixin({});h.type={},h.expression={transform:Object.create(h)},h.typed=i.create(h.type);var c={epsilon:1e-12,matrix:"Matrix",number:"number",precision:64,predictable:!1};return h["import"]=e(s),h.config=e(a),t&&h.config(t),h}},function(t,e){"use strict";e.clone=function n(t){var e=typeof t;if("number"===e||"string"===e||"boolean"===e||null===t||void 0===t)return t;if("function"==typeof t.clone)return t.clone();if(Array.isArray(t))return t.map(function(t){return n(t)});if(t instanceof Number)return new Number(t.valueOf());if(t instanceof String)return new String(t.valueOf());if(t instanceof Boolean)return new Boolean(t.valueOf());if(t instanceof Date)return new Date(t.valueOf());if(t&&t.isBigNumber===!0)return t;if(t instanceof RegExp)throw new TypeError("Cannot clone "+t);var r={};for(var i in t)t.hasOwnProperty(i)&&(r[i]=n(t[i]));return r},e.extend=function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},e.deepExtend=function r(t,e){if(Array.isArray(e))throw new TypeError("Arrays are not supported by deepExtend");for(var n in e)if(e.hasOwnProperty(n))if(e[n]&&e[n].constructor===Object)void 0===t[n]&&(t[n]={}),t[n].constructor===Object?r(t[n],e[n]):t[n]=e[n];else{if(Array.isArray(e[n]))throw new TypeError("Arrays are not supported by deepExtend");t[n]=e[n]}return t},e.deepEqual=function(t,n){
var r,i,o;if(Array.isArray(t)){if(!Array.isArray(n))return!1;if(t.length!=n.length)return!1;for(i=0,o=t.length;o>i;i++)if(!e.deepEqual(t[i],n[i]))return!1;return!0}if(t instanceof Object){if(Array.isArray(n)||!(n instanceof Object))return!1;for(r in t)if(!e.deepEqual(t[r],n[r]))return!1;for(r in n)if(!e.deepEqual(t[r],n[r]))return!1;return!0}return typeof t==typeof n&&t==n},e.canDefineProperty=function(){try{if(Object.defineProperty)return Object.defineProperty({},"x",{get:function(){}}),!0}catch(t){}return!1},e.lazy=function(t,n,r){if(e.canDefineProperty()){var i,o=!0;Object.defineProperty(t,n,{get:function(){return o&&(i=r(),o=!1),i},set:function(t){i=t,o=!1},configurable:!0,enumerable:!0})}else t[n]=r()},e.traverse=function(t,e){var n=t;if(e)for(var r=e.split("."),i=0;i<r.length;i++){var o=r[i];o in n||(n[o]={}),n=n[o]}return n},e.isFactory=function(t){return t&&"function"==typeof t.factory}},function(t,e,n){var r=n(5),i=n(6).digits,o=function(){return o=r.create,r};e.create=function(t){var e=o();return e.types=[{name:"number",test:function(t){return"number"==typeof t}},{name:"Complex",test:function(t){return t&&t.isComplex}},{name:"BigNumber",test:function(t){return t&&t.isBigNumber}},{name:"Fraction",test:function(t){return t&&t.isFraction}},{name:"Unit",test:function(t){return t&&t.isUnit}},{name:"string",test:function(t){return"string"==typeof t}},{name:"Array",test:Array.isArray},{name:"Matrix",test:function(t){return t&&t.isMatrix}},{name:"DenseMatrix",test:function(t){return t&&t.isDenseMatrix}},{name:"SparseMatrix",test:function(t){return t&&t.isSparseMatrix}},{name:"ImmutableDenseMatrix",test:function(t){return t&&t.isImmutableDenseMatrix}},{name:"Range",test:function(t){return t&&t.isRange}},{name:"Index",test:function(t){return t&&t.isIndex}},{name:"boolean",test:function(t){return"boolean"==typeof t}},{name:"ResultSet",test:function(t){return t&&t.isResultSet}},{name:"Help",test:function(t){return t&&t.isHelp}},{name:"function",test:function(t){return"function"==typeof t}},{name:"Date",test:function(t){return t instanceof Date}},{name:"RegExp",test:function(t){return t instanceof RegExp}},{name:"Object",test:function(t){return"object"==typeof t}},{name:"null",test:function(t){return null===t}},{name:"undefined",test:function(t){return void 0===t}}],e.conversions=[{from:"number",to:"BigNumber",convert:function(e){if(i(e)>15)throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+e+"). Use function bignumber(x) to convert to BigNumber.");return new t.BigNumber(e)}},{from:"number",to:"Complex",convert:function(e){return new t.Complex(e,0)}},{from:"number",to:"string",convert:function(t){return t+""}},{from:"BigNumber",to:"Complex",convert:function(e){return new t.Complex(e.toNumber(),0)}},{from:"Fraction",to:"Complex",convert:function(e){return new t.Complex(e.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(e){if(i(e)>15)throw new TypeError("Cannot implicitly convert a number with >15 significant digits to Fraction (value: "+e+"). Use function fraction(x) to convert to Fraction.");return new t.Fraction(e)}},{from:"string",to:"number",convert:function(t){var e=Number(t);if(isNaN(e))throw new Error('Cannot convert "'+t+'" to a number');return e}},{from:"boolean",to:"number",convert:function(t){return+t}},{from:"boolean",to:"BigNumber",convert:function(e){return new t.BigNumber((+e))}},{from:"boolean",to:"Fraction",convert:function(e){return new t.Fraction((+e))}},{from:"boolean",to:"string",convert:function(t){return+t}},{from:"null",to:"number",convert:function(){return 0}},{from:"null",to:"string",convert:function(){return"null"}},{from:"null",to:"BigNumber",convert:function(){return new t.BigNumber(0)}},{from:"null",to:"Fraction",convert:function(){return new t.Fraction(0)}},{from:"Array",to:"Matrix",convert:function(e){return new t.DenseMatrix(e)}},{from:"Matrix",to:"Array",convert:function(t){return t.valueOf()}}],e}},function(t,e,n){var r,i,o;!function(n,s){i=[],r=s,o="function"==typeof r?r.apply(e,i):r,!(void 0!==o&&(t.exports=o))}(this,function(){function t(){function e(t){for(var e,n=0;n<b.types.length;n++){var r=b.types[n];if(r.name===t){e=r.test;break}}if(!e){var i;for(n=0;n<b.types.length;n++)if(r=b.types[n],r.name.toLowerCase()==t.toLowerCase()){i=r.name;break}throw new Error('Unknown type "'+t+'"'+(i?'. Did you mean "'+i+'"?':""))}return e}function n(t){for(var e="",n=0;n<t.length;n++){var r=t[n];if(r.signatures&&""!=r.name)if(""==e)e=r.name;else if(e!=r.name){var i=new Error("Function names do not match (expected: "+e+", actual: "+r.name+")");throw i.data={actual:r.name,expected:e},i}}return e}function r(t,e,n,r,i){var o,s=f(r),a=i?i.split(","):null,l=t||"unnamed",h=a&&g(a,"any"),c={fn:t,index:n,actual:r,expected:a};o=a?e>n&&!h?"Unexpected type of argument in function "+l+" (expected: "+a.join(" or ")+", actual: "+s+", index: "+n+")":"Too few arguments in function "+l+" (expected: "+a.join(" or ")+", index: "+n+")":"Too many arguments in function "+l+" (expected: "+n+", actual: "+e+")";var u=new TypeError(o);return u.data=c,u}function i(t){this.name=t||"refs",this.categories={}}function o(t,e){if("string"==typeof t){var n=t.trim(),r="..."===n.substr(0,3);if(r&&(n=n.substr(3)),""===n)this.types=["any"];else{this.types=n.split("|");for(var i=0;i<this.types.length;i++)this.types[i]=this.types[i].trim()}}else{if(!Array.isArray(t)){if(t instanceof o)return t.clone();throw new Error("String or Array expected")}this.types=t}this.conversions=[],this.varArgs=r||e||!1,this.anyType=-1!==this.types.indexOf("any")}function s(t,e){var n;if("string"==typeof t)n=""!==t?t.split(","):[];else{if(!Array.isArray(t))throw new Error("string or Array expected");n=t}this.params=new Array(n.length);for(var r=0;r<n.length;r++){var i=new o(n[r]);if(this.params[r]=i,r===n.length-1)this.varArgs=i.varArgs;else if(i.varArgs)throw new SyntaxError('Unexpected variable arguments operator "..."')}this.fn=e}function a(t,e,n){this.path=t||[],this.param=t[t.length-1]||null,this.signature=e||null,this.childs=n||[]}function l(t){var e,n,r={},i=[];for(var o in t)if(t.hasOwnProperty(o)){var a=t[o];if(e=new s(o,a),e.ignore())continue;var l=e.expand();for(n=0;n<l.length;n++){var h=l[n],c=h.toString(),u=r[c];if(u){var d=s.compare(h,u);if(0>d)r[c]=h;else if(0===d)throw new Error('Signature "'+c+'" is defined twice')}else r[c]=h}}for(c in r)r.hasOwnProperty(c)&&i.push(r[c]);for(i.sort(function(t,e){return s.compare(t,e)}),n=0;n<i.length;n++)if(e=i[n],e.varArgs)for(var p=e.params.length-1,f=e.params[p],m=0;m<f.types.length;){if(f.conversions[m])for(var x=f.types[m],y=0;y<i.length;y++){var v=i[y],C=v.params[p];if(v!==e&&C&&g(C.types,x)&&!C.conversions[p]){f.types.splice(m,1),f.conversions.splice(m,1),m--;break}}m++}return i}function h(t){for(var e={},n=0;n<t.length;n++){var r=t[n];if(r.fn&&!r.hasConversions()){var i=r.params.join(",");e[i]=r.fn}}return e}function c(t,e){var n,r,i,s=e.length,l=[];for(n=0;n<t.length;n++)r=t[n],r.params.length!==s||i||(i=r),void 0!=r.params[s]&&l.push(r);l.sort(function(t,e){return o.compare(t.params[s],e.params[s])});var h=[];for(n=0;n<l.length;n++){r=l[n];var u=r.params[s],d=h.filter(function(t){return t.param.overlapping(u)})[0];if(d){if(d.param.varArgs)throw new Error('Conflicting types "'+d.param+'" and "'+u+'"');d.signatures.push(r)}else h.push({param:u,signatures:[r]})}var p=new Array(h.length);for(n=0;n<h.length;n++){var f=h[n];p[n]=c(f.signatures,e.concat(f.param))}return new a(e,i,p)}function u(t){for(var e=[],n=0;t>n;n++)e[n]="arg"+n;return e}function d(t,e){var n=new i,o=l(e);if(0==o.length)throw new Error("No signatures provided");var s=c(o,[]),a=[],d=t||"",f=u(p(o));a.push("function "+d+"("+f.join(", ")+") {"),a.push('  "use strict";'),a.push("  var name = '"+d+"';"),a.push(s.toCode(n,"  ")),a.push("}");var g=[n.toCode(),"return "+a.join("\n")].join("\n"),m=new Function(n.name,"createError",g),x=m(n,r);return x.signatures=h(o),x}function p(t){for(var e=0,n=0;n<t.length;n++){var r=t[n].params.length;r>e&&(e=r)}return e}function f(t){for(var e,n=0;n<b.types.length;n++){var r=b.types[n];if("Object"===r.name)e=r;else if(r.test(t))return r.name}return e&&e.test(t)?e.name:"unknown"}function g(t,e){return-1!==t.indexOf(e)}function m(t,e){if(!t.signatures)throw new TypeError("Function is no typed-function");var n;if("string"==typeof e){n=e.split(",");for(var r=0;r<n.length;r++)n[r]=n[r].trim()}else{if(!Array.isArray(e))throw new TypeError("String array or a comma separated string expected");n=e}var i=n.join(","),o=t.signatures[i];if(o)return o;throw new TypeError("Signature not found (signature: "+(t.name||"unnamed")+"("+n.join(", ")+"))")}function x(t,e){var n=f(t);if(e===n)return t;for(var r=0;r<b.conversions.length;r++){var i=b.conversions[r];if(i.from===n&&i.to===e)return i.convert(t)}throw new Error("Cannot convert from "+n+" to "+e)}i.prototype.add=function(t,e){var n=e||"fn";this.categories[n]||(this.categories[n]=[]);var r=this.categories[n].indexOf(t);return-1==r&&(r=this.categories[n].length,this.categories[n].push(t)),n+r},i.prototype.toCode=function(){var t=[],e=this.name+".categories",n=this.categories;for(var r in n)if(n.hasOwnProperty(r))for(var i=n[r],o=0;o<i.length;o++)t.push("var "+r+o+" = "+e+"['"+r+"']["+o+"];");return t.join("\n")},o.compare=function(t,e){if(t.anyType)return 1;if(e.anyType)return-1;if(g(t.types,"Object"))return 1;if(g(e.types,"Object"))return-1;if(t.hasConversions()){if(e.hasConversions()){var n,r,i;for(n=0;n<t.conversions.length;n++)if(void 0!==t.conversions[n]){r=t.conversions[n];break}for(n=0;n<e.conversions.length;n++)if(void 0!==e.conversions[n]){i=e.conversions[n];break}return b.conversions.indexOf(r)-b.conversions.indexOf(i)}return 1}if(e.hasConversions())return-1;var o,s;for(n=0;n<b.types.length;n++)if(b.types[n].name===t.types[0]){o=n;break}for(n=0;n<b.types.length;n++)if(b.types[n].name===e.types[0]){s=n;break}return o-s},o.prototype.overlapping=function(t){for(var e=0;e<this.types.length;e++)if(g(t.types,this.types[e]))return!0;return!1},o.prototype.clone=function(){var t=new o(this.types.slice(),this.varArgs);return t.conversions=this.conversions.slice(),t},o.prototype.hasConversions=function(){return this.conversions.length>0},o.prototype.contains=function(t){for(var e=0;e<this.types.length;e++)if(t[this.types[e]])return!0;return!1},o.prototype.toString=function(t){for(var e=[],n={},r=0;r<this.types.length;r++){var i=this.conversions[r],o=t&&i?i.to:this.types[r];o in n||(n[o]=!0,e.push(o))}return(this.varArgs?"...":"")+e.join("|")},s.prototype.clone=function(){return new s(this.params.slice(),this.fn)},s.prototype.expand=function(){function t(n,r){if(r.length<n.params.length){var i,a,l,h=n.params[r.length];if(h.varArgs){for(a=h.clone(),i=0;i<b.conversions.length;i++)if(l=b.conversions[i],!g(h.types,l.from)&&g(h.types,l.to)){var c=a.types.length;a.types[c]=l.from,a.conversions[c]=l}t(n,r.concat(a))}else{for(i=0;i<h.types.length;i++)t(n,r.concat(new o(h.types[i])));for(i=0;i<b.conversions.length;i++)l=b.conversions[i],!g(h.types,l.from)&&g(h.types,l.to)&&(a=new o(l.from),a.conversions[0]=l,t(n,r.concat(a)))}}else e.push(new s(r,n.fn))}var e=[];return t(this,[]),e},s.compare=function(t,e){if(t.params.length>e.params.length)return 1;if(t.params.length<e.params.length)return-1;var n,r=t.params.length,i=0,s=0;for(n=0;r>n;n++)t.params[n].hasConversions()&&i++,e.params[n].hasConversions()&&s++;if(i>s)return 1;if(s>i)return-1;for(n=0;n<t.params.length;n++){var a=o.compare(t.params[n],e.params[n]);if(0!==a)return a}return 0},s.prototype.hasConversions=function(){for(var t=0;t<this.params.length;t++)if(this.params[t].hasConversions())return!0;return!1},s.prototype.ignore=function(){for(var t={},e=0;e<b.ignore.length;e++)t[b.ignore[e]]=!0;for(e=0;e<this.params.length;e++)if(this.params[e].contains(t))return!0;return!1},s.prototype.toCode=function(t,e){for(var n=[],r=new Array(this.params.length),i=0;i<this.params.length;i++){var o=this.params[i],s=o.conversions[0];o.varArgs?r[i]="varArgs":s?r[i]=t.add(s.convert,"convert")+"(arg"+i+")":r[i]="arg"+i}var a=this.fn?t.add(this.fn,"signature"):void 0;return a?e+"return "+a+"("+r.join(", ")+"); // signature: "+this.params.join(", "):n.join("\n")},s.prototype.toString=function(){return this.params.join(", ")},a.prototype.toCode=function(t,n,r){var i=[];if(this.param){var o=this.path.length-1,s=this.param.conversions[0],a="// type: "+(s?s.from+" (convert to "+s.to+")":this.param);if(this.param.varArgs)if(this.param.anyType)i.push(n+"if (arguments.length > "+o+") {"),i.push(n+"  var varArgs = [];"),i.push(n+"  for (var i = "+o+"; i < arguments.length; i++) {"),i.push(n+"    varArgs.push(arguments[i]);"),i.push(n+"  }"),i.push(this.signature.toCode(t,n+"  ")),i.push(n+"}");else{for(var l=function(n,r){for(var i=[],o=0;o<n.length;o++)i[o]=t.add(e(n[o]),"test")+"("+r+")";return i.join(" || ")}.bind(this),h=this.param.types,c=[],u=0;u<h.length;u++)void 0===this.param.conversions[u]&&c.push(h[u]);i.push(n+"if ("+l(h,"arg"+o)+") { "+a),i.push(n+"  var varArgs = [arg"+o+"];"),i.push(n+"  for (var i = "+(o+1)+"; i < arguments.length; i++) {"),i.push(n+"    if ("+l(c,"arguments[i]")+") {"),i.push(n+"      varArgs.push(arguments[i]);");for(var u=0;u<h.length;u++){var d=this.param.conversions[u];if(d){var p=t.add(e(h[u]),"test"),f=t.add(d.convert,"convert");i.push(n+"    }"),i.push(n+"    else if ("+p+"(arguments[i])) {"),i.push(n+"      varArgs.push("+f+"(arguments[i]));")}}i.push(n+"    } else {"),i.push(n+"      throw createError(name, arguments.length, i, arguments[i], '"+c.join(",")+"');"),i.push(n+"    }"),i.push(n+"  }"),i.push(this.signature.toCode(t,n+"  ")),i.push(n+"}")}else if(this.param.anyType)i.push(n+"// type: any"),i.push(this._innerCode(t,n,r));else{var g=this.param.types[0],p="any"!==g?t.add(e(g),"test"):null;i.push(n+"if ("+p+"(arg"+o+")) { "+a),i.push(this._innerCode(t,n+"  ",r)),i.push(n+"}")}}else i.push(this._innerCode(t,n,r));return i.join("\n")},a.prototype._innerCode=function(t,e,n){var r,i=[];this.signature&&(i.push(e+"if (arguments.length === "+this.path.length+") {"),i.push(this.signature.toCode(t,e+"  ")),i.push(e+"}"));var o;for(r=0;r<this.childs.length;r++)if(this.childs[r].param.anyType){o=this.childs[r];break}for(r=0;r<this.childs.length;r++)i.push(this.childs[r].toCode(t,e,o));n&&!this.param.anyType&&i.push(n.toCode(t,e,o));var s=this._exceptions(t,e);return s&&i.push(s),i.join("\n")},a.prototype._exceptions=function(t,e){var n=this.path.length;if(0===this.childs.length)return[e+"if (arguments.length > "+n+") {",e+"  throw createError(name, arguments.length, "+n+", arguments["+n+"]);",e+"}"].join("\n");for(var r={},i=[],o=0;o<this.childs.length;o++){var s=this.childs[o];if(s.param)for(var a=0;a<s.param.types.length;a++){var l=s.param.types[a];l in r||s.param.conversions[a]||(r[l]=!0,i.push(l))}}return e+"throw createError(name, arguments.length, "+n+", arguments["+n+"], '"+i.join(",")+"');"};var y=[{name:"number",test:function(t){return"number"==typeof t}},{name:"string",test:function(t){return"string"==typeof t}},{name:"boolean",test:function(t){return"boolean"==typeof t}},{name:"Function",test:function(t){return"function"==typeof t}},{name:"Array",test:Array.isArray},{name:"Date",test:function(t){return t instanceof Date}},{name:"RegExp",test:function(t){return t instanceof RegExp}},{name:"Object",test:function(t){return"object"==typeof t}},{name:"null",test:function(t){return null===t}},{name:"undefined",test:function(t){return void 0===t}}],v={},C=[],w=[],b={config:v,types:y,conversions:C,ignore:w};return b=d("typed",{Object:function(t){var e=[];for(var r in t)t.hasOwnProperty(r)&&e.push(t[r]);var i=n(e);return d(i,t)},"string, Object":d,"...Function":function(t){for(var e,r=n(t),i={},o=0;o<t.length;o++){var s=t[o];if("object"!=typeof s.signatures)throw e=new TypeError("Function is no typed-function (index: "+o+")"),e.data={index:o},e;for(var a in s.signatures)if(s.signatures.hasOwnProperty(a))if(i.hasOwnProperty(a)){if(s.signatures[a]!==i[a])throw e=new Error('Signature "'+a+'" is defined twice'),e.data={signature:a},e}else i[a]=s.signatures[a]}return d(r,i)}}),b.config=v,b.types=y,b.conversions=C,b.ignore=w,b.create=t,b.find=m,b.convert=x,b.addType=function(t){if(!t||"string"!=typeof t.name||"function"!=typeof t.test)throw new TypeError("Object with properties {name: string, test: function} expected");b.types.push(t)},b.addConversion=function(t){if(!t||"string"!=typeof t.from||"string"!=typeof t.to||"function"!=typeof t.convert)throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");b.conversions.push(t)},b}return t()})},function(t,e,n){"use strict";var r=n(7);e.isNumber=function(t){return"number"==typeof t},e.isInteger=function(t){return!!isFinite(t)&&t==Math.round(t)},e.sign=Math.sign||function(t){return t>0?1:0>t?-1:0},e.format=function(t,n){if("function"==typeof n)return n(t);if(t===1/0)return"Infinity";if(t===-(1/0))return"-Infinity";if(isNaN(t))return"NaN";var r="auto",i=void 0;switch(n&&(n.notation&&(r=n.notation),e.isNumber(n)?i=n:n.precision&&(i=n.precision)),r){case"fixed":return e.toFixed(t,i);case"exponential":return e.toExponential(t,i);case"engineering":return e.toEngineering(t,i);case"auto":return e.toPrecision(t,i,n&&n.exponential).replace(/((\.\d*?)(0+))($|e)/,function(){var t=arguments[2],e=arguments[4];return"."!==t?t+e:e});default:throw new Error('Unknown notation "'+r+'". Choose "auto", "exponential", or "fixed".')}},e.toExponential=function(t,e){return new r(t).toExponential(e)},e.toEngineering=function(t,e){return new r(t).toEngineering(e)},e.toFixed=function(t,e){return new r(t).toFixed(e)},e.toPrecision=function(t,e,n){return new r(t).toPrecision(e,n)},e.digits=function(t){return t.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length},e.DBL_EPSILON=Number.EPSILON||2.220446049250313e-16,e.nearlyEqual=function(t,n,r){if(null==r)return t==n;if(t==n)return!0;if(isNaN(t)||isNaN(n))return!1;if(isFinite(t)&&isFinite(n)){var i=Math.abs(t-n);return i<e.DBL_EPSILON||i<=Math.max(Math.abs(t),Math.abs(n))*r}return!1}},function(t,e){"use strict";function n(t){var e=String(t).toLowerCase().match(/^0*?(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!e)throw new SyntaxError("Invalid number");var n=e[1],r=e[2],i=parseFloat(e[4]||"0"),o=r.indexOf(".");i+=-1!==o?o-1:r.length-1,this.sign=n,this.coefficients=r.replace(".","").replace(/^0*/,function(t){return i-=t.length,""}).replace(/0*$/,"").split("").map(function(t){return parseInt(t)}),0===this.coefficients.length&&(this.coefficients.push(0),i++),this.exponent=i}function r(t){for(var e=[],n=0;t>n;n++)e.push(0);return e}n.prototype.toEngineering=function(t){var e=this.roundDigits(t),n=e.exponent,i=e.coefficients,o=n%3===0?n:0>n?n-3-n%3:n-n%3,s=n>=0?n:Math.abs(o);i.length-1<s&&(i=i.concat(r(s-(i.length-1))));for(var a=Math.abs(n-o),l=1,h="";--a>=0;)l++;var c=i.slice(l).join(""),u=c.match(/[1-9]/)?"."+c:"";return h=i.slice(0,l).join("")+u,h+="e"+(n>=0?"+":"")+o.toString(),e.sign+h},n.prototype.toFixed=function(t){var e=this.roundDigits(this.exponent+1+(t||0)),n=e.coefficients,i=e.exponent+1,o=i+(t||0);return n.length<o&&(n=n.concat(r(o-n.length))),0>i&&(n=r(-i+1).concat(n),i=1),t&&n.splice(i,0,0===i?"0.":"."),this.sign+n.join("")},n.prototype.toExponential=function(t){var e=t?this.roundDigits(t):this.clone(),n=e.coefficients,i=e.exponent;n.length<t&&(n=n.concat(r(t-n.length)));var o=n.shift();return this.sign+o+(n.length>0?"."+n.join(""):"")+"e"+(i>=0?"+":"")+i},n.prototype.toPrecision=function(t,e){var n=e&&void 0!==e.lower?e.lower:.001,i=e&&void 0!==e.upper?e.upper:1e5,o=Math.abs(Math.pow(10,this.exponent));if(n>o||o>=i)return this.toExponential(t);var s=t?this.roundDigits(t):this.clone(),a=s.coefficients,l=s.exponent;a.length<t&&(a=a.concat(r(t-a.length))),a=a.concat(r(l-a.length+1+(a.length<t?t-a.length:0))),a=r(-l).concat(a);var h=l>0?l:0;return h<a.length-1&&a.splice(h+1,0,"."),this.sign+a.join("")},n.prototype.clone=function(){var t=new n("0");return t.sign=this.sign,t.coefficients=this.coefficients.slice(0),t.exponent=this.exponent,t},n.prototype.roundDigits=function(t){for(var e=this.clone(),n=e.coefficients;0>=t;)n.unshift(0),e.exponent++,t++;if(n.length>t){var r=n.splice(t,n.length-t);if(r[0]>=5){var i=t-1;for(n[i]++;10===n[i];)n.pop(),0===i&&(n.unshift(0),e.exponent++,i++),i--,n[i]++}}return e},t.exports=n},function(t,e,n){var r=n(9);e.mixin=function(t){var e=new r;return t.on=e.on.bind(e),t.off=e.off.bind(e),t.once=e.once.bind(e),t.emit=e.emit.bind(e),t}},function(t,e){function n(){}n.prototype={on:function(t,e,n){var r=this.e||(this.e={});return(r[t]||(r[t]=[])).push({fn:e,ctx:n}),this},once:function(t,e,n){function r(){i.off(t,r),e.apply(n,arguments)}var i=this;return r._=e,this.on(t,r,n)},emit:function(t){var e=[].slice.call(arguments,1),n=((this.e||(this.e={}))[t]||[]).slice(),r=0,i=n.length;for(r;i>r;r++)n[r].fn.apply(n[r].ctx,e);return this},off:function(t,e){var n=this.e||(this.e={}),r=n[t],i=[];if(r&&e)for(var o=0,s=r.length;s>o;o++)r[o].fn!==e&&r[o].fn._!==e&&i.push(r[o]);return i.length?n[t]=i:delete n[t],this}},t.exports=n},function(t,e,n){"use strict";function r(t,e,n,r,l){function h(t,e){var n=arguments.length;if(1!=n&&2!=n)throw new a("import",n,1,2);if(e||(e={}),o(t))p(t,e);else if(Array.isArray(t))t.forEach(function(t){h(t,e)});else if("object"==typeof t){for(var r in t)if(t.hasOwnProperty(r)){var i=t[r];f(i)?c(r,i,e):o(t)?p(t,e):h(i,e)}}else if(!e.silent)throw new TypeError("Factory, Object, or Array expected")}function c(t,e,n){if(n.wrap&&"function"==typeof e&&(e=d(e)),g(l[t])&&g(e))return e=n.override?r(t,e.signatures):r(l[t],e),l[t]=e,u(t,e),void l.emit("import",t,function(){return e});if(void 0===l[t]||n.override)return l[t]=e,u(t,e),void l.emit("import",t,function(){return e});if(!n.silent)throw new Error('Cannot import "'+t+'": already exists')}function u(t,e){e&&"function"==typeof e.transform&&(l.expression.transform[t]=e.transform)}function d(t){var e=function(){for(var e=[],n=0,r=arguments.length;r>n;n++){var i=arguments[n];e[n]=i&&i.valueOf()}return t.apply(l,e)};return t.transform&&(e.transform=t.transform),e}function p(t,e){if("string"==typeof t.name){var o=t.name,a=t.path?s(l,t.path):l,h=a.hasOwnProperty(o)?a[o]:void 0,c=function(){var i=n(t);if(g(h)&&g(i))return e.override||(i=r(h,i)),i;if(void 0===h||e.override)return i;if(!e.silent)throw new Error('Cannot import "'+o+'": already exists')};t.lazy!==!1?i(a,o,c):a[o]=c(),l.emit("import",o,c,t.path)}else n(t)}function f(t){return"function"==typeof t||"number"==typeof t||"string"==typeof t||"boolean"==typeof t||null===t||t&&t.isUnit===!0||t&&t.isComplex===!0||t&&t.isBigNumber===!0||t&&t.isFraction===!0||t&&t.isMatrix===!0||t&&Array.isArray(t)===!0}function g(t){return"function"==typeof t&&"object"==typeof t.signatures}return h}var i=n(3).lazy,o=n(3).isFactory,s=n(3).traverse,a=(n(3).extend,n(11));e.math=!0,e.name="import",e.factory=r,e.lazy=!0},function(t,e){"use strict";function n(t,e,r,i){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");this.fn=t,this.count=e,this.min=r,this.max=i,this.message="Wrong number of arguments in function "+t+" ("+e+" provided, "+r+(void 0!=i?"-"+i:"")+" expected)",this.stack=(new Error).stack}n.prototype=new Error,n.prototype.constructor=Error,n.prototype.name="ArgumentsError",n.prototype.isArgumentsError=!0,t.exports=n},function(t,e,n){"use strict";function r(t,e,n,r,i){function o(t){if(t){var n=a.clone(e);s(t,"matrix",l),s(t,"number",h),a.deepExtend(e,t);var r=a.clone(e);return i.emit("config",r,n),r}return a.clone(e)}var l=["Matrix","Array"],h=["number","BigNumber","Fraction"];return o.MATRIX=l,o.NUMBER=h,o}function i(t,e){return-1!==t.indexOf(e)}function o(t,e){return t.map(function(t){return t.toLowerCase()}).indexOf(e.toLowerCase())}function s(t,e,n){if(void 0!==t[e]&&!i(n,t[e])){var r=o(n,t[e]);-1!==r?(console.warn('Warning: Wrong casing for configuration option "'+e+'", should be "'+n[r]+'" instead of "'+t[e]+'".'),t[e]=n[r]):console.warn('Warning: Unknown value "'+t[e]+'" for configuration option "'+e+'". Available options: '+n.map(JSON.stringify).join(", ")+".")}}var a=n(3);e.name="config",e.math=!0,e.factory=r},function(t,e,n){t.exports=[n(14),n(100),n(102),n(335),n(499),n(501)]},function(t,e,n){t.exports=[n(15),n(20),n(21),n(26),n(33),n(37),n(70),n(71),n(73),n(74)]},function(t,e,n){t.exports=[n(16),n(18)]},function(t,e,n){function r(t,e,n,r,o){var s=i.clone({precision:e.precision});return s.prototype.type="BigNumber",s.prototype.isBigNumber=!0,s.prototype.toJSON=function(){return{mathjs:"BigNumber",value:this.toString()}},s.fromJSON=function(t){return new s(t.value)},o.on("config",function(t,e){t.precision!==e.precision&&s.config({precision:t.precision})}),s}var i=n(17);e.name="BigNumber",e.path="type",e.factory=r,e.math=!0},function(t,e,n){var r;!function(i){"use strict";function o(t){var e,n,r,i=t.length-1,o="",s=t[0];if(i>0){for(o+=s,e=1;i>e;e++)r=t[e]+"",n=zt-r.length,n&&(o+=m(n)),o+=r;s=t[e],r=s+"",n=zt-r.length,n&&(o+=m(n))}else if(0===s)return"0";for(;s%10===0;)s/=10;return o+s}function s(t,e,n){if(t!==~~t||e>t||t>n)throw Error(It+t)}function a(t,e,n,r){var i,o,s,a;for(o=t[0];o>=10;o/=10)--e;return--e<0?(e+=zt,i=0):(i=Math.ceil((e+1)/zt),e%=zt),o=Tt(10,zt-e),a=t[i]%o|0,null==r?3>e?(0==e?a=a/100|0:1==e&&(a=a/10|0),s=4>n&&99999==a||n>3&&49999==a||5e4==a||0==a):s=(4>n&&a+1==o||n>3&&a+1==o/2)&&(t[i+1]/o/100|0)==Tt(10,e-2)-1||(a==o/2||0==a)&&0==(t[i+1]/o/100|0):4>e?(0==e?a=a/1e3|0:1==e?a=a/100|0:2==e&&(a=a/10|0),s=(r||4>n)&&9999==a||!r&&n>3&&4999==a):s=((r||4>n)&&a+1==o||!r&&n>3&&a+1==o/2)&&(t[i+1]/o/1e3|0)==Tt(10,e-3)-1,s}function l(t,e,n){for(var r,i,o=[0],s=0,a=t.length;a>s;){for(i=o.length;i--;)o[i]*=e;for(o[0]+=vt.indexOf(t.charAt(s++)),r=0;r<o.length;r++)o[r]>n-1&&(void 0===o[r+1]&&(o[r+1]=0),o[r+1]+=o[r]/n|0,o[r]%=n)}return o.reverse()}function h(t,e){var n,r,i=e.d.length;32>i?(n=Math.ceil(i/3),r=Math.pow(4,-n).toString()):(n=16,r="2.3283064365386962890625e-10"),t.precision+=n,e=I(t,1,e.times(r),new t(1));for(var o=n;o--;){var s=e.times(e);e=s.times(s).minus(s).times(8).plus(1)}return t.precision-=n,e}function c(t,e,n,r){var i,o,s,a,l,h,c,u,d,p=t.constructor;t:if(null!=e){if(u=t.d,!u)return t;for(i=1,a=u[0];a>=10;a/=10)i++;if(o=e-i,0>o)o+=zt,s=e,c=u[d=0],l=c/Tt(10,i-s-1)%10|0;else if(d=Math.ceil((o+1)/zt),a=u.length,d>=a){if(!r)break t;for(;a++<=d;)u.push(0);c=l=0,i=1,o%=zt,s=o-zt+1}else{for(c=a=u[d],i=1;a>=10;a/=10)i++;o%=zt,s=o-zt+i,l=0>s?0:c/Tt(10,i-s-1)%10|0}if(r=r||0>e||void 0!==u[d+1]||(0>s?c:c%Tt(10,i-s-1)),h=4>n?(l||r)&&(0==n||n==(t.s<0?3:2)):l>5||5==l&&(4==n||r||6==n&&(o>0?s>0?c/Tt(10,i-s):0:u[d-1])%10&1||n==(t.s<0?8:7)),1>e||!u[0])return u.length=0,h?(e-=t.e+1,u[0]=Tt(10,(zt-e%zt)%zt),t.e=-e||0):u[0]=t.e=0,t;if(0==o?(u.length=d,a=1,d--):(u.length=d+1,a=Tt(10,zt-o),u[d]=s>0?(c/Tt(10,i-s)%Tt(10,s)|0)*a:0),h)for(;;){if(0==d){for(o=1,s=u[0];s>=10;s/=10)o++;for(s=u[0]+=a,a=1;s>=10;s/=10)a++;o!=a&&(t.e++,u[0]==Rt&&(u[0]=1));break}if(u[d]+=a,u[d]!=Rt)break;u[d--]=0,a=1}for(o=u.length;0===u[--o];)u.pop()}return St&&(t.e>p.maxE?(t.d=null,t.e=NaN):t.e<p.minE&&(t.e=0,t.d=[0])),t}function u(t,e,n){if(!t.isFinite())return b(t);var r,i=t.e,s=o(t.d),a=s.length;return e?(n&&(r=n-a)>0?s=s.charAt(0)+"."+s.slice(1)+m(r):a>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(t.e<0?"e":"e+")+t.e):0>i?(s="0."+m(-i-1)+s,n&&(r=n-a)>0&&(s+=m(r))):i>=a?(s+=m(i+1-a),n&&(r=n-i-1)>0&&(s=s+"."+m(r))):((r=i+1)<a&&(s=s.slice(0,r)+"."+s.slice(r)),n&&(r=n-a)>0&&(i+1===a&&(s+="."),s+=m(r))),s}function d(t,e){for(var n=1,r=t[0];r>=10;r/=10)n++;return n+e*zt-1}function p(t,e,n){if(e>Lt)throw St=!0,n&&(t.precision=n),Error(Nt);return c(new t(Ct),e,1,!0)}function f(t,e,n){if(e>Dt)throw Error(Nt);return c(new t(wt),e,n,!0)}function g(t){var e=t.length-1,n=e*zt+1;if(e=t[e]){for(;e%10==0;e/=10)n--;for(e=t[0];e>=10;e/=10)n++}return n}function m(t){for(var e="";t--;)e+="0";return e}function x(t,e,n,r){var i,o=new t(1),s=Math.ceil(r/zt+4);for(St=!1;;){if(n%2&&(o=o.times(e),T(o.d,s)&&(i=!0)),n=Ot(n/2),0===n){n=o.d.length-1,i&&0===o.d[n]&&++o.d[n];break}e=e.times(e),T(e.d,s)}return St=!0,o}function y(t){return 1&t.d[t.d.length-1]}function v(t,e,n){for(var r,i=new t(e[0]),o=0;++o<e.length;){if(r=new t(e[o]),!r.s){i=r;break}i[n](r)&&(i=r)}return i}function C(t,e){var n,r,i,s,l,h,u,d=0,p=0,f=0,g=t.constructor,m=g.rounding,x=g.precision;if(!t.d||!t.d[0]||t.e>17)return new g(t.d?t.d[0]?t.s<0?0:1/0:1:t.s?t.s<0?0:t:NaN);for(null==e?(St=!1,u=x):u=e,h=new g(.03125);t.e>-2;)t=t.times(h),f+=5;for(r=Math.log(Tt(2,f))/Math.LN10*2+5|0,u+=r,n=s=l=new g(1),g.precision=u;;){if(s=c(s.times(t),u,1),n=n.times(++p),h=l.plus(Ft(s,n,u,1)),o(h.d).slice(0,u)===o(l.d).slice(0,u)){for(i=f;i--;)l=c(l.times(l),u,1);if(null!=e)return g.precision=x,l;if(!(3>d&&a(l.d,u-r,m,d)))return c(l,g.precision=x,m,St=!0);g.precision=u+=10,n=s=h=new g(1),p=0,d++}l=h}}function w(t,e){var n,r,i,s,l,h,u,d,f,g,m,x=1,y=10,v=t,C=v.d,b=v.constructor,M=b.rounding,S=b.precision;if(v.s<0||!C||!C[0]||!v.e&&1==C[0]&&1==C.length)return new b(C&&!C[0]?-1/0:1!=v.s?NaN:C?0:v);if(null==e?(St=!1,f=S):f=e,b.precision=f+=y,n=o(C),r=n.charAt(0),!(Math.abs(s=v.e)<15e14))return d=p(b,f+2,S).times(s+""),v=w(new b(r+"."+n.slice(1)),f-y).plus(d),b.precision=S,null==e?c(v,S,M,St=!0):v;for(;7>r&&1!=r||1==r&&n.charAt(1)>3;)v=v.times(t),n=o(v.d),r=n.charAt(0),x++;for(s=v.e,r>1?(v=new b("0."+n),s++):v=new b(r+"."+n.slice(1)),g=v,u=l=v=Ft(v.minus(1),v.plus(1),f,1),m=c(v.times(v),f,1),i=3;;){if(l=c(l.times(m),f,1),d=u.plus(Ft(l,new b(i),f,1)),o(d.d).slice(0,f)===o(u.d).slice(0,f)){if(u=u.times(2),0!==s&&(u=u.plus(p(b,f+2,S).times(s+""))),u=Ft(u,new b(x),f,1),null!=e)return b.precision=S,u;if(!a(u.d,f-y,M,h))return c(u,b.precision=S,M,St=!0);b.precision=f+=y,d=l=v=Ft(g.minus(1),g.plus(1),f,1),m=c(v.times(v),f,1),i=h=1}u=d,i+=2}}function b(t){return String(t.s*t.s/0)}function M(t,e){var n,r,i;for((n=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(0>n&&(n=r),n+=+e.slice(r+1),e=e.substring(0,r)):0>n&&(n=e.length),r=0;48===e.charCodeAt(r);r++);for(i=e.length;48===e.charCodeAt(i-1);--i);if(e=e.slice(r,i)){if(i-=r,t.e=n=n-r-1,t.d=[],r=(n+1)%zt,0>n&&(r+=zt),i>r){for(r&&t.d.push(+e.slice(0,r)),i-=zt;i>r;)t.d.push(+e.slice(r,r+=zt));e=e.slice(r),r=zt-e.length}else r-=i;for(;r--;)e+="0";t.d.push(+e),St&&(t.e>t.constructor.maxE?(t.d=null,t.e=NaN):t.e<t.constructor.minE&&(t.e=0,t.d=[0]))}else t.e=0,t.d=[0];return t}function S(t,e){var n,r,i,o,s,a,h,c,u;if("Infinity"===e||"NaN"===e)return+e||(t.s=NaN),t.e=NaN,t.d=null,t;if(Pt.test(e))n=16,e=e.toLowerCase();else if(_t.test(e))n=2;else{if(!At.test(e))throw Error(It+e);n=8}for(o=e.search(/p/i),o>0?(h=+e.slice(o+1),e=e.substring(2,o)):e=e.slice(2),o=e.indexOf("."),s=o>=0,r=t.constructor,s&&(e=e.replace(".",""),a=e.length,o=a-o,i=x(r,new r(n),o,2*o)),c=l(e,n,Rt),u=c.length-1,o=u;0===c[o];--o)c.pop();return 0>o?new r(0*t.s):(t.e=d(c,u),t.d=c,St=!1,s&&(t=Ft(t,i,4*a)),h&&(t=t.times(Math.abs(h)<54?Math.pow(2,h):bt.pow(2,h))),St=!0,t)}function E(t,e){var n,r=e.d.length;if(3>r)return I(t,2,e,e);n=1.4*Math.sqrt(r),n=n>16?16:0|n,e=e.times(Math.pow(5,-n)),e=I(t,2,e,e);for(var i,o=new t(5),s=new t(16),a=new t(20);n--;)i=e.times(e),e=e.times(o.plus(i.times(s.times(i).minus(a))));return e}function I(t,e,n,r,i){var o,s,a,l,h=1,c=t.precision,u=Math.ceil(c/zt);for(St=!1,l=n.times(n),a=new t(r);;){if(s=Ft(a.times(l),new t(e++*e++),c,1),a=i?r.plus(s):r.minus(s),r=Ft(s.times(l),new t(e++*e++),c,1),s=a.plus(r),void 0!==s.d[u]){for(o=u;s.d[o]===a.d[o]&&o--;);if(-1==o)break}o=a,a=r,r=s,s=o,h++}return St=!0,s.d.length=u+1,s}function N(t,e){var n,r=e.s<0,i=f(t,t.precision,1),o=i.times(.5);if(e=e.abs(),e.lte(o))return mt=r?4:1,e;if(n=e.divToInt(i),n.isZero())mt=r?3:2;else{if(e=e.minus(n.times(i)),e.lte(o))return mt=y(n)?r?2:3:r?4:1,e;mt=y(n)?r?1:4:r?3:2}return e.minus(i).abs()}function O(t,e,n,r){var i,o,a,h,c,d,p,f,g,m=t.constructor,x=void 0!==n;if(x?(s(n,1,yt),void 0===r?r=m.rounding:s(r,0,8)):(n=m.precision,
r=m.rounding),t.isFinite()){for(p=u(t),a=p.indexOf("."),x?(i=2,16==e?n=4*n-3:8==e&&(n=3*n-2)):i=e,a>=0&&(p=p.replace(".",""),g=new m(1),g.e=p.length-a,g.d=l(u(g),10,i),g.e=g.d.length),f=l(p,10,i),o=c=f.length;0==f[--c];)f.pop();if(f[0]){if(0>a?o--:(t=new m(t),t.d=f,t.e=o,t=Ft(t,g,n,r,0,i),f=t.d,o=t.e,d=gt),a=f[n],h=i/2,d=d||void 0!==f[n+1],d=4>r?(void 0!==a||d)&&(0===r||r===(t.s<0?3:2)):a>h||a===h&&(4===r||d||6===r&&1&f[n-1]||r===(t.s<0?8:7)),f.length=n,d)for(;++f[--n]>i-1;)f[n]=0,n||(++o,f.unshift(1));for(c=f.length;!f[c-1];--c);for(a=0,p="";c>a;a++)p+=vt.charAt(f[a]);if(x){if(c>1)if(16==e||8==e){for(a=16==e?4:3,--c;c%a;c++)p+="0";for(f=l(p,i,e),c=f.length;!f[c-1];--c);for(a=1,p="1.";c>a;a++)p+=vt.charAt(f[a])}else p=p.charAt(0)+"."+p.slice(1);p=p+(0>o?"p":"p+")+o}else if(0>o){for(;++o;)p="0"+p;p="0."+p}else if(++o>c)for(o-=c;o--;)p+="0";else c>o&&(p=p.slice(0,o)+"."+p.slice(o))}else p=x?"0p+0":"0";p=(16==e?"0x":2==e?"0b":8==e?"0o":"")+p}else p=b(t);return t.s<0?"-"+p:p}function T(t,e){return t.length>e?(t.length=e,!0):void 0}function _(t){return new this(t).abs()}function P(t){return new this(t).acos()}function A(t){return new this(t).acosh()}function k(t,e){return new this(t).plus(e)}function R(t){return new this(t).asin()}function z(t){return new this(t).asinh()}function B(t){return new this(t).atan()}function L(t){return new this(t).atanh()}function D(t,e){t=new this(t),e=new this(e);var n,r=this.precision,i=this.rounding,o=r+4;return t.s&&e.s?t.d||e.d?!e.d||t.isZero()?(n=e.s<0?f(this,r,i):new this(0),n.s=t.s):!t.d||e.isZero()?(n=f(this,o,1).times(.5),n.s=t.s):e.s<0?(this.precision=o,this.rounding=1,n=this.atan(Ft(t,e,o,1)),e=f(this,o,1),this.precision=r,this.rounding=i,n=t.s<0?n.minus(e):n.plus(e)):n=this.atan(Ft(t,e,o,1)):(n=f(this,o,1).times(e.s>0?.25:.75),n.s=t.s):n=new this(NaN),n}function W(t){return new this(t).cbrt()}function F(t){return c(t=new this(t),t.e+1,2)}function V(t){if(!t||"object"!=typeof t)throw Error(Et+"Object expected");var e,n,r,i=["precision",1,yt,"rounding",0,8,"toExpNeg",-xt,0,"toExpPos",0,xt,"maxE",0,xt,"minE",-xt,0,"modulo",0,9];for(e=0;e<i.length;e+=3)if(void 0!==(r=t[n=i[e]])){if(!(Ot(r)===r&&r>=i[e+1]&&r<=i[e+2]))throw Error(It+n+": "+r);this[n]=r}if(t.hasOwnProperty(n="crypto"))if(void 0===(r=t[n]))this[n]=r;else{if(r!==!0&&r!==!1&&0!==r&&1!==r)throw Error(It+n+": "+r);this[n]=!(!r||!Mt||!Mt.getRandomValues&&!Mt.randomBytes)}return this}function q(t){return new this(t).cos()}function H(t){return new this(t).cosh()}function U(t){function e(t){var n,r,i,o=this;if(!(o instanceof e))return new e(t);if(o.constructor=e,t instanceof e)return o.s=t.s,o.e=t.e,void(o.d=(t=t.d)?t.slice():t);if(i=typeof t,"number"===i){if(0===t)return o.s=0>1/t?-1:1,o.e=0,void(o.d=[0]);if(0>t?(t=-t,o.s=-1):o.s=1,t===~~t&&1e7>t){for(n=0,r=t;r>=10;r/=10)n++;return o.e=n,void(o.d=[t])}return 0*t!==0?(t||(o.s=NaN),o.e=NaN,void(o.d=null)):M(o,t.toString())}if("string"!==i)throw Error(It+t);return 45===t.charCodeAt(0)?(t=t.slice(1),o.s=-1):o.s=1,kt.test(t)?M(o,t):S(o,t)}var n,r,i;if(e.prototype=Wt,e.ROUND_UP=0,e.ROUND_DOWN=1,e.ROUND_CEIL=2,e.ROUND_FLOOR=3,e.ROUND_HALF_UP=4,e.ROUND_HALF_DOWN=5,e.ROUND_HALF_EVEN=6,e.ROUND_HALF_CEIL=7,e.ROUND_HALF_FLOOR=8,e.EUCLID=9,e.config=V,e.clone=U,e.abs=_,e.acos=P,e.acosh=A,e.add=k,e.asin=R,e.asinh=z,e.atan=B,e.atanh=L,e.atan2=D,e.cbrt=W,e.ceil=F,e.cos=q,e.cosh=H,e.div=j,e.exp=$,e.floor=G,e.fromJSON=Y,e.hypot=J,e.ln=X,e.log=Z,e.log10=K,e.log2=Q,e.max=tt,e.min=et,e.mod=nt,e.mul=rt,e.pow=it,e.random=ot,e.round=st,e.sign=at,e.sin=lt,e.sinh=ht,e.sqrt=ct,e.sub=ut,e.tan=dt,e.tanh=pt,e.trunc=ft,void 0===t&&(t={}),t)for(i=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],n=0;n<i.length;)t.hasOwnProperty(r=i[n++])||(t[r]=this[r]);return e.config(t),e}function j(t,e){return new this(t).div(e)}function $(t){return new this(t).exp()}function G(t){return c(t=new this(t),t.e+1,3)}function Y(t){var e,n,r,i;if("string"!=typeof t||!t)throw Error(It+t);if(r=t.length,i=vt.indexOf(t.charAt(0)),1===r)return new this(i>81?[-1/0,1/0,NaN][i-82]:i>40?-(i-41):i);if(64&i)n=16&i,e=n?(7&i)-3:(15&i)-7,r=1;else{if(2===r)return i=88*i+vt.indexOf(t.charAt(1)),new this(i>=2816?-(i-2816)-41:i+41);if(n=32&i,!(31&i))return t=l(t.slice(1),88,10).join(""),new this(n?"-"+t:t);e=15&i,r=e+1,e=1===e?vt.indexOf(t.charAt(1)):2===e?88*vt.indexOf(t.charAt(1))+vt.indexOf(t.charAt(2)):+l(t.slice(1,r),88,10).join(""),16&i&&(e=-e)}return t=l(t.slice(r),88,10).join(""),e=e-t.length+1,t=t+"e"+e,new this(n?"-"+t:t)}function J(){var t,e,n=new this(0);for(St=!1,t=0;t<arguments.length;)if(e=new this(arguments[t++]),e.d)n.d&&(n=n.plus(e.times(e)));else{if(e.s)return St=!0,new this(1/0);n=e}return St=!0,n.sqrt()}function X(t){return new this(t).ln()}function Z(t,e){return new this(t).log(e)}function Q(t){return new this(t).log(2)}function K(t){return new this(t).log(10)}function tt(){return v(this,arguments,"lt")}function et(){return v(this,arguments,"gt")}function nt(t,e){return new this(t).mod(e)}function rt(t,e){return new this(t).mul(e)}function it(t,e){return new this(t).pow(e)}function ot(t){var e,n,r,i,o=0,a=new this(1),l=[];if(void 0===t?t=this.precision:s(t,1,yt),r=Math.ceil(t/zt),this.crypto===!1)for(;r>o;)l[o++]=1e7*Math.random()|0;else if(Mt&&Mt.getRandomValues)for(e=Mt.getRandomValues(new Uint32Array(r));r>o;)i=e[o],i>=429e7?e[o]=Mt.getRandomValues(new Uint32Array(1))[0]:l[o++]=i%1e7;else if(Mt&&Mt.randomBytes){for(e=Mt.randomBytes(r*=4);r>o;)i=e[o]+(e[o+1]<<8)+(e[o+2]<<16)+((127&e[o+3])<<24),i>=214e7?Mt.randomBytes(4).copy(e,o):(l.push(i%1e7),o+=4);o=r/4}else{if(this.crypto)throw Error(Et+"crypto unavailable");for(;r>o;)l[o++]=1e7*Math.random()|0}for(r=l[--o],t%=zt,r&&t&&(i=Tt(10,zt-t),l[o]=(r/i|0)*i);0===l[o];o--)l.pop();if(0>o)n=0,l=[0];else{for(n=-1;0===l[0];n-=zt)l.shift();for(r=1,i=l[0];i>=10;i/=10)r++;zt>r&&(n-=zt-r)}return a.e=n,a.d=l,a}function st(t){return c(t=new this(t),t.e+1,this.rounding)}function at(t){return t=new this(t),t.d?t.d[0]?t.s:0*t.s:t.s||NaN}function lt(t){return new this(t).sin()}function ht(t){return new this(t).sinh()}function ct(t){return new this(t).sqrt()}function ut(t,e){return new this(t).sub(e)}function dt(t){return new this(t).tan()}function pt(t){return new this(t).tanh()}function ft(t){return c(t=new this(t),t.e+1,1)}var gt,mt,xt=9e15,yt=1e9,vt="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!#$%()*+,-./:;=?@[]^_`{|}~",Ct="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",wt="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",bt={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-xt,maxE:xt,crypto:void 0},Mt="undefined"!=typeof crypto?crypto:null,St=!0,Et="[DecimalError] ",It=Et+"Invalid argument: ",Nt=Et+"Precision limit exceeded",Ot=Math.floor,Tt=Math.pow,_t=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Pt=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,At=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,kt=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Rt=1e7,zt=7,Bt=9007199254740991,Lt=Ct.length-1,Dt=wt.length-1,Wt={};Wt.absoluteValue=Wt.abs=function(){var t=new this.constructor(this);return t.s<0&&(t.s=1),c(t)},Wt.ceil=function(){return c(new this.constructor(this),this.e+1,2)},Wt.comparedTo=Wt.cmp=function(t){var e,n,r,i,o=this,s=o.d,a=(t=new o.constructor(t)).d,l=o.s,h=t.s;if(!s||!a)return l&&h?l!==h?l:s===a?0:!s^0>l?1:-1:NaN;if(!s[0]||!a[0])return s[0]?l:a[0]?-h:0;if(l!==h)return l;if(o.e!==t.e)return o.e>t.e^0>l?1:-1;for(r=s.length,i=a.length,e=0,n=i>r?r:i;n>e;++e)if(s[e]!==a[e])return s[e]>a[e]^0>l?1:-1;return r===i?0:r>i^0>l?1:-1},Wt.cosine=Wt.cos=function(){var t,e,n=this,r=n.constructor;return n.d?n.d[0]?(t=r.precision,e=r.rounding,r.precision=t+Math.max(n.e,n.sd())+zt,r.rounding=1,n=h(r,N(r,n)),r.precision=t,r.rounding=e,c(2==mt||3==mt?n.neg():n,t,e,!0)):new r(1):new r(NaN)},Wt.cubeRoot=Wt.cbrt=function(){var t,e,n,r,i,s,a,l,h,u,d=this,p=d.constructor;if(!d.isFinite()||d.isZero())return new p(d);for(St=!1,s=d.s*Math.pow(d.s*d,1/3),s&&Math.abs(s)!=1/0?r=new p(s.toString()):(n=o(d.d),t=d.e,(s=(t-n.length+1)%3)&&(n+=1==s||-2==s?"0":"00"),s=Math.pow(n,1/3),t=Ot((t+1)/3)-(t%3==(0>t?-1:2)),s==1/0?n="5e"+t:(n=s.toExponential(),n=n.slice(0,n.indexOf("e")+1)+t),r=new p(n),r.s=d.s),a=(t=p.precision)+3;;)if(l=r,h=l.times(l).times(l),u=h.plus(d),r=Ft(u.plus(d).times(l),u.plus(h),a+2,1),o(l.d).slice(0,a)===(n=o(r.d)).slice(0,a)){if(n=n.slice(a-3,a+1),"9999"!=n&&(i||"4999"!=n)){+n&&(+n.slice(1)||"5"!=n.charAt(0))||(c(r,t+1,1),e=!r.times(r).times(r).eq(d));break}if(!i&&(c(l,t+1,0),l.times(l).times(l).eq(d))){r=l;break}a+=4,i=1}return St=!0,c(r,t,p.rounding,e)},Wt.decimalPlaces=Wt.dp=function(){var t,e=this.d,n=NaN;if(e){if(t=e.length-1,n=(t-Ot(this.e/zt))*zt,t=e[t])for(;t%10==0;t/=10)n--;0>n&&(n=0)}return n},Wt.dividedBy=Wt.div=function(t){return Ft(this,new this.constructor(t))},Wt.dividedToIntegerBy=Wt.divToInt=function(t){var e=this,n=e.constructor;return c(Ft(e,new n(t),0,1,1),n.precision,n.rounding)},Wt.equals=Wt.eq=function(t){return 0===this.cmp(t)},Wt.floor=function(){return c(new this.constructor(this),this.e+1,3)},Wt.greaterThan=Wt.gt=function(t){return this.cmp(t)>0},Wt.greaterThanOrEqualTo=Wt.gte=function(t){var e=this.cmp(t);return 1==e||0===e},Wt.hyperbolicCosine=Wt.cosh=function(){var t,e,n,r,i,o=this,s=o.constructor,a=new s(1);if(!o.isFinite())return new s(o.s?1/0:NaN);if(o.isZero())return a;n=s.precision,r=s.rounding,s.precision=n+Math.max(o.e,o.sd())+4,s.rounding=1,i=o.d.length,32>i?(t=Math.ceil(i/3),e=Math.pow(4,-t).toString()):(t=16,e="2.3283064365386962890625e-10"),o=I(s,1,o.times(e),new s(1),!0);for(var l,h=t,u=new s(8);h--;)l=o.times(o),o=a.minus(l.times(u.minus(l.times(u))));return c(o,s.precision=n,s.rounding=r,!0)},Wt.hyperbolicSine=Wt.sinh=function(){var t,e,n,r,i=this,o=i.constructor;if(!i.isFinite()||i.isZero())return new o(i);if(e=o.precision,n=o.rounding,o.precision=e+Math.max(i.e,i.sd())+4,o.rounding=1,r=i.d.length,3>r)i=I(o,2,i,i,!0);else{t=1.4*Math.sqrt(r),t=t>16?16:0|t,i=i.times(Math.pow(5,-t)),i=I(o,2,i,i,!0);for(var s,a=new o(5),l=new o(16),h=new o(20);t--;)s=i.times(i),i=i.times(a.plus(s.times(l.times(s).plus(h))))}return o.precision=e,o.rounding=n,c(i,e,n,!0)},Wt.hyperbolicTangent=Wt.tanh=function(){var t,e,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+7,r.rounding=1,Ft(n.sinh(),n.cosh(),r.precision=t,r.rounding=e)):new r(n.s)},Wt.inverseCosine=Wt.acos=function(){var t,e=this,n=e.constructor,r=e.abs().cmp(1),i=n.precision,o=n.rounding;return-1!==r?0===r?e.isNeg()?f(n,i,o):new n(0):new n(NaN):e.isZero()?f(n,i+4,o).times(.5):(n.precision=i+6,n.rounding=1,e=e.asin(),t=f(n,i+4,o).times(.5),n.precision=i,n.rounding=o,t.minus(e))},Wt.inverseHyperbolicCosine=Wt.acosh=function(){var t,e,n=this,r=n.constructor;return n.lte(1)?new r(n.eq(1)?0:NaN):n.isFinite()?(t=r.precision,e=r.rounding,r.precision=t+Math.max(Math.abs(n.e),n.sd())+4,r.rounding=1,St=!1,n=n.times(n).minus(1).sqrt().plus(n),St=!0,r.precision=t,r.rounding=e,n.ln()):new r(n)},Wt.inverseHyperbolicSine=Wt.asinh=function(){var t,e,n=this,r=n.constructor;return!n.isFinite()||n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+2*Math.max(Math.abs(n.e),n.sd())+6,r.rounding=1,St=!1,n=n.times(n).plus(1).sqrt().plus(n),St=!0,r.precision=t,r.rounding=e,n.ln())},Wt.inverseHyperbolicTangent=Wt.atanh=function(){var t,e,n,r,i=this,o=i.constructor;return i.isFinite()?i.e>=0?new o(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(t=o.precision,e=o.rounding,r=i.sd(),Math.max(r,t)<2*-i.e-1?c(new o(i),t,e,!0):(o.precision=n=r-i.e,i=Ft(i.plus(1),new o(1).minus(i),n+t,1),o.precision=t+4,o.rounding=1,i=i.ln(),o.precision=t,o.rounding=e,i.times(.5))):new o(NaN)},Wt.inverseSine=Wt.asin=function(){var t,e,n,r,i=this,o=i.constructor;return i.isZero()?new o(i):(e=i.abs().cmp(1),n=o.precision,r=o.rounding,-1!==e?0===e?(t=f(o,n+4,r).times(.5),t.s=i.s,t):new o(NaN):(o.precision=n+6,o.rounding=1,i=i.div(new o(1).minus(i.times(i)).sqrt().plus(1)).atan(),o.precision=n,o.rounding=r,i.times(2)))},Wt.inverseTangent=Wt.atan=function(){var t,e,n,r,i,o,s,a,l,h=this,u=h.constructor,d=u.precision,p=u.rounding;if(h.isFinite()){if(h.isZero())return new u(h);if(h.abs().eq(1)&&Dt>=d+4)return s=f(u,d+4,p).times(.25),s.s=h.s,s}else{if(!h.s)return new u(NaN);if(Dt>=d+4)return s=f(u,d+4,p).times(.5),s.s=h.s,s}for(u.precision=a=d+10,u.rounding=1,n=Math.min(28,a/zt+2|0),t=n;t;--t)h=h.div(h.times(h).plus(1).sqrt().plus(1));for(St=!1,e=Math.ceil(a/zt),r=1,l=h.times(h),s=new u(h),i=h;-1!==t;)if(i=i.times(l),o=s.minus(i.div(r+=2)),i=i.times(l),s=o.plus(i.div(r+=2)),void 0!==s.d[e])for(t=e;s.d[t]===o.d[t]&&t--;);return n&&(s=s.times(2<<n-1)),St=!0,c(s,u.precision=d,u.rounding=p,!0)},Wt.isFinite=function(){return!!this.d},Wt.isInteger=Wt.isInt=function(){return!!this.d&&Ot(this.e/zt)>this.d.length-2},Wt.isNaN=function(){return!this.s},Wt.isNegative=Wt.isNeg=function(){return this.s<0},Wt.isPositive=Wt.isPos=function(){return this.s>0},Wt.isZero=function(){return!!this.d&&0===this.d[0]},Wt.lessThan=Wt.lt=function(t){return this.cmp(t)<0},Wt.lessThanOrEqualTo=Wt.lte=function(t){return this.cmp(t)<1},Wt.logarithm=Wt.log=function(t){var e,n,r,i,s,l,h,u,d=this,f=d.constructor,g=f.precision,m=f.rounding,x=5;if(null==t)t=new f(10),e=!0;else{if(t=new f(t),n=t.d,t.s<0||!n||!n[0]||t.eq(1))return new f(NaN);e=t.eq(10)}if(n=d.d,d.s<0||!n||!n[0]||d.eq(1))return new f(n&&!n[0]?-1/0:1!=d.s?NaN:n?0:1/0);if(e)if(n.length>1)s=!0;else{for(i=n[0];i%10===0;)i/=10;s=1!==i}if(St=!1,h=g+x,l=w(d,h),r=e?p(f,h+10):w(t,h),u=Ft(l,r,h,1),a(u.d,i=g,m))do if(h+=10,l=w(d,h),r=e?p(f,h+10):w(t,h),u=Ft(l,r,h,1),!s){+o(u.d).slice(i+1,i+15)+1==1e14&&(u=c(u,g+1,0));break}while(a(u.d,i+=10,m));return St=!0,c(u,g,m)},Wt.minus=Wt.sub=function(t){var e,n,r,i,o,s,a,l,h,u,p,f,g=this,m=g.constructor;if(t=new m(t),!g.d||!t.d)return g.s&&t.s?g.d?t.s=-t.s:t=new m(t.d||g.s!==t.s?g:NaN):t=new m(NaN),t;if(g.s!=t.s)return t.s=-t.s,g.plus(t);if(h=g.d,f=t.d,a=m.precision,l=m.rounding,!h[0]||!f[0]){if(f[0])t.s=-t.s;else{if(!h[0])return new m(3===l?-0:0);t=new m(g)}return St?c(t,a,l):t}if(n=Ot(t.e/zt),u=Ot(g.e/zt),h=h.slice(),o=u-n){for(p=0>o,p?(e=h,o=-o,s=f.length):(e=f,n=u,s=h.length),r=Math.max(Math.ceil(a/zt),s)+2,o>r&&(o=r,e.length=1),e.reverse(),r=o;r--;)e.push(0);e.reverse()}else{for(r=h.length,s=f.length,p=s>r,p&&(s=r),r=0;s>r;r++)if(h[r]!=f[r]){p=h[r]<f[r];break}o=0}for(p&&(e=h,h=f,f=e,t.s=-t.s),s=h.length,r=f.length-s;r>0;--r)h[s++]=0;for(r=f.length;r>o;){if(h[--r]<f[r]){for(i=r;i&&0===h[--i];)h[i]=Rt-1;--h[i],h[r]+=Rt}h[r]-=f[r]}for(;0===h[--s];)h.pop();for(;0===h[0];h.shift())--n;return h[0]?(t.d=h,t.e=d(h,n),St?c(t,a,l):t):new m(3===l?-0:0)},Wt.modulo=Wt.mod=function(t){var e,n=this,r=n.constructor;return t=new r(t),!n.d||!t.s||t.d&&!t.d[0]?new r(NaN):!t.d||n.d&&!n.d[0]?c(new r(n),r.precision,r.rounding):(St=!1,9==r.modulo?(e=Ft(n,t.abs(),0,3,1),e.s*=t.s):e=Ft(n,t,0,r.modulo,1),e=e.times(t),St=!0,n.minus(e))},Wt.naturalExponential=Wt.exp=function(){return C(this)},Wt.naturalLogarithm=Wt.ln=function(){return w(this)},Wt.negated=Wt.neg=function(){var t=new this.constructor(this);return t.s=-t.s,c(t)},Wt.plus=Wt.add=function(t){var e,n,r,i,o,s,a,l,h,u,p=this,f=p.constructor;if(t=new f(t),!p.d||!t.d)return p.s&&t.s?p.d||(t=new f(t.d||p.s===t.s?p:NaN)):t=new f(NaN),t;if(p.s!=t.s)return t.s=-t.s,p.minus(t);if(h=p.d,u=t.d,a=f.precision,l=f.rounding,!h[0]||!u[0])return u[0]||(t=new f(p)),St?c(t,a,l):t;if(o=Ot(p.e/zt),r=Ot(t.e/zt),h=h.slice(),i=o-r){for(0>i?(n=h,i=-i,s=u.length):(n=u,r=o,s=h.length),o=Math.ceil(a/zt),s=o>s?o+1:s+1,i>s&&(i=s,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(s=h.length,i=u.length,0>s-i&&(i=s,n=u,u=h,h=n),e=0;i;)e=(h[--i]=h[i]+u[i]+e)/Rt|0,h[i]%=Rt;for(e&&(h.unshift(e),++r),s=h.length;0==h[--s];)h.pop();return t.d=h,t.e=d(h,r),St?c(t,a,l):t},Wt.precision=Wt.sd=function(t){var e,n=this;if(void 0!==t&&t!==!!t&&1!==t&&0!==t)throw Error(It+t);return n.d?(e=g(n.d),t&&n.e+1>e&&(e=n.e+1)):e=NaN,e},Wt.round=function(){var t=this,e=t.constructor;return c(new e(t),t.e+1,e.rounding)},Wt.sine=Wt.sin=function(){var t,e,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+Math.max(n.e,n.sd())+zt,r.rounding=1,n=E(r,N(r,n)),r.precision=t,r.rounding=e,c(mt>2?n.neg():n,t,e,!0)):new r(NaN)},Wt.squareRoot=Wt.sqrt=function(){var t,e,n,r,i,s,a=this,l=a.d,h=a.e,u=a.s,d=a.constructor;if(1!==u||!l||!l[0])return new d(!u||0>u&&(!l||l[0])?NaN:l?a:1/0);for(St=!1,u=Math.sqrt(+a),0==u||u==1/0?(e=o(l),(e.length+h)%2==0&&(e+="0"),u=Math.sqrt(e),h=Ot((h+1)/2)-(0>h||h%2),u==1/0?e="1e"+h:(e=u.toExponential(),e=e.slice(0,e.indexOf("e")+1)+h),r=new d(e)):r=new d(u.toString()),n=(h=d.precision)+3;;)if(s=r,r=s.plus(Ft(a,s,n+2,1)).times(.5),o(s.d).slice(0,n)===(e=o(r.d)).slice(0,n)){if(e=e.slice(n-3,n+1),"9999"!=e&&(i||"4999"!=e)){+e&&(+e.slice(1)||"5"!=e.charAt(0))||(c(r,h+1,1),t=!r.times(r).eq(a));break}if(!i&&(c(s,h+1,0),s.times(s).eq(a))){r=s;break}n+=4,i=1}return St=!0,c(r,h,d.rounding,t)},Wt.tangent=Wt.tan=function(){var t,e,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(t=r.precision,e=r.rounding,r.precision=t+10,r.rounding=1,n=n.sin(),n.s=1,n=Ft(n,new r(1).minus(n.times(n)).sqrt(),t+10,0),r.precision=t,r.rounding=e,c(2==mt||4==mt?n.neg():n,t,e,!0)):new r(NaN)},Wt.times=Wt.mul=function(t){var e,n,r,i,o,s,a,l,h,u=this,p=u.constructor,f=u.d,g=(t=new p(t)).d;if(t.s*=u.s,!(f&&f[0]&&g&&g[0]))return new p(!t.s||f&&!f[0]&&!g||g&&!g[0]&&!f?NaN:f&&g?0*t.s:t.s/0);for(n=Ot(u.e/zt)+Ot(t.e/zt),l=f.length,h=g.length,h>l&&(o=f,f=g,g=o,s=l,l=h,h=s),o=[],s=l+h,r=s;r--;)o.push(0);for(r=h;--r>=0;){for(e=0,i=l+r;i>r;)a=o[i]+g[r]*f[i-r-1]+e,o[i--]=a%Rt|0,e=a/Rt|0;o[i]=(o[i]+e)%Rt|0}for(;!o[--s];)o.pop();for(e?++n:o.shift(),r=o.length;!o[--r];)o.pop();return t.d=o,t.e=d(o,n),St?c(t,p.precision,p.rounding):t},Wt.toBinary=function(t,e){return O(this,2,t,e)},Wt.toDecimalPlaces=Wt.toDP=function(t,e){var n=this,r=n.constructor;return n=new r(n),void 0===t?n:(s(t,0,yt),void 0===e?e=r.rounding:s(e,0,8),c(n,t+n.e+1,e))},Wt.toExponential=function(t,e){var n,r=this,i=r.constructor;return void 0===t?n=u(r,!0):(s(t,0,yt),void 0===e?e=i.rounding:s(e,0,8),r=c(new i(r),t+1,e),n=u(r,!0,t+1)),r.isNeg()&&!r.isZero()?"-"+n:n},Wt.toFixed=function(t,e){var n,r,i=this,o=i.constructor;return void 0===t?n=u(i):(s(t,0,yt),void 0===e?e=o.rounding:s(e,0,8),r=c(new o(i),t+i.e+1,e),n=u(r,!1,t+r.e+1)),i.isNeg()&&!i.isZero()?"-"+n:n},Wt.toFraction=function(t){var e,n,r,i,s,a,l,h,c,u,d,p,f=this,m=f.d,x=f.constructor;if(!m)return new x(f);if(c=n=new x(1),r=h=new x(0),e=new x(r),s=e.e=g(m)-f.e-1,a=s%zt,e.d[0]=Tt(10,0>a?zt+a:a),null==t)t=s>0?e:c;else{if(l=new x(t),!l.isInt()||l.lt(c))throw Error(It+l);t=l.gt(e)?s>0?e:c:l}for(St=!1,l=new x(o(m)),u=x.precision,x.precision=s=m.length*zt*2;d=Ft(l,e,0,1,1),i=n.plus(d.times(r)),1!=i.cmp(t);)n=r,r=i,i=c,c=h.plus(d.times(i)),h=i,i=e,e=l.minus(d.times(i)),l=i;return i=Ft(t.minus(n),r,0,1,1),h=h.plus(i.times(c)),n=n.plus(i.times(r)),h.s=c.s=f.s,p=Ft(c,r,s,1).minus(f).abs().cmp(Ft(h,n,s,1).minus(f).abs())<1?[c,r]:[h,n],x.precision=u,St=!0,p},Wt.toHexadecimal=Wt.toHex=function(t,e){return O(this,16,t,e)},Wt.toJSON=function(){var t,e,n,r,i,s,a,h,c=this,u=c.s<0;if(!c.d)return vt.charAt(c.s?u?82:83:84);if(e=c.e,1===c.d.length&&4>e&&e>=0&&(s=c.d[0],2857>s))return 41>s?vt.charAt(u?s+41:s):(s-=41,u&&(s+=2816),r=s/88|0,vt.charAt(r)+vt.charAt(s-88*r));if(h=o(c.d),a="",!u&&8>=e&&e>=-7)r=64+e+7;else if(u&&4>=e&&e>=-3)r=80+e+3;else if(h.length===e+1)r=32*u;else if(r=32*u+16*(0>e),e=Math.abs(e),88>e)r+=1,a=vt.charAt(e);else if(7744>e)r+=2,s=e/88|0,a=vt.charAt(s)+vt.charAt(e-88*s);else for(t=l(String(e),10,88),i=t.length,r+=i,n=0;i>n;n++)a+=vt.charAt(t[n]);for(a=vt.charAt(r)+a,t=l(h,10,88),i=t.length,n=0;i>n;n++)a+=vt.charAt(t[n]);return a},Wt.toNearest=function(t,e){var n=this,r=n.constructor;if(n=new r(n),null==t){if(!n.d)return n;t=new r(1),e=r.rounding}else{if(t=new r(t),void 0!==e&&s(e,0,8),!n.d)return t.s?n:t;if(!t.d)return t.s&&(t.s=n.s),t}return t.d[0]?(St=!1,4>e&&(e=[4,5,7,8][e]),n=Ft(n,t,0,e,1).times(t),St=!0,c(n)):(t.s=n.s,n=t),n},Wt.toNumber=function(){return+this},Wt.toOctal=function(t,e){return O(this,8,t,e)},Wt.toPower=Wt.pow=function(t){var e,n,r,i,s,l,h,u=this,d=u.constructor,p=+(t=new d(t));if(!(u.d&&t.d&&u.d[0]&&t.d[0]))return new d(Tt(+u,p));if(u=new d(u),u.eq(1))return u;if(r=d.precision,s=d.rounding,t.eq(1))return c(u,r,s);if(e=Ot(t.e/zt),n=t.d.length-1,h=e>=n,l=u.s,h){if((n=0>p?-p:p)<=Bt)return i=x(d,u,n,r),t.s<0?new d(1).div(i):c(i,r,s)}else if(0>l)return new d(NaN);return l=0>l&&1&t.d[Math.max(e,n)]?-1:1,n=Tt(+u,p),e=0!=n&&isFinite(n)?new d(n+"").e:Ot(p*(Math.log("0."+o(u.d))/Math.LN10+u.e+1)),e>d.maxE+1||e<d.minE-1?new d(e>0?l/0:0):(St=!1,d.rounding=u.s=1,n=Math.min(12,(e+"").length),i=C(t.times(w(u,r+n)),r),i=c(i,r+5,1),a(i.d,r,s)&&(e=r+10,i=c(C(t.times(w(u,e+n)),e),e+5,1),+o(i.d).slice(r+1,r+15)+1==1e14&&(i=c(i,r+1,0))),i.s=l,St=!0,d.rounding=s,c(i,r,s))},Wt.toPrecision=function(t,e){var n,r=this,i=r.constructor;return void 0===t?n=u(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):(s(t,1,yt),void 0===e?e=i.rounding:s(e,0,8),r=c(new i(r),t,e),n=u(r,t<=r.e||r.e<=i.toExpNeg,t)),r.isNeg()&&!r.isZero()?"-"+n:n},Wt.toSignificantDigits=Wt.toSD=function(t,e){var n=this,r=n.constructor;return void 0===t?(t=r.precision,e=r.rounding):(s(t,1,yt),void 0===e?e=r.rounding:s(e,0,8)),c(new r(n),t,e)},Wt.toString=function(){var t=this,e=t.constructor,n=u(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()&&!t.isZero()?"-"+n:n},Wt.truncated=Wt.trunc=function(){return c(new this.constructor(this),this.e+1,1)},Wt.valueOf=function(){var t=this,e=t.constructor,n=u(t,t.e<=e.toExpNeg||t.e>=e.toExpPos);return t.isNeg()?"-"+n:n};var Ft=function(){function t(t,e,n){var r,i=0,o=t.length;for(t=t.slice();o--;)r=t[o]*e+i,t[o]=r%n|0,i=r/n|0;return i&&t.unshift(i),t}function e(t,e,n,r){var i,o;if(n!=r)o=n>r?1:-1;else for(i=o=0;n>i;i++)if(t[i]!=e[i]){o=t[i]>e[i]?1:-1;break}return o}function n(t,e,n,r){for(var i=0;n--;)t[n]-=i,i=t[n]<e[n]?1:0,t[n]=i*r+t[n]-e[n];for(;!t[0]&&t.length>1;)t.shift()}return function(r,i,o,s,a,l){var h,u,d,p,f,g,m,x,y,v,C,w,b,M,S,E,I,N,O,T,_=r.constructor,P=r.s==i.s?1:-1,A=r.d,k=i.d;if(!(A&&A[0]&&k&&k[0]))return new _(r.s&&i.s&&(A?!k||A[0]!=k[0]:k)?A&&0==A[0]||!k?0*P:P/0:NaN);for(l?(f=1,u=r.e-i.e):(l=Rt,f=zt,u=Ot(r.e/f)-Ot(i.e/f)),O=k.length,I=A.length,y=new _(P),v=y.d=[],d=0;k[d]==(A[d]||0);d++);if(k[d]>(A[d]||0)&&u--,null==o?(M=o=_.precision,s=_.rounding):M=a?o+(r.e-i.e)+1:o,0>M)v.push(1),g=!0;else{if(M=M/f+2|0,d=0,1==O){for(p=0,k=k[0],M++;(I>d||p)&&M--;d++)S=p*l+(A[d]||0),v[d]=S/k|0,p=S%k|0;g=p||I>d}else{for(p=l/(k[0]+1)|0,p>1&&(k=t(k,p,l),A=t(A,p,l),O=k.length,I=A.length),E=O,C=A.slice(0,O),w=C.length;O>w;)C[w++]=0;T=k.slice(),T.unshift(0),N=k[0],k[1]>=l/2&&++N;do p=0,h=e(k,C,O,w),0>h?(b=C[0],O!=w&&(b=b*l+(C[1]||0)),p=b/N|0,p>1?(p>=l&&(p=l-1),m=t(k,p,l),x=m.length,w=C.length,h=e(m,C,x,w),1==h&&(p--,n(m,x>O?T:k,x,l))):(0==p&&(h=p=1),m=k.slice()),x=m.length,w>x&&m.unshift(0),n(C,m,w,l),-1==h&&(w=C.length,h=e(k,C,O,w),1>h&&(p++,n(C,w>O?T:k,w,l))),w=C.length):0===h&&(p++,C=[0]),v[d++]=p,h&&C[0]?C[w++]=A[E]||0:(C=[A[E]],w=1);while((E++<I||void 0!==C[0])&&M--);g=void 0!==C[0]}v[0]||v.shift()}if(1==f)y.e=u,gt=g;else{for(d=1,p=v[0];p>=10;p/=10)d++;y.e=d+u*f-1,c(y,a?o+y.e+1:o,s,g)}return y}}();bt=U(bt),Ct=new bt(Ct),wt=new bt(wt),r=function(){return bt}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))}(this)},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("bignumber",{"":function(){return new t.BigNumber(0)},number:function(e){return new t.BigNumber(e+"")},string:function(e){return new t.BigNumber(e)},BigNumber:function(t){return t},Fraction:function(e){return new t.BigNumber(e.n).div(e.d)},"Array | Matrix":function(t){return i(t,o)}});return o.toTex={0:"0",1:"\\left(${args[0]}\\right)"},o}var i=n(19);e.name="bignumber",e.factory=r},function(t,e){"use strict";t.exports=function n(t,e,r){return t&&"function"==typeof t.map?t.map(function(t){return n(t,e,r)}):e(t)}},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("bool",{"":function(){return!1},"boolean":function(t){return t},number:function(t){return!!t},BigNumber:function(t){return!t.isZero()},string:function(t){var e=t.toLowerCase();if("true"===e)return!0;if("false"===e)return!1;var n=Number(t);if(""!=t&&!isNaN(n))return!!n;throw new Error('Cannot convert "'+t+'" to a boolean')},"Array | Matrix":function(t){return i(t,o)}});return o}var i=n(19);e.name="boolean",e.factory=r},function(t,e,n){t.exports=[n(22),n(25)]},function(t,e,n){"use strict";function r(t,e,n,r,s){function a(t){if(!(this instanceof a))throw new SyntaxError("Constructor must be called with the new operator");t&&t.isChain?this.value=t.value:this.value=t}function l(t,e){"function"==typeof e&&(a.prototype[t]=c(e))}function h(t,e){o(a.prototype,t,function(){var t=e();return"function"==typeof t?c(t):void 0})}function c(t){return function(){for(var e=[this.value],n=0;n<arguments.length;n++)e[n+1]=arguments[n];return new a(t.apply(t,e))}}return a.prototype.type="Chain",a.prototype.isChain=!0,a.prototype.done=function(){return this.value},a.prototype.valueOf=function(){return this.value},a.prototype.toString=function(){return i(this.value)},a.createProxy=function(t,e){if("string"==typeof t)l(t,e);else for(var n in t)t.hasOwnProperty(n)&&l(n,t[n])},a.createProxy(s),s.on("import",function(t,e,n){void 0===n&&h(t,e)}),a}var i=n(23).format,o=n(3).lazy;e.name="Chain",e.path="type",e.factory=r,e.math=!0,e.lazy=!1},function(t,e,n){"use strict";function r(t,n){if(Array.isArray(t)){for(var i="[",o=t.length,s=0;o>s;s++)0!=s&&(i+=", "),i+=r(t[s],n);return i+="]"}return e.format(t,n)}var i=n(6).format,o=n(24).format;e.isString=function(t){return"string"==typeof t},e.endsWith=function(t,e){var n=t.length-e.length,r=t.length;return t.substring(n,r)===e},e.format=function(t,n){if("number"==typeof t)return i(t,n);if(t&&t.isBigNumber===!0)return o(t,n);if(t&&t.isFraction===!0)return n&&"decimal"===n.fraction?t.toString():t.s*t.n+"/"+t.d;if(Array.isArray(t))return r(t,n);if(e.isString(t))return'"'+t+'"';if("function"==typeof t)return t.syntax?String(t.syntax):"function";if(t&&"object"==typeof t){if("function"==typeof t.format)return t.format(n);if(t&&t.toString()!=={}.toString())return t.toString();var s=[];for(var a in t)t.hasOwnProperty(a)&&s.push('"'+a+'": '+e.format(t[a],n));return"{"+s.join(", ")+"}"}return String(t)}},function(t,e){e.format=function(t,n){if("function"==typeof n)return n(t);if(!t.isFinite())return t.isNaN()?"NaN":t.gt(0)?"Infinity":"-Infinity";var r="auto",i=void 0;switch(void 0!==n&&(n.notation&&(r=n.notation),"number"==typeof n?i=n:n.precision&&(i=n.precision)),r){case"fixed":return e.toFixed(t,i);case"exponential":return e.toExponential(t,i);case"auto":var o=.001,s=1e5;if(n&&n.exponential&&(void 0!==n.exponential.lower&&(o=n.exponential.lower),void 0!==n.exponential.upper&&(s=n.exponential.upper)),{toExpNeg:t.constructor.toExpNeg,toExpPos:t.constructor.toExpPos},t.constructor.config({toExpNeg:Math.round(Math.log(o)/Math.LN10),toExpPos:Math.round(Math.log(s)/Math.LN10)}),t.isZero())return"0";var a,l=t.abs();return a=l.gte(o)&&l.lt(s)?t.toSignificantDigits(i).toFixed():e.toExponential(t,i),a.replace(/((\.\d*?)(0+))($|e)/,function(){var t=arguments[2],e=arguments[4];return"."!==t?t+e:e});default:throw new Error('Unknown notation "'+r+'". Choose "auto", "exponential", or "fixed".')}},e.toExponential=function(t,e){return void 0!==e?t.toExponential(e-1):t.toExponential()},e.toFixed=function(t,e){return t.toFixed(e||0)}},function(t,e){"use strict";function n(t,e,n,r){return r("chain",{"":function(){return new t.Chain},any:function(e){return new t.Chain(e)}})}e.name="chain",e.factory=n},function(t,e,n){t.exports=[n(27),n(31)]},function(t,e,n){function r(t,e,n,r,a){return i.prototype.type="Complex",i.prototype.isComplex=!0,i.prototype.toJSON=function(){return{mathjs:"Complex",re:this.re,im:this.im}},i.prototype.toPolar=function(){return{r:this.abs(),phi:this.arg()}},i.prototype.format=function(t){var e="",n=this.im,r=this.re,i=o(this.re,t),a=o(this.im,t),l=s(t)?t:t?t.precision:null;if(null!==l){var h=Math.pow(10,-l);Math.abs(r/n)<h&&(r=0),Math.abs(n/r)<h&&(n=0)}return e=0==n?i:0==r?1==n?"i":-1==n?"-i":a+"i":n>0?1==n?i+" + i":i+" + "+a+"i":-1==n?i+" - i":i+" - "+a.substring(1)+"i"},i.fromPolar=function(t){switch(arguments.length){case 1:var e=arguments[0];if("object"==typeof e)return i(e);throw new TypeError("Input has to be an object with r and phi keys.");case 2:var n=arguments[0],r=arguments[1];if(s(n)){if(r&&r.isUnit&&r.hasBase("ANGLE")&&(r=r.toNumber("rad")),s(r))return new i({r:n,phi:r});throw new TypeError("Phi is not a number nor an angle unit.")}throw new TypeError("Radius r is not a number.");default:throw new SyntaxError("Wrong number of arguments in function fromPolar")}},i.prototype.valueOf=i.prototype.toString,i.fromJSON=function(t){return new i(t)},i.EPSILON=e.epsilon,a.on("config",function(t,e){t.epsilon!==e.epsilon&&(i.EPSILON=t.epsilon)}),i}var i=n(28),o=n(6).format,s=n(6).isNumber;e.name="Complex",e.path="type",e.factory=r,e.math=!0},function(t,e,n){var r,i;(function(t){!function(o){"use strict";function s(t,e){var n=Math.abs(t),r=Math.abs(e);return 0===t?Math.log(r):0===e?Math.log(n):3e3>n&&3e3>r?.5*Math.log(t*t+e*e):Math.log(t/Math.cos(Math.atan2(e,t)))}function a(t,e){return this instanceof a?(c(t,e),this.re=l.re,void(this.im=l.im)):new a(t,e)}var l={re:0,im:0};Math.cosh=Math.cosh||function(t){return.5*(Math.exp(t)+Math.exp(-t))},Math.sinh=Math.sinh||function(t){return.5*(Math.exp(t)-Math.exp(-t))};var h=function(){throw SyntaxError("Invalid Param")},c=function(t,e){if(void 0===t||null===t)l.re=l.im=0;else if(void 0!==e)l.re=t,l.im=e;else switch(typeof t){case"object":"im"in t&&"re"in t?(l.re=t.re,l.im=t.im):"abs"in t&&"arg"in t?(l.re=t.abs*Math.cos(t.arg),l.im=t.abs*Math.sin(t.arg)):"r"in t&&"phi"in t?(l.re=t.r*Math.cos(t.phi),l.im=t.r*Math.sin(t.phi)):h();break;case"string":l.im=l.re=0;var n=t.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),r=1,i=0;null===n&&h();
for(var o=0;o<n.length;o++){var s=n[o];" "===s||"\t"===s||"\n"===s||("+"===s?r++:"-"===s?i++:"i"===s||"I"===s?(r+i===0&&h()," "===n[o+1]||isNaN(n[o+1])?l.im+=parseFloat((i%2?"-":"")+"1"):(l.im+=parseFloat((i%2?"-":"")+n[o+1]),o++),r=i=0):((r+i===0||isNaN(s))&&h(),"i"===n[o+1]||"I"===n[o+1]?(l.im+=parseFloat((i%2?"-":"")+s),o++):l.re+=parseFloat((i%2?"-":"")+s),r=i=0))}r+i>0&&h();break;case"number":l.im=0,l.re=t;break;default:h()}isNaN(l.re)||isNaN(l.im)};a.prototype={re:0,im:0,sign:function(){var t=this.abs();return new a(this.re/t,this.im/t)},add:function(t,e){return c(t,e),new a(this.re+l.re,this.im+l.im)},sub:function(t,e){return c(t,e),new a(this.re-l.re,this.im-l.im)},mul:function(t,e){return c(t,e),0===l.im&&0===this.im?new a(this.re*l.re,0):new a(this.re*l.re-this.im*l.im,this.re*l.im+this.im*l.re)},div:function(t,e){c(t,e),t=this.re,e=this.im;var n,r,i=l.re,o=l.im;return 0===i&&0===o?new a(0!==t?t/0:0,0!==e?e/0:0):0===o?new a(t/i,e/i):Math.abs(i)<Math.abs(o)?(r=i/o,n=i*r+o,new a((t*r+e)/n,(e*r-t)/n)):(r=o/i,n=o*r+i,new a((t+e*r)/n,(e-t*r)/n))},pow:function(t,e){if(c(t,e),t=this.re,e=this.im,0===t&&0===e)return new a(0,0);var n=Math.atan2(e,t),r=s(t,e);if(0===l.im){if(0===e&&t>=0)return new a(Math.pow(t,l.re),0);if(0===t)switch(l.re%4){case 0:return new a(Math.pow(e,l.re),0);case 1:return new a(0,Math.pow(e,l.re));case 2:return new a((-Math.pow(e,l.re)),0);case 3:return new a(0,(-Math.pow(e,l.re)))}}return t=Math.exp(l.re*r-l.im*n),e=l.im*r+l.re*n,new a(t*Math.cos(e),t*Math.sin(e))},sqrt:function(){var t,e,n=this.re,r=this.im,i=this.abs();return n>=0&&0===r?new a(Math.sqrt(n),0):(t=n>=0?.5*Math.sqrt(2*(i+n)):Math.abs(r)/Math.sqrt(2*(i-n)),e=0>=n?.5*Math.sqrt(2*(i-n)):Math.abs(r)/Math.sqrt(2*(i+n)),new a(t,r>=0?e:-e))},exp:function(){var t=Math.exp(this.re);return 0===this.im,new a(t*Math.cos(this.im),t*Math.sin(this.im))},log:function(){var t=this.re,e=this.im;return new a(s(t,e),Math.atan2(e,t))},abs:function(){var t=Math.abs(this.re),e=Math.abs(this.im);return 3e3>t&&3e3>e?Math.sqrt(t*t+e*e):(e>t?(t=e,e=this.re/this.im):e=this.im/this.re,t*Math.sqrt(1+e*e))},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){var t=this.re,e=this.im;return new a(Math.sin(t)*Math.cosh(e),Math.cos(t)*Math.sinh(e))},cos:function(){var t=this.re,e=this.im;return new a(Math.cos(t)*Math.cosh(e),-Math.sin(t)*Math.sinh(e))},tan:function(){var t=2*this.re,e=2*this.im,n=Math.cos(t)+Math.cosh(e);return new a(Math.sin(t)/n,Math.sinh(e)/n)},cot:function(){var t=2*this.re,e=2*this.im,n=Math.cos(t)-Math.cosh(e);return new a(-Math.sin(t)/n,Math.sinh(e)/n)},sec:function(){var t=this.re,e=this.im,n=.5*Math.cosh(2*e)+.5*Math.cos(2*t);return new a(Math.cos(t)*Math.cosh(e)/n,Math.sin(t)*Math.sinh(e)/n)},csc:function(){var t=this.re,e=this.im,n=.5*Math.cosh(2*e)-.5*Math.cos(2*t);return new a(Math.sin(t)*Math.cosh(e)/n,-Math.cos(t)*Math.sinh(e)/n)},asin:function(){var t=this.re,e=this.im,n=new a(e*e-t*t+1,-2*t*e).sqrt(),r=new a(n.re-e,n.im+t).log();return new a(r.im,(-r.re))},acos:function(){var t=this.re,e=this.im,n=new a(e*e-t*t+1,-2*t*e).sqrt(),r=new a(n.re-e,n.im+t).log();return new a(Math.PI/2-r.im,r.re)},atan:function(){var t=this.re,e=this.im;if(0===t){if(1===e)return new a(0,1/0);if(-1===e)return new a(0,(-(1/0)))}var n=t*t+(1-e)*(1-e),r=new a((1-e*e-t*t)/n,-2*t/n).log();return new a(-.5*r.im,.5*r.re)},acot:function(){var t=this.re,e=this.im;if(0===e)return new a(Math.atan2(1,t),0);var n=t*t+e*e;return 0!==n?new a(t/n,-e/n).atan():new a(0!==t?t/0:0,0!==e?-e/0:0).atan()},asec:function(){var t=this.re,e=this.im;if(0===t&&0===e)return new a(0,1/0);var n=t*t+e*e;return 0!==n?new a(t/n,-e/n).acos():new a(0!==t?t/0:0,0!==e?-e/0:0).acos()},acsc:function(){var t=this.re,e=this.im;if(0===t&&0===e)return new a(Math.PI/2,1/0);var n=t*t+e*e;return 0!==n?new a(t/n,-e/n).asin():new a(0!==t?t/0:0,0!==e?-e/0:0).asin()},sinh:function(){var t=this.re,e=this.im;return new a(Math.sinh(t)*Math.cos(e),Math.cosh(t)*Math.sin(e))},cosh:function(){var t=this.re,e=this.im;return new a(Math.cosh(t)*Math.cos(e),Math.sinh(t)*Math.sin(e))},tanh:function(){var t=2*this.re,e=2*this.im,n=Math.cosh(t)+Math.cos(e);return new a(Math.sinh(t)/n,Math.sin(e)/n)},coth:function(){var t=2*this.re,e=2*this.im,n=Math.cosh(t)-Math.cos(e);return new a(Math.sinh(t)/n,-Math.sin(e)/n)},csch:function(){var t=this.re,e=this.im,n=Math.cos(2*e)-Math.cosh(2*t);return new a(-2*Math.sinh(t)*Math.cos(e)/n,2*Math.cosh(t)*Math.sin(e)/n)},sech:function(){var t=this.re,e=this.im,n=Math.cos(2*e)+Math.cosh(2*t);return new a(2*Math.cosh(t)*Math.cos(e)/n,-2*Math.sinh(t)*Math.sin(e)/n)},asinh:function(){var t=this.im;this.im=-this.re,this.re=t;var e=this.asin();return this.re=-this.im,this.im=t,t=e.re,e.re=-e.im,e.im=t,e},acosh:function(){var t,e=this.acos();return e.im<=0?(t=e.re,e.re=-e.im,e.im=t):(t=e.im,e.im=-e.re,e.re=t),e},atanh:function(){var t=this.re,e=this.im,n=t>1&&0===e,r=1-t,i=1+t,o=r*r+e*e,l=0!==o?new a((i*r-e*e)/o,(e*r+i*e)/o):new a(-1!==t?t/0:0,0!==e?e/0:0),h=l.re;return l.re=s(l.re,l.im)/2,l.im=Math.atan2(l.im,h)/2,n&&(l.im=-l.im),l},acoth:function(){var t=this.re,e=this.im;if(0===t&&0===e)return new a(0,Math.PI/2);var n=t*t+e*e;return 0!==n?new a(t/n,-e/n).atanh():new a(0!==t?t/0:0,0!==e?-e/0:0).atanh()},acsch:function(){var t=this.re,e=this.im;if(0===e)return new a(0!==t?Math.log(t+Math.sqrt(t*t+1)):1/0,0);var n=t*t+e*e;return 0!==n?new a(t/n,-e/n).asinh():new a(0!==t?t/0:0,0!==e?-e/0:0).asinh()},asech:function(){var t=this.re,e=this.im;if(0===t&&0===e)return new a(1/0,0);var n=t*t+e*e;return 0!==n?new a(t/n,-e/n).acosh():new a(0!==t?t/0:0,0!==e?-e/0:0).acosh()},inverse:function(){var t=this.re,e=this.im,n=t*t+e*e;return new a(0!==t?t/n:0,0!==e?-e/n:0)},conjugate:function(){return new a(this.re,(-this.im))},neg:function(){return new a((-this.re),(-this.im))},ceil:function(t){return t=Math.pow(10,t||0),new a(Math.ceil(this.re*t)/t,Math.ceil(this.im*t)/t)},floor:function(t){return t=Math.pow(10,t||0),new a(Math.floor(this.re*t)/t,Math.floor(this.im*t)/t)},round:function(t){return t=Math.pow(10,t||0),new a(Math.round(this.re*t)/t,Math.round(this.im*t)/t)},equals:function(t,e){return c(t,e),Math.abs(l.re-this.re)<=a.EPSILON&&Math.abs(l.im-this.im)<=a.EPSILON},clone:function(){return new a(this.re,this.im)},toString:function(){var t=this.re,e=this.im,n="";return isNaN(t)||isNaN(e)?"NaN":(0!==t&&(n+=t),0!==e&&(0!==t?n+=0>e?" - ":" + ":0>e&&(n+="-"),e=Math.abs(e),1!==e&&(n+=e),n+="i"),n?n:"0")},toVector:function(){return[this.re,this.im]},valueOf:function(){return 0===this.im?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)}},a.ZERO=new a(0,0),a.ONE=new a(1,0),a.I=new a(0,1),a.PI=new a(Math.PI,0),a.E=new a(Math.E,0),a.EPSILON=1e-16,n(30).amd?(r=[],i=function(){return a}.apply(e,r),!(void 0!==i&&(t.exports=i))):t.exports=a}(this)}).call(e,n(29)(t))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e,n){"use strict";function r(t,e,r,o){var s=n(32),a=o("complex",{"":function(){return t.Complex.ZERO},number:function(e){return new t.Complex(e,0)},"number, number":function(e,n){return new t.Complex(e,n)},"BigNumber, BigNumber":function(e,n){return new t.Complex(e.toNumber(),n.toNumber())},Complex:function(t){return t.clone()},string:function(e){return t.Complex(e)},Object:function(e){if("re"in e&&"im"in e)return new t.Complex(e.re,e.im);if("r"in e&&"phi"in e)return new t.Complex(e);throw new Error("Expected object with either properties re and im, or properties r and phi.")},"Array | Matrix":function(t){return i(t,a)}});return a.toTex={0:"0",1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)+"+s.symbols.i+"\\cdot\\left(${args[1]}\\right)\\right)"},a}var i=n(19);e.name="complex",e.factory=r},function(t,e){"use strict";e.symbols={Alpha:"A",alpha:"\\alpha",Beta:"B",beta:"\\beta",Gamma:"\\Gamma",gamma:"\\gamma",Delta:"\\Delta",delta:"\\delta",Epsilon:"E",epsilon:"\\epsilon",varepsilon:"\\varepsilon",Zeta:"Z",zeta:"\\zeta",Eta:"H",eta:"\\eta",Theta:"\\Theta",theta:"\\theta",vartheta:"\\vartheta",Iota:"I",iota:"\\iota",Kappa:"K",kappa:"\\kappa",varkappa:"\\varkappa",Lambda:"\\Lambda",lambda:"\\lambda",Mu:"M",mu:"\\mu",Nu:"N",nu:"\\nu",Xi:"\\Xi",xi:"\\xi",Omicron:"O",omicron:"o",Pi:"\\Pi",pi:"\\pi",varpi:"\\varpi",Rho:"P",rho:"\\rho",varrho:"\\varrho",Sigma:"\\Sigma",sigma:"\\sigma",varsigma:"\\varsigma",Tau:"T",tau:"\\tau",Upsilon:"\\Upsilon",upsilon:"\\upsilon",Phi:"\\Phi",phi:"\\phi",varphi:"\\varphi",Chi:"X",chi:"\\chi",Psi:"\\Psi",psi:"\\psi",Omega:"\\Omega",omega:"\\omega","true":"\\mathrm{True}","false":"\\mathrm{False}",i:"i",inf:"\\infty",Inf:"\\infty",infinity:"\\infty",Infinity:"\\infty",oo:"\\infty",lim:"\\lim",undefined:"\\mathbf{?}"},e.operators={transpose:"^\\top",factorial:"!",pow:"^",dotPow:".^\\wedge",unaryPlus:"+",unaryMinus:"-",bitNot:"~",not:"\\neg",multiply:"\\cdot",divide:"\\frac",dotMultiply:".\\cdot",dotDivide:".:",mod:"\\mod",add:"+",subtract:"-",to:"\\rightarrow",leftShift:"<<",rightArithShift:">>",rightLogShift:">>>",equal:"=",unequal:"\\neq",smaller:"<",larger:">",smallerEq:"\\leq",largerEq:"\\geq",bitAnd:"\\&",bitXor:"\\underline{|}",bitOr:"|",and:"\\wedge",xor:"\\veebar",or:"\\vee"},e.defaultTemplate="\\mathrm{${name}}\\left(${args}\\right)";var n={deg:"^\\circ"};e.toSymbol=function(t,r){if(r="undefined"!=typeof r&&r)return n.hasOwnProperty(t)?n[t]:"\\mathrm{"+t+"}";if(e.symbols.hasOwnProperty(t))return e.symbols[t];if(-1!==t.indexOf("_")){var i=t.indexOf("_");return e.toSymbol(t.substring(0,i))+"_{"+e.toSymbol(t.substring(i+1))+"}"}return t}},function(t,e,n){t.exports=[n(34),n(36)]},function(t,e,n){function r(t,e,n,r){return i}var i=n(35);i.prototype.type="Fraction",i.prototype.isFraction=!0,i.prototype.toJSON=function(){return{mathjs:"Fraction",n:this.s*this.n,d:this.d}},i.fromJSON=function(t){return new i(t)},e.name="Fraction",e.path="type",e.factory=r},function(t,e,n){var r,i;(function(t){!function(o){"use strict";function s(t,e){return isNaN(t=parseInt(t,10))&&a(),t*e}function a(){throw"Invalid Param"}function l(t,e){return this instanceof l?(u(t,e),t=l.REDUCE?g(c.d,c.n):1,this.s=c.s,this.n=c.n/t,void(this.d=c.d/t)):new l(t,e)}var h=2e3,c={s:1,n:0,d:1},u=function(t,e){var n,r=0,i=1,o=1,l=0,h=0,u=0,d=1,p=1,f=0,g=1,m=1,x=1,y=1e7;if(void 0===t||null===t);else if(void 0!==e)r=t,i=e,o=r*i;else switch(typeof t){case"object":"d"in t&&"n"in t?(r=t.n,i=t.d,"s"in t&&(r*=t.s)):0 in t?(r=t[0],1 in t&&(i=t[1])):a(),o=r*i;break;case"number":if(0>t&&(o=t,t=-t),t%1===0)r=t;else if(t>0){for(t>=1&&(p=Math.pow(10,Math.floor(1+Math.log(t)/Math.LN10)),t/=p);y>=g&&y>=x;){if(n=(f+m)/(g+x),t===n){y>=g+x?(r=f+m,i=g+x):x>g?(r=m,i=x):(r=f,i=g);break}t>n?(f+=m,g+=x):(m+=f,x+=g),g>y?(r=m,i=x):(r=f,i=g)}r*=p}else(isNaN(t)||isNaN(e))&&(i=r=NaN);break;case"string":if(g=t.match(/\d+|./g),"-"===g[f]?(o=-1,f++):"+"===g[f]&&f++,g.length===f+1?h=s(g[f++],o):"."===g[f+1]||"."===g[f]?("."!==g[f]&&(l=s(g[f++],o)),f++,(f+1===g.length||"("===g[f+1]&&")"===g[f+3]||"'"===g[f+1]&&"'"===g[f+3])&&(h=s(g[f],o),d=Math.pow(10,g[f].length),f++),("("===g[f]&&")"===g[f+2]||"'"===g[f]&&"'"===g[f+2])&&(u=s(g[f+1],o),p=Math.pow(10,g[f+1].length)-1,f+=3)):"/"===g[f+1]||":"===g[f+1]?(h=s(g[f],o),d=s(g[f+2],1),f+=3):"/"===g[f+3]&&" "===g[f+1]&&(l=s(g[f],o),h=s(g[f+2],o),d=s(g[f+4],1),f+=5),g.length<=f){i=d*p,o=r=u+i*l+p*h;break}default:a()}if(0===i)throw"DIV/0";c.s=0>o?-1:1,c.n=Math.abs(r),c.d=Math.abs(i)},d=function(t,e,n){for(var r=1;e>0;t=t*t%n,e>>=1)1&e&&(r=r*t%n);return r},p=function(t,e){for(;e%2===0;e/=2);for(;e%5===0;e/=5);if(1===e)return 0;for(var n=10%e,r=1;1!==n;r++)if(n=10*n%e,r>h)return 0;return r},f=function(t,e,n){for(var r=1,i=d(10,n,e),o=0;300>o;o++){if(r===i)return o;r=10*r%e,i=10*i%e}return 0},g=function(t,e){if(!t)return e;if(!e)return t;for(;;){if(t%=e,!t)return e;if(e%=t,!e)return t}};l.REDUCE=1,l.prototype={s:1,n:0,d:1,abs:function(){return new l(this.n,this.d)},neg:function(){return new l(-this.s*this.n,this.d)},add:function(t,e){return u(t,e),new l(this.s*this.n*c.d+c.s*this.d*c.n,this.d*c.d)},sub:function(t,e){return u(t,e),new l(this.s*this.n*c.d-c.s*this.d*c.n,this.d*c.d)},mul:function(t,e){return u(t,e),new l(this.s*c.s*this.n*c.n,this.d*c.d)},div:function(t,e){return u(t,e),new l(this.s*c.s*this.n*c.d,this.d*c.n)},clone:function(){return new l(this)},mod:function(t,e){return isNaN(this.n)||isNaN(this.d)?new l(NaN):void 0===t?new l(this.s*this.n%this.d,1):(u(t,e),0===c.n&&0===this.d&&l(0,0),new l(this.s*c.d*this.n%(c.n*this.d),c.d*this.d))},gcd:function(t,e){return u(t,e),new l(g(c.n,this.n),c.d*this.d/g(c.d,this.d))},lcm:function(t,e){return u(t,e),0===c.n&&0===this.n?new l:new l(c.n*this.n/g(c.n,this.n),g(c.d,this.d))},ceil:function(t){return t=Math.pow(10,t||0),isNaN(this.n)||isNaN(this.d)?new l(NaN):new l(Math.ceil(t*this.s*this.n/this.d),t)},floor:function(t){return t=Math.pow(10,t||0),isNaN(this.n)||isNaN(this.d)?new l(NaN):new l(Math.floor(t*this.s*this.n/this.d),t)},round:function(t){return t=Math.pow(10,t||0),isNaN(this.n)||isNaN(this.d)?new l(NaN):new l(Math.round(t*this.s*this.n/this.d),t)},inverse:function(){return new l(this.s*this.d,this.n)},pow:function(t){return 0>t?new l(Math.pow(this.s*this.d,-t),Math.pow(this.n,-t)):new l(Math.pow(this.s*this.n,t),Math.pow(this.d,t))},equals:function(t,e){return u(t,e),this.s*this.n*c.d===c.s*c.n*this.d},compare:function(t,e){u(t,e);var n=this.s*this.n*c.d-c.s*c.n*this.d;return(n>0)-(0>n)},divisible:function(t,e){return u(t,e),!(!(c.n*this.d)||this.n*c.d%(c.n*this.d))},valueOf:function(){return this.s*this.n/this.d},toFraction:function(t){var e,n="",r=this.n,i=this.d;return this.s<0&&(n+="-"),1===i?n+=r:(t&&(e=Math.floor(r/i))>0&&(n+=e,n+=" ",r%=i),n+=r,n+="/",n+=i),n},toLatex:function(t){var e,n="",r=this.n,i=this.d;return this.s<0&&(n+="-"),1===i?n+=r:(t&&(e=Math.floor(r/i))>0&&(n+=e,r%=i),n+="\\frac{",n+=r,n+="}{",n+=i,n+="}"),n},toContinued:function(){var t,e=this.n,n=this.d,r=[];do r.push(Math.floor(e/n)),t=e%n,e=n,n=t;while(1!==e);return r},toString:function(){var t,e=this.n,n=this.d;if(isNaN(e)||isNaN(n))return"NaN";l.REDUCE||(t=g(e,n),e/=t,n/=t);for(var r=String(e).split(""),i=0,o=[~this.s?"":"-","",""],s="",a=p(e,n),h=f(e,n,a),c=-1,u=1,d=15+a+h+r.length,m=0;d>m;m++,i*=10){if(m<r.length?i+=Number(r[m]):(u=2,c++),a>0)if(c===h)o[u]+=s+"(",s="";else if(c===a+h){o[u]+=s+")";break}i>=n?(o[u]+=s+(i/n|0),s="",i%=n):u>1?s+="0":o[u]&&(o[u]+="0")}return o[0]+=o[1]||"0",o[2]?o[0]+"."+o[2]:o[0]}},n(30).amd?(r=[],i=function(){return l}.apply(e,r),!(void 0!==i&&(t.exports=i))):t.exports=l}(this)}).call(e,n(29)(t))},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("fraction",{number:function(e){if(!isFinite(e)||isNaN(e))throw new Error(e+" cannot be represented as a fraction");return new t.Fraction(e)},string:function(e){return new t.Fraction(e)},"number, number":function(e,n){return new t.Fraction(e,n)},BigNumber:function(e){return new t.Fraction(e.toString())},Fraction:function(t){return t},Object:function(e){return new t.Fraction(e)},"Array | Matrix":function(t){return i(t,o)}});return o}var i=n(19);e.name="fraction",e.factory=r},function(t,e,n){t.exports=[n(38),n(46),n(47),n(50),n(59),n(65),n(66),n(67),n(68),n(52),n(69)]},function(t,e,n){"use strict";function r(t,e,n,r){function i(){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator")}return i.prototype.type="Matrix",i.prototype.isMatrix=!0,i.storage=function(t){if(!s(t))throw new TypeError("format must be a string value");var e=i._storage[t];if(!e)throw new SyntaxError("Unsupported matrix storage format: "+t);return e},i._storage={},i.prototype.storage=function(){throw new Error("Cannot invoke storage on a Matrix interface")},i.prototype.datatype=function(){throw new Error("Cannot invoke datatype on a Matrix interface")},i.prototype.create=function(t,e){throw new Error("Cannot invoke create on a Matrix interface")},i.prototype.subset=function(t,e,n){throw new Error("Cannot invoke subset on a Matrix interface")},i.prototype.get=function(t){throw new Error("Cannot invoke get on a Matrix interface")},i.prototype.set=function(t,e,n){throw new Error("Cannot invoke set on a Matrix interface")},i.prototype.resize=function(t,e){throw new Error("Cannot invoke resize on a Matrix interface")},i.prototype.clone=function(){throw new Error("Cannot invoke clone on a Matrix interface")},i.prototype.size=function(){throw new Error("Cannot invoke size on a Matrix interface")},i.prototype.map=function(t,e){throw new Error("Cannot invoke map on a Matrix interface")},i.prototype.forEach=function(t){throw new Error("Cannot invoke forEach on a Matrix interface")},i.prototype.toArray=function(){throw new Error("Cannot invoke toArray on a Matrix interface")},i.prototype.valueOf=function(){throw new Error("Cannot invoke valueOf on a Matrix interface")},i.prototype.format=function(t){throw new Error("Cannot invoke format on a Matrix interface")},i.prototype.toString=function(){throw new Error("Cannot invoke toString on a Matrix interface")},i}var i=n(39),o=i.string,s=o.isString;e.name="Matrix",e.path="type",e.factory=r},function(t,e,n){"use strict";e.array=n(40),e["boolean"]=n(44),e["function"]=n(45),e.number=n(6),e.object=n(3),e.string=n(23),e.types=n(41),e.emitter=n(8)},function(t,e,n){"use strict";function r(t,e,n){var i,o=t.length;if(o!=e[n])throw new h(o,e[n]);if(n<e.length-1){var s=n+1;for(i=0;o>i;i++){var a=t[i];if(!Array.isArray(a))throw new h(e.length-1,e.length,"<");r(t[i],e,s)}}else for(i=0;o>i;i++)if(Array.isArray(t[i]))throw new h(e.length+1,e.length,">")}function i(t,n,r,o){var s,a,l=t.length,h=n[r],c=Math.min(l,h);if(t.length=h,r<n.length-1){var u=r+1;for(s=0;c>s;s++)a=t[s],Array.isArray(a)||(a=[a],t[s]=a),i(a,n,u,o);for(s=c;h>s;s++)a=[],t[s]=a,i(a,n,u,o)}else{for(s=0;c>s;s++)for(;Array.isArray(t[s]);)t[s]=t[s][0];if(o!==e.UNINITIALIZED)for(s=c;h>s;s++)t[s]=o}}function o(t,e,n){var r,i;if(e>n){var s=n+1;for(r=0,i=t.length;i>r;r++)t[r]=o(t[r],e,s)}else for(;Array.isArray(t);)t=t[0];return t}function s(t,e,n){var r,i;if(Array.isArray(t)){var o=n+1;for(r=0,i=t.length;i>r;r++)t[r]=s(t[r],e,o)}else for(var a=n;e>a;a++)t=[t];return t}var a=n(6),l=n(23),h=(n(3),n(41),n(42)),c=n(43);e.size=function(t){for(var e=[];Array.isArray(t);)e.push(t.length),t=t[0];return e},e.validate=function(t,e){var n=0==e.length;if(n){if(Array.isArray(t))throw new h(t.length,0)}else r(t,e,0)},e.validateIndex=function(t,e){if(!a.isNumber(t)||!a.isInteger(t))throw new TypeError("Index must be an integer (value: "+t+")");if(0>t||"number"==typeof e&&t>=e)throw new c(t,e)},e.UNINITIALIZED={},e.resize=function(t,e,n){if(!Array.isArray(t)||!Array.isArray(e))throw new TypeError("Array expected");if(0===e.length)throw new Error("Resizing to scalar is not supported");e.forEach(function(t){if(!a.isNumber(t)||!a.isInteger(t)||0>t)throw new TypeError("Invalid size, must contain positive integers (size: "+l.format(e)+")")});var r=void 0!==n?n:0;return i(t,e,0,r),t},e.squeeze=function(t,n){for(var r=n||e.size(t);Array.isArray(t)&&1===t.length;)t=t[0],r.shift();for(var i=r.length;1===r[i-1];)i--;return i<r.length&&(t=o(t,i,0),r.length=i),t},e.unsqueeze=function(t,n,r,i){var o=i||e.size(t);if(r)for(var a=0;r>a;a++)t=[t],o.unshift(1);for(t=s(t,n,0);o.length<n;)o.push(1);return t},e.flatten=function(t){if(!Array.isArray(t))return t;var e=[];return t.forEach(function n(t){Array.isArray(t)?t.forEach(n):e.push(t)}),e},e.isArray=Array.isArray},function(t,e){"use strict";e.type=function(t){var e=typeof t;return"object"===e?null===t?"null":t instanceof Boolean?"boolean":t instanceof Number?"number":t instanceof String?"string":Array.isArray(t)?"Array":t instanceof Date?"Date":t instanceof RegExp?"RegExp":"Object":"function"===e?"Function":e},e.isScalar=function(t){return!(t&&t.isMatrix||Array.isArray(t))}},function(t,e){"use strict";function n(t,e,r){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");this.actual=t,this.expected=e,this.relation=r,this.message="Dimension mismatch ("+(Array.isArray(t)?"["+t.join(", ")+"]":t)+" "+(this.relation||"!=")+" "+(Array.isArray(e)?"["+e.join(", ")+"]":e)+")",this.stack=(new Error).stack}n.prototype=new RangeError,n.prototype.constructor=RangeError,n.prototype.name="DimensionError",n.prototype.isDimensionError=!0,t.exports=n},function(t,e){"use strict";function n(t,e,r){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");this.index=t,arguments.length<3?(this.min=0,this.max=e):(this.min=e,this.max=r),void 0!==this.min&&this.index<this.min?this.message="Index out of range ("+this.index+" < "+this.min+")":void 0!==this.max&&this.index>=this.max?this.message="Index out of range ("+this.index+" > "+(this.max-1)+")":this.message="Index out of range ("+this.index+")",this.stack=(new Error).stack}n.prototype=new RangeError,n.prototype.constructor=RangeError,n.prototype.name="IndexError",n.prototype.isIndexError=!0,t.exports=n},function(t,e){"use strict";e.isBoolean=function(t){return"boolean"==typeof t}},function(t,e){e.memoize=function(t,e){return function n(){"object"!=typeof n.cache&&(n.cache={});for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var o=e?e(r):JSON.stringify(r);return o in n.cache?n.cache[o]:n.cache[o]=t.apply(t,r)}},e.maxArgumentCount=function(t){return Object.keys(t.signatures||{}).reduce(function(t,e){var n=(e.match(/,/g)||[]).length+1;return Math.max(t,n)},-1)}},function(t,e,n){"use strict";function r(t,e,r,h){function g(t,e){if(!(this instanceof g))throw new SyntaxError("Constructor must be called with the new operator");if(e&&!p(e))throw new Error("Invalid datatype: "+e);if(t&&t.isMatrix===!0)"DenseMatrix"===t.type?(this._data=l.clone(t._data),this._size=l.clone(t._size),this._datatype=e||t._datatype):(this._data=t.toArray(),this._size=t.size(),this._datatype=e||t._datatype);else if(t&&c(t.data)&&c(t.size))this._data=t.data,this._size=t.size,this._datatype=e||t.datatype;else if(c(t))this._data=w(t),this._size=a.size(this._data),a.validate(this._data,this._size),this._datatype=e;else{if(t)throw new TypeError("Unsupported type of data ("+i.types.type(t)+")");this._data=[],this._size=[0],this._datatype=e}}function m(t,e){if(!e||e.isIndex!==!0)throw new TypeError("Invalid index");var n=e.isScalar();if(n)return t.get(e.min());var r=e.size();if(r.length!=t._size.length)throw new o(r.length,t._size.length);for(var i=e.min(),s=e.max(),a=0,l=t._size.length;l>a;a++)f(i[a],t._size[a]),f(s[a],t._size[a]);return new g(x(t._data,e,r.length,0),t._datatype)}function x(t,e,n,r){var i=r==n-1,o=e.dimension(r);return i?o.map(function(e){return t[e]}).valueOf():o.map(function(i){var o=t[i];return x(o,e,n,r+1)}).valueOf()}function y(t,e,n,r){if(!e||e.isIndex!==!0)throw new TypeError("Invalid index");var i,s=e.size(),h=e.isScalar();if(n&&n.isMatrix===!0?(i=n.size(),n=n.valueOf()):i=a.size(n),h){if(0!==i.length)throw new TypeError("Scalar expected");t.set(e.min(),n,r)}else{if(s.length<t._size.length)throw new o(s.length,t._size.length,"<");if(i.length<s.length){for(var c=0,u=0;1===s[c]&&1===i[c];)c++;for(;1===s[c];)u++,c++;n=a.unsqueeze(n,s.length,u,i)}if(!l.deepEqual(s,i))throw new o(s,i,">");var d=e.max().map(function(t){return t+1});C(t,d,r);var p=s.length,f=0;v(t._data,e,n,p,f)}return t}function v(t,e,n,r,i){var o=i==r-1,s=e.dimension(i);o?s.forEach(function(e,r){f(e),t[e]=n[r[0]]}):s.forEach(function(o,s){f(o),v(t[o],e,n[s[0]],r,i+1)})}function C(t,e,n){for(var r=t._size.slice(0),i=!1;r.length<e.length;)r.push(0),i=!0;for(var o=0,s=e.length;s>o;o++)e[o]>r[o]&&(r[o]=e[o],i=!0);i&&M(t,r,n)}function w(t){for(var e=0,n=t.length;n>e;e++){var r=t[e];c(r)?t[e]=w(r):r&&r.isMatrix===!0&&(t[e]=w(r.valueOf()))}return t}var b=r(n(38));g.prototype=new b,g.prototype.type="DenseMatrix",g.prototype.isDenseMatrix=!0,g.prototype.storage=function(){return"dense"},g.prototype.datatype=function(){return this._datatype},g.prototype.create=function(t,e){return new g(t,e)},g.prototype.subset=function(t,e,n){switch(arguments.length){case 1:return m(this,t);case 2:case 3:return y(this,t,e,n);default:throw new SyntaxError("Wrong number of arguments")}},g.prototype.get=function(t){if(!c(t))throw new TypeError("Array expected");if(t.length!=this._size.length)throw new o(t.length,this._size.length);for(var e=0;e<t.length;e++)f(t[e],this._size[e]);for(var n=this._data,r=0,i=t.length;i>r;r++){var s=t[r];f(s,n.length),n=n[s]}return n},g.prototype.set=function(t,e,n){if(!c(t))throw new TypeError("Array expected");if(t.length<this._size.length)throw new o(t.length,this._size.length,"<");var r,i,s,a=t.map(function(t){return t+1});C(this,a,n);var l=this._data;for(r=0,i=t.length-1;i>r;r++)s=t[r],f(s,l.length),l=l[s];return s=t[t.length-1],f(s,l.length),l[s]=e,this},g.prototype.resize=function(t,e,n){if(!c(t))throw new TypeError("Array expected");var r=n?this.clone():this;return M(r,t,e)};var M=function(t,e,n){if(0===e.length){for(var r=t._data;c(r);)r=r[0];return r}return t._size=e.slice(0),t._data=a.resize(t._data,t._size,n),t};return g.prototype.clone=function(){var t=new g({data:l.clone(this._data),size:l.clone(this._size),datatype:this._datatype});return t},g.prototype.size=function(){return this._size.slice(0)},g.prototype.map=function(t){var e=this,n=function(r,i){return c(r)?r.map(function(t,e){return n(t,i.concat(e))}):t(r,i,e)};return new g({data:n(this._data,[]),size:l.clone(this._size),datatype:this._datatype})},g.prototype.forEach=function(t){var e=this,n=function(r,i){c(r)?r.forEach(function(t,e){n(t,i.concat(e))}):t(r,i,e)};n(this._data,[])},g.prototype.toArray=function(){return l.clone(this._data)},g.prototype.valueOf=function(){return this._data},g.prototype.format=function(t){return s.format(this._data,t)},g.prototype.toString=function(){return s.format(this._data)},g.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},g.prototype.diagonal=function(t){if(t){if(t.isBigNumber===!0&&(t=t.toNumber()),!u(t)||!d(t))throw new TypeError("The parameter k must be an integer number")}else t=0;for(var e=t>0?t:0,n=0>t?-t:0,r=this._size[0],i=this._size[1],o=Math.min(r-n,i-e),s=[],a=0;o>a;a++)s[a]=this._data[a+n][a+e];return new g({data:s,size:[o],datatype:this._datatype})},g.diagonal=function(e,n,r,i,o){if(!c(e))throw new TypeError("Array expected, size parameter");if(2!==e.length)throw new Error("Only two dimensions matrix are supported");if(e=e.map(function(t){if(t&&t.isBigNumber===!0&&(t=t.toNumber()),!u(t)||!d(t)||1>t)throw new Error("Size values must be positive integers");return t}),r){if(r&&r.isBigNumber===!0&&(r=r.toNumber()),!u(r)||!d(r))throw new TypeError("The parameter k must be an integer number")}else r=0;i&&p(o)&&(i=h.convert(i,o));var s,l=r>0?r:0,f=0>r?-r:0,m=e[0],x=e[1],y=Math.min(m-f,x-l);if(c(n)){if(n.length!==y)throw new Error("Invalid value array length");s=function(t){return n[t]}}else if(n&&n.isMatrix===!0){var v=n.size();if(1!==v.length||v[0]!==y)throw new Error("Invalid matrix length");s=function(t){return n.get([t])}}else s=function(){return n};i||(i=s(0)&&s(0).isBigNumber===!0?new t.BigNumber(0):0);var C=[];if(e.length>0){C=a.resize(C,e,i);for(var w=0;y>w;w++)C[w+f][w+l]=s(w)}return new g({data:C,size:[m,x]})},g.fromJSON=function(t){return new g(t)},g.prototype.swapRows=function(t,e){if(!(u(t)&&d(t)&&u(e)&&d(e)))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return f(t,this._size[0]),f(e,this._size[0]),g._swapRows(t,e,this._data),this},g._swapRows=function(t,e,n){var r=n[t];n[t]=n[e],n[e]=r},t.Matrix._storage.dense=g,t.Matrix._storage["default"]=g,g}var i=n(39),o=n(42),s=i.string,a=i.array,l=i.object,h=i.number,c=Array.isArray,u=h.isNumber,d=h.isInteger,p=s.isString,f=a.validateIndex;e.name="DenseMatrix",e.path="type",e.factory=r,e.lazy=!1},function(t,e,n){"use strict";function r(t,e,r,g){function m(t,e){if(!(this instanceof m))throw new SyntaxError("Constructor must be called with the new operator");if(e&&!p(e))throw new Error("Invalid datatype: "+e);if(t&&t.isMatrix===!0)v(this,t,e);else if(t&&c(t.index)&&c(t.ptr)&&c(t.size))this._values=t.values,this._index=t.index,this._ptr=t.ptr,this._size=t.size,this._datatype=e||t.datatype;else if(c(t))C(this,t,e);else{if(t)throw new TypeError("Unsupported type of data ("+i.types.type(t)+")");this._values=[],this._index=[],this._ptr=[0],this._size=[0,0],this._datatype=e}}var x=r(n(38)),y=r(n(48)),v=function(t,e,n){"SparseMatrix"===e.type?(t._values=e._values?a.clone(e._values):void 0,t._index=a.clone(e._index),t._ptr=a.clone(e._ptr),t._size=a.clone(e._size),t._datatype=n||e._datatype):C(t,e.valueOf(),n||e._datatype)},C=function(t,e,n){t._values=[],t._index=[],t._ptr=[],t._datatype=n;var r=e.length,i=0,o=y,s=0;if(p(n)&&(o=g.find(y,[n,n])||y,s=g.convert(0,n)),r>0){var a=0;do{t._ptr.push(t._index.length);for(var l=0;r>l;l++){var h=e[l];if(c(h)){if(0===a&&i<h.length&&(i=h.length),a<h.length){var u=h[a];o(u,s)||(t._values.push(u),t._index.push(l))}}else 0===a&&1>i&&(i=1),o(h,s)||(t._values.push(h),t._index.push(l))}a++}while(i>a)}t._ptr.push(t._index.length),t._size=[r,i]};m.prototype=new x,m.prototype.type="SparseMatrix",m.prototype.isSparseMatrix=!0,m.prototype.storage=function(){return"sparse"},m.prototype.datatype=function(){return this._datatype},m.prototype.create=function(t,e){return new m(t,e)},m.prototype.density=function(){var t=this._size[0],e=this._size[1];return 0!==t&&0!==e?this._index.length/(t*e):0},m.prototype.subset=function(t,e,n){if(!this._values)throw new Error("Cannot invoke subset on a Pattern only matrix");switch(arguments.length){case 1:return w(this,t);case 2:case 3:return b(this,t,e,n);default:throw new SyntaxError("Wrong number of arguments")}};var w=function(t,e){if(!e||e.isIndex!==!0)throw new TypeError("Invalid index");var n=e.isScalar();if(n)return t.get(e.min());var r=e.size();if(r.length!=t._size.length)throw new o(r.length,t._size.length);var i,s,a,l,h=e.min(),c=e.max();for(i=0,s=t._size.length;s>i;i++)f(h[i],t._size[i]),f(c[i],t._size[i]);var u=t._values,d=t._index,p=t._ptr,g=e.dimension(0),x=e.dimension(1),y=[],v=[];g.forEach(function(t,e){v[t]=e[0],y[t]=!0});var C=u?[]:void 0,w=[],b=[];return x.forEach(function(t){for(b.push(w.length),a=p[t],l=p[t+1];l>a;a++)i=d[a],y[i]===!0&&(w.push(v[i]),C&&C.push(u[a]))}),b.push(w.length),new m({values:C,index:w,ptr:b,size:r,datatype:t._datatype})},b=function(t,e,n,r){if(!e||e.isIndex!==!0)throw new TypeError("Invalid index");var i,l=e.size(),h=e.isScalar();if(n&&n.isMatrix===!0?(i=n.size(),n=n.toArray()):i=s.size(n),h){if(0!==i.length)throw new TypeError("Scalar expected");t.set(e.min(),n,r)}else{if(1!==l.length&&2!==l.length)throw new o(l.length,t._size.length,"<");if(i.length<l.length){for(var c=0,u=0;1===l[c]&&1===i[c];)c++;for(;1===l[c];)u++,c++;n=s.unsqueeze(n,l.length,u,i)}if(!a.deepEqual(l,i))throw new o(l,i,">");for(var d=e.min()[0],p=e.min()[1],f=i[0],g=i[1],m=0;f>m;m++)for(var x=0;g>x;x++){var y=n[m][x];t.set([m+d,x+p],y,r)}}return t};m.prototype.get=function(t){if(!c(t))throw new TypeError("Array expected");if(t.length!=this._size.length)throw new o(t.length,this._size.length);if(!this._values)throw new Error("Cannot invoke get on a Pattern only matrix");var e=t[0],n=t[1];f(e,this._size[0]),f(n,this._size[1]);var r=M(e,this._ptr[n],this._ptr[n+1],this._index);return r<this._ptr[n+1]&&this._index[r]===e?this._values[r]:0},m.prototype.set=function(t,e,n){if(!c(t))throw new TypeError("Array expected");if(t.length!=this._size.length)throw new o(t.length,this._size.length);if(!this._values)throw new Error("Cannot invoke set on a Pattern only matrix");var r=t[0],i=t[1],s=this._size[0],a=this._size[1],l=y,h=0;p(this._datatype)&&(l=g.find(y,[this._datatype,this._datatype])||y,h=g.convert(0,this._datatype)),(r>s-1||i>a-1)&&(I(this,Math.max(r+1,s),Math.max(i+1,a),n),
s=this._size[0],a=this._size[1]),f(r,s),f(i,a);var u=M(r,this._ptr[i],this._ptr[i+1],this._index);return u<this._ptr[i+1]&&this._index[u]===r?l(e,h)?S(u,i,this._values,this._index,this._ptr):this._values[u]=e:E(u,r,i,e,this._values,this._index,this._ptr),this};var M=function(t,e,n,r){if(n-e===0)return n;for(var i=e;n>i;i++)if(r[i]===t)return i;return e},S=function(t,e,n,r,i){n.splice(t,1),r.splice(t,1);for(var o=e+1;o<i.length;o++)i[o]--},E=function(t,e,n,r,i,o,s){i.splice(t,0,r),o.splice(t,0,e);for(var a=n+1;a<s.length;a++)s[a]++};m.prototype.resize=function(t,e,n){if(!c(t))throw new TypeError("Array expected");if(2!==t.length)throw new Error("Only two dimensions matrix are supported");t.forEach(function(e){if(!h.isNumber(e)||!h.isInteger(e)||0>e)throw new TypeError("Invalid size, must contain positive integers (size: "+l.format(t)+")")});var r=n?this.clone():this;return I(r,t[0],t[1],e)};var I=function(t,e,n,r){var i=r||0,o=y,s=0;p(t._datatype)&&(o=g.find(y,[t._datatype,t._datatype])||y,s=g.convert(0,t._datatype),i=g.convert(i,t._datatype));var a,l,h,c=!o(i,s),u=t._size[0],d=t._size[1];if(n>d){for(l=d;n>l;l++)if(t._ptr[l]=t._values.length,c)for(a=0;u>a;a++)t._values.push(i),t._index.push(a);t._ptr[n]=t._values.length}else d>n&&(t._ptr.splice(n+1,d-n),t._values.splice(t._ptr[n],t._values.length),t._index.splice(t._ptr[n],t._index.length));if(d=n,e>u){if(c){var f=0;for(l=0;d>l;l++){t._ptr[l]=t._ptr[l]+f,h=t._ptr[l+1]+f;var m=0;for(a=u;e>a;a++,m++)t._values.splice(h+m,0,i),t._index.splice(h+m,0,a),f++}t._ptr[d]=t._values.length}}else if(u>e){var x=0;for(l=0;d>l;l++){t._ptr[l]=t._ptr[l]-x;var v=t._ptr[l],C=t._ptr[l+1]-x;for(h=v;C>h;h++)a=t._index[h],a>e-1&&(t._values.splice(h,1),t._index.splice(h,1),x++)}t._ptr[l]=t._values.length}return t._size[0]=e,t._size[1]=n,t};m.prototype.clone=function(){var t=new m({values:this._values?a.clone(this._values):void 0,index:a.clone(this._index),ptr:a.clone(this._ptr),size:a.clone(this._size),datatype:this._datatype});return t},m.prototype.size=function(){return this._size.slice(0)},m.prototype.map=function(t,e){if(!this._values)throw new Error("Cannot invoke map on a Pattern only matrix");var n=this,r=this._size[0],i=this._size[1],o=function(e,r,i){return t(e,[r,i],n)};return N(this,0,r-1,0,i-1,o,e)};var N=function(t,e,n,r,i,o,s){var a=[],l=[],h=[],c=y,u=0;p(t._datatype)&&(c=g.find(y,[t._datatype,t._datatype])||y,u=g.convert(0,t._datatype));for(var d=function(t,e,n){t=o(t,e,n),c(t,u)||(a.push(t),l.push(e))},f=r;i>=f;f++){h.push(a.length);for(var x=t._ptr[f],v=t._ptr[f+1],C=e,w=x;v>w;w++){var b=t._index[w];if(b>=e&&n>=b){if(!s)for(var M=C;b>M;M++)d(0,M-e,f-r);d(t._values[w],b-e,f-r)}C=b+1}if(!s)for(var S=C;n>=S;S++)d(0,S-e,f-r)}return h.push(a.length),new m({values:a,index:l,ptr:h,size:[n-e+1,i-r+1]})};m.prototype.forEach=function(t,e){if(!this._values)throw new Error("Cannot invoke forEach on a Pattern only matrix");for(var n=this,r=this._size[0],i=this._size[1],o=0;i>o;o++){for(var s=this._ptr[o],a=this._ptr[o+1],l=0,h=s;a>h;h++){var c=this._index[h];if(!e)for(var u=l;c>u;u++)t(0,[u,o],n);t(this._values[h],[c,o],n),l=c+1}if(!e)for(var d=l;r>d;d++)t(0,[d,o],n)}},m.prototype.toArray=function(){return O(this._values,this._index,this._ptr,this._size,!0)},m.prototype.valueOf=function(){return O(this._values,this._index,this._ptr,this._size,!1)};var O=function(t,e,n,r,i){var o,s,l=r[0],h=r[1],c=[];for(o=0;l>o;o++)for(c[o]=[],s=0;h>s;s++)c[o][s]=0;for(s=0;h>s;s++)for(var u=n[s],d=n[s+1],p=u;d>p;p++)o=e[p],c[o][s]=t?i?a.clone(t[p]):t[p]:1;return c};return m.prototype.format=function(t){for(var e=this._size[0],n=this._size[1],r=this.density(),i="Sparse Matrix ["+l.format(e,t)+" x "+l.format(n,t)+"] density: "+l.format(r,t)+"\n",o=0;n>o;o++)for(var s=this._ptr[o],a=this._ptr[o+1],h=s;a>h;h++){var c=this._index[h];i+="\n    ("+l.format(c,t)+", "+l.format(o,t)+") ==> "+(this._values?l.format(this._values[h],t):"X")}return i},m.prototype.toString=function(){return l.format(this.toArray())},m.prototype.toJSON=function(){return{mathjs:"SparseMatrix",values:this._values,index:this._index,ptr:this._ptr,size:this._size,datatype:this._datatype}},m.prototype.diagonal=function(t){if(t){if(t.isBigNumber===!0&&(t=t.toNumber()),!u(t)||!d(t))throw new TypeError("The parameter k must be an integer number")}else t=0;var e=t>0?t:0,n=0>t?-t:0,r=this._size[0],i=this._size[1],o=Math.min(r-n,i-e),s=[],a=[],l=[];l[0]=0;for(var h=e;i>h&&s.length<o;h++)for(var c=this._ptr[h],p=this._ptr[h+1],f=c;p>f;f++){var g=this._index[f];if(g===h-e+n){s.push(this._values[f]),a[s.length-1]=g-n;break}}return l.push(s.length),new m({values:s,index:a,ptr:l,size:[o,1]})},m.fromJSON=function(t){return new m(t)},m.diagonal=function(t,e,n,r,i){if(!c(t))throw new TypeError("Array expected, size parameter");if(2!==t.length)throw new Error("Only two dimensions matrix are supported");if(t=t.map(function(t){if(t&&t.isBigNumber===!0&&(t=t.toNumber()),!u(t)||!d(t)||1>t)throw new Error("Size values must be positive integers");return t}),n){if(n.isBigNumber===!0&&(n=n.toNumber()),!u(n)||!d(n))throw new TypeError("The parameter k must be an integer number")}else n=0;var o=y,s=0;p(i)&&(o=g.find(y,[i,i])||y,s=g.convert(0,i));var a,l=n>0?n:0,h=0>n?-n:0,f=t[0],x=t[1],v=Math.min(f-h,x-l);if(c(e)){if(e.length!==v)throw new Error("Invalid value array length");a=function(t){return e[t]}}else if(e&&e.isMatrix===!0){var C=e.size();if(1!==C.length||C[0]!==v)throw new Error("Invalid matrix length");a=function(t){return e.get([t])}}else a=function(){return e};for(var w=[],b=[],M=[],S=0;x>S;S++){M.push(w.length);var E=S-l;if(E>=0&&v>E){var I=a(E);o(I,s)||(b.push(E+h),w.push(I))}}return M.push(w.length),new m({values:w,index:b,ptr:M,size:[f,x]})},m.prototype.swapRows=function(t,e){if(!(u(t)&&d(t)&&u(e)&&d(e)))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return f(t,this._size[0]),f(e,this._size[0]),m._swapRows(t,e,this._size[1],this._values,this._index,this._ptr),this},m._forEachRow=function(t,e,n,r,i){for(var o=r[t],s=r[t+1],a=o;s>a;a++)i(n[a],e[a])},m._swapRows=function(t,e,n,r,i,o){for(var s=0;n>s;s++){var a=o[s],l=o[s+1],h=M(t,a,l,i),c=M(e,a,l,i);if(l>h&&l>c&&i[h]===t&&i[c]===e){if(r){var u=r[h];r[h]=r[c],r[c]=u}}else if(l>h&&i[h]===t&&(c>=l||i[c]!==e)){var d=r?r[h]:void 0;i.splice(c,0,e),r&&r.splice(c,0,d),i.splice(h>=c?h+1:h,1),r&&r.splice(h>=c?h+1:h,1)}else if(l>c&&i[c]===e&&(h>=l||i[h]!==t)){var p=r?r[c]:void 0;i.splice(h,0,t),r&&r.splice(h,0,p),i.splice(c>=h?c+1:c,1),r&&r.splice(c>=h?c+1:c,1)}}},t.Matrix._storage.sparse=m,m}var i=n(39),o=n(42),s=i.array,a=i.object,l=i.string,h=i.number,c=Array.isArray,u=h.isNumber,d=h.isInteger,p=l.isString,f=s.validateIndex;e.name="SparseMatrix",e.path="type",e.factory=r,e.lazy=!1},function(t,e,n){"use strict";function r(t,e,n,r){var s=r("equalScalar",{"boolean, boolean":function(t,e){return t===e},"number, number":function(t,n){return t===n||i(t,n,e.epsilon)},"BigNumber, BigNumber":function(t,n){return t.eq(n)||o(t,n,e.epsilon)},"Fraction, Fraction":function(t,e){return t.equals(e)},"Complex, Complex":function(t,e){return t.equals(e)},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return s(t.value,e.value)},"string, string":function(t,e){return t===e}});return s}var i=n(6).nearlyEqual,o=n(49);e.factory=r},function(t,e){"use strict";t.exports=function(t,e,n){if(null==n)return t.eq(e);if(t.eq(e))return!0;if(t.isNaN()||e.isNaN())return!1;if(t.isFinite()&&e.isFinite()){var r=t.minus(e).abs();if(r.isZero())return!0;var i=t.constructor.max(t.abs(),e.abs());return r.lte(i.times(n))}return!1}},function(t,e,n){"use strict";function r(t,e,r){function i(){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");this._values=[],this._heap=new t.FibonacciHeap}var o=r(n(51)),s=r(n(48));return i.prototype.type="Spa",i.prototype.isSpa=!0,i.prototype.set=function(t,e){if(this._values[t])this._values[t].value=e;else{var n=this._heap.insert(t,e);this._values[t]=n}},i.prototype.get=function(t){var e=this._values[t];return e?e.value:0},i.prototype.accumulate=function(t,e){var n=this._values[t];n?n.value=o(n.value,e):(n=this._heap.insert(t,e),this._values[t]=n)},i.prototype.forEach=function(t,e,n){var r=this._heap,i=this._values,o=[],a=r.extractMinimum();for(a&&o.push(a);a&&a.key<=e;)a.key>=t&&(s(a.value,0)||n(a.key,a.value,this)),a=r.extractMinimum(),a&&o.push(a);for(var l=0;l<o.length;l++){var h=o[l];a=r.insert(h.key,h.value),i[a.key]=a}},i.prototype.swap=function(t,e){var n=this._values[t],r=this._values[e];if(!n&&r)n=this._heap.insert(t,r.value),this._heap.remove(r),this._values[t]=n,this._values[e]=void 0;else if(n&&!r)r=this._heap.insert(e,n.value),this._heap.remove(n),this._values[e]=r,this._values[t]=void 0;else if(n&&r){var i=n.value;n.value=r.value,r.value=i}},i}e.name="Spa",e.path="type",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,o){var s=r(n(52)),a=r(n(53)),l=n(32),h=r(n(54)),c=r(n(55)),u=r(n(56)),d=r(n(57)),p=r(n(58)),f=o("add",i({"Matrix, Matrix":function(t,e){var n;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":n=c(t,e,a);break;default:n=h(e,t,a,!0)}break;default:switch(e.storage()){case"sparse":n=h(t,e,a,!1);break;default:n=d(t,e,a)}}return n},"Array, Array":function(t,e){return f(s(t),s(e)).valueOf()},"Array, Matrix":function(t,e){return f(s(t),e)},"Matrix, Array":function(t,e){return f(t,s(e))},"Matrix, any":function(t,e){var n;switch(t.storage()){case"sparse":n=u(t,e,a,!1);break;default:n=p(t,e,a,!1)}return n},"any, Matrix":function(t,e){var n;switch(e.storage()){case"sparse":n=u(e,t,a,!0);break;default:n=p(e,t,a,!0)}return n},"Array, any":function(t,e){return p(s(t),e,a,!1).valueOf()},"any, Array":function(t,e){return p(s(e),t,a,!0).valueOf()}},a.signatures));return f.toTex={2:"\\left(${args[0]}"+l.operators.add+"${args[1]}\\right)"},f}var i=n(3).extend;e.name="add",e.factory=r},function(t,e){"use strict";function n(t,e,n,r){function i(e,n,r){var i=t.Matrix.storage(n||"default");return new i(e,r)}var o=r("matrix",{"":function(){return i([])},string:function(t){return i([],t)},"string, string":function(t,e){return i([],t,e)},Array:function(t){return i(t)},Matrix:function(t){return i(t,t.storage())},"Array | Matrix, string":i,"Array | Matrix, string, string":i});return o.toTex={0:"\\begin{bmatrix}\\end{bmatrix}",1:"\\left(${args[0]}\\right)",2:"\\left(${args[0]}\\right)"},o}e.name="matrix",e.factory=n},function(t,e){"use strict";function n(t,e,n,r){var i=r("add",{"number, number":function(t,e){return t+e},"Complex, Complex":function(t,e){return t.add(e)},"BigNumber, BigNumber":function(t,e){return t.plus(e)},"Fraction, Fraction":function(t,e){return t.add(e)},"Unit, Unit":function(t,e){if(null==t.value)throw new Error("Parameter x contains a unit with undefined value");if(null==e.value)throw new Error("Parameter y contains a unit with undefined value");if(!t.equalBase(e))throw new Error("Units do not match");var n=t.clone();return n.value=i(n.value,e.value),n.fixPrefix=!1,n}});return i}e.factory=n},function(t,e,n){"use strict";function r(t,e,n,r){var o=t.DenseMatrix,s=function(t,e,n,s){var a=t._data,l=t._size,h=t._datatype,c=e._values,u=e._index,d=e._ptr,p=e._size,f=e._datatype;if(l.length!==p.length)throw new i(l.length,p.length);if(l[0]!==p[0]||l[1]!==p[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+p+")");if(!c)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var g,m,x=l[0],y=l[1],v="string"==typeof h&&h===f?h:void 0,C=v?r.find(n,[v,v]):n,w=[];for(g=0;x>g;g++)w[g]=[];var b=[],M=[];for(m=0;y>m;m++){for(var S=m+1,E=d[m],I=d[m+1],N=E;I>N;N++)g=u[N],b[g]=s?C(c[N],a[g][m]):C(a[g][m],c[N]),M[g]=S;for(g=0;x>g;g++)M[g]===S?w[g][m]=b[g]:w[g][m]=a[g][m]}return new o({data:w,size:[x,y],datatype:v})};return s}var i=n(42);e.name="algorithm01",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,o){var s=r(n(48)),a=t.SparseMatrix,l=function(t,e,n){var r=t._values,l=t._index,h=t._ptr,c=t._size,u=t._datatype,d=e._values,p=e._index,f=e._ptr,g=e._size,m=e._datatype;if(c.length!==g.length)throw new i(c.length,g.length);if(c[0]!==g[0]||c[1]!==g[1])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+g+")");var x,y=c[0],v=c[1],C=s,w=0,b=n;"string"==typeof u&&u===m&&(x=u,C=o.find(s,[x,x]),w=o.convert(0,x),b=o.find(n,[x,x]));var M,S,E,I,N,O=r&&d?[]:void 0,T=[],_=[],P=new a({values:O,index:T,ptr:_,size:[y,v],datatype:x}),A=r&&d?[]:void 0,k=r&&d?[]:void 0,R=[],z=[];for(S=0;v>S;S++){_[S]=T.length;var B=S+1;for(I=h[S],N=h[S+1],E=I;N>E;E++)M=l[E],T.push(M),R[M]=B,A&&(A[M]=r[E]);for(I=f[S],N=f[S+1],E=I;N>E;E++)if(M=p[E],R[M]===B){if(A){var L=b(A[M],d[E]);C(L,w)?R[M]=null:A[M]=L}}else T.push(M),z[M]=B,k&&(k[M]=d[E]);if(A&&k)for(E=_[S];E<T.length;)M=T[E],R[M]===B?(O[E]=A[M],E++):z[M]===B?(O[E]=k[M],E++):T.splice(E,1)}return _[v]=T.length,P};return l}var i=n(42);e.name="algorithm04",e.factory=r},function(t,e){"use strict";function n(t,e,n,r){var i=t.DenseMatrix,o=function(t,e,n,o){var s=t._values,a=t._index,l=t._ptr,h=t._size,c=t._datatype;if(!s)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var u,d=h[0],p=h[1],f=n;"string"==typeof c&&(u=c,e=r.convert(e,u),f=r.find(n,[u,u]));for(var g=[],m=new i({data:g,size:[d,p],datatype:u}),x=[],y=[],v=0;p>v;v++){for(var C=v+1,w=l[v],b=l[v+1],M=w;b>M;M++){var S=a[M];x[S]=s[M],y[S]=C}for(var E=0;d>E;E++)0===v&&(g[E]=[]),y[E]===C?g[E][v]=o?f(e,x[E]):f(x[E],e):g[E][v]=e}return m};return o}e.name="algorithm10",e.factory=n},function(t,e,n){"use strict";function r(t,e,n,r){var i=t.DenseMatrix,s=function(t,e,n){var s=t._data,l=t._size,h=t._datatype,c=e._data,u=e._size,d=e._datatype,p=[];if(l.length!==u.length)throw new o(l.length,u.length);for(var f=0;f<l.length;f++){if(l[f]!==u[f])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+u+")");p[f]=l[f]}var g,m=n;"string"==typeof h&&h===d&&(g=h,e=r.convert(e,g),m=r.find(n,[g,g]));var x=p.length>0?a(m,0,p,p[0],s,c):[];return new i({data:x,size:p,datatype:g})},a=function(t,e,n,r,i,o){var s=[];if(e===n.length-1)for(var l=0;r>l;l++)s[l]=t(i[l],o[l]);else for(var h=0;r>h;h++)s[h]=a(t,e+1,n,n[e+1],i[h],o[h]);return s};return s}var i=n(39),o=n(42),s=i.string;s.isString,e.name="algorithm13",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=t.DenseMatrix,s=function(t,e,n,s){var l,h=t._data,c=t._size,u=t._datatype,d=n;"string"==typeof u&&(l=u,e=r.convert(e,l),d=r.find(n,[l,l]));var p=c.length>0?a(d,0,c,c[0],h,e,s):[];return new o({data:p,size:i(c),datatype:l})},a=function(t,e,n,r,i,o,s){var l=[];if(e===n.length-1)for(var h=0;r>h;h++)l[h]=s?t(o,i[h]):t(i[h],o);else for(var c=0;r>c;c++)l[c]=a(t,e+1,n,n[e+1],i[c],o,s);return l};return s}var i=n(3).clone;e.name="algorithm14",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,i){function o(){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");this._minimum=null,this._size=0}var s=r(n(60)),a=r(n(64)),l=1/Math.log((1+Math.sqrt(5))/2);o.prototype.type="FibonacciHeap",o.prototype.isFibonacciHeap=!0,o.prototype.insert=function(t,e){var n={key:t,value:e,degree:0};if(this._minimum){var r=this._minimum;n.left=r,n.right=r.right,r.right=n,n.right.left=n,s(t,r.key)&&(this._minimum=n)}else n.left=n,n.right=n,this._minimum=n;return this._size++,n},o.prototype.size=function(){return this._size},o.prototype.clear=function(){this._minimum=null,this._size=0},o.prototype.isEmpty=function(){return!!this._minimum},o.prototype.extractMinimum=function(){var t=this._minimum;if(null===t)return t;for(var e=this._minimum,n=t.degree,r=t.child;n>0;){var i=r.right;r.left.right=r.right,r.right.left=r.left,r.left=e,r.right=e.right,e.right=r,r.right.left=r,r.parent=null,r=i,n--}return t.left.right=t.right,t.right.left=t.left,t==t.right?e=null:(e=t.right,e=p(e,this._size)),this._size--,this._minimum=e,t},o.prototype.remove=function(t){this._minimum=h(this._minimum,t,-1),this.extractMinimum()};var h=function(t,e,n){e.key=n;var r=e.parent;return r&&s(e.key,r.key)&&(c(t,e,r),u(t,r)),s(e.key,t.key)&&(t=e),t},c=function(t,e,n){e.left.right=e.right,e.right.left=e.left,n.degree--,n.child==e&&(n.child=e.right),0===n.degree&&(n.child=null),e.left=t,e.right=t.right,t.right=e,e.right.left=e,e.parent=null,e.mark=!1},u=function(t,e){var n=e.parent;n&&(e.mark?(c(t,e,n),u(n)):e.mark=!0)},d=function(t,e){t.left.right=t.right,t.right.left=t.left,t.parent=e,e.child?(t.left=e.child,t.right=e.child.right,e.child.right=t,t.right.left=t):(e.child=t,t.right=t,t.left=t),e.degree++,t.mark=!1},p=function(t,e){var n=Math.floor(Math.log(e)*l)+1,r=new Array(n),i=0,o=t;if(o)for(i++,o=o.right;o!==t;)i++,o=o.right;for(var h;i>0;){for(var c=o.degree,u=o.right;h=r[c],h;){if(a(o.key,h.key)){var p=h;h=o,o=p}d(h,o),r[c]=null,c++}r[c]=o,o=u,i--}t=null;for(var f=0;n>f;f++)h=r[f],h&&(t?(h.left.right=h.right,h.right.left=h.left,h.left=t,h.right=t.right,t.right=h,h.right.left=h,s(h.key,t.key)&&(t=h)):t=h);return t};return o}e.name="FibonacciHeap",e.path="type",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,s){var a=r(n(52)),l=r(n(61)),h=r(n(62)),c=r(n(63)),u=r(n(57)),d=r(n(58)),p=n(32),f=s("smaller",{"boolean, boolean":function(t,e){return e>t},"number, number":function(t,n){return n>t&&!i(t,n,e.epsilon)},"BigNumber, BigNumber":function(t,n){return t.lt(n)&&!o(t,n,e.epsilon)},"Fraction, Fraction":function(t,e){return-1===t.compare(e)},"Complex, Complex":function(t,e){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return f(t.value,e.value)},"string, string":function(t,e){return e>t},"Matrix, Matrix":function(t,e){var n;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":n=h(t,e,f);break;default:n=l(e,t,f,!0)}break;default:switch(e.storage()){case"sparse":n=l(t,e,f,!1);break;default:n=u(t,e,f)}}return n},"Array, Array":function(t,e){return f(a(t),a(e)).valueOf()},"Array, Matrix":function(t,e){return f(a(t),e)},"Matrix, Array":function(t,e){return f(t,a(e))},"Matrix, any":function(t,e){var n;switch(t.storage()){case"sparse":n=c(t,e,f,!1);break;default:n=d(t,e,f,!1)}return n},"any, Matrix":function(t,e){var n;switch(e.storage()){case"sparse":n=c(e,t,f,!0);break;default:n=d(e,t,f,!0)}return n},"Array, any":function(t,e){return d(a(t),e,f,!1).valueOf()},"any, Array":function(t,e){return d(a(e),t,f,!0).valueOf()}});return f.toTex={2:"\\left(${args[0]}"+p.operators.smaller+"${args[1]}\\right)"},f}var i=n(6).nearlyEqual,o=n(49);e.name="smaller",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=t.DenseMatrix,s=function(t,e,n,s){var a=t._data,l=t._size,h=t._datatype,c=e._values,u=e._index,d=e._ptr,p=e._size,f=e._datatype;if(l.length!==p.length)throw new i(l.length,p.length);if(l[0]!==p[0]||l[1]!==p[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+p+")");if(!c)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var g,m=l[0],x=l[1],y=0,v=n;"string"==typeof h&&h===f&&(g=h,y=r.convert(0,g),v=r.find(n,[g,g]));for(var C=[],w=0;m>w;w++)C[w]=[];for(var b=[],M=[],S=0;x>S;S++){for(var E=S+1,I=d[S],N=d[S+1],O=I;N>O;O++){var T=u[O];b[T]=s?v(c[O],a[T][S]):v(a[T][S],c[O]),M[T]=E}for(var _=0;m>_;_++)M[_]===E?C[_][S]=b[_]:C[_][S]=s?v(y,a[_][S]):v(a[_][S],y)}return new o({data:C,size:[m,x],datatype:g})};return s}var i=n(42);e.name="algorithm03",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=t.DenseMatrix,s=function(t,e,n){var s=t._size,l=t._datatype,h=e._size,c=e._datatype;if(s.length!==h.length)throw new i(s.length,h.length);if(s[0]!==h[0]||s[1]!==h[1])throw new RangeError("Dimension mismatch. Matrix A ("+s+") must match Matrix B ("+h+")");var u,d=s[0],p=s[1],f=0,g=n;"string"==typeof l&&l===c&&(u=l,f=r.convert(0,u),g=r.find(n,[u,u]));var m,x,y=[];for(m=0;d>m;m++)y[m]=[];var v=new o({data:y,size:[d,p],datatype:u}),C=[],w=[],b=[],M=[];for(x=0;p>x;x++){var S=x+1;for(a(t,x,b,C,S),a(e,x,M,w,S),m=0;d>m;m++){var E=b[m]===S?C[m]:f,I=M[m]===S?w[m]:f;y[m][x]=g(E,I)}}return v},a=function(t,e,n,r,i){for(var o=t._values,s=t._index,a=t._ptr,l=a[e],h=a[e+1];h>l;l++){var c=s[l];n[c]=i,r[c]=o[l]}};return s}var i=n(42);e.name="algorithm07",e.factory=r},function(t,e){"use strict";function n(t,e,n,r){var i=t.DenseMatrix,o=function(t,e,n,o){var s=t._values,a=t._index,l=t._ptr,h=t._size,c=t._datatype;if(!s)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var u,d=h[0],p=h[1],f=n;"string"==typeof c&&(u=c,e=r.convert(e,u),f=r.find(n,[u,u]));for(var g=[],m=new i({data:g,size:[d,p],datatype:u}),x=[],y=[],v=0;p>v;v++){for(var C=v+1,w=l[v],b=l[v+1],M=w;b>M;M++){var S=a[M];x[S]=s[M],y[S]=C}for(var E=0;d>E;E++)0===v&&(g[E]=[]),y[E]===C?g[E][v]=o?f(e,x[E]):f(x[E],e):g[E][v]=o?f(e,0):f(0,e)}return m};return o}e.name="algorithm12",e.factory=n},function(t,e,n){"use strict";function r(t,e,r,s){var a=r(n(52)),l=r(n(61)),h=r(n(62)),c=r(n(63)),u=r(n(57)),d=r(n(58)),p=n(32),f=s("larger",{"boolean, boolean":function(t,e){return t>e},"number, number":function(t,n){return t>n&&!i(t,n,e.epsilon)},"BigNumber, BigNumber":function(t,n){return t.gt(n)&&!o(t,n,e.epsilon)},"Fraction, Fraction":function(t,e){return 1===t.compare(e)},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return f(t.value,e.value)},"string, string":function(t,e){return t>e},"Matrix, Matrix":function(t,e){var n;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":n=h(t,e,f);break;default:n=l(e,t,f,!0)}break;default:switch(e.storage()){case"sparse":n=l(t,e,f,!1);break;default:n=u(t,e,f)}}return n},"Array, Array":function(t,e){return f(a(t),a(e)).valueOf()},"Array, Matrix":function(t,e){return f(a(t),e)},"Matrix, Array":function(t,e){return f(t,a(e))},"Matrix, any":function(t,e){var n;switch(t.storage()){case"sparse":n=c(t,e,f,!1);break;default:n=d(t,e,f,!1)}return n},"any, Matrix":function(t,e){var n;switch(e.storage()){case"sparse":n=c(e,t,f,!0);break;default:n=d(e,t,f,!0)}return n},"Array, any":function(t,e){return d(a(t),e,f,!1).valueOf()},"any, Array":function(t,e){return d(a(e),t,f,!0).valueOf()}});return f.toTex={2:"\\left(${args[0]}"+p.operators.larger+"${args[1]}\\right)"},f}var i=n(6).nearlyEqual,o=n(49);e.name="larger",e.factory=r},function(t,e,n){"use strict";function r(t,e,r){function o(t,e){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");if(e&&!l(e))throw new Error("Invalid datatype: "+e);if(t&&t.isMatrix===!0||a(t)){var n=new h(t,e);this._data=n._data,this._size=n._size,this._datatype=n._datatype,this._min=null,this._max=null}else if(t&&a(t.data)&&a(t.size))this._data=t.data,this._size=t.size,this._datatype=t.datatype,this._min="undefined"!=typeof t.min?t.min:null,this._max="undefined"!=typeof t.max?t.max:null;else{if(t)throw new TypeError("Unsupported type of data ("+i.types.type(t)+")");this._data=[],this._size=[0],this._datatype=e,this._min=null,this._max=null}}var h=r(n(46)),c=r(n(60));return o.prototype=new h,o.prototype.type="ImmutableDenseMatrix",o.prototype.isImmutableDenseMatrix=!0,o.prototype.subset=function(t){switch(arguments.length){case 1:var e=h.prototype.subset.call(this,t);return e.isMatrix?new o({data:e._data,size:e._size,datatype:e._datatype}):e;case 2:case 3:throw new Error("Cannot invoke set subset on an Immutable Matrix instance");default:throw new SyntaxError("Wrong number of arguments")}},o.prototype.set=function(){throw new Error("Cannot invoke set on an Immutable Matrix instance")},o.prototype.resize=function(){throw new Error("Cannot invoke resize on an Immutable Matrix instance")},o.prototype.clone=function(){var t=new o({data:s.clone(this._data),size:s.clone(this._size),datatype:this._datatype});return t},o.prototype.toJSON=function(){return{mathjs:"ImmutableDenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},o.fromJSON=function(t){return new o(t)},o.prototype.swapRows=function(){throw new Error("Cannot invoke swapRows on an Immutable Matrix instance")},o.prototype.min=function(){if(null===this._min){var t=null;this.forEach(function(e){(null===t||c(e,t))&&(t=e)}),this._min=null!==t?t:void 0}return this._min},o.prototype.max=function(){if(null===this._max){var t=null;this.forEach(function(e){(null===t||c(t,e))&&(t=e)}),this._max=null!==t?t:void 0}return this._max},o}var i=n(39),o=i.string,s=i.object,a=Array.isArray,l=o.isString;e.name="ImmutableDenseMatrix",e.path="type",e.factory=r},function(t,e,n){"use strict";function r(t){function e(t){if(!(this instanceof e))throw new SyntaxError("Constructor must be called with the new operator");this._dimensions=[],this._isScalar=!0;for(var r=0,i=arguments.length;i>r;r++){var o=arguments[r];if(o&&o.isRange===!0)this._dimensions.push(o),this._isScalar=!1;else if(o&&(Array.isArray(o)||o.isMatrix===!0)){var s=n(o.valueOf());this._dimensions.push(s);var a=s.size();1===a.length&&1===a[0]||(this._isScalar=!1)}else if("number"==typeof o)this._dimensions.push(n([o]));else{if("string"!=typeof o)throw new TypeError("Dimension must be an Array, Matrix, number, string, or Range");this._dimensions.push(o)}}}function n(e){for(var n=0,r=e.length;r>n;n++)if("number"!=typeof e[n]||!o(e[n]))throw new TypeError("Index parameters must be positive integer numbers");return new t.ImmutableDenseMatrix(e)}return e.prototype.type="Index",e.prototype.isIndex=!0,e.prototype.clone=function(){var t=new e;return t._dimensions=i(this._dimensions),t._isScalar=this._isScalar,t},e.create=function(t){var n=new e;return e.apply(n,t),n},e.prototype.size=function(){for(var t=[],e=0,n=this._dimensions.length;n>e;e++){var r=this._dimensions[e];t[e]="string"==typeof r?1:r.size()[0]}return t},e.prototype.max=function(){for(var t=[],e=0,n=this._dimensions.length;n>e;e++){var r=this._dimensions[e];t[e]="string"==typeof r?r:r.max()}return t},e.prototype.min=function(){for(var t=[],e=0,n=this._dimensions.length;n>e;e++){var r=this._dimensions[e];t[e]="string"==typeof r?r:r.min()}return t},e.prototype.forEach=function(t){for(var e=0,n=this._dimensions.length;n>e;e++)t(this._dimensions[e],e,this)},e.prototype.dimension=function(t){return this._dimensions[t]||null},e.prototype.isObjectProperty=function(){return 1===this._dimensions.length&&"string"==typeof this._dimensions[0]},e.prototype.getObjectProperty=function(){return this.isObjectProperty()?this._dimensions[0]:null},e.prototype.isScalar=function(){return this._isScalar},e.prototype.toArray=function(){for(var t=[],e=0,n=this._dimensions.length;n>e;e++){var r=this._dimensions[e];t.push("string"==typeof r?r:r.toArray())}return t},e.prototype.valueOf=e.prototype.toArray,e.prototype.toString=function(){for(var t=[],e=0,n=this._dimensions.length;n>e;e++){var r=this._dimensions[e];"string"==typeof r?t.push(JSON.stringify(r)):t.push(r.toString())}return"["+t.join(", ")+"]"},e.prototype.toJSON=function(){return{mathjs:"Index",dimensions:this._dimensions}},e.fromJSON=function(t){return e.create(t.dimensions)},e}var i=n(3).clone,o=n(6).isInteger;e.name="Index",e.path="type",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){function o(t,e,n){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");if(null!=t)if(t.isBigNumber===!0)t=t.toNumber();else if("number"!=typeof t)throw new TypeError("Parameter start must be a number");if(null!=e)if(e.isBigNumber===!0)e=e.toNumber();else if("number"!=typeof e)throw new TypeError("Parameter end must be a number");if(null!=n)if(n.isBigNumber===!0)n=n.toNumber();else if("number"!=typeof n)throw new TypeError("Parameter step must be a number");this.start=null!=t?parseFloat(t):0,this.end=null!=e?parseFloat(e):0,this.step=null!=n?parseFloat(n):1}return o.prototype.type="Range",o.prototype.isRange=!0,o.parse=function(t){if("string"!=typeof t)return null;var e=t.split(":"),n=e.map(function(t){return parseFloat(t)}),r=n.some(function(t){return isNaN(t)});if(r)return null;switch(n.length){case 2:return new o(n[0],n[1]);case 3:return new o(n[0],n[2],n[1]);default:return null}},o.prototype.clone=function(){return new o(this.start,this.end,this.step)},o.prototype.size=function(){var t=0,e=this.start,n=this.step,r=this.end,o=r-e;return i.sign(n)==i.sign(o)?t=Math.ceil(o/n):0==o&&(t=0),isNaN(t)&&(t=0),[t]},o.prototype.min=function(){var t=this.size()[0];return t>0?this.step>0?this.start:this.start+(t-1)*this.step:void 0},o.prototype.max=function(){var t=this.size()[0];return t>0?this.step>0?this.start+(t-1)*this.step:this.start:void 0},o.prototype.forEach=function(t){var e=this.start,n=this.step,r=this.end,i=0;if(n>0)for(;r>e;)t(e,[i],this),e+=n,i++;else if(0>n)for(;e>r;)t(e,[i],this),e+=n,i++},o.prototype.map=function(t){var e=[];return this.forEach(function(n,r,i){e[r[0]]=t(n,r,i)}),e},o.prototype.toArray=function(){var t=[];return this.forEach(function(e,n){t[n[0]]=e}),t},o.prototype.valueOf=function(){return this.toArray()},o.prototype.format=function(t){var e=i.format(this.start,t);return 1!=this.step&&(e+=":"+i.format(this.step,t)),e+=":"+i.format(this.end,t)},o.prototype.toString=function(){return this.format()},o.prototype.toJSON=function(){return{mathjs:"Range",start:this.start,end:this.end,step:this.step}},o.fromJSON=function(t){return new o(t.start,t.end,t.step)},o}var i=n(6);e.name="Range",e.path="type",e.factory=r},function(t,e){"use strict";function n(t,e,n,r){return r("index",{"...number | string | BigNumber | Range | Array | Matrix":function(e){var n=e.map(function(t){return t&&t.isBigNumber===!0?t.toNumber():t&&(Array.isArray(t)||t.isMatrix===!0)?t.map(function(t){return t&&t.isBigNumber===!0?t.toNumber():t}):t}),r=new t.Index;return t.Index.apply(r,n),r}})}e.name="index",e.factory=n},function(t,e){"use strict";function n(t,e,n,r){var i=t.SparseMatrix,o=r("sparse",{"":function(){return new i([])},string:function(t){return new i([],t)},"Array | Matrix":function(t){return new i(t)},"Array | Matrix, string":function(t,e){return new i(t,e)}});return o.toTex={0:"\\begin{bsparse}\\end{bsparse}",1:"\\left(${args[0]}\\right)"},o}e.name="sparse",e.factory=n},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("number",{"":function(){return 0},number:function(t){return t},string:function(t){var e=Number(t);if(isNaN(e))throw new SyntaxError('String "'+t+'" is no valid number');return e},BigNumber:function(t){return t.toNumber()},Fraction:function(t){return t.valueOf()},Unit:function(t){throw new Error("Second argument with valueless unit expected")},"Unit, string | Unit":function(t,e){return t.toNumber(e)},"Array | Matrix":function(t){return i(t,o)}});return o.toTex={0:"0",1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)${args[1]}\\right)"},o}var i=n(19);e.name="number",e.factory=r},function(t,e,n){t.exports=[n(72)]},function(t,e){"use strict";function n(t,e,n,r){function i(t){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");this.entries=t||[]}return i.prototype.type="ResultSet",i.prototype.isResultSet=!0,i.prototype.valueOf=function(){return this.entries},i.prototype.toString=function(){return"["+this.entries.join(", ")+"]"},i.prototype.toJSON=function(){return{mathjs:"ResultSet",entries:this.entries}},i.fromJSON=function(t){return new i(t.entries)},i}e.name="ResultSet",e.path="type",e.factory=n},function(t,e,n){"use strict";function r(t,e,n,r){var s=r("string",{"":function(){return""},number:o.format,"null":function(t){return"null"},"boolean":function(t){return t+""},string:function(t){return t},"Array | Matrix":function(t){return i(t,s)},any:function(t){return String(t)}});return s.toTex={0:'\\mathtt{""}',1:"\\mathrm{string}\\left(${args[0]}\\right)"
},s}var i=n(19),o=n(6);e.name="string",e.factory=r},function(t,e,n){t.exports=[n(75),n(96),n(97),n(98),n(99)]},function(t,e,n){"use strict";function r(t,e,r,a,l){function h(t,e){if(!(this instanceof h))throw new Error("Constructor must be called with the new operator");if(void 0!==t&&!T(t)&&!t.isComplex)throw new TypeError("First parameter in Unit constructor must be number, BigNumber, Fraction, Complex, or undefined");if(void 0!=e&&("string"!=typeof e||""==e))throw new TypeError("Second parameter in Unit constructor must be a string");if(void 0!=e){var n=h.parse(e);this.units=n.units,this.dimensions=n.dimensions}else{this.units=[{unit:H,prefix:D.NONE,power:0}],this.dimensions=[];for(var r=0;r<F.length;r++)this.dimensions[r]=0}this.value=void 0!=t?this._normalize(t):null,this.fixPrefix=!1,this.isUnitListSimplified=!0}function c(){for(;" "==B||"\t"==B;)p()}function u(t){return t>="0"&&"9">=t||"."==t}function d(t){return t>="0"&&"9">=t}function p(){z++,B=R.charAt(z)}function f(t){z=t,B=R.charAt(z)}function g(){var t,e="";if(t=z,"+"==B?p():"-"==B&&(e+=B,p()),!u(B))return f(t),null;if("."==B){if(e+=B,p(),!d(B))return f(t),null}else{for(;d(B);)e+=B,p();"."==B&&(e+=B,p())}for(;d(B);)e+=B,p();if("E"==B||"e"==B){var n="",r=z;if(n+=B,p(),"+"!=B&&"-"!=B||(n+=B,p()),!d(B))return f(r),e;for(e+=n;d(B);)e+=B,p()}return e}function m(){for(var t="",e=R.charCodeAt(z);e>=48&&57>=e||e>=65&&90>=e||e>=97&&122>=e;)t+=B,p(),e=R.charCodeAt(z);return e=t.charCodeAt(0),e>=65&&90>=e||e>=97&&122>=e?t||null:null}function x(t){return B===t?(p(),t):null}function y(t){if(U.hasOwnProperty(t)){var e=U[t],n=e.prefixes[""];return{unit:e,prefix:n}}for(var r in U)if(U.hasOwnProperty(r)&&i(t,r)){var e=U[r],o=t.length-r.length,s=t.substring(0,o),n=e.prefixes[s];if(void 0!==n)return{unit:e,prefix:n}}return null}function v(e){if("BigNumber"===e.number){var n=s.pi(t.BigNumber);U.rad.value=new t.BigNumber(1),U.deg.value=n.div(180),U.grad.value=n.div(200),U.cycle.value=n.times(2),U.arcsec.value=n.div(648e3),U.arcmin.value=n.div(10800)}else U.rad.value=1,U.deg.value=Math.PI/180,U.grad.value=Math.PI/200,U.cycle.value=2*Math.PI,U.arcsec.value=Math.PI/648e3,U.arcmin.value=Math.PI/10800}function C(t){for(var e=0;e<t.length;e++){var n=t.charAt(e),r=function(t){return/^[a-zA-Z]$/.test(t)},i=function(t){return t>="0"&&"9">=t};if(0===e&&!r(n))throw new Error('Invalid unit name (must begin with alpha character): "'+t+'"');if(e>0&&!r(n)&&!i(n))throw new Error('Invalid unit name (only alphanumeric characters are allowed): "'+t+'"')}}var w=r(n(53)),b=r(n(77)),M=r(n(80)),S=r(n(81)),E=r(n(82)),I=r(n(86)),N=r(n(87)),O=r(n(88)),T=r(n(89)),_=r(n(90)),P=r(n(91)),A=r(n(70)),k=r(n(27));h.prototype.type="Unit",h.prototype.isUnit=!0;var R,z,B;h.parse=function(n,r){if(r=r||{},R=n,z=-1,B="","string"!=typeof R)throw new TypeError("Invalid argument in Unit.parse, string expected");var i=new h;i.units=[],p(),c();var o=g(),s=null;o&&(s="BigNumber"===e.number?new t.BigNumber(o):"Fraction"===e.number?new t.Fraction(o):parseFloat(o)),c();for(var a=1,l=!1,u=[],d=1;;){for(c();"("===B;)u.push(a),d*=a,a=1,p(),c();if(!B)break;var f=B,v=m();if(null==v)throw new SyntaxError('Unexpected "'+f+'" in "'+R+'" at index '+z.toString());var C=y(v);if(null==C)throw new SyntaxError('Unit "'+v+'" not found.');var w=a*d;if(c(),x("^")){c();var b=g();if(null==b)throw new SyntaxError('In "'+n+'", "^" must be followed by a floating-point number');w*=b}i.units.push({unit:C.unit,prefix:C.prefix,power:w});for(var M=0;M<F.length;M++)i.dimensions[M]+=(C.unit.dimensions[M]||0)*w;for(c();")"===B;){if(0===u.length)throw new SyntaxError('Unmatched ")" in "'+R+'" at index '+z.toString());d/=u.pop(),p(),c()}if(l=!1,x("*")?(a=1,l=!0):x("/")?(a=-1,l=!0):a=1,C.unit.base){var S=C.unit.base.key;$.auto[S]={unit:C.unit,prefix:C.prefix}}}if(c(),B)throw new SyntaxError('Could not parse: "'+n+'"');if(l)throw new SyntaxError('Trailing characters: "'+n+'"');if(0!==u.length)throw new SyntaxError('Unmatched "(" in "'+R+'"');if(0==i.units.length&&!r.allowNoUnits)throw new SyntaxError('"'+n+'" contains no units');return i.value=void 0!=s?i._normalize(s):null,i},h.prototype.clone=function(){var t=new h;t.fixPrefix=this.fixPrefix,t.isUnitListSimplified=this.isUnitListSimplified,t.value=o(this.value),t.dimensions=this.dimensions.slice(0),t.units=[];for(var e=0;e<this.units.length;e++){t.units[e]={};for(var n in this.units[e])this.units[e].hasOwnProperty(n)&&(t.units[e][n]=this.units[e][n])}return t},h.prototype._isDerived=function(){return 0!==this.units.length&&(this.units.length>1||Math.abs(this.units[0].power-1)>1e-15)},h.prototype._normalize=function(t){var e,n,r,i,o;if(null==t||0===this.units.length)return t;if(this._isDerived()){var s=t;o=h._getNumberConverter(P(t));for(var a=0;a<this.units.length;a++)e=o(this.units[a].unit.value),i=o(this.units[a].prefix.value),r=o(this.units[a].power),s=M(s,E(M(e,i),r));return s}return o=h._getNumberConverter(P(t)),e=o(this.units[0].unit.value),n=o(this.units[0].unit.offset),i=o(this.units[0].prefix.value),M(w(t,n),M(e,i))},h.prototype._denormalize=function(t,e){var n,r,i,o,s;if(null==t||0===this.units.length)return t;if(this._isDerived()){var a=t;s=h._getNumberConverter(P(t));for(var l=0;l<this.units.length;l++)n=s(this.units[l].unit.value),o=s(this.units[l].prefix.value),i=s(this.units[l].power),a=S(a,E(M(n,o),i));return a}return s=h._getNumberConverter(P(t)),n=s(this.units[0].unit.value),o=s(this.units[0].prefix.value),r=s(this.units[0].unit.offset),void 0==e?b(S(S(t,n),o),r):b(S(S(t,n),e),r)},h.isValuelessUnit=function(t){return null!=y(t)},h.prototype.hasBase=function(t){if("string"==typeof t&&(t=V[t]),!t)return!1;for(var e=0;e<F.length;e++)if(Math.abs((this.dimensions[e]||0)-(t.dimensions[e]||0))>1e-12)return!1;return!0},h.prototype.equalBase=function(t){for(var e=0;e<F.length;e++)if(Math.abs((this.dimensions[e]||0)-(t.dimensions[e]||0))>1e-12)return!1;return!0},h.prototype.equals=function(t){return this.equalBase(t)&&O(this.value,t.value)},h.prototype.multiply=function(t){for(var e=this.clone(),n=0;n<F.length;n++)e.dimensions[n]=(this.dimensions[n]||0)+(t.dimensions[n]||0);for(var n=0;n<t.units.length;n++){var r={};for(var i in t.units[n])r[i]=t.units[n][i];e.units.push(r)}if(null!=this.value||null!=t.value){var o=null==this.value?this._normalize(1):this.value,s=null==t.value?t._normalize(1):t.value;e.value=M(o,s)}else e.value=null;return e.isUnitListSimplified=!1,L(e)},h.prototype.divide=function(t){for(var e=this.clone(),n=0;n<F.length;n++)e.dimensions[n]=(this.dimensions[n]||0)-(t.dimensions[n]||0);for(var n=0;n<t.units.length;n++){var r={};for(var i in t.units[n])r[i]=t.units[n][i];r.power=-r.power,e.units.push(r)}if(null!=this.value||null!=t.value){var o=null==this.value?this._normalize(1):this.value,s=null==t.value?t._normalize(1):t.value;e.value=S(o,s)}else e.value=null;return e.isUnitListSimplified=!1,L(e)},h.prototype.pow=function(t){for(var e=this.clone(),n=0;n<F.length;n++)e.dimensions[n]=(this.dimensions[n]||0)*t;for(var n=0;n<e.units.length;n++)e.units[n].power*=t;return null!=e.value?e.value=E(e.value,t):e.value=null,e.isUnitListSimplified=!1,L(e)};var L=function(t){return t.equalBase(V.NONE)&&null!==t.value&&!e.predictable?t.value:t};h.prototype.abs=function(){var t=this.clone();t.value=I(t.value);for(var e in t.units)"VA"!==t.units[e].unit.name&&"VAR"!==t.units[e].unit.name||(t.units[e].unit=U.W);return t},h.prototype.to=function(t){var e,n=null==this.value?this._normalize(1):this.value;if("string"==typeof t){if(e=h.parse(t),!this.equalBase(e))throw new Error("Units do not match");if(null!==e.value)throw new Error("Cannot convert to a unit with a value");return e.value=o(n),e.fixPrefix=!0,e.isUnitListSimplified=!0,e}if(t&&t.isUnit){if(!this.equalBase(t))throw new Error("Units do not match");if(null!==t.value)throw new Error("Cannot convert to a unit with a value");return e=t.clone(),e.value=o(n),e.fixPrefix=!0,e.isUnitListSimplified=!0,e}throw new Error("String or Unit expected as parameter")},h.prototype.toNumber=function(t){return A(this.toNumeric(t))},h.prototype.toNumeric=function(t){var e=this;return t&&(e=this.to(t)),e._isDerived()?e._denormalize(e.value):e._denormalize(e.value,e.units[0].prefix.value)},h.prototype.toString=function(){return this.format()},h.prototype.toJSON=function(){return{mathjs:"Unit",value:this._denormalize(this.value),unit:this.formatUnits(),fixPrefix:this.fixPrefix}},h.fromJSON=function(t){var e=new h(t.value,t.unit);return e.fixPrefix=t.fixPrefix||!1,e},h.prototype.valueOf=h.prototype.toString,h.prototype.simplifyUnitListLazy=function(){if(!this.isUnitListSimplified&&null!=this.value){var t,e=[];for(var r in G)if(this.hasBase(V[r])){t=r;break}if("NONE"===t)this.units=[];else{var i;if(t&&G.hasOwnProperty(t)&&(i=G[t]),i)this.units=[{unit:i.unit,prefix:i.prefix,power:1}];else{for(var o=!1,s=0;s<F.length;s++){var a=F[s];Math.abs(this.dimensions[s]||0)>1e-12&&(G.hasOwnProperty(a)?e.push({unit:G[a].unit,prefix:G[a].prefix,power:this.dimensions[s]||0}):o=!0)}n(92),e.length<this.units.length&&!o&&(this.units=e)}}this.isUnitListSimplified=!0}},h.prototype.formatUnits=function(){this.simplifyUnitListLazy();for(var t="",e="",n=0,r=0,i=0;i<this.units.length;i++)this.units[i].power>0?(n++,t+=" "+this.units[i].prefix.name+this.units[i].unit.name,Math.abs(this.units[i].power-1)>1e-15&&(t+="^"+this.units[i].power)):this.units[i].power<0&&r++;if(r>0)for(var i=0;i<this.units.length;i++)this.units[i].power<0&&(n>0?(e+=" "+this.units[i].prefix.name+this.units[i].unit.name,Math.abs(this.units[i].power+1)>1e-15&&(e+="^"+-this.units[i].power)):(e+=" "+this.units[i].prefix.name+this.units[i].unit.name,e+="^"+this.units[i].power));t=t.substr(1),e=e.substr(1),n>1&&r>0&&(t="("+t+")"),r>1&&n>0&&(e="("+e+")");var o=t;return n>0&&r>0&&(o+=" / "),o+=e},h.prototype.format=function(t){this.simplifyUnitListLazy();var e=!1,n=!0;"undefined"!=typeof this.value&&null!==this.value&&this.value.isComplex&&(e=Math.abs(this.value.re)<1e-14,n=Math.abs(this.value.im)<1e-14);for(var r in this.units)this.units[r].unit&&("VA"===this.units[r].unit.name&&e?this.units[r].unit=U.VAR:"VAR"!==this.units[r].unit.name||e||(this.units[r].unit=U.VA));1!==this.units.length||this.fixPrefix||Math.abs(this.units[0].power-Math.round(this.units[0].power))<1e-14&&(this.units[0].prefix=this._bestPrefix());var i=this._denormalize(this.value),o=null!==this.value?_(i,t||{}):"",s=this.formatUnits();return this.value&&this.value.isComplex&&(o="("+o+")"),s.length>0&&o.length>0&&(o+=" "),o+=s},h.prototype._bestPrefix=function(){if(1!==this.units.length)throw new Error("Can only compute the best prefix for single units with integer powers, like kg, s^2, N^-1, and so forth!");if(Math.abs(this.units[0].power-Math.round(this.units[0].power))>=1e-14)throw new Error("Can only compute the best prefix for single units with integer powers, like kg, s^2, N^-1, and so forth!");var t=I(this.value),e=I(this.units[0].unit.value),n=this.units[0].prefix;if(0===t)return n;var r=this.units[0].power,i=Math.abs(Math.log(t/Math.pow(n.value*e,r))/Math.LN10-1.2),o=this.units[0].unit.prefixes;for(var s in o)if(o.hasOwnProperty(s)){var a=o[s];if(a.scientific){var l=Math.abs(Math.log(t/Math.pow(a.value*e,r))/Math.LN10-1.2);(i>l||l===i&&a.name.length<n.name.length)&&(n=a,i=l)}}return n},h.prototype.splitUnit=function(t){for(var e=this.clone(),n=[],r=0;r<t.length&&(e=e.to(t[r]),r!=t.length-1);r++){var i=N(e.toNumeric()),o=new h(i,t[r].toString());n.push(o),e=b(e,o)}return n.push(e),n};var D={NONE:{"":{name:"",value:1,scientific:!0}},SHORT:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:10,scientific:!1},h:{name:"h",value:100,scientific:!1},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0},d:{name:"d",value:.1,scientific:!1},c:{name:"c",value:.01,scientific:!1},m:{name:"m",value:.001,scientific:!0},u:{name:"u",value:1e-6,scientific:!0},n:{name:"n",value:1e-9,scientific:!0},p:{name:"p",value:1e-12,scientific:!0},f:{name:"f",value:1e-15,scientific:!0},a:{name:"a",value:1e-18,scientific:!0},z:{name:"z",value:1e-21,scientific:!0},y:{name:"y",value:1e-24,scientific:!0}},LONG:{"":{name:"",value:1,scientific:!0},deca:{name:"deca",value:10,scientific:!1},hecto:{name:"hecto",value:100,scientific:!1},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0},deci:{name:"deci",value:.1,scientific:!1},centi:{name:"centi",value:.01,scientific:!1},milli:{name:"milli",value:.001,scientific:!0},micro:{name:"micro",value:1e-6,scientific:!0},nano:{name:"nano",value:1e-9,scientific:!0},pico:{name:"pico",value:1e-12,scientific:!0},femto:{name:"femto",value:1e-15,scientific:!0},atto:{name:"atto",value:1e-18,scientific:!0},zepto:{name:"zepto",value:1e-21,scientific:!0},yocto:{name:"yocto",value:1e-24,scientific:!0}},SQUARED:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:100,scientific:!1},h:{name:"h",value:1e4,scientific:!1},k:{name:"k",value:1e6,scientific:!0},M:{name:"M",value:1e12,scientific:!0},G:{name:"G",value:1e18,scientific:!0},T:{name:"T",value:1e24,scientific:!0},P:{name:"P",value:1e30,scientific:!0},E:{name:"E",value:1e36,scientific:!0},Z:{name:"Z",value:1e42,scientific:!0},Y:{name:"Y",value:1e48,scientific:!0},d:{name:"d",value:.01,scientific:!1},c:{name:"c",value:1e-4,scientific:!1},m:{name:"m",value:1e-6,scientific:!0},u:{name:"u",value:1e-12,scientific:!0},n:{name:"n",value:1e-18,scientific:!0},p:{name:"p",value:1e-24,scientific:!0},f:{name:"f",value:1e-30,scientific:!0},a:{name:"a",value:1e-36,scientific:!0},z:{name:"z",value:1e-42,scientific:!0},y:{name:"y",value:1e-48,scientific:!0}},CUBIC:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:1e3,scientific:!1},h:{name:"h",value:1e6,scientific:!1},k:{name:"k",value:1e9,scientific:!0},M:{name:"M",value:1e18,scientific:!0},G:{name:"G",value:1e27,scientific:!0},T:{name:"T",value:1e36,scientific:!0},P:{name:"P",value:1e45,scientific:!0},E:{name:"E",value:1e54,scientific:!0},Z:{name:"Z",value:1e63,scientific:!0},Y:{name:"Y",value:1e72,scientific:!0},d:{name:"d",value:.001,scientific:!1},c:{name:"c",value:1e-6,scientific:!1},m:{name:"m",value:1e-9,scientific:!0},u:{name:"u",value:1e-18,scientific:!0},n:{name:"n",value:1e-27,scientific:!0},p:{name:"p",value:1e-36,scientific:!0},f:{name:"f",value:1e-45,scientific:!0},a:{name:"a",value:1e-54,scientific:!0},z:{name:"z",value:1e-63,scientific:!0},y:{name:"y",value:1e-72,scientific:!0}},BINARY_SHORT:{"":{name:"",value:1,scientific:!0},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0},Ki:{name:"Ki",value:1024,scientific:!0},Mi:{name:"Mi",value:Math.pow(1024,2),scientific:!0},Gi:{name:"Gi",value:Math.pow(1024,3),scientific:!0},Ti:{name:"Ti",value:Math.pow(1024,4),scientific:!0},Pi:{name:"Pi",value:Math.pow(1024,5),scientific:!0},Ei:{name:"Ei",value:Math.pow(1024,6),scientific:!0},Zi:{name:"Zi",value:Math.pow(1024,7),scientific:!0},Yi:{name:"Yi",value:Math.pow(1024,8),scientific:!0}},BINARY_LONG:{"":{name:"",value:1,scientific:!0},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0},kibi:{name:"kibi",value:1024,scientific:!0},mebi:{name:"mebi",value:Math.pow(1024,2),scientific:!0},gibi:{name:"gibi",value:Math.pow(1024,3),scientific:!0},tebi:{name:"tebi",value:Math.pow(1024,4),scientific:!0},pebi:{name:"pebi",value:Math.pow(1024,5),scientific:!0},exi:{name:"exi",value:Math.pow(1024,6),scientific:!0},zebi:{name:"zebi",value:Math.pow(1024,7),scientific:!0},yobi:{name:"yobi",value:Math.pow(1024,8),scientific:!0}},BTU:{"":{name:"",value:1,scientific:!0},MM:{name:"MM",value:1e6,scientific:!0}}};D.SHORTLONG={};for(var W in D.SHORT)D.SHORT.hasOwnProperty(W)&&(D.SHORTLONG[W]=D.SHORT[W]);for(var W in D.LONG)D.LONG.hasOwnProperty(W)&&(D.SHORTLONG[W]=D.LONG[W]);var F=["MASS","LENGTH","TIME","CURRENT","TEMPERATURE","LUMINOUS_INTENSITY","AMOUNT_OF_SUBSTANCE","ANGLE","BIT"],V={NONE:{dimensions:[0,0,0,0,0,0,0,0,0]},MASS:{dimensions:[1,0,0,0,0,0,0,0,0]},LENGTH:{dimensions:[0,1,0,0,0,0,0,0,0]},TIME:{dimensions:[0,0,1,0,0,0,0,0,0]},CURRENT:{dimensions:[0,0,0,1,0,0,0,0,0]},TEMPERATURE:{dimensions:[0,0,0,0,1,0,0,0,0]},LUMINOUS_INTENSITY:{dimensions:[0,0,0,0,0,1,0,0,0]},AMOUNT_OF_SUBSTANCE:{dimensions:[0,0,0,0,0,0,1,0,0]},FORCE:{dimensions:[1,1,-2,0,0,0,0,0,0]},SURFACE:{dimensions:[0,2,0,0,0,0,0,0,0]},VOLUME:{dimensions:[0,3,0,0,0,0,0,0,0]},ENERGY:{dimensions:[1,2,-2,0,0,0,0,0,0]},POWER:{dimensions:[1,2,-3,0,0,0,0,0,0]},PRESSURE:{dimensions:[1,-1,-2,0,0,0,0,0,0]},ELECTRIC_CHARGE:{dimensions:[0,0,1,1,0,0,0,0,0]},ELECTRIC_CAPACITANCE:{dimensions:[-1,-2,4,2,0,0,0,0,0]},ELECTRIC_POTENTIAL:{dimensions:[1,2,-3,-1,0,0,0,0,0]},ELECTRIC_RESISTANCE:{dimensions:[1,2,-3,-2,0,0,0,0,0]},ELECTRIC_INDUCTANCE:{dimensions:[1,2,-2,-2,0,0,0,0,0]},ELECTRIC_CONDUCTANCE:{dimensions:[-1,-2,3,2,0,0,0,0,0]},MAGNETIC_FLUX:{dimensions:[1,2,-2,-1,0,0,0,0,0]},MAGNETIC_FLUX_DENSITY:{dimensions:[1,0,-2,-1,0,0,0,0,0]},FREQUENCY:{dimensions:[0,0,-1,0,0,0,0,0,0]},ANGLE:{dimensions:[0,0,0,0,0,0,0,1,0]},BIT:{dimensions:[0,0,0,0,0,0,0,0,1]}};for(var W in V)V[W].key=W;var q={},H={name:"",base:q,value:1,offset:0,dimensions:[0,0,0,0,0,0,0,0,0]},U={meter:{name:"meter",base:V.LENGTH,prefixes:D.LONG,value:1,offset:0},inch:{name:"inch",base:V.LENGTH,prefixes:D.NONE,value:.0254,offset:0},foot:{name:"foot",base:V.LENGTH,prefixes:D.NONE,value:.3048,offset:0},yard:{name:"yard",base:V.LENGTH,prefixes:D.NONE,value:.9144,offset:0},mile:{name:"mile",base:V.LENGTH,prefixes:D.NONE,value:1609.344,offset:0},link:{name:"link",base:V.LENGTH,prefixes:D.NONE,value:.201168,offset:0},rod:{name:"rod",base:V.LENGTH,prefixes:D.NONE,value:5.02921,offset:0},chain:{name:"chain",base:V.LENGTH,prefixes:D.NONE,value:20.1168,offset:0},angstrom:{name:"angstrom",base:V.LENGTH,prefixes:D.NONE,value:1e-10,offset:0},m:{name:"m",base:V.LENGTH,prefixes:D.SHORT,value:1,offset:0},"in":{name:"in",base:V.LENGTH,prefixes:D.NONE,value:.0254,offset:0},ft:{name:"ft",base:V.LENGTH,prefixes:D.NONE,value:.3048,offset:0},yd:{name:"yd",base:V.LENGTH,prefixes:D.NONE,value:.9144,offset:0},mi:{name:"mi",base:V.LENGTH,prefixes:D.NONE,value:1609.344,offset:0},li:{name:"li",base:V.LENGTH,prefixes:D.NONE,value:.201168,offset:0},rd:{name:"rd",base:V.LENGTH,prefixes:D.NONE,value:5.02921,offset:0},ch:{name:"ch",base:V.LENGTH,prefixes:D.NONE,value:20.1168,offset:0},mil:{name:"mil",base:V.LENGTH,prefixes:D.NONE,value:254e-7,offset:0},m2:{name:"m2",base:V.SURFACE,prefixes:D.SQUARED,value:1,offset:0},sqin:{name:"sqin",base:V.SURFACE,prefixes:D.NONE,value:64516e-8,offset:0},sqft:{name:"sqft",base:V.SURFACE,prefixes:D.NONE,value:.09290304,offset:0},sqyd:{name:"sqyd",base:V.SURFACE,prefixes:D.NONE,value:.83612736,offset:0},sqmi:{name:"sqmi",base:V.SURFACE,prefixes:D.NONE,value:2589988.110336,offset:0},sqrd:{name:"sqrd",base:V.SURFACE,prefixes:D.NONE,value:25.29295,offset:0},sqch:{name:"sqch",base:V.SURFACE,prefixes:D.NONE,value:404.6873,offset:0},sqmil:{name:"sqmil",base:V.SURFACE,prefixes:D.NONE,value:6.4516e-10,offset:0},acre:{name:"acre",base:V.SURFACE,prefixes:D.NONE,value:4046.86,offset:0},hectare:{name:"hectare",base:V.SURFACE,prefixes:D.NONE,value:1e4,offset:0},m3:{name:"m3",base:V.VOLUME,prefixes:D.CUBIC,value:1,offset:0},L:{name:"L",base:V.VOLUME,prefixes:D.SHORT,value:.001,offset:0},l:{name:"l",base:V.VOLUME,prefixes:D.SHORT,value:.001,offset:0},litre:{name:"litre",base:V.VOLUME,prefixes:D.LONG,value:.001,offset:0},cuin:{name:"cuin",base:V.VOLUME,prefixes:D.NONE,value:16387064e-12,offset:0},cuft:{name:"cuft",base:V.VOLUME,prefixes:D.NONE,value:.028316846592,offset:0},cuyd:{name:"cuyd",base:V.VOLUME,prefixes:D.NONE,value:.764554857984,offset:0},teaspoon:{name:"teaspoon",base:V.VOLUME,prefixes:D.NONE,value:5e-6,offset:0},tablespoon:{name:"tablespoon",base:V.VOLUME,prefixes:D.NONE,value:15e-6,offset:0},drop:{name:"drop",base:V.VOLUME,prefixes:D.NONE,value:5e-8,offset:0},gtt:{name:"gtt",base:V.VOLUME,prefixes:D.NONE,value:5e-8,offset:0},minim:{name:"minim",base:V.VOLUME,prefixes:D.NONE,value:6.161152e-8,offset:0},fluiddram:{name:"fluiddram",base:V.VOLUME,prefixes:D.NONE,value:36966911e-13,offset:0},fluidounce:{name:"fluidounce",base:V.VOLUME,prefixes:D.NONE,value:2957353e-11,offset:0},gill:{name:"gill",base:V.VOLUME,prefixes:D.NONE,value:.0001182941,offset:0},cc:{name:"cc",base:V.VOLUME,prefixes:D.NONE,value:1e-6,offset:0},cup:{name:"cup",base:V.VOLUME,prefixes:D.NONE,value:.0002365882,offset:0},pint:{name:"pint",base:V.VOLUME,prefixes:D.NONE,value:.0004731765,offset:0},quart:{name:"quart",base:V.VOLUME,prefixes:D.NONE,value:.0009463529,offset:0},gallon:{name:"gallon",base:V.VOLUME,prefixes:D.NONE,value:.003785412,offset:0},beerbarrel:{name:"beerbarrel",base:V.VOLUME,prefixes:D.NONE,value:.1173478,offset:0},oilbarrel:{name:"oilbarrel",base:V.VOLUME,prefixes:D.NONE,value:.1589873,offset:0},hogshead:{name:"hogshead",base:V.VOLUME,prefixes:D.NONE,value:.238481,offset:0},fldr:{name:"fldr",base:V.VOLUME,prefixes:D.NONE,value:36966911e-13,offset:0},floz:{name:"floz",base:V.VOLUME,prefixes:D.NONE,value:2957353e-11,offset:0},gi:{name:"gi",base:V.VOLUME,prefixes:D.NONE,value:.0001182941,offset:0},cp:{name:"cp",base:V.VOLUME,prefixes:D.NONE,value:.0002365882,offset:0},pt:{name:"pt",base:V.VOLUME,prefixes:D.NONE,value:.0004731765,offset:0},qt:{name:"qt",base:V.VOLUME,prefixes:D.NONE,value:.0009463529,offset:0},gal:{name:"gal",base:V.VOLUME,prefixes:D.NONE,value:.003785412,offset:0},bbl:{name:"bbl",base:V.VOLUME,prefixes:D.NONE,value:.1173478,offset:0},obl:{name:"obl",base:V.VOLUME,prefixes:D.NONE,value:.1589873,offset:0},g:{name:"g",base:V.MASS,prefixes:D.SHORT,value:.001,offset:0},gram:{name:"gram",base:V.MASS,prefixes:D.LONG,value:.001,offset:0},ton:{name:"ton",base:V.MASS,prefixes:D.SHORT,value:907.18474,offset:0},tonne:{name:"tonne",base:V.MASS,prefixes:D.SHORT,value:1e3,offset:0},grain:{name:"grain",base:V.MASS,prefixes:D.NONE,value:6479891e-11,offset:0},dram:{name:"dram",base:V.MASS,prefixes:D.NONE,value:.0017718451953125,offset:0},ounce:{name:"ounce",base:V.MASS,prefixes:D.NONE,value:.028349523125,offset:0},poundmass:{name:"poundmass",base:V.MASS,prefixes:D.NONE,value:.45359237,offset:0},hundredweight:{name:"hundredweight",base:V.MASS,prefixes:D.NONE,value:45.359237,offset:0},stick:{name:"stick",base:V.MASS,prefixes:D.NONE,value:.115,offset:0},stone:{name:"stone",base:V.MASS,prefixes:D.NONE,value:6.35029318,offset:0},gr:{name:"gr",base:V.MASS,prefixes:D.NONE,value:6479891e-11,offset:0},dr:{name:"dr",base:V.MASS,prefixes:D.NONE,value:.0017718451953125,offset:0},oz:{name:"oz",base:V.MASS,prefixes:D.NONE,value:.028349523125,offset:0},lbm:{name:"lbm",base:V.MASS,prefixes:D.NONE,value:.45359237,offset:0},cwt:{name:"cwt",base:V.MASS,prefixes:D.NONE,value:45.359237,offset:0},s:{name:"s",base:V.TIME,prefixes:D.SHORT,value:1,offset:0},min:{name:"min",base:V.TIME,prefixes:D.NONE,value:60,offset:0},h:{name:"h",base:V.TIME,prefixes:D.NONE,value:3600,offset:0},second:{name:"second",base:V.TIME,prefixes:D.LONG,value:1,offset:0},sec:{name:"sec",base:V.TIME,prefixes:D.LONG,value:1,offset:0},minute:{name:"minute",base:V.TIME,prefixes:D.NONE,value:60,offset:0},hour:{name:"hour",base:V.TIME,prefixes:D.NONE,value:3600,offset:0},day:{name:"day",base:V.TIME,prefixes:D.NONE,value:86400,offset:0},week:{name:"week",base:V.TIME,prefixes:D.NONE,value:604800,offset:0},month:{name:"month",base:V.TIME,prefixes:D.NONE,value:2629800,offset:0},year:{name:"year",base:V.TIME,prefixes:D.NONE,value:31557600,offset:0},decade:{name:"year",base:V.TIME,prefixes:D.NONE,value:315576e3,offset:0},century:{name:"century",base:V.TIME,prefixes:D.NONE,value:315576e4,offset:0},millennium:{name:"millennium",base:V.TIME,prefixes:D.NONE,value:315576e5,offset:0},hertz:{name:"Hertz",base:V.FREQUENCY,prefixes:D.LONG,value:1,offset:0,reciprocal:!0},Hz:{name:"Hz",base:V.FREQUENCY,prefixes:D.SHORT,value:1,offset:0,reciprocal:!0},rad:{name:"rad",base:V.ANGLE,prefixes:D.NONE,value:1,offset:0},deg:{name:"deg",base:V.ANGLE,prefixes:D.NONE,value:null,offset:0},grad:{name:"grad",base:V.ANGLE,prefixes:D.NONE,value:null,offset:0},cycle:{name:"cycle",base:V.ANGLE,prefixes:D.NONE,value:null,offset:0},arcsec:{name:"arcsec",base:V.ANGLE,prefixes:D.NONE,value:null,offset:0},arcmin:{name:"arcmin",base:V.ANGLE,prefixes:D.NONE,value:null,offset:0},A:{name:"A",base:V.CURRENT,prefixes:D.SHORT,value:1,offset:0},ampere:{name:"ampere",base:V.CURRENT,prefixes:D.LONG,value:1,offset:0},K:{name:"K",base:V.TEMPERATURE,prefixes:D.NONE,value:1,offset:0},degC:{name:"degC",base:V.TEMPERATURE,prefixes:D.NONE,value:1,offset:273.15},degF:{name:"degF",base:V.TEMPERATURE,prefixes:D.NONE,value:1/1.8,offset:459.67},degR:{name:"degR",base:V.TEMPERATURE,prefixes:D.NONE,value:1/1.8,offset:0},kelvin:{name:"kelvin",base:V.TEMPERATURE,prefixes:D.NONE,value:1,offset:0},celsius:{name:"celsius",base:V.TEMPERATURE,prefixes:D.NONE,value:1,offset:273.15},fahrenheit:{name:"fahrenheit",base:V.TEMPERATURE,prefixes:D.NONE,value:1/1.8,offset:459.67},rankine:{name:"rankine",base:V.TEMPERATURE,prefixes:D.NONE,value:1/1.8,offset:0},mol:{name:"mol",base:V.AMOUNT_OF_SUBSTANCE,prefixes:D.SHORT,value:1,offset:0},mole:{name:"mole",base:V.AMOUNT_OF_SUBSTANCE,prefixes:D.LONG,value:1,offset:0},cd:{name:"cd",base:V.LUMINOUS_INTENSITY,prefixes:D.NONE,value:1,offset:0},candela:{name:"candela",base:V.LUMINOUS_INTENSITY,prefixes:D.NONE,value:1,offset:0},N:{name:"N",base:V.FORCE,prefixes:D.SHORT,value:1,offset:0},newton:{name:"newton",base:V.FORCE,prefixes:D.LONG,value:1,offset:0},dyn:{name:"dyn",base:V.FORCE,prefixes:D.SHORT,value:1e-5,offset:0},dyne:{name:"dyne",base:V.FORCE,prefixes:D.LONG,value:1e-5,offset:0},lbf:{name:"lbf",base:V.FORCE,prefixes:D.NONE,value:4.4482216152605,offset:0},poundforce:{name:"poundforce",base:V.FORCE,prefixes:D.NONE,value:4.4482216152605,offset:0},kip:{name:"kip",base:V.FORCE,prefixes:D.LONG,value:4448.2216,offset:0},J:{name:"J",base:V.ENERGY,prefixes:D.SHORT,value:1,offset:0},joule:{name:"joule",base:V.ENERGY,prefixes:D.SHORT,value:1,offset:0},erg:{name:"erg",base:V.ENERGY,prefixes:D.NONE,value:1e-5,offset:0},Wh:{name:"Wh",base:V.ENERGY,prefixes:D.SHORT,value:3600,offset:0},BTU:{name:"BTU",base:V.ENERGY,prefixes:D.BTU,value:1055.05585262,offset:0},eV:{name:"eV",base:V.ENERGY,prefixes:D.SHORT,value:1.602176565e-19,offset:0},electronvolt:{name:"electronvolt",base:V.ENERGY,prefixes:D.LONG,value:1.602176565e-19,offset:0},W:{name:"W",base:V.POWER,prefixes:D.SHORT,value:1,offset:0},watt:{name:"W",base:V.POWER,prefixes:D.LONG,value:1,offset:0},hp:{name:"hp",base:V.POWER,prefixes:D.NONE,value:745.6998715386,offset:0},VAR:{name:"VAR",base:V.POWER,prefixes:D.SHORT,value:k.I,offset:0},VA:{name:"VA",base:V.POWER,prefixes:D.SHORT,value:1,offset:0},Pa:{name:"Pa",base:V.PRESSURE,prefixes:D.SHORT,value:1,offset:0},psi:{name:"psi",base:V.PRESSURE,prefixes:D.NONE,value:6894.75729276459,offset:0},atm:{name:"atm",base:V.PRESSURE,prefixes:D.NONE,value:101325,offset:0},bar:{name:"bar",base:V.PRESSURE,prefixes:D.NONE,value:1e5,offset:0},torr:{name:"torr",base:V.PRESSURE,prefixes:D.NONE,value:133.322,offset:0},mmHg:{name:"mmHg",base:V.PRESSURE,prefixes:D.NONE,value:133.322,offset:0},mmH2O:{name:"mmH2O",base:V.PRESSURE,prefixes:D.NONE,value:9.80665,offset:0},cmH2O:{name:"cmH2O",base:V.PRESSURE,prefixes:D.NONE,value:98.0665,offset:0},coulomb:{name:"coulomb",base:V.ELECTRIC_CHARGE,prefixes:D.LONG,value:1,offset:0},C:{name:"C",base:V.ELECTRIC_CHARGE,prefixes:D.SHORT,value:1,offset:0},farad:{name:"farad",base:V.ELECTRIC_CAPACITANCE,prefixes:D.LONG,value:1,offset:0},F:{name:"F",base:V.ELECTRIC_CAPACITANCE,prefixes:D.SHORT,value:1,offset:0},volt:{name:"volt",base:V.ELECTRIC_POTENTIAL,prefixes:D.LONG,value:1,offset:0},V:{name:"V",base:V.ELECTRIC_POTENTIAL,prefixes:D.SHORT,value:1,offset:0},ohm:{name:"ohm",base:V.ELECTRIC_RESISTANCE,prefixes:D.SHORTLONG,value:1,offset:0},henry:{name:"henry",base:V.ELECTRIC_INDUCTANCE,prefixes:D.LONG,value:1,offset:0},H:{name:"H",base:V.ELECTRIC_INDUCTANCE,prefixes:D.SHORT,value:1,offset:0},siemens:{name:"siemens",base:V.ELECTRIC_CONDUCTANCE,prefixes:D.LONG,value:1,offset:0},S:{name:"S",base:V.ELECTRIC_CONDUCTANCE,prefixes:D.SHORT,value:1,offset:0},weber:{name:"weber",base:V.MAGNETIC_FLUX,prefixes:D.LONG,value:1,offset:0},Wb:{name:"Wb",base:V.MAGNETIC_FLUX,prefixes:D.SHORT,value:1,offset:0},tesla:{name:"tesla",base:V.MAGNETIC_FLUX_DENSITY,prefixes:D.LONG,value:1,offset:0},T:{name:"T",base:V.MAGNETIC_FLUX_DENSITY,prefixes:D.SHORT,value:1,offset:0},b:{name:"b",base:V.BIT,prefixes:D.BINARY_SHORT,value:1,offset:0},bits:{name:"bits",base:V.BIT,prefixes:D.BINARY_LONG,value:1,offset:0},B:{name:"B",base:V.BIT,prefixes:D.BINARY_SHORT,value:8,offset:0},bytes:{name:"bytes",base:V.BIT,prefixes:D.BINARY_LONG,value:8,offset:0}},j={meters:"meter",inches:"inch",feet:"foot",yards:"yard",miles:"mile",links:"link",rods:"rod",chains:"chain",angstroms:"angstrom",lt:"l",litres:"litre",liter:"litre",liters:"litre",teaspoons:"teaspoon",tablespoons:"tablespoon",minims:"minim",fluiddrams:"fluiddram",fluidounces:"fluidounce",gills:"gill",cups:"cup",pints:"pint",quarts:"quart",gallons:"gallon",beerbarrels:"beerbarrel",oilbarrels:"oilbarrel",hogsheads:"hogshead",gtts:"gtt",grams:"gram",tons:"ton",tonnes:"tonne",grains:"grain",drams:"dram",ounces:"ounce",poundmasses:"poundmass",hundredweights:"hundredweight",sticks:"stick",lb:"lbm",lbs:"lbm",kips:"kip",acres:"acre",hectares:"hectare",sqfeet:"sqft",sqyard:"sqyd",sqmile:"sqmi",sqmiles:"sqmi",mmhg:"mmHg",mmh2o:"mmH2O",cmh2o:"cmH2O",seconds:"second",secs:"second",minutes:"minute",mins:"minute",hours:"hour",hr:"hour",hrs:"hour",days:"day",weeks:"week",months:"month",years:"year",hertz:"hertz",radians:"rad",degree:"deg",degrees:"deg",gradian:"grad",gradians:"grad",cycles:"cycle",arcsecond:"arcsec",arcseconds:"arcsec",arcminute:"arcmin",arcminutes:"arcmin",BTUs:"BTU",watts:"watt",joules:"joule",amperes:"ampere",coulombs:"coulomb",volts:"volt",ohms:"ohm",farads:"farad",webers:"weber",teslas:"tesla",electronvolts:"electronvolt",moles:"mole"};v(e),l.on("config",function(t,e){t.number!==e.number&&v(t)});var $={si:{NONE:{unit:H,prefix:D.NONE[""]},LENGTH:{unit:U.m,prefix:D.SHORT[""]},MASS:{unit:U.g,prefix:D.SHORT.k},TIME:{unit:U.s,prefix:D.SHORT[""]},CURRENT:{unit:U.A,prefix:D.SHORT[""]},TEMPERATURE:{unit:U.K,prefix:D.SHORT[""]},LUMINOUS_INTENSITY:{unit:U.cd,prefix:D.SHORT[""]},AMOUNT_OF_SUBSTANCE:{unit:U.mol,prefix:D.SHORT[""]},ANGLE:{unit:U.rad,prefix:D.SHORT[""]},BIT:{unit:U.bit,prefix:D.SHORT[""]},FORCE:{unit:U.N,prefix:D.SHORT[""]},ENERGY:{unit:U.J,prefix:D.SHORT[""]},POWER:{unit:U.W,prefix:D.SHORT[""]},PRESSURE:{unit:U.Pa,prefix:D.SHORT[""]},ELECTRIC_CHARGE:{unit:U.C,prefix:D.SHORT[""]},ELECTRIC_CAPACITANCE:{unit:U.F,prefix:D.SHORT[""]},ELECTRIC_POTENTIAL:{unit:U.V,prefix:D.SHORT[""]},ELECTRIC_RESISTANCE:{unit:U.ohm,prefix:D.SHORT[""]},ELECTRIC_INDUCTANCE:{unit:U.H,prefix:D.SHORT[""]},ELECTRIC_CONDUCTANCE:{unit:U.S,prefix:D.SHORT[""]},MAGNETIC_FLUX:{unit:U.Wb,prefix:D.SHORT[""]},MAGNETIC_FLUX_DENSITY:{unit:U.T,prefix:D.SHORT[""]},FREQUENCY:{unit:U.Hz,prefix:D.SHORT[""]}}};$.cgs=JSON.parse(JSON.stringify($.si)),$.cgs.LENGTH={unit:U.m,prefix:D.SHORT.c},
$.cgs.MASS={unit:U.g,prefix:D.SHORT[""]},$.cgs.FORCE={unit:U.dyn,prefix:D.SHORT[""]},$.cgs.ENERGY={unit:U.erg,prefix:D.NONE[""]},$.us=JSON.parse(JSON.stringify($.si)),$.us.LENGTH={unit:U.ft,prefix:D.NONE[""]},$.us.MASS={unit:U.lbm,prefix:D.NONE[""]},$.us.TEMPERATURE={unit:U.degF,prefix:D.NONE[""]},$.us.FORCE={unit:U.lbf,prefix:D.NONE[""]},$.us.ENERGY={unit:U.BTU,prefix:D.BTU[""]},$.us.POWER={unit:U.hp,prefix:D.NONE[""]},$.us.PRESSURE={unit:U.psi,prefix:D.NONE[""]},$.auto=JSON.parse(JSON.stringify($.si));var G=$.auto;h.setUnitSystem=function(t){if(!$.hasOwnProperty(t))throw new Error("Unit system "+t+" does not exist. Choices are: "+Object.keys($).join(", "));G=$[t]},h.getUnitSystem=function(){for(var t in $)if($[t]===G)return t},h.typeConverters={BigNumber:function(e){return new t.BigNumber(e+"")},Fraction:function(e){return new t.Fraction(e)},Complex:function(t){return t},number:function(t){return t}},h._getNumberConverter=function(t){if(!h.typeConverters[t])throw new TypeError('Unsupported type "'+t+'"');return h.typeConverters[t]};for(var W in U){var Y=U[W];Y.dimensions=Y.base.dimensions}for(var J in j)if(j.hasOwnProperty(J)){var Y=U[j[J]],X={};for(var W in Y)Y.hasOwnProperty(W)&&(X[W]=Y[W]);X.name=J,U[J]=X}return h.createUnit=function(t,e){if("object"!=typeof t)throw new TypeError("createUnit expects first parameter to be of type 'Object'");if(e&&e.override)for(var n in t)if(t.hasOwnProperty(n)&&h.deleteUnit(n),t[n].aliases)for(var r=0;r<t[n].aliases.length;r++)h.deleteUnit(t[n].aliases[r]);var i;for(var n in t)t.hasOwnProperty(n)&&(i=h.createUnitSingle(n,t[n]));return i},h.createUnitSingle=function(t,e,n){if("undefined"!=typeof e&&null!==e||(e={}),"string"!=typeof t)throw new TypeError("createUnitSingle expects first parameter to be of type 'string'");if(U.hasOwnProperty(t))throw new Error('Cannot create unit "'+t+'": a unit with that name already exists');C(t);var r,i,o=null,s=[],a=0;if(e&&"Unit"===e.type)o=e.clone();else if("string"==typeof e)""!==e&&(r=e);else{if("object"!=typeof e)throw new TypeError('Cannot create unit "'+t+'" from "'+e.toString()+'": expecting "string" or "Unit" or "Object"');r=e.definition,i=e.prefixes,a=e.offset,s=e.aliases}if(s)for(var l=0;l<s.length;l++)if(U.hasOwnProperty(s[l]))throw new Error('Cannot create alias "'+s[l]+'": a unit with that name already exists');if(r&&"string"==typeof r&&!o)try{o=h.parse(r,{allowNoUnits:!0})}catch(c){throw c.message='Could not create unit "'+t+'" from "'+r+'": '+c.message,c}else r&&"Unit"===r.type&&(o=r.clone());s=s||[],a=a||0,i=i&&i.toUpperCase?D[i.toUpperCase()]||D.NONE:D.NONE;var u={};if(o){u={name:t,value:o.value,dimensions:o.dimensions.slice(0),prefixes:i,offset:a};var d=!1;for(var l in V)if(V.hasOwnProperty(l)){for(var p=!0,f=0;f<F.length;f++)if(Math.abs((u.dimensions[f]||0)-(V[l].dimensions[f]||0))>1e-12){p=!1;break}if(p){d=!0;break}}if(!d){var g=t+"_STUFF",m={dimensions:o.dimensions.slice(0)};m.key=g,V[g]=m,G[g]={unit:u,prefix:D.NONE[""]},u.base=g}}else{var g=t+"_STUFF";if(F.indexOf(g)>=0)throw new Error('Cannot create new base unit "'+t+'": a base unit with that name already exists (and cannot be overridden)');F.push(g);for(var x in V)V.hasOwnProperty(x)&&(V[x].dimensions[F.length-1]=0);for(var m={dimensions:[]},l=0;l<F.length;l++)m.dimensions[l]=0;m.dimensions[F.length-1]=1,m.key=g,V[g]=m,u={name:t,value:1,dimensions:V[g].dimensions.slice(0),prefixes:i,offset:a,base:g},G[g]={unit:u,prefix:D.NONE[""]}}h.UNITS[t]=u;for(var l=0;l<s.length;l++){var y=s[l],v={};for(var w in u)u.hasOwnProperty(w)&&(v[w]=u[w]);v.name=y,h.UNITS[y]=v}return new h(null,t)},h.deleteUnit=function(t){delete h.UNITS[t]},h.PREFIXES=D,h.BASE_UNITS=V,h.UNITS=U,h.UNIT_SYSTEMS=$,h}var i=n(23).endsWith,o=n(3).clone,s=n(76);e.name="Unit",e.path="type",e.factory=r,e.math=!0},function(t,e,n){function r(t){return t[0].precision}var i=n(45).memoize;e.e=i(function(t){return new t(1).exp()},r),e.phi=i(function(t){return new t(1).plus(new t(5).sqrt()).div(2)},r),e.pi=i(function(t){return pi=t.acos(-1)},r),e.tau=i(function(t){return e.pi(t).times(2)},r)},function(t,e,n){"use strict";function r(t,e,r,o){var s=n(32),a=r(n(52)),l=r(n(53)),h=r(n(78)),c=r(n(54)),u=r(n(61)),d=r(n(79)),p=r(n(56)),f=r(n(57)),g=r(n(58)),m=o("subtract",{"number, number":function(t,e){return t-e},"Complex, Complex":function(t,e){return t.sub(e)},"BigNumber, BigNumber":function(t,e){return t.minus(e)},"Fraction, Fraction":function(t,e){return t.sub(e)},"Unit, Unit":function(t,e){if(null==t.value)throw new Error("Parameter x contains a unit with undefined value");if(null==e.value)throw new Error("Parameter y contains a unit with undefined value");if(!t.equalBase(e))throw new Error("Units do not match");var n=t.clone();return n.value=m(n.value,e.value),n.fixPrefix=!1,n},"Matrix, Matrix":function(t,e){var n=t.size(),r=e.size();if(n.length!==r.length)throw new i(n.length,r.length);var o;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":o=d(t,e,m);break;default:o=u(e,t,m,!0)}break;default:switch(e.storage()){case"sparse":o=c(t,e,m,!1);break;default:o=f(t,e,m)}}return o},"Array, Array":function(t,e){return m(a(t),a(e)).valueOf()},"Array, Matrix":function(t,e){return m(a(t),e)},"Matrix, Array":function(t,e){return m(t,a(e))},"Matrix, any":function(t,e){var n;switch(t.storage()){case"sparse":n=p(t,h(e),l);break;default:n=g(t,e,m)}return n},"any, Matrix":function(t,e){var n;switch(e.storage()){case"sparse":n=p(e,t,m,!0);break;default:n=g(e,t,m,!0)}return n},"Array, any":function(t,e){return g(a(t),e,m,!1).valueOf()},"any, Array":function(t,e){return g(a(e),t,m,!0).valueOf()}});return m.toTex={2:"\\left(${args[0]}"+s.operators.subtract+"${args[1]}\\right)"},m}var i=n(42);e.name="subtract",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,o){var s=n(32),a=o("unaryMinus",{number:function(t){return-t},Complex:function(t){return t.neg()},BigNumber:function(t){return t.neg()},Fraction:function(t){return t.neg()},Unit:function(t){var e=t.clone();return e.value=a(t.value),e},"Array | Matrix":function(t){return i(t,a,!0)}});return a.toTex={1:s.operators.unaryMinus+"\\left(${args[0]}\\right)"},a}var i=n(19);e.name="unaryMinus",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,o){var s=r(n(48)),a=t.SparseMatrix,l=function(t,e,n){var r=t._values,l=t._index,h=t._ptr,c=t._size,u=t._datatype,d=e._values,p=e._index,f=e._ptr,g=e._size,m=e._datatype;if(c.length!==g.length)throw new i(c.length,g.length);if(c[0]!==g[0]||c[1]!==g[1])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+g+")");var x,y=c[0],v=c[1],C=s,w=0,b=n;"string"==typeof u&&u===m&&(x=u,C=o.find(s,[x,x]),w=o.convert(0,x),b=o.find(n,[x,x]));var M,S,E,I,N=r&&d?[]:void 0,O=[],T=[],_=new a({values:N,index:O,ptr:T,size:[y,v],datatype:x}),P=N?[]:void 0,A=N?[]:void 0,k=[],R=[];for(S=0;v>S;S++){T[S]=O.length;var z=S+1;for(E=h[S],I=h[S+1];I>E;E++)M=l[E],O.push(M),k[M]=z,P&&(P[M]=r[E]);for(E=f[S],I=f[S+1];I>E;E++)M=p[E],k[M]!==z&&O.push(M),R[M]=z,A&&(A[M]=d[E]);if(N)for(E=T[S];E<O.length;){M=O[E];var B=k[M],L=R[M];if(B===z||L===z){var D=B===z?P[M]:w,W=L===z?A[M]:w,F=b(D,W);C(F,w)?O.splice(E,1):(N.push(F),E++)}}}return T[v]=O.length,_};return l}var i=n(42);e.name="algorithm05",e.factory=r},function(t,e){"use strict";function n(t,e,n,r){var i=r("multiplyScalar",{"number, number":function(t,e){return t*e},"Complex, Complex":function(t,e){return t.mul(e)},"BigNumber, BigNumber":function(t,e){return t.times(e)},"Fraction, Fraction":function(t,e){return t.mul(e)},"number | Fraction | BigNumber | Complex, Unit":function(t,e){var n=e.clone();return n.value=null===n.value?n._normalize(t):i(n.value,t),n},"Unit, number | Fraction | BigNumber | Complex":function(t,e){var n=t.clone();return n.value=null===n.value?n._normalize(e):i(n.value,e),n},"Unit, Unit":function(t,e){return t.multiply(e)}});return i}e.factory=n},function(t,e,n){"use strict";function r(t,e,r,i){var o=r(n(80)),s=i("divide",{"number, number":function(t,e){return t/e},"Complex, Complex":function(t,e){return t.div(e)},"BigNumber, BigNumber":function(t,e){return t.div(e)},"Fraction, Fraction":function(t,e){return t.div(e)},"Unit, number | Fraction | BigNumber":function(t,e){var n=t.clone();return n.value=s(null===n.value?n._normalize(1):n.value,e),n},"number | Fraction | BigNumber, Unit":function(t,e){var n=e.pow(-1);return n.value=o(null===n.value?n._normalize(1):n.value,t),n},"Unit, Unit":function(t,e){return t.divide(e)}});return s}e.factory=r},function(t,e,n){"use strict";function r(t,e,r,s){function a(n,r){if(e.predictable&&!i(r)&&0>n)try{var o=f(r),s=g(o);if((r===s||Math.abs((r-s)/r)<1e-14)&&o.d%2===1)return(o.n%2===0?1:-1)*Math.pow(-n,r)}catch(a){}return i(r)||n>=0||e.predictable?Math.pow(n,r):new t.Complex(n,0).pow(r,0)}function l(t,e){if(!i(e)||0>e)throw new TypeError("For A^b, b must be a positive integer (value is "+e+")");var n=o(t);if(2!=n.length)throw new Error("For A^b, A must be 2 dimensional (A has "+n.length+" dimensions)");if(n[0]!=n[1])throw new Error("For A^b, A must be square (size is "+n[0]+"x"+n[1]+")");for(var r=u(n[0]).valueOf(),s=t;e>=1;)1==(1&e)&&(r=d(s,r)),e>>=1,s=d(s,s);return r}function h(t,e){return p(l(t.valueOf(),e))}var c=n(32),u=r(n(83)),d=r(n(84)),p=r(n(52)),f=r(n(36)),g=r(n(70)),m=s("pow",{"number, number":a,"Complex, Complex":function(t,e){return t.pow(e)},"BigNumber, BigNumber":function(n,r){return r.isInteger()||n>=0||e.predictable?n.pow(r):new t.Complex(n.toNumber(),0).pow(r.toNumber(),0)},"Fraction, Fraction":function(t,n){if(1!==n.d){if(e.predictable)throw new Error("Function pow does not support non-integer exponents for fractions.");return a(t.valueOf(),n.valueOf())}return t.pow(n)},"Array, number":l,"Array, BigNumber":function(t,e){return l(t,e.toNumber())},"Matrix, number":h,"Matrix, BigNumber":function(t,e){return h(t,e.toNumber())},"Unit, number":function(t,e){return t.pow(e)}});return m.toTex={2:"\\left(${args[0]}\\right)"+c.operators.pow+"{${args[1]}}"},m}var i=n(6).isInteger,o=n(40).size;e.name="pow",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,s){function a(t,e){switch(t.length){case 0:return e?h(e):[];case 1:return l(t[0],t[0],e);case 2:return l(t[0],t[1],e);default:throw new Error("Vector containing two values expected")}}function l(e,n,r){var s=e&&e.isBigNumber===!0?t.BigNumber:n&&n.isBigNumber===!0?t.BigNumber:null;if(e&&e.isBigNumber===!0&&(e=e.toNumber()),n&&n.isBigNumber===!0&&(n=n.toNumber()),!o(e)||1>e)throw new Error("Parameters in function eye must be positive integers");if(!o(n)||1>n)throw new Error("Parameters in function eye must be positive integers");var a=s?new t.BigNumber(1):1,l=s?new s(0):0,h=[e,n];if(r){var c=t.Matrix.storage(r);return c.diagonal(h,a,0,l)}for(var u=i.resize([],h,l),d=n>e?e:n,p=0;d>p;p++)u[p][p]=a;return u}var h=r(n(52)),c=s("eye",{"":function(){return"Matrix"===e.matrix?h([]):[]},string:function(t){return h(t)},"number | BigNumber":function(t){return l(t,t,"Matrix"===e.matrix?"default":void 0)},"number | BigNumber, string":function(t,e){return l(t,t,e)},"number | BigNumber, number | BigNumber":function(t,n){return l(t,n,"Matrix"===e.matrix?"default":void 0)},"number | BigNumber, number | BigNumber, string":function(t,e,n){return l(t,e,n)},Array:function(t){return a(t)},"Array, string":function(t,e){return a(t,e)},Matrix:function(t){return a(t.valueOf(),t.storage())},"Matrix, string":function(t,e){return a(t.valueOf(),e)}});return c.toTex=void 0,c}var i=n(40),o=n(6).isInteger;e.name="eye",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,s){var a=n(32),l=r(n(52)),h=r(n(53)),c=r(n(80)),u=r(n(48)),d=r(n(85)),p=r(n(58)),f=t.DenseMatrix,g=t.SparseMatrix,m=s("multiply",i({"Array, Array":function(t,e){x(o.size(t),o.size(e));var n=m(l(t),l(e));return n&&n.isMatrix===!0?n.valueOf():n},"Matrix, Matrix":function(t,e){var n=t.size(),r=e.size();return x(n,r),1===n.length?1===r.length?y(t,e,n[0]):v(t,e):1===r.length?w(t,e):b(t,e)},"Matrix, Array":function(t,e){return m(t,l(e))},"Array, Matrix":function(t,e){return m(l(t,e.storage()),e)},"Matrix, any":function(t,e){var n;switch(t.storage()){case"sparse":n=d(t,e,c,!1);break;case"dense":n=p(t,e,c,!1)}return n},"any, Matrix":function(t,e){var n;switch(e.storage()){case"sparse":n=d(e,t,c,!0);break;case"dense":n=p(e,t,c,!0)}return n},"Array, any":function(t,e){return p(l(t),e,c,!1).valueOf()},"any, Array":function(t,e){return p(l(e),t,c,!0).valueOf()}},c.signatures)),x=function(t,e){switch(t.length){case 1:switch(e.length){case 1:if(t[0]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(t[0]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+t[0]+") must match Matrix rows ("+e[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+e.length+" dimensions)")}break;case 2:switch(e.length){case 1:if(t[1]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+t[1]+") must match Vector length ("+e[0]+")");break;case 2:if(t[1]!==e[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+t[1]+") must match Matrix B rows ("+e[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+e.length+" dimensions)")}break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+t.length+" dimensions)")}},y=function(t,e,n){if(0===n)throw new Error("Cannot multiply two empty vectors");var r,i=t._data,o=t._datatype,a=e._data,l=e._datatype,u=h,d=c;o&&l&&o===l&&"string"==typeof o&&(r=o,u=s.find(h,[r,r]),d=s.find(c,[r,r]));for(var p=d(i[0],a[0]),f=1;n>f;f++)p=u(p,d(i[f],a[f]));return p},v=function(t,e){switch(e.storage()){case"dense":return C(t,e)}throw new Error("Not implemented")},C=function(t,e){var n,r=t._data,i=t._size,o=t._datatype,a=e._data,l=e._size,u=e._datatype,d=i[0],p=l[1],g=h,m=c;o&&u&&o===u&&"string"==typeof o&&(n=o,g=s.find(h,[n,n]),m=s.find(c,[n,n]));for(var x=[],y=0;p>y;y++){for(var v=m(r[0],a[0][y]),C=1;d>C;C++)v=g(v,m(r[C],a[C][y]));x[y]=v}return new f({data:x,size:[p],datatype:n})},w=function(t,e){switch(t.storage()){case"dense":return M(t,e);case"sparse":return I(t,e)}},b=function(t,e){switch(t.storage()){case"dense":switch(e.storage()){case"dense":return S(t,e);case"sparse":return E(t,e)}break;case"sparse":switch(e.storage()){case"dense":return N(t,e);case"sparse":return O(t,e)}}},M=function(t,e){var n,r=t._data,i=t._size,o=t._datatype,a=e._data,l=e._datatype,u=i[0],d=i[1],p=h,g=c;o&&l&&o===l&&"string"==typeof o&&(n=o,p=s.find(h,[n,n]),g=s.find(c,[n,n]));for(var m=[],x=0;u>x;x++){for(var y=r[x],v=g(y[0],a[0]),C=1;d>C;C++)v=p(v,g(y[C],a[C]));m[x]=v}return new f({data:m,size:[u],datatype:n})},S=function(t,e){var n,r=t._data,i=t._size,o=t._datatype,a=e._data,l=e._size,u=e._datatype,d=i[0],p=i[1],g=l[1],m=h,x=c;o&&u&&o===u&&"string"==typeof o&&(n=o,m=s.find(h,[n,n]),x=s.find(c,[n,n]));for(var y=[],v=0;d>v;v++){var C=r[v];y[v]=[];for(var w=0;g>w;w++){for(var b=x(C[0],a[0][w]),M=1;p>M;M++)b=m(b,x(C[M],a[M][w]));y[v][w]=b}}return new f({data:y,size:[d,g],datatype:n})},E=function(t,e){var n=t._data,r=t._size,i=t._datatype,o=e._values,a=e._index,l=e._ptr,d=e._size,p=e._datatype;if(!o)throw new Error("Cannot multiply Dense Matrix times Pattern only Matrix");var f,m=r[0],x=d[1],y=h,v=c,C=u,w=0;i&&p&&i===p&&"string"==typeof i&&(f=i,y=s.find(h,[f,f]),v=s.find(c,[f,f]),C=s.find(u,[f,f]),w=s.convert(0,f));for(var b=[],M=[],S=[],E=new g({values:b,index:M,ptr:S,size:[m,x],datatype:f}),I=0;x>I;I++){S[I]=M.length;var N=l[I],O=l[I+1];if(O>N)for(var T=0,_=0;m>_;_++){for(var P,A=_+1,k=N;O>k;k++){var R=a[k];T!==A?(P=v(n[_][R],o[k]),T=A):P=y(P,v(n[_][R],o[k]))}T!==A||C(P,w)||(M.push(_),b.push(P))}}return S[x]=M.length,E},I=function(t,e){var n=t._values,r=t._index,i=t._ptr,o=t._datatype;if(!n)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var a,l=e._data,d=e._datatype,p=t._size[0],f=e._size[0],m=[],x=[],y=[],v=h,C=c,w=u,b=0;o&&d&&o===d&&"string"==typeof o&&(a=o,v=s.find(h,[a,a]),C=s.find(c,[a,a]),w=s.find(u,[a,a]),b=s.convert(0,a));var M=[],S=[];y[0]=0;for(var E=0;f>E;E++){var I=l[E];if(!w(I,b))for(var N=i[E],O=i[E+1],T=N;O>T;T++){var _=r[T];S[_]?M[_]=v(M[_],C(I,n[T])):(S[_]=!0,x.push(_),M[_]=C(I,n[T]))}}for(var P=x.length,A=0;P>A;A++){var k=x[A];m[A]=M[k]}return y[1]=x.length,new g({values:m,index:x,ptr:y,size:[p,1],datatype:a})},N=function(t,e){var n=t._values,r=t._index,i=t._ptr,o=t._datatype;if(!n)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var a,l=e._data,d=e._datatype,p=t._size[0],f=e._size[0],m=e._size[1],x=h,y=c,v=u,C=0;o&&d&&o===d&&"string"==typeof o&&(a=o,x=s.find(h,[a,a]),y=s.find(c,[a,a]),v=s.find(u,[a,a]),C=s.convert(0,a));for(var w=[],b=[],M=[],S=new g({values:w,index:b,ptr:M,size:[p,m],datatype:a}),E=[],I=[],N=0;m>N;N++){M[N]=b.length;for(var O=N+1,T=0;f>T;T++){var _=l[T][N];if(!v(_,C))for(var P=i[T],A=i[T+1],k=P;A>k;k++){var R=r[k];I[R]!==O?(I[R]=O,b.push(R),E[R]=y(_,n[k])):E[R]=x(E[R],y(_,n[k]))}}for(var z=M[N],B=b.length,L=z;B>L;L++){var D=b[L];w[L]=E[D]}}return M[m]=b.length,S},O=function(t,e){var n,r=t._values,i=t._index,o=t._ptr,a=t._datatype,l=e._values,u=e._index,d=e._ptr,p=e._datatype,f=t._size[0],m=e._size[1],x=r&&l,y=h,v=c;a&&p&&a===p&&"string"==typeof a&&(n=a,y=s.find(h,[n,n]),v=s.find(c,[n,n]));for(var C,w,b,M,S,E,I,N,O=x?[]:void 0,T=[],_=[],P=new g({values:O,index:T,ptr:_,size:[f,m],datatype:n}),A=x?[]:void 0,k=[],R=0;m>R;R++){_[R]=T.length;var z=R+1;for(S=d[R],E=d[R+1],M=S;E>M;M++)if(N=u[M],x)for(w=o[N],b=o[N+1],C=w;b>C;C++)I=i[C],k[I]!==z?(k[I]=z,T.push(I),A[I]=v(l[M],r[C])):A[I]=y(A[I],v(l[M],r[C]));else for(w=o[N],b=o[N+1],C=w;b>C;C++)I=i[C],k[I]!==z&&(k[I]=z,T.push(I));if(x)for(var B=_[R],L=T.length,D=B;L>D;D++){var W=T[D];O[D]=A[W]}}return _[m]=T.length,P};return m.toTex={2:"\\left(${args[0]}"+a.operators.multiply+"${args[1]}\\right)"},m}var i=n(3).extend,o=n(40);e.name="multiply",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,i){var o=r(n(48)),s=t.SparseMatrix,a=function(t,e,n,r){var a=t._values,l=t._index,h=t._ptr,c=t._size,u=t._datatype;if(!a)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var d,p=c[0],f=c[1],g=o,m=0,x=n;"string"==typeof u&&(d=u,g=i.find(o,[d,d]),m=i.convert(0,d),e=i.convert(e,d),x=i.find(n,[d,d]));for(var y=[],v=[],C=[],w=new s({values:y,index:v,ptr:C,size:[p,f],datatype:d}),b=0;f>b;b++){C[b]=v.length;for(var M=h[b],S=h[b+1],E=M;S>E;E++){var I=l[E],N=r?x(e,a[E]):x(a[E],e);g(N,m)||(v.push(I),y.push(N))}}return C[f]=v.length,w};return a}e.name="algorithm11",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("abs",{number:Math.abs,Complex:function(t){return t.abs()},BigNumber:function(t){return t.abs()},Fraction:function(t){return t.abs()},"Array | Matrix":function(t){return i(t,o,!0)},Unit:function(t){return t.abs()}});return o.toTex={1:"\\left|${args[0]}\\right|"},o}var i=n(19);e.name="abs",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("fix",{number:function(t){return t>0?Math.floor(t):Math.ceil(t)},Complex:function(e){return new t.Complex(e.re>0?Math.floor(e.re):Math.ceil(e.re),e.im>0?Math.floor(e.im):Math.ceil(e.im))},BigNumber:function(t){return t.isNegative()?t.ceil():t.floor()},Fraction:function(t){return t.s<0?t.ceil():t.floor()},"Array | Matrix":function(t){return i(t,o,!0)}});return o.toTex={1:"\\mathrm{${name}}\\left(${args[0]}\\right)"},o}var i=n(19);e.name="fix",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,i){var o=r(n(52)),s=r(n(48)),a=r(n(61)),l=r(n(62)),h=r(n(63)),c=r(n(57)),u=r(n(58)),d=n(32),p=i("equal",{"any, any":function(t,e){return null===t?null===e:null===e?null===t:void 0===t?void 0===e:void 0===e?void 0===t:s(t,e)},"Matrix, Matrix":function(t,e){var n;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":n=l(t,e,s);break;default:n=a(e,t,s,!0)}break;default:switch(e.storage()){case"sparse":n=a(t,e,s,!1);break;default:n=c(t,e,s)}}return n},"Array, Array":function(t,e){return p(o(t),o(e)).valueOf()},"Array, Matrix":function(t,e){return p(o(t),e)},"Matrix, Array":function(t,e){return p(t,o(e))},"Matrix, any":function(t,e){var n;switch(t.storage()){case"sparse":n=h(t,e,s,!1);break;default:n=u(t,e,s,!1)}return n},"any, Matrix":function(t,e){var n;switch(e.storage()){case"sparse":n=h(e,t,s,!0);break;default:n=u(e,t,s,!0)}return n},"Array, any":function(t,e){return u(o(t),e,s,!1).valueOf()},"any, Array":function(t,e){return u(o(e),t,s,!0).valueOf()}});return p.toTex={2:"\\left(${args[0]}"+d.operators.equal+"${args[1]}\\right)"},p}e.name="equal",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("isNumeric",{"number | BigNumber | Fraction | boolean":function(){return!0},"Complex | Unit | string":function(){return!1},"Array | Matrix":function(t){return i(t,o)}});return o}var i=n(19);n(6),e.name="isNumeric",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("format",{any:i.format,"any, Object | function | number":i.format});return o.toTex=void 0,o}var i=n(23);e.name="format",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("_typeof",{any:function(t){var e=i.type(t);if("Object"===e){if(t.isBigNumber===!0)return"BigNumber";if(t.isComplex===!0)return"Complex";if(t.isFraction===!0)return"Fraction";if(t.isMatrix===!0)return"Matrix";if(t.isUnit===!0)return"Unit";if(t.isIndex===!0)return"Index";if(t.isRange===!0)return"Range";if(t.isChain===!0)return"Chain";if(t.isHelp===!0)return"Help"}return e}});return o.toTex=void 0,o}var i=n(41);e.name="typeof",e.factory=r},function(t,e,n){(function(t,r){function i(t,n){var r={seen:[],stylize:s};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),g(n)?r.showHidden=n:n&&e._extend(r,n),w(r.showHidden)&&(r.showHidden=!1),w(r.depth)&&(r.depth=2),w(r.colors)&&(r.colors=!1),w(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=o),l(r,t,r.depth)}function o(t,e){var n=i.styles[e];return n?"["+i.colors[n][0]+"m"+t+"["+i.colors[n][1]+"m":t}function s(t,e){return t}function a(t){var e={};return t.forEach(function(t,n){e[t]=!0}),e}function l(t,n,r){if(t.customInspect&&n&&I(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,t);return v(i)||(i=l(t,i,r)),i}var o=h(t,n);if(o)return o;var s=Object.keys(n),g=a(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(n)),E(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return c(n);if(0===s.length){if(I(n)){var m=n.name?": "+n.name:"";return t.stylize("[Function"+m+"]","special")}if(b(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(S(n))return t.stylize(Date.prototype.toString.call(n),"date");if(E(n))return c(n)}var x="",y=!1,C=["{","}"];if(f(n)&&(y=!0,C=["[","]"]),I(n)){var w=n.name?": "+n.name:"";x=" [Function"+w+"]"}if(b(n)&&(x=" "+RegExp.prototype.toString.call(n)),S(n)&&(x=" "+Date.prototype.toUTCString.call(n)),E(n)&&(x=" "+c(n)),0===s.length&&(!y||0==n.length))return C[0]+x+C[1];if(0>r)return b(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special");t.seen.push(n);var M;return M=y?u(t,n,r,g,s):s.map(function(e){return d(t,n,r,g,e,y)}),t.seen.pop(),p(M,x,C)}function h(t,e){if(w(e))return t.stylize("undefined","undefined");if(v(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return y(e)?t.stylize(""+e,"number"):g(e)?t.stylize(""+e,"boolean"):m(e)?t.stylize("null","null"):void 0}function c(t){return"["+Error.prototype.toString.call(t)+"]"}function u(t,e,n,r,i){for(var o=[],s=0,a=e.length;a>s;++s)P(e,String(s))?o.push(d(t,e,n,r,String(s),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(d(t,e,n,r,i,!0))}),o}function d(t,e,n,r,i,o){var s,a,h;if(h=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]},h.get?a=h.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):h.set&&(a=t.stylize("[Setter]","special")),P(r,i)||(s="["+i+"]"),a||(t.seen.indexOf(h.value)<0?(a=m(n)?l(t,h.value,null):l(t,h.value,n-1),a.indexOf("\n")>-1&&(a=o?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n"))):a=t.stylize("[Circular]","special")),w(s)){if(o&&i.match(/^\d+$/))return a;s=JSON.stringify(""+i),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+a}function p(t,e,n){var r=0,i=t.reduce(function(t,e){return r++,e.indexOf("\n")>=0&&r++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function f(t){return Array.isArray(t)}function g(t){return"boolean"==typeof t}function m(t){return null===t}function x(t){return null==t}function y(t){return"number"==typeof t}function v(t){return"string"==typeof t}function C(t){return"symbol"==typeof t}function w(t){return void 0===t}function b(t){return M(t)&&"[object RegExp]"===O(t)}function M(t){return"object"==typeof t&&null!==t}function S(t){return M(t)&&"[object Date]"===O(t)}function E(t){return M(t)&&("[object Error]"===O(t)||t instanceof Error)}function I(t){return"function"==typeof t}function N(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function O(t){return Object.prototype.toString.call(t)}function T(t){return 10>t?"0"+t.toString(10):t.toString(10)}function _(){var t=new Date,e=[T(t.getHours()),T(t.getMinutes()),T(t.getSeconds())].join(":");return[t.getDate(),z[t.getMonth()],e].join(" ")}function P(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var A=/%[sdj%]/g;e.format=function(t){if(!v(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(i(arguments[n]));return e.join(" ")}for(var n=1,r=arguments,o=r.length,s=String(t).replace(A,function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return t}}),a=r[n];o>n;a=r[++n])s+=m(a)||!M(a)?" "+a:" "+i(a);return s},e.deprecate=function(n,i){function o(){if(!s){if(r.throwDeprecation)throw new Error(i);r.traceDeprecation?console.trace(i):console.error(i),s=!0}return n.apply(this,arguments)}if(w(t.process))return function(){return e.deprecate(n,i).apply(this,arguments)};if(r.noDeprecation===!0)return n;var s=!1;return o};var k,R={};e.debuglog=function(t){if(w(k)&&(k=r.env.NODE_DEBUG||""),t=t.toUpperCase(),!R[t])if(new RegExp("\\b"+t+"\\b","i").test(k)){var n=r.pid;R[t]=function(){var r=e.format.apply(e,arguments);console.error("%s %d: %s",t,n,r)}}else R[t]=function(){};return R[t]},e.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=f,e.isBoolean=g,e.isNull=m,e.isNullOrUndefined=x,e.isNumber=y,e.isString=v,e.isSymbol=C,e.isUndefined=w,e.isRegExp=b,e.isObject=M,e.isDate=S,e.isError=E,e.isFunction=I,e.isPrimitive=N,e.isBuffer=n(94);var z=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];e.log=function(){console.log("%s - %s",_(),e.format.apply(e,arguments))},e.inherits=n(95),e._extend=function(t,e){if(!e||!M(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}).call(e,function(){return this}(),n(93))},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function i(t){if(c===setTimeout)return setTimeout(t,0);if((c===n||!c)&&setTimeout)return c=setTimeout,setTimeout(t,0);try{return c(t,0)}catch(e){try{return c.call(null,t,0)}catch(e){return c.call(this,t,0)}}}function o(t){if(u===clearTimeout)return clearTimeout(t);if((u===r||!u)&&clearTimeout)return u=clearTimeout,clearTimeout(t);try{return u(t)}catch(e){try{return u.call(null,t)}catch(e){return u.call(this,t)}}}function s(){g&&p&&(g=!1,p.length?f=p.concat(f):m=-1,f.length&&a())}function a(){if(!g){var t=i(s);g=!0;for(var e=f.length;e;){for(p=f,f=[];++m<e;)p&&p[m].run();m=-1,e=f.length}p=null,g=!1,o(t)}}function l(t,e){this.fun=t,this.array=e}function h(){}var c,u,d=t.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:n}catch(t){c=n}try{u="function"==typeof clearTimeout?clearTimeout:r}catch(t){u=r}}();var p,f=[],g=!1,m=-1;d.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];f.push(new l(t,e)),1!==f.length||g||i(a)},l.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=h,d.addListener=h,d.once=h,d.off=h,d.removeListener=h,d.removeAllListeners=h,d.emit=h,d.binding=function(t){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(t){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("unit",{Unit:function(t){return t.clone()},string:function(e){return t.Unit.isValuelessUnit(e)?new t.Unit(null,e):t.Unit.parse(e)},"number | BigNumber | Fraction | Complex, string":function(e,n){return new t.Unit(e,n)},"Array | Matrix":function(t){return i(t,o)}});return o.toTex={1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)${args[1]}\\right)"},o}var i=n(19);e.name="unit",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var i=r("createUnit",{"Object, Object":function(e,n){return t.Unit.createUnit(e,n)},Object:function(e){return t.Unit.createUnit(e,{})},"string, Unit | string | Object, Object":function(e,n,r){var i={};return i[e]=n,t.Unit.createUnit(i,r)},"string, Unit | string | Object":function(e,n){var r={};return r[e]=n,t.Unit.createUnit(r,{})},string:function(e){var n={};return n[e]={},t.Unit.createUnit(n,{})}});return i}n(19),e.name="createUnit",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var i=r("splitUnit",{"Unit, Array":function(t,e){return t.splitUnit(e)}});return i}n(19),e.name="splitUnit",e.factory=r},function(t,e,n){function r(t,e,n,r,o){function s(e){var n=t.Unit.parse(e);return n.fixPrefix=!0,n}i(o,"speedOfLight",function(){return s("299792458 m s^-1")}),i(o,"gravitationConstant",function(){return s("6.6738480e-11 m^3 kg^-1 s^-2")}),i(o,"planckConstant",function(){return s("6.626069311e-34 J s")}),i(o,"reducedPlanckConstant",function(){return s("1.05457172647e-34 J s")}),i(o,"magneticConstant",function(){return s("1.2566370614e-6 N A^-2")}),i(o,"electricConstant",function(){return s("8.854187817e-12 F m^-1")}),i(o,"vacuumImpedance",function(){return s("376.730313461 ohm")}),i(o,"coulomb",function(){return s("8.9875517873681764e9 N m^2 C^-2")}),i(o,"elementaryCharge",function(){return s("1.60217656535e-19 C")}),i(o,"bohrMagneton",function(){return s("9.2740096820e-24 J T^-1")}),i(o,"conductanceQuantum",function(){return s("7.748091734625e-5 S")}),i(o,"inverseConductanceQuantum",function(){return s("12906.403721742 ohm")}),i(o,"magneticFluxQuantum",function(){return s("2.06783375846e-15 Wb")}),i(o,"nuclearMagneton",function(){return s("5.0507835311e-27 J T^-1");
}),i(o,"klitzing",function(){return s("25812.807443484 ohm")}),i(o,"bohrRadius",function(){return s("5.291772109217e-11 m")}),i(o,"classicalElectronRadius",function(){return s("2.817940326727e-15 m")}),i(o,"electronMass",function(){return s("9.1093829140e-31 kg")}),i(o,"fermiCoupling",function(){return s("1.1663645e-5 GeV^-2")}),i(o,"fineStructure",function(){return.007297352569824}),i(o,"hartreeEnergy",function(){return s("4.3597443419e-18 J")}),i(o,"protonMass",function(){return s("1.67262177774e-27 kg")}),i(o,"deuteronMass",function(){return s("3.3435830926e-27 kg")}),i(o,"neutronMass",function(){return s("1.6749271613e-27 kg")}),i(o,"quantumOfCirculation",function(){return s("3.636947552024e-4 m^2 s^-1")}),i(o,"rydberg",function(){return s("10973731.56853955 m^-1")}),i(o,"thomsonCrossSection",function(){return s("6.65245873413e-29 m^2")}),i(o,"weakMixingAngle",function(){return.222321}),i(o,"efimovFactor",function(){return 22.7}),i(o,"atomicMass",function(){return s("1.66053892173e-27 kg")}),i(o,"avogadro",function(){return s("6.0221412927e23 mol^-1")}),i(o,"boltzmann",function(){return s("1.380648813e-23 J K^-1")}),i(o,"faraday",function(){return s("96485.336521 C mol^-1")}),i(o,"firstRadiation",function(){return s("3.7417715317e-16 W m^2")}),i(o,"loschmidt",function(){return s("2.686780524e25 m^-3")}),i(o,"gasConstant",function(){return s("8.314462175 J K^-1 mol^-1")}),i(o,"molarPlanckConstant",function(){return s("3.990312717628e-10 J s mol^-1")}),i(o,"molarVolume",function(){return s("2.241396820e-10 m^3 mol^-1")}),i(o,"sackurTetrode",function(){return-1.164870823}),i(o,"secondRadiation",function(){return s("1.438777013e-2 m K")}),i(o,"stefanBoltzmann",function(){return s("5.67037321e-8 W m^-2 K^-4")}),i(o,"wienDisplacement",function(){return s("2.897772126e-3 m K")}),i(o,"molarMass",function(){return s("1e-3 kg mol^-1")}),i(o,"molarMassC12",function(){return s("1.2e-2 kg mol^-1")}),i(o,"gravity",function(){return s("9.80665 m s^-2")}),i(o,"planckLength",function(){return s("1.61619997e-35 m")}),i(o,"planckMass",function(){return s("2.1765113e-8 kg")}),i(o,"planckTime",function(){return s("5.3910632e-44 s")}),i(o,"planckCharge",function(){return s("1.87554595641e-18 C")}),i(o,"planckTemperature",function(){return s("1.41683385e+32 K")})}var i=n(3).lazy;e.factory=r,e.lazy=!1,e.math=!0},function(t,e,n){"use strict";function r(t,e,s,a,l){l.on("config",function(n,i){n.number!==i.number&&r(t,e,s,a,l)}),l["true"]=!0,l["false"]=!1,l["null"]=null,l.uninitialized=n(40).UNINITIALIZED,"BigNumber"===e.number?(l.Infinity=new t.BigNumber(1/0),l.NaN=new t.BigNumber(NaN),i.lazy(l,"pi",function(){return o.pi(t.BigNumber)}),i.lazy(l,"tau",function(){return o.tau(t.BigNumber)}),i.lazy(l,"e",function(){return o.e(t.BigNumber)}),i.lazy(l,"phi",function(){return o.phi(t.BigNumber)}),i.lazy(l,"E",function(){return l.e}),i.lazy(l,"LN2",function(){return new t.BigNumber(2).ln()}),i.lazy(l,"LN10",function(){return new t.BigNumber(10).ln()}),i.lazy(l,"LOG2E",function(){return new t.BigNumber(1).div(new t.BigNumber(2).ln())}),i.lazy(l,"LOG10E",function(){return new t.BigNumber(1).div(new t.BigNumber(10).ln())}),i.lazy(l,"PI",function(){return l.pi}),i.lazy(l,"SQRT1_2",function(){return new t.BigNumber("0.5").sqrt()}),i.lazy(l,"SQRT2",function(){return new t.BigNumber(2).sqrt()})):(l.Infinity=1/0,l.NaN=NaN,l.pi=Math.PI,l.tau=2*Math.PI,l.e=Math.E,l.phi=1.618033988749895,l.E=l.e,l.LN2=Math.LN2,l.LN10=Math.LN10,l.LOG2E=Math.LOG2E,l.LOG10E=Math.LOG10E,l.PI=l.pi,l.SQRT1_2=Math.SQRT1_2,l.SQRT2=Math.SQRT2),l.i=t.Complex.I,l.version=n(101)}var i=n(3),o=n(76);e.factory=r,e.lazy=!1,e.math=!0},function(t,e){t.exports="3.5.3"},function(t,e,n){t.exports=[n(103),n(277),n(306),n(308),n(334),n(279),n(305)]},function(t,e,n){function r(t,e,r,i){var o={};return o.bignumber=n(104),o["boolean"]=n(105),o.complex=n(106),o.fraction=n(107),o.index=n(108),o.matrix=n(109),o.number=n(110),o.sparse=n(111),o.string=n(112),o.unit=n(113),o.e=n(114),o.E=n(114),o["false"]=n(115),o.i=n(116),o.Infinity=n(117),o.LN2=n(118),o.LN10=n(119),o.LOG2E=n(120),o.LOG10E=n(121),o.NaN=n(122),o["null"]=n(123),o.pi=n(124),o.PI=n(124),o.phi=n(125),o.SQRT1_2=n(126),o.SQRT2=n(127),o.tau=n(128),o["true"]=n(129),o.version=n(130),o.speedOfLight={description:"Speed of light in vacuum",examples:["speedOfLight"]},o.gravitationConstant={description:"Newtonian constant of gravitation",examples:["gravitationConstant"]},o.planckConstant={description:"Planck constant",examples:["planckConstant"]},o.reducedPlanckConstant={description:"Reduced Planck constant",examples:["reducedPlanckConstant"]},o.magneticConstant={description:"Magnetic constant (vacuum permeability)",examples:["magneticConstant"]},o.electricConstant={description:"Electric constant (vacuum permeability)",examples:["electricConstant"]},o.vacuumImpedance={description:"Characteristic impedance of vacuum",examples:["vacuumImpedance"]},o.coulomb={description:"Coulomb's constant",examples:["coulomb"]},o.elementaryCharge={description:"Elementary charge",examples:["elementaryCharge"]},o.bohrMagneton={description:"Borh magneton",examples:["bohrMagneton"]},o.conductanceQuantum={description:"Conductance quantum",examples:["conductanceQuantum"]},o.inverseConductanceQuantum={description:"Inverse conductance quantum",examples:["inverseConductanceQuantum"]},o.magneticFluxQuantum={description:"Magnetic flux quantum",examples:["magneticFluxQuantum"]},o.nuclearMagneton={description:"Nuclear magneton",examples:["nuclearMagneton"]},o.klitzing={description:"Von Klitzing constant",examples:["klitzing"]},o.bohrRadius={description:"Borh radius",examples:["bohrRadius"]},o.classicalElectronRadius={description:"Classical electron radius",examples:["classicalElectronRadius"]},o.electronMass={description:"Electron mass",examples:["electronMass"]},o.fermiCoupling={description:"Fermi coupling constant",examples:["fermiCoupling"]},o.fineStructure={description:"Fine-structure constant",examples:["fineStructure"]},o.hartreeEnergy={description:"Hartree energy",examples:["hartreeEnergy"]},o.protonMass={description:"Proton mass",examples:["protonMass"]},o.deuteronMass={description:"Deuteron Mass",examples:["deuteronMass"]},o.neutronMass={description:"Neutron mass",examples:["neutronMass"]},o.quantumOfCirculation={description:"Quantum of circulation",examples:["quantumOfCirculation"]},o.rydberg={description:"Rydberg constant",examples:["rydberg"]},o.thomsonCrossSection={description:"Thomson cross section",examples:["thomsonCrossSection"]},o.weakMixingAngle={description:"Weak mixing angle",examples:["weakMixingAngle"]},o.efimovFactor={description:"Efimov factor",examples:["efimovFactor"]},o.atomicMass={description:"Atomic mass constant",examples:["atomicMass"]},o.avogadro={description:"Avogadro's number",examples:["avogadro"]},o.boltzmann={description:"Boltzmann constant",examples:["boltzmann"]},o.faraday={description:"Faraday constant",examples:["faraday"]},o.firstRadiation={description:"First radiation constant",examples:["firstRadiation"]},o.loschmidt={description:"Loschmidt constant at T=273.15 K and p=101.325 kPa",examples:["loschmidt"]},o.gasConstant={description:"Gas constant",examples:["gasConstant"]},o.molarPlanckConstant={description:"Molar Planck constant",examples:["molarPlanckConstant"]},o.molarVolume={description:"Molar volume of an ideal gas at T=273.15 K and p=101.325 kPa",examples:["molarVolume"]},o.sackurTetrode={description:"Sackur-Tetrode constant at T=1 K and p=101.325 kPa",examples:["sackurTetrode"]},o.secondRadiation={description:"Second radiation constant",examples:["secondRadiation"]},o.stefanBoltzmann={description:"Stefan-Boltzmann constant",examples:["stefanBoltzmann"]},o.wienDisplacement={description:"Wien displacement law constant",examples:["wienDisplacement"]},o.molarMass={description:"Molar mass constant",examples:["molarMass"]},o.molarMassC12={description:"Molar mass constant of carbon-12",examples:["molarMassC12"]},o.gravity={description:"Standard acceleration of gravity (standard acceleration of free-fall on Earth)",examples:["gravity"]},o.planckLength={description:"Planck length",examples:["planckLength"]},o.planckMass={description:"Planck mass",examples:["planckMass"]},o.planckTime={description:"Planck time",examples:["planckTime"]},o.planckCharge={description:"Planck charge",examples:["planckCharge"]},o.planckTemperature={description:"Planck temperature",examples:["planckTemperature"]},o.lsolve=n(131),o.lup=n(132),o.lusolve=n(133),o.slu=n(134),o.usolve=n(135),o.abs=n(136),o.add=n(137),o.cbrt=n(138),o.ceil=n(139),o.cube=n(140),o.divide=n(141),o.dotDivide=n(142),o.dotMultiply=n(143),o.dotPow=n(144),o.exp=n(145),o.fix=n(146),o.floor=n(147),o.gcd=n(148),o.hypot=n(149),o.lcm=n(150),o.log=n(151),o.log10=n(152),o.mod=n(153),o.multiply=n(154),o.norm=n(155),o.nthRoot=n(156),o.pow=n(157),o.round=n(158),o.sign=n(159),o.sqrt=n(160),o.square=n(161),o.subtract=n(162),o.unaryMinus=n(163),o.unaryPlus=n(164),o.xgcd=n(165),o.bitAnd=n(166),o.bitNot=n(167),o.bitOr=n(168),o.bitXor=n(169),o.leftShift=n(170),o.rightArithShift=n(171),o.rightLogShift=n(172),o.bellNumbers=n(173),o.catalan=n(174),o.composition=n(175),o.stirlingS2=n(176),o.config=n(177),o["import"]=n(178),o.typed=n(179),o.arg=n(180),o.conj=n(181),o.re=n(182),o.im=n(183),o.eval=n(184),o.help=n(185),o.distance=n(186),o.intersect=n(187),o.and=n(188),o.not=n(189),o.or=n(190),o.xor=n(191),o.concat=n(192),o.cross=n(193),o.det=n(194),o.diag=n(195),o.dot=n(196),o.eye=n(197),o.filter=n(198),o.flatten=n(199),o.forEach=n(200),o.inv=n(201),o.map=n(202),o.ones=n(203),o.partitionSelect=n(204),o.range=n(205),o.resize=n(206),o.size=n(207),o.sort=n(208),o.squeeze=n(209),o.subset=n(210),o.trace=n(211),o.transpose=n(212),o.zeros=n(213),o.combinations=n(214),o.factorial=n(215),o.gamma=n(216),o.kldivergence=n(217),o.multinomial=n(218),o.permutations=n(219),o.pickRandom=n(220),o.random=n(221),o.randomInt=n(222),o.compare=n(223),o.deepEqual=n(224),o.equal=n(225),o.larger=n(226),o.largerEq=n(227),o.smaller=n(228),o.smallerEq=n(229),o.unequal=n(230),o.max=n(231),o.mean=n(232),o.median=n(233),o.min=n(234),o.mode=n(235),o.prod=n(236),o.quantileSeq=n(237),o.std=n(238),o.sum=n(239),o["var"]=n(240),o.acos=n(241),o.acosh=n(242),o.acot=n(243),o.acoth=n(244),o.acsc=n(245),o.acsch=n(246),o.asec=n(247),o.asech=n(248),o.asin=n(249),o.asinh=n(250),o.atan=n(251),o.atanh=n(252),o.atan2=n(253),o.cos=n(254),o.cosh=n(255),o.cot=n(256),o.coth=n(257),o.csc=n(258),o.csch=n(259),o.sec=n(260),o.sech=n(261),o.sin=n(262),o.sinh=n(263),o.tan=n(264),o.tanh=n(265),o.to=n(266),o.clone=n(267),o.format=n(268),o.isNaN=n(269),o.isInteger=n(270),o.isNegative=n(271),o.isNumeric=n(272),o.isPositive=n(273),o.isPrime=n(274),o.isZero=n(275),o["typeof"]=n(276),o}e.name="docs",e.path="expression",e.factory=r},function(t,e){t.exports={name:"bignumber",category:"Construction",syntax:["bignumber(x)"],description:"Create a big number from a number or string.",examples:["0.1 + 0.2","bignumber(0.1) + bignumber(0.2)",'bignumber("7.2")','bignumber("7.2e500")',"bignumber([0.1, 0.2, 0.3])"],seealso:["boolean","complex","fraction","index","matrix","string","unit"]}},function(t,e){t.exports={name:"boolean",category:"Construction",syntax:["x","boolean(x)"],description:"Convert a string or number into a boolean.",examples:["boolean(0)","boolean(1)","boolean(3)",'boolean("true")','boolean("false")',"boolean([1, 0, 1, 1])"],seealso:["bignumber","complex","index","matrix","number","string","unit"]}},function(t,e){t.exports={name:"complex",category:"Construction",syntax:["complex()","complex(re, im)","complex(string)"],description:"Create a complex number.",examples:["complex()","complex(2, 3)",'complex("7 - 2i")'],seealso:["bignumber","boolean","index","matrix","number","string","unit"]}},function(t,e){t.exports={name:"fraction",category:"Construction",syntax:["fraction(num)","fraction(num,den)"],description:"Create a fraction from a number or from a numerator and denominator.",examples:["fraction(0.125)","fraction(1, 3) + fraction(2, 5)"],seealso:["bignumber","boolean","complex","index","matrix","string","unit"]}},function(t,e){t.exports={name:"index",category:"Construction",syntax:["[start]","[start:end]","[start:step:end]","[start1, start 2, ...]","[start1:end1, start2:end2, ...]","[start1:step1:end1, start2:step2:end2, ...]"],description:"Create an index to get or replace a subset of a matrix",examples:["[]","[1, 2, 3]","A = [1, 2, 3; 4, 5, 6]","A[1, :]","A[1, 2] = 50","A[0:2, 0:2] = ones(2, 2)"],seealso:["bignumber","boolean","complex","matrix,","number","range","string","unit"]}},function(t,e){t.exports={name:"matrix",category:"Construction",syntax:["[]","[a1, b1, ...; a2, b2, ...]","matrix()",'matrix("dense")',"matrix([...])"],description:"Create a matrix.",examples:["[]","[1, 2, 3]","[1, 2, 3; 4, 5, 6]","matrix()","matrix([3, 4])",'matrix([3, 4; 5, 6], "sparse")','matrix([3, 4; 5, 6], "sparse", "number")'],seealso:["bignumber","boolean","complex","index","number","string","unit","sparse"]}},function(t,e){t.exports={name:"number",category:"Construction",syntax:["x","number(x)"],description:"Create a number or convert a string or boolean into a number.",examples:["2","2e3","4.05","number(2)",'number("7.2")',"number(true)","number([true, false, true, true])",'number("52cm", "m")'],seealso:["bignumber","boolean","complex","fraction","index","matrix","string","unit"]}},function(t,e){t.exports={name:"sparse",category:"Construction",syntax:["sparse()","sparse([a1, b1, ...; a1, b2, ...])",'sparse([a1, b1, ...; a1, b2, ...], "number")'],description:"Create a sparse matrix.",examples:["sparse()","sparse([3, 4; 5, 6])",'sparse([3, 0; 5, 0], "number")'],seealso:["bignumber","boolean","complex","index","number","string","unit","matrix"]}},function(t,e){t.exports={name:"string",category:"Construction",syntax:['"text"',"string(x)"],description:"Create a string or convert a value to a string",examples:['"Hello World!"',"string(4.2)","string(3 + 2i)"],seealso:["bignumber","boolean","complex","index","matrix","number","unit"]}},function(t,e){t.exports={name:"unit",category:"Construction",syntax:["value unit","unit(value, unit)","unit(string)"],description:"Create a unit.",examples:["5.5 mm","3 inch",'unit(7.1, "kilogram")','unit("23 deg")'],seealso:["bignumber","boolean","complex","index","matrix","number","string"]}},function(t,e){t.exports={name:"e",category:"Constants",syntax:["e"],description:"Euler's number, the base of the natural logarithm. Approximately equal to 2.71828",examples:["e","e ^ 2","exp(2)","log(e)"],seealso:["exp"]}},function(t,e){t.exports={name:"false",category:"Constants",syntax:["false"],description:"Boolean value false",examples:["false"],seealso:["true"]}},function(t,e){t.exports={name:"i",category:"Constants",syntax:["i"],description:"Imaginary unit, defined as i*i=-1. A complex number is described as a + b*i, where a is the real part, and b is the imaginary part.",examples:["i","i * i","sqrt(-1)"],seealso:[]}},function(t,e){t.exports={name:"Infinity",category:"Constants",syntax:["Infinity"],description:"Infinity, a number which is larger than the maximum number that can be handled by a floating point number.",examples:["Infinity","1 / 0"],seealso:[]}},function(t,e){t.exports={name:"LN2",category:"Constants",syntax:["LN2"],description:"Returns the natural logarithm of 2, approximately equal to 0.693",examples:["LN2","log(2)"],seealso:[]}},function(t,e){t.exports={name:"LN10",category:"Constants",syntax:["LN10"],description:"Returns the natural logarithm of 10, approximately equal to 2.302",examples:["LN10","log(10)"],seealso:[]}},function(t,e){t.exports={name:"LOG2E",category:"Constants",syntax:["LOG2E"],description:"Returns the base-2 logarithm of E, approximately equal to 1.442",examples:["LOG2E","log(e, 2)"],seealso:[]}},function(t,e){t.exports={name:"LOG10E",category:"Constants",syntax:["LOG10E"],description:"Returns the base-10 logarithm of E, approximately equal to 0.434",examples:["LOG10E","log(e, 10)"],seealso:[]}},function(t,e){t.exports={name:"NaN",category:"Constants",syntax:["NaN"],description:"Not a number",examples:["NaN","0 / 0"],seealso:[]}},function(t,e){t.exports={name:"null",category:"Constants",syntax:["null"],description:"Value null",examples:["null"],seealso:["true","false"]}},function(t,e){t.exports={name:"pi",category:"Constants",syntax:["pi"],description:"The number pi is a mathematical constant that is the ratio of a circle's circumference to its diameter, and is approximately equal to 3.14159",examples:["pi","sin(pi/2)"],seealso:["tau"]}},function(t,e){t.exports={name:"phi",category:"Constants",syntax:["phi"],description:"Phi is the golden ratio. Two quantities are in the golden ratio if their ratio is the same as the ratio of their sum to the larger of the two quantities. Phi is defined as `(1 + sqrt(5)) / 2` and is approximately 1.618034...",examples:["tau"],seealso:[]}},function(t,e){t.exports={name:"SQRT1_2",category:"Constants",syntax:["SQRT1_2"],description:"Returns the square root of 1/2, approximately equal to 0.707",examples:["SQRT1_2","sqrt(1/2)"],seealso:[]}},function(t,e){t.exports={name:"SQRT2",category:"Constants",syntax:["SQRT2"],description:"Returns the square root of 2, approximately equal to 1.414",examples:["SQRT2","sqrt(2)"],seealso:[]}},function(t,e){t.exports={name:"tau",category:"Constants",syntax:["tau"],description:"Tau is the ratio constant of a circle's circumference to radius, equal to 2 * pi, approximately 6.2832.",examples:["tau","2 * pi"],seealso:["pi"]}},function(t,e){t.exports={name:"true",category:"Constants",syntax:["true"],description:"Boolean value true",examples:["true"],seealso:["false"]}},function(t,e){t.exports={name:"version",category:"Constants",syntax:["version"],description:"A string with the version number of math.js",examples:["version"],seealso:[]}},function(t,e){t.exports={name:"lsolve",category:"Algebra",syntax:["x=lsolve(L, b)"],description:"Solves the linear system L * x = b where L is an [n x n] lower triangular matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lsolve(a, b)"],seealso:["lup","lusolve","usolve","matrix","sparse"]}},function(t,e){t.exports={name:"lup",category:"Algebra",syntax:["lup(m)"],description:"Calculate the Matrix LU decomposition with partial pivoting. Matrix A is decomposed in three matrices (L, U, P) where P * A = L * U",examples:["lup([[2, 1], [1, 4]])","lup(matrix([[2, 1], [1, 4]]))","lup(sparse([[2, 1], [1, 4]]))"],seealso:["lusolve","lsolve","usolve","matrix","sparse","slu"]}},function(t,e){t.exports={name:"lusolve",category:"Algebra",syntax:["x=lusolve(A, b)","x=lusolve(lu, b)"],description:"Solves the linear system A * x = b where A is an [n x n] matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lusolve(a, b)"],seealso:["lup","slu","lsolve","usolve","matrix","sparse"]}},function(t,e){t.exports={name:"slu",category:"Algebra",syntax:["slu(A, order, threshold)"],description:"Calculate the Matrix LU decomposition with full pivoting. Matrix A is decomposed in two matrices (L, U) and two permutation vectors (pinv, q) where P * A * Q = L * U",examples:["slu(sparse([4.5, 0, 3.2, 0; 3.1, 2.9, 0, 0.9; 0, 1.7, 3, 0; 3.5, 0.4, 0, 1]), 1, 0.001)"],seealso:["lusolve","lsolve","usolve","matrix","sparse","lup"]}},function(t,e){t.exports={name:"usolve",category:"Algebra",syntax:["x=usolve(U, b)"],description:"Solves the linear system U * x = b where U is an [n x n] upper triangular matrix and b is a [n] column vector.",examples:["x=usolve(sparse([1, 1, 1, 1; 0, 1, 1, 1; 0, 0, 1, 1; 0, 0, 0, 1]), [1; 2; 3; 4])"],seealso:["lup","lusolve","lsolve","matrix","sparse"]}},function(t,e){t.exports={name:"abs",category:"Arithmetic",syntax:["abs(x)"],description:"Compute the absolute value.",examples:["abs(3.5)","abs(-4.2)"],seealso:["sign"]}},function(t,e){t.exports={name:"add",category:"Operators",syntax:["x + y","add(x, y)"],description:"Add two values.",examples:["a = 2.1 + 3.6","a - 3.6","3 + 2i","3 cm + 2 inch",'"2.3" + "4"'],seealso:["subtract"]}},function(t,e){t.exports={name:"cbrt",category:"Arithmetic",syntax:["cbrt(x)","cbrt(x, allRoots)"],description:"Compute the cubic root value. If x = y * y * y, then y is the cubic root of x. When `x` is a number or complex number, an optional second argument `allRoots` can be provided to return all three cubic roots. If not provided, the principal root is returned",examples:["cbrt(64)","cube(4)","cbrt(-8)","cbrt(2 + 3i)","cbrt(8i)","cbrt(8i, true)","cbrt(27 m^3)"],seealso:["square","sqrt","cube","multiply"]}},function(t,e){t.exports={name:"ceil",category:"Arithmetic",syntax:["ceil(x)"],description:"Round a value towards plus infinity. If x is complex, both real and imaginary part are rounded towards plus infinity.",examples:["ceil(3.2)","ceil(3.8)","ceil(-4.2)"],seealso:["floor","fix","round"]}},function(t,e){t.exports={name:"cube",category:"Arithmetic",syntax:["cube(x)"],description:"Compute the cube of a value. The cube of x is x * x * x.",examples:["cube(2)","2^3","2 * 2 * 2"],seealso:["multiply","square","pow"]}},function(t,e){t.exports={name:"divide",category:"Operators",syntax:["x / y","divide(x, y)"],description:"Divide two values.",examples:["a = 2 / 3","a * 3","4.5 / 2","3 + 4 / 2","(3 + 4) / 2","18 km / 4.5"],seealso:["multiply"]}},function(t,e){t.exports={name:"dotDivide",category:"Operators",syntax:["x ./ y","dotDivide(x, y)"],description:"Divide two values element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","b = [2, 1, 1; 3, 2, 5]","a ./ b"],seealso:["multiply","dotMultiply","divide"]}},function(t,e){t.exports={name:"dotMultiply",category:"Operators",syntax:["x .* y","dotMultiply(x, y)"],description:"Multiply two values element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","b = [2, 1, 1; 3, 2, 5]","a .* b"],seealso:["multiply","divide","dotDivide"]}},function(t,e){t.exports={name:"dotpow",category:"Operators",syntax:["x .^ y","dotpow(x, y)"],description:"Calculates the power of x to y element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","a .^ 2"],seealso:["pow"]}},function(t,e){t.exports={name:"exp",category:"Arithmetic",syntax:["exp(x)"],description:"Calculate the exponent of a value.",examples:["exp(1.3)","e ^ 1.3","log(exp(1.3))","x = 2.4","(exp(i*x) == cos(x) + i*sin(x))   # Euler's formula"],seealso:["pow","log"]}},function(t,e){t.exports={name:"fix",category:"Arithmetic",syntax:["fix(x)"],description:"Round a value towards zero. If x is complex, both real and imaginary part are rounded towards zero.",examples:["fix(3.2)","fix(3.8)","fix(-4.2)","fix(-4.8)"],seealso:["ceil","floor","round"]}},function(t,e){t.exports={name:"floor",category:"Arithmetic",syntax:["floor(x)"],description:"Round a value towards minus infinity.If x is complex, both real and imaginary part are rounded towards minus infinity.",examples:["floor(3.2)","floor(3.8)","floor(-4.2)"],seealso:["ceil","fix","round"]}},function(t,e){t.exports={name:"gcd",category:"Arithmetic",syntax:["gcd(a, b)","gcd(a, b, c, ...)"],description:"Compute the greatest common divisor.",examples:["gcd(8, 12)","gcd(-4, 6)","gcd(25, 15, -10)"],seealso:["lcm","xgcd"]}},function(t,e){t.exports={name:"hypot",category:"Arithmetic",syntax:["hypot(a, b, c, ...)","hypot([a, b, c, ...])"],description:"Calculate the hypotenusa of a list with values. ",examples:["hypot(3, 4)","sqrt(3^2 + 4^2)","hypot(-2)","hypot([3, 4, 5])"],seealso:["abs","norm"]}},function(t,e){t.exports={name:"lcm",category:"Arithmetic",syntax:["lcm(x, y)"],description:"Compute the least common multiple.",examples:["lcm(4, 6)","lcm(6, 21)","lcm(6, 21, 5)"],seealso:["gcd"]}},function(t,e){t.exports={name:"log",category:"Arithmetic",syntax:["log(x)","log(x, base)"],description:"Compute the logarithm of a value. If no base is provided, the natural logarithm of x is calculated. If base if provided, the logarithm is calculated for the specified base. log(x, base) is defined as log(x) / log(base).",examples:["log(3.5)","a = log(2.4)","exp(a)","10 ^ 4","log(10000, 10)","log(10000) / log(10)","b = log(1024, 2)","2 ^ b"],seealso:["exp","log10"]}},function(t,e){t.exports={name:"log10",category:"Arithmetic",syntax:["log10(x)"],description:"Compute the 10-base logarithm of a value.",examples:["log10(0.00001)","log10(10000)","10 ^ 4","log(10000) / log(10)","log(10000, 10)"],seealso:["exp","log"]}},function(t,e){t.exports={name:"mod",category:"Operators",syntax:["x % y","x mod y","mod(x, y)"],description:"Calculates the modulus, the remainder of an integer division.",examples:["7 % 3","11 % 2","10 mod 4","function isOdd(x) = x % 2","isOdd(2)","isOdd(3)"],seealso:["divide"]}},function(t,e){t.exports={name:"multiply",category:"Operators",syntax:["x * y","multiply(x, y)"],description:"multiply two values.",examples:["a = 2.1 * 3.4","a / 3.4","2 * 3 + 4","2 * (3 + 4)","3 * 2.1 km"],seealso:["divide"]}},function(t,e){t.exports={name:"norm",category:"Arithmetic",syntax:["norm(x)","norm(x, p)"],description:"Calculate the norm of a number, vector or matrix.",examples:["abs(-3.5)","norm(-3.5)","norm(3 - 4i))","norm([1, 2, -3], Infinity)","norm([1, 2, -3], -Infinity)","norm([3, 4], 2)","norm([[1, 2], [3, 4]], 1)","norm([[1, 2], [3, 4]], 'inf')","norm([[1, 2], [3, 4]], 'fro')"]}},function(t,e){t.exports={name:"nthRoot",category:"Arithmetic",syntax:["nthRoot(a)","nthRoot(a, root)"],description:'Calculate the nth root of a value. The principal nth root of a positive real number A, is the positive real solution of the equation "x^root = A".',examples:["4 ^ 3","nthRoot(64, 3)","nthRoot(9, 2)","sqrt(9)"],seealso:["sqrt","pow"]}},function(t,e){t.exports={name:"pow",category:"Operators",syntax:["x ^ y","pow(x, y)"],description:"Calculates the power of x to y, x^y.",examples:["2^3 = 8","2*2*2","1 + e ^ (pi * i)"],seealso:["multiply"]}},function(t,e){t.exports={name:"round",category:"Arithmetic",syntax:["round(x)","round(x, n)"],description:"round a value towards the nearest integer.If x is complex, both real and imaginary part are rounded towards the nearest integer. When n is specified, the value is rounded to n decimals.",examples:["round(3.2)","round(3.8)","round(-4.2)","round(-4.8)","round(pi, 3)","round(123.45678, 2)"],seealso:["ceil","floor","fix"]}},function(t,e){t.exports={name:"sign",category:"Arithmetic",syntax:["sign(x)"],description:"Compute the sign of a value. The sign of a value x is 1 when x>1, -1 when x<0, and 0 when x=0.",examples:["sign(3.5)","sign(-4.2)","sign(0)"],seealso:["abs"]}},function(t,e){t.exports={name:"sqrt",category:"Arithmetic",syntax:["sqrt(x)"],description:"Compute the square root value. If x = y * y, then y is the square root of x.",examples:["sqrt(25)","5 * 5","sqrt(-1)"],seealso:["square","multiply"]}},function(t,e){t.exports={name:"square",category:"Arithmetic",syntax:["square(x)"],description:"Compute the square of a value. The square of x is x * x.",examples:["square(3)","sqrt(9)","3^2","3 * 3"],seealso:["multiply","pow","sqrt","cube"]}},function(t,e){t.exports={name:"subtract",category:"Operators",syntax:["x - y","subtract(x, y)"],description:"subtract two values.",examples:["a = 5.3 - 2","a + 2","2/3 - 1/6","2 * 3 - 3","2.1 km - 500m"],seealso:["add"]}},function(t,e){t.exports={name:"unaryMinus",category:"Operators",syntax:["-x","unaryMinus(x)"],description:"Inverse the sign of a value. Converts booleans and strings to numbers.",examples:["-4.5","-(-5.6)",'-"22"'],seealso:["add","subtract","unaryPlus"]}},function(t,e){t.exports={name:"unaryPlus",category:"Operators",syntax:["+x","unaryPlus(x)"],description:"Converts booleans and strings to numbers.",examples:["+true",'+"2"'],seealso:["add","subtract","unaryMinus"]}},function(t,e){t.exports={name:"xgcd",category:"Arithmetic",syntax:["xgcd(a, b)"],description:"Calculate the extended greatest common divisor for two values",examples:["xgcd(8, 12)","gcd(8, 12)","xgcd(36163, 21199)"],seealso:["gcd","lcm"]}},function(t,e){t.exports={name:"bitAnd",category:"Bitwise",syntax:["x & y","bitAnd(x, y)"],description:"Bitwise AND operation. Performs the logical AND operation on each pair of the corresponding bits of the two given values by multiplying them. If both bits in the compared position are 1, the bit in the resulting binary representation is 1, otherwise, the result is 0",examples:["5 & 3","bitAnd(53, 131)","[1, 12, 31] & 42"],seealso:["bitNot","bitOr","bitXor","leftShift","rightArithShift","rightLogShift"]}},function(t,e){t.exports={name:"bitNot",category:"Bitwise",syntax:["~x","bitNot(x)"],description:"Bitwise NOT operation. Performs a logical negation on each bit of the given value. Bits that are 0 become 1, and those that are 1 become 0.",examples:["~1","~2","bitNot([2, -3, 4])"],seealso:["bitAnd","bitOr","bitXor","leftShift","rightArithShift","rightLogShift"]}},function(t,e){t.exports={name:"bitOr",category:"Bitwise",syntax:["x | y","bitOr(x, y)"],description:"Bitwise OR operation. Performs the logical inclusive OR operation on each pair of corresponding bits of the two given values. The result in each position is 1 if the first bit is 1 or the second bit is 1 or both bits are 1, otherwise, the result is 0.",examples:["5 | 3","bitOr([1, 2, 3], 4)"],seealso:["bitAnd","bitNot","bitXor","leftShift","rightArithShift","rightLogShift"]}},function(t,e){t.exports={name:"bitXor",category:"Bitwise",syntax:["bitXor(x, y)"],description:"Bitwise XOR operation, exclusive OR. Performs the logical exclusive OR operation on each pair of corresponding bits of the two given values. The result in each position is 1 if only the first bit is 1 or only the second bit is 1, but will be 0 if both are 0 or both are 1.",examples:["bitOr(1, 2)","bitXor([2, 3, 4], 4)"],seealso:["bitAnd","bitNot","bitOr","leftShift","rightArithShift","rightLogShift"]}},function(t,e){t.exports={name:"leftShift",category:"Bitwise",syntax:["x << y","leftShift(x, y)"],description:"Bitwise left logical shift of a value x by y number of bits.",examples:["4 << 1","8 >> 1"],seealso:["bitAnd","bitNot","bitOr","bitXor","rightArithShift","rightLogShift"]}},function(t,e){t.exports={name:"rightArithShift",category:"Bitwise",syntax:["x >> y","leftShift(x, y)"],description:"Bitwise right arithmetic shift of a value x by y number of bits.",examples:["8 >> 1","4 << 1","-12 >> 2"],seealso:["bitAnd","bitNot","bitOr","bitXor","leftShift","rightLogShift"]}},function(t,e){t.exports={name:"rightLogShift",category:"Bitwise",syntax:["x >> y","leftShift(x, y)"],description:"Bitwise right logical shift of a value x by y number of bits.",examples:["8 >>> 1","4 << 1","-12 >>> 2"],seealso:["bitAnd","bitNot","bitOr","bitXor","leftShift","rightArithShift"]}},function(t,e){t.exports={name:"bellNumbers",category:"Combinatorics",syntax:["bellNumbers(n)"],description:"The Bell Numbers count the number of partitions of a set. A partition is a pairwise disjoint subset of S whose union is S. `bellNumbers` only takes integer arguments. The following condition must be enforced: n >= 0.",examples:["bellNumbers(3)","bellNumbers(8)"],seealso:["stirlingS2"]}},function(t,e){t.exports={name:"catalan",category:"Combinatorics",syntax:["catalan(n)"],description:"The Catalan Numbers enumerate combinatorial structures of many different types. catalan only takes integer arguments. The following condition must be enforced: n >= 0.",examples:["catalan(3)","catalan(8)"],seealso:["bellNumbers"]}},function(t,e){t.exports={name:"composition",category:"Combinatorics",syntax:["composition(n, k)"],description:"The composition counts of n into k parts. composition only takes integer arguments. The following condition must be enforced: k <= n.",examples:["composition(5, 3)"],seealso:["combinations"]}},function(t,e){t.exports={name:"stirlingS2",category:"Combinatorics",syntax:["stirlingS2(n, k)"],description:"he Stirling numbers of the second kind, counts the number of ways to partition a set of n labelled objects into k nonempty unlabelled subsets. `stirlingS2` only takes integer arguments. The following condition must be enforced: k <= n. If n = k or k = 1, then s(n,k) = 1.",
examples:["stirlingS2(5, 3)"],seealso:["bellNumbers"]}},function(t,e){t.exports={name:"config",category:"Core",syntax:["config()","config(options)"],description:"Get configuration or change configuration.",examples:["config()","1/3 + 1/4",'config({number: "Fraction"})',"1/3 + 1/4"],seealso:[]}},function(t,e){t.exports={name:"import",category:"Core",syntax:["import(functions)","import(functions, options)"],description:"Import functions or constants from an object.",examples:["import({myFn: f(x)=x^2, myConstant: 32 })","myFn(2)","myConstant"],seealso:[]}},function(t,e){t.exports={name:"typed",category:"Core",syntax:["typed(signatures)","typed(name, signatures)"],description:"Create a typed function.",examples:['double = typed({ "number, number": f(x)=x+x })',"double(2)",'double("hello")'],seealso:[]}},function(t,e){t.exports={name:"arg",category:"Complex",syntax:["arg(x)"],description:"Compute the argument of a complex value. If x = a+bi, the argument is computed as atan2(b, a).",examples:["arg(2 + 2i)","atan2(3, 2)","arg(2 + 3i)"],seealso:["re","im","conj","abs"]}},function(t,e){t.exports={name:"conj",category:"Complex",syntax:["conj(x)"],description:"Compute the complex conjugate of a complex value. If x = a+bi, the complex conjugate is a-bi.",examples:["conj(2 + 3i)","conj(2 - 3i)","conj(-5.2i)"],seealso:["re","im","abs","arg"]}},function(t,e){t.exports={name:"re",category:"Complex",syntax:["re(x)"],description:"Get the real part of a complex number.",examples:["re(2 + 3i)","im(2 + 3i)","re(-5.2i)","re(2.4)"],seealso:["im","conj","abs","arg"]}},function(t,e){t.exports={name:"im",category:"Complex",syntax:["im(x)"],description:"Get the imaginary part of a complex number.",examples:["im(2 + 3i)","re(2 + 3i)","im(-5.2i)","im(2.4)"],seealso:["re","conj","abs","arg"]}},function(t,e){t.exports={name:"eval",category:"Expression",syntax:["eval(expression)","eval([expr1, expr2, expr3, ...])"],description:"Evaluate an expression or an array with expressions.",examples:['eval("2 + 3")','eval("sqrt(" + 4 + ")")'],seealso:[]}},function(t,e){t.exports={name:"help",category:"Expression",syntax:["help(object)","help(string)"],description:"Display documentation on a function or data type.",examples:["help(sqrt)",'help("complex")'],seealso:[]}},function(t,e){t.exports={name:"distance",category:"Geometry",syntax:["distance([x1, y1], [x2, y2])","distance([[x1, y1], [x2, y2])"],description:"Calculates the Euclidean distance between two points.",examples:["distance([0,0], [4,4])","distance([[0,0], [4,4]])"],seealso:[]}},function(t,e){t.exports={name:"intersect",category:"Geometry",syntax:["intersect(expr1, expr2, expr3, expr4)","intersect(expr1, expr2, expr3)"],description:"Computes the intersection point of lines and/or planes.",examples:["intersect([0, 0], [10, 10], [10, 0], [0, 10])","intersect([1, 0, 1],  [4, -2, 2], [1, 1, 1, 6])"],seealso:[]}},function(t,e){t.exports={name:"and",category:"Logical",syntax:["x and y","and(x, y)"],description:"Logical and. Test whether two values are both defined with a nonzero/nonempty value.",examples:["true and false","true and true","2 and 4"],seealso:["not","or","xor"]}},function(t,e){t.exports={name:"not",category:"Logical",syntax:["not x","not(x)"],description:"Logical not. Flips the boolean value of given argument.",examples:["not true","not false","not 2","not 0"],seealso:["and","or","xor"]}},function(t,e){t.exports={name:"or",category:"Logical",syntax:["x or y","or(x, y)"],description:"Logical or. Test if at least one value is defined with a nonzero/nonempty value.",examples:["true or false","false or false","0 or 4"],seealso:["not","and","xor"]}},function(t,e){t.exports={name:"xor",category:"Logical",syntax:["x or y","or(x, y)"],description:"Logical exclusive or, xor. Test whether one and only one value is defined with a nonzero/nonempty value.",examples:["true xor false","false xor false","true xor true","0 or 4"],seealso:["not","and","or"]}},function(t,e){t.exports={name:"concat",category:"Matrix",syntax:["concat(A, B, C, ...)","concat(A, B, C, ..., dim)"],description:"Concatenate matrices. By default, the matrices are concatenated by the last dimension. The dimension on which to concatenate can be provided as last argument.",examples:["A = [1, 2; 5, 6]","B = [3, 4; 7, 8]","concat(A, B)","concat(A, B, 1)","concat(A, B, 2)"],seealso:["det","diag","eye","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]}},function(t,e){t.exports={name:"cross",category:"Matrix",syntax:["cross(A, B)"],description:"Calculate the cross product for two vectors in three dimensional space.",examples:["cross([1, 1, 0],  [0, 1, 1])","cross([3, -3, 1], [4, 9, 2])","cross([2, 3, 4],  [5, 6, 7])"],seealso:["multiply","dot"]}},function(t,e){t.exports={name:"det",category:"Matrix",syntax:["det(x)"],description:"Calculate the determinant of a matrix",examples:["det([1, 2; 3, 4])","det([-2, 2, 3; -1, 1, 3; 2, 0, -1])"],seealso:["concat","diag","eye","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]}},function(t,e){t.exports={name:"diag",category:"Matrix",syntax:["diag(x)","diag(x, k)"],description:"Create a diagonal matrix or retrieve the diagonal of a matrix. When x is a vector, a matrix with the vector values on the diagonal will be returned. When x is a matrix, a vector with the diagonal values of the matrix is returned. When k is provided, the k-th diagonal will be filled in or retrieved, if k is positive, the values are placed on the super diagonal. When k is negative, the values are placed on the sub diagonal.",examples:["diag(1:3)","diag(1:3, 1)","a = [1, 2, 3; 4, 5, 6; 7, 8, 9]","diag(a)"],seealso:["concat","det","eye","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]}},function(t,e){t.exports={name:"dot",category:"Matrix",syntax:["dot(A, B)"],description:"Calculate the dot product of two vectors. The dot product of A = [a1, a2, a3, ..., an] and B = [b1, b2, b3, ..., bn] is defined as dot(A, B) = a1 * b1 + a2 * b2 + a3 * b3 + ... + an * bn",examples:["dot([2, 4, 1], [2, 2, 3])","[2, 4, 1] * [2, 2, 3]"],seealso:["multiply","cross"]}},function(t,e){t.exports={name:"eye",category:"Matrix",syntax:["eye(n)","eye(m, n)","eye([m, n])","eye"],description:"Returns the identity matrix with size m-by-n. The matrix has ones on the diagonal and zeros elsewhere.",examples:["eye(3)","eye(3, 5)","a = [1, 2, 3; 4, 5, 6]","eye(size(a))"],seealso:["concat","det","diag","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]}},function(t,e){t.exports={name:"filter",category:"Matrix",syntax:["filter(x, test)"],description:"Filter items in a matrix.",examples:["isPositive(x) = x > 0","filter([6, -2, -1, 4, 3], isPositive)","filter([6, -2, 0, 1, 0], x != 0)"],seealso:["sort","map","forEach"]}},function(t,e){t.exports={name:"flatten",category:"Matrix",syntax:["flatten(x)"],description:"Flatten a multi dimensional matrix into a single dimensional matrix.",examples:["a = [1, 2, 3; 4, 5, 6]","size(a)","b = flatten(a)","size(b)"],seealso:["concat","resize","size","squeeze"]}},function(t,e){t.exports={name:"forEach",category:"Matrix",syntax:["forEach(x, callback)"],description:"Iterates over all elements of a matrix/array, and executes the given callback function.",examples:["forEach([1, 2, 3], function(val) { console.log(val) })"],seealso:["map","sort","filter"]}},function(t,e){t.exports={name:"inv",category:"Matrix",syntax:["inv(x)"],description:"Calculate the inverse of a matrix",examples:["inv([1, 2; 3, 4])","inv(4)","1 / 4"],seealso:["concat","det","diag","eye","ones","range","size","squeeze","subset","trace","transpose","zeros"]}},function(t,e){t.exports={name:"map",category:"Matrix",syntax:["map(x, callback)"],description:"Create a new matrix or array with the results of the callback function executed on each entry of the matrix/array.",examples:["map([1, 2, 3], function(val) { return value * value })"],seealso:["filter","forEach"]}},function(t,e){t.exports={name:"ones",category:"Matrix",syntax:["ones(m)","ones(m, n)","ones(m, n, p, ...)","ones([m])","ones([m, n])","ones([m, n, p, ...])","ones"],description:"Create a matrix containing ones.",examples:["ones(3)","ones(3, 5)","ones([2,3]) * 4.5","a = [1, 2, 3; 4, 5, 6]","ones(size(a))"],seealso:["concat","det","diag","eye","inv","range","size","squeeze","subset","trace","transpose","zeros"]}},function(t,e){t.exports={name:"partitionSelect",category:"Matrix",syntax:["partitionSelect(x, k)","partitionSelect(x, k, compare)"],description:"Partition-based selection of an array or 1D matrix. Will find the kth smallest value, and mutates the input array. Uses Quickselect.",examples:["partitionSelect([5, 10, 1], 2)",'partitionSelect(["C", "B", "A", "D"], 1)'],seealso:["sort"]}},function(t,e){t.exports={name:"range",category:"Type",syntax:["start:end","start:step:end","range(start, end)","range(start, end, step)","range(string)"],description:"Create a range. Lower bound of the range is included, upper bound is excluded.",examples:["1:5","3:-1:-3","range(3, 7)","range(0, 12, 2)",'range("4:10")',"a = [1, 2, 3, 4; 5, 6, 7, 8]","a[1:2, 1:2]"],seealso:["concat","det","diag","eye","inv","ones","size","squeeze","subset","trace","transpose","zeros"]}},function(t,e){t.exports={name:"resize",category:"Matrix",syntax:["resize(x, size)","resize(x, size, defaultValue)"],description:"Resize a matrix.",examples:["resize([1,2,3,4,5], [3])","resize([1,2,3], [5])","resize([1,2,3], [5], -1)","resize(2, [2, 3])",'resize("hello", [8], "!")'],seealso:["size","subset","squeeze"]}},function(t,e){t.exports={name:"size",category:"Matrix",syntax:["size(x)"],description:"Calculate the size of a matrix.",examples:["size(2.3)",'size("hello world")',"a = [1, 2; 3, 4; 5, 6]","size(a)","size(1:6)"],seealso:["concat","det","diag","eye","inv","ones","range","squeeze","subset","trace","transpose","zeros"]}},function(t,e){t.exports={name:"sort",category:"Matrix",syntax:["sort(x)","sort(x, compare)"],description:'Sort the items in a matrix. Compare can be a string "asc" or "desc", or a custom sort function.',examples:["sort([5, 10, 1])",'sort(["C", "B", "A", "D"])',"sortByLength(a, b) = size(a)[1] - size(b)[1]",'sort(["Langdon", "Tom", "Sara"], sortByLength)'],seealso:["map","filter","forEach"]}},function(t,e){t.exports={name:"squeeze",category:"Matrix",syntax:["squeeze(x)"],description:"Remove inner and outer singleton dimensions from a matrix.",examples:["a = zeros(3,2,1)","size(squeeze(a))","b = zeros(1,1,3)","size(squeeze(b))"],seealso:["concat","det","diag","eye","inv","ones","range","size","subset","trace","transpose","zeros"]}},function(t,e){t.exports={name:"subset",category:"Matrix",syntax:["value(index)","value(index) = replacement","subset(value, [index])","subset(value, [index], replacement)"],description:"Get or set a subset of a matrix or string. Indexes are one-based. Both the ranges lower-bound and upper-bound are included.",examples:["d = [1, 2; 3, 4]","e = []","e[1, 1:2] = [5, 6]","e[2, :] = [7, 8]","f = d * e","f[2, 1]","f[:, 1]"],seealso:["concat","det","diag","eye","inv","ones","range","size","squeeze","trace","transpose","zeros"]}},function(t,e){t.exports={name:"trace",category:"Matrix",syntax:["trace(A)"],description:"Calculate the trace of a matrix: the sum of the elements on the main diagonal of a square matrix.",examples:["A = [1, 2, 3; -1, 2, 3; 2, 0, 3]","trace(A)"],seealso:["concat","det","diag","eye","inv","ones","range","size","squeeze","subset","transpose","zeros"]}},function(t,e){t.exports={name:"transpose",category:"Matrix",syntax:["x'","transpose(x)"],description:"Transpose a matrix",examples:["a = [1, 2, 3; 4, 5, 6]","a'","transpose(a)"],seealso:["concat","det","diag","eye","inv","ones","range","size","squeeze","subset","trace","zeros"]}},function(t,e){t.exports={name:"zeros",category:"Matrix",syntax:["zeros(m)","zeros(m, n)","zeros(m, n, p, ...)","zeros([m])","zeros([m, n])","zeros([m, n, p, ...])","zeros"],description:"Create a matrix containing zeros.",examples:["zeros(3)","zeros(3, 5)","a = [1, 2, 3; 4, 5, 6]","zeros(size(a))"],seealso:["concat","det","diag","eye","inv","ones","range","size","squeeze","subset","trace","transpose"]}},function(t,e){t.exports={name:"combinations",category:"Probability",syntax:["combinations(n, k)"],description:"Compute the number of combinations of n items taken k at a time",examples:["combinations(7, 5)"],seealso:["permutations","factorial"]}},function(t,e){t.exports={name:"factorial",category:"Probability",syntax:["kldivergence(x, y)"],description:"Compute the factorial of a value",examples:["5!","5 * 4 * 3 * 2 * 1","3!"],seealso:["combinations","permutations","gamma"]}},function(t,e){t.exports={name:"gamma",category:"Probability",syntax:["gamma(n)"],description:"Compute the gamma function. For small values, the Lanczos approximation is used, and for large values the extended Stirling approximation.",examples:["gamma(4)","3!","gamma(1/2)","sqrt(pi)"],seealso:["factorial"]}},function(t,e){t.exports={name:"kldivergence",category:"Probability",syntax:["n!","factorial(n)"],description:"Calculate the Kullback-Leibler (KL) divergence  between two distributions.",examples:["math.kldivergence([0.7,0.5,0.4], [0.2,0.9,0.5])"],seealso:[]}},function(t,e){t.exports={name:"multinomial",category:"Probability",syntax:["multinomial(A)"],description:"Multinomial Coefficients compute the number of ways of picking a1, a2, ..., ai unordered outcomes from `n` possibilities. multinomial takes one array of integers as an argument. The following condition must be enforced: every ai <= 0.",examples:["multinomial([1, 2, 1])"],seealso:["combinations","factorial"]}},function(t,e){t.exports={name:"permutations",category:"Probability",syntax:["permutations(n)","permutations(n, k)"],description:"Compute the number of permutations of n items taken k at a time",examples:["permutations(5)","permutations(5, 3)"],seealso:["combinations","factorial"]}},function(t,e){t.exports={name:"pickRandom",category:"Probability",syntax:["pickRandom(array)"],description:"Pick a random entry from a given array.",examples:["pickRandom(0:10)","pickRandom([1, 3, 1, 6])"],seealso:["random","randomInt"]}},function(t,e){t.exports={name:"random",category:"Probability",syntax:["random()","random(max)","random(min, max)","random(size)","random(size, max)","random(size, min, max)"],description:"Return a random number.",examples:["random()","random(10, 20)","random([2, 3])"],seealso:["pickRandom","randomInt"]}},function(t,e){t.exports={name:"randInt",category:"Probability",syntax:["randInt(max)","randInt(min, max)","randInt(size)","randInt(size, max)","randInt(size, min, max)"],description:"Return a random integer number",examples:["randInt(10, 20)","randInt([2, 3], 10)"],seealso:["pickRandom","random"]}},function(t,e){t.exports={name:"compare",category:"Relational",syntax:["compare(x, y)"],description:"Compare two values. Returns 1 if x is larger than y, -1 if x is smaller than y, and 0 if x and y are equal.",examples:["compare(2, 3)","compare(3, 2)","compare(2, 2)","compare(5cm, 40mm)","compare(2, [1, 2, 3])"],seealso:["equal","unequal","smaller","smallerEq","largerEq"]}},function(t,e){t.exports={name:"deepEqual",category:"Relational",syntax:["deepEqual(x, y)"],description:"Check equality of two matrices element wise. Returns true if the size of both matrices is equal and when and each of the elements are equal.",examples:["[1,3,4] == [1,3,4]","[1,3,4] == [1,3]"],seealso:["equal","unequal","smaller","larger","smallerEq","largerEq","compare"]}},function(t,e){t.exports={name:"equal",category:"Relational",syntax:["x == y","equal(x, y)"],description:"Check equality of two values. Returns true if the values are equal, and false if not.",examples:["2+2 == 3","2+2 == 4","a = 3.2","b = 6-2.8","a == b","50cm == 0.5m"],seealso:["unequal","smaller","larger","smallerEq","largerEq","compare","deepEqual"]}},function(t,e){t.exports={name:"larger",category:"Relational",syntax:["x > y","larger(x, y)"],description:"Check if value x is larger than y. Returns true if x is larger than y, and false if not.",examples:["2 > 3","5 > 2*2","a = 3.3","b = 6-2.8","(a > b)","(b < a)","5 cm > 2 inch"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compare"]}},function(t,e){t.exports={name:"largerEq",category:"Relational",syntax:["x >= y","largerEq(x, y)"],description:"Check if value x is larger or equal to y. Returns true if x is larger or equal to y, and false if not.",examples:["2 > 1+1","2 >= 1+1","a = 3.2","b = 6-2.8","(a > b)"],seealso:["equal","unequal","smallerEq","smaller","largerEq","compare"]}},function(t,e){t.exports={name:"smaller",category:"Relational",syntax:["x < y","smaller(x, y)"],description:"Check if value x is smaller than value y. Returns true if x is smaller than y, and false if not.",examples:["2 < 3","5 < 2*2","a = 3.3","b = 6-2.8","(a < b)","5 cm < 2 inch"],seealso:["equal","unequal","larger","smallerEq","largerEq","compare"]}},function(t,e){t.exports={name:"smallerEq",category:"Relational",syntax:["x <= y","smallerEq(x, y)"],description:"Check if value x is smaller or equal to value y. Returns true if x is smaller than y, and false if not.",examples:["2 < 1+1","2 <= 1+1","a = 3.2","b = 6-2.8","(a < b)"],seealso:["equal","unequal","larger","smaller","largerEq","compare"]}},function(t,e){t.exports={name:"unequal",category:"Relational",syntax:["x != y","unequal(x, y)"],description:"Check unequality of two values. Returns true if the values are unequal, and false if they are equal.",examples:["2+2 != 3","2+2 != 4","a = 3.2","b = 6-2.8","a != b","50cm != 0.5m","5 cm != 2 inch"],seealso:["equal","smaller","larger","smallerEq","largerEq","compare","deepEqual"]}},function(t,e){t.exports={name:"max",category:"Statistics",syntax:["max(a, b, c, ...)","max(A)","max(A, dim)"],description:"Compute the maximum value of a list of values.",examples:["max(2, 3, 4, 1)","max([2, 3, 4, 1])","max([2, 5; 4, 3])","max([2, 5; 4, 3], 1)","max([2, 5; 4, 3], 2)","max(2.7, 7.1, -4.5, 2.0, 4.1)","min(2.7, 7.1, -4.5, 2.0, 4.1)"],seealso:["mean","median","min","prod","std","sum","var"]}},function(t,e){t.exports={name:"mean",category:"Statistics",syntax:["mean(a, b, c, ...)","mean(A)","mean(A, dim)"],description:"Compute the arithmetic mean of a list of values.",examples:["mean(2, 3, 4, 1)","mean([2, 3, 4, 1])","mean([2, 5; 4, 3])","mean([2, 5; 4, 3], 1)","mean([2, 5; 4, 3], 2)","mean([1.0, 2.7, 3.2, 4.0])"],seealso:["max","median","min","prod","std","sum","var"]}},function(t,e){t.exports={name:"median",category:"Statistics",syntax:["median(a, b, c, ...)","median(A)"],description:"Compute the median of all values. The values are sorted and the middle value is returned. In case of an even number of values, the average of the two middle values is returned.",examples:["median(5, 2, 7)","median([3, -1, 5, 7])"],seealso:["max","mean","min","prod","std","sum","var"]}},function(t,e){t.exports={name:"min",category:"Statistics",syntax:["min(a, b, c, ...)","min(A)","min(A, dim)"],description:"Compute the minimum value of a list of values.",examples:["min(2, 3, 4, 1)","min([2, 3, 4, 1])","min([2, 5; 4, 3])","min([2, 5; 4, 3], 1)","min([2, 5; 4, 3], 2)","min(2.7, 7.1, -4.5, 2.0, 4.1)","max(2.7, 7.1, -4.5, 2.0, 4.1)"],seealso:["max","mean","median","prod","std","sum","var"]}},function(t,e){t.exports={name:"mode",category:"Statistics",syntax:["mode(a, b, c, ...)","mode(A)","mode(A, a, b, B, c, ...)"],description:"Computes the mode of all values as an array. In case mode being more than one, multiple values are returned in an array.",examples:["mode(5, 2, 7)","mode([3, -1, 5, 7])"],seealso:["max","mean","min","median","prod","std","sum","var"]}},function(t,e){t.exports={name:"prod",category:"Statistics",syntax:["prod(a, b, c, ...)","prod(A)"],description:"Compute the product of all values.",examples:["prod(2, 3, 4)","prod([2, 3, 4])","prod([2, 5; 4, 3])"],seealso:["max","mean","min","median","min","std","sum","var"]}},function(t,e){t.exports={name:"quantileSeq",category:"Statistics",syntax:["quantileSeq(A, prob[, sorted])","quantileSeq(A, [prob1, prob2, ...][, sorted])","quantileSeq(A, N[, sorted])"],description:"Compute the prob order quantile of a matrix or a list with values. The sequence is sorted and the middle value is returned. Supported types of sequence values are: Number, BigNumber, Unit Supported types of probablity are: Number, BigNumber. \n\nIn case of a (multi dimensional) array or matrix, the prob order quantile of all elements will be calculated.",examples:["quantileSeq([3, -1, 5, 7], 0.5)","quantileSeq([3, -1, 5, 7], [1/3, 2/3])","quantileSeq([3, -1, 5, 7], 2)","quantileSeq([-1, 3, 5, 7], 0.5, true)"],seealso:["mean","median","min","max","prod","std","sum","var"]}},function(t,e){t.exports={name:"std",category:"Statistics",syntax:["std(a, b, c, ...)","std(A)","std(A, normalization)"],description:'Compute the standard deviation of all values, defined as std(A) = sqrt(var(A)). Optional parameter normalization can be "unbiased" (default), "uncorrected", or "biased".',examples:["std(2, 4, 6)","std([2, 4, 6, 8])",'std([2, 4, 6, 8], "uncorrected")','std([2, 4, 6, 8], "biased")',"std([1, 2, 3; 4, 5, 6])"],seealso:["max","mean","min","median","min","prod","sum","var"]}},function(t,e){t.exports={name:"sum",category:"Statistics",syntax:["sum(a, b, c, ...)","sum(A)"],description:"Compute the sum of all values.",examples:["sum(2, 3, 4, 1)","sum([2, 3, 4, 1])","sum([2, 5; 4, 3])"],seealso:["max","mean","median","min","prod","std","sum","var"]}},function(t,e){t.exports={name:"var",category:"Statistics",syntax:["var(a, b, c, ...)","var(A)","var(A, normalization)"],description:'Compute the variance of all values. Optional parameter normalization can be "unbiased" (default), "uncorrected", or "biased".',examples:["var(2, 4, 6)","var([2, 4, 6, 8])",'var([2, 4, 6, 8], "uncorrected")','var([2, 4, 6, 8], "biased")',"var([1, 2, 3; 4, 5, 6])"],seealso:["max","mean","min","median","min","prod","std","sum"]}},function(t,e){t.exports={name:"acos",category:"Trigonometry",syntax:["acos(x)"],description:"Compute the inverse cosine of a value in radians.",examples:["acos(0.5)","acos(cos(2.3))"],seealso:["cos","atan","asin"]}},function(t,e){t.exports={name:"acosh",category:"Trigonometry",syntax:["acosh(x)"],description:"Calculate the hyperbolic arccos of a value, defined as `acosh(x) = ln(sqrt(x^2 - 1) + x)`.",examples:["acosh(1.5)"],seealso:["cosh","asinh","atanh"]}},function(t,e){t.exports={name:"acot",category:"Trigonometry",syntax:["acot(x)"],description:"Calculate the inverse cotangent of a value.",examples:["acot(0.5)","acot(cot(0.5))","acot(2)"],seealso:["cot","atan"]}},function(t,e){t.exports={name:"acoth",category:"Trigonometry",syntax:["acoth(x)"],description:"Calculate the hyperbolic arccotangent of a value, defined as `acoth(x) = (ln((x+1)/x) + ln(x/(x-1))) / 2`.",examples:["acoth(0.5)"],seealso:["acsch","asech"]}},function(t,e){t.exports={name:"acsc",category:"Trigonometry",syntax:["acsc(x)"],description:"Calculate the inverse cotangent of a value.",examples:["acsc(0.5)","acsc(csc(0.5))","acsc(2)"],seealso:["csc","asin","asec"]}},function(t,e){t.exports={name:"acsch",category:"Trigonometry",syntax:["acsch(x)"],description:"Calculate the hyperbolic arccosecant of a value, defined as `acsch(x) = ln(1/x + sqrt(1/x^2 + 1))`.",examples:["acsch(0.5)"],seealso:["asech","acoth"]}},function(t,e){t.exports={name:"asec",category:"Trigonometry",syntax:["asec(x)"],description:"Calculate the inverse secant of a value.",examples:["asec(0.5)","asec(sec(0.5))","asec(2)"],seealso:["acos","acot","acsc"]}},function(t,e){t.exports={name:"asech",category:"Trigonometry",syntax:["asech(x)"],description:"Calculate the inverse secant of a value.",examples:["asech(0.5)"],seealso:["acsch","acoth"]}},function(t,e){t.exports={name:"asin",category:"Trigonometry",syntax:["asin(x)"],description:"Compute the inverse sine of a value in radians.",examples:["asin(0.5)","asin(sin(2.3))"],seealso:["sin","acos","atan"]}},function(t,e){t.exports={name:"asinh",category:"Trigonometry",syntax:["asinh(x)"],description:"Calculate the hyperbolic arcsine of a value, defined as `asinh(x) = ln(x + sqrt(x^2 + 1))`.",examples:["asinh(0.5)"],seealso:["acosh","atanh"]}},function(t,e){t.exports={name:"atan",category:"Trigonometry",syntax:["atan(x)"],description:"Compute the inverse tangent of a value in radians.",examples:["atan(0.5)","atan(tan(2.3))"],seealso:["tan","acos","asin"]}},function(t,e){t.exports={name:"atanh",category:"Trigonometry",syntax:["atanh(x)"],description:"Calculate the hyperbolic arctangent of a value, defined as `atanh(x) = ln((1 + x)/(1 - x)) / 2`.",examples:["atanh(0.5)"],seealso:["acosh","asinh"]}},function(t,e){t.exports={name:"atan2",category:"Trigonometry",syntax:["atan2(y, x)"],description:"Computes the principal value of the arc tangent of y/x in radians.",examples:["atan2(2, 2) / pi","angle = 60 deg in rad","x = cos(angle)","y = sin(angle)","atan2(y, x)"],seealso:["sin","cos","tan"]}},function(t,e){t.exports={name:"cos",category:"Trigonometry",syntax:["cos(x)"],description:"Compute the cosine of x in radians.",examples:["cos(2)","cos(pi / 4) ^ 2","cos(180 deg)","cos(60 deg)","sin(0.2)^2 + cos(0.2)^2"],seealso:["acos","sin","tan"]}},function(t,e){t.exports={name:"cosh",category:"Trigonometry",syntax:["cosh(x)"],description:"Compute the hyperbolic cosine of x in radians.",examples:["cosh(0.5)"],seealso:["sinh","tanh","coth"]}},function(t,e){t.exports={name:"cot",category:"Trigonometry",syntax:["cot(x)"],description:"Compute the cotangent of x in radians. Defined as 1/tan(x)",examples:["cot(2)","1 / tan(2)"],seealso:["sec","csc","tan"]}},function(t,e){t.exports={name:"coth",category:"Trigonometry",syntax:["coth(x)"],description:"Compute the hyperbolic cotangent of x in radians.",examples:["coth(2)","1 / tanh(2)"],seealso:["sech","csch","tanh"]}},function(t,e){t.exports={name:"csc",category:"Trigonometry",syntax:["csc(x)"],description:"Compute the cosecant of x in radians. Defined as 1/sin(x)",examples:["csc(2)","1 / sin(2)"],seealso:["sec","cot","sin"]}},function(t,e){t.exports={name:"csch",category:"Trigonometry",syntax:["csch(x)"],description:"Compute the hyperbolic cosecant of x in radians. Defined as 1/sinh(x)",examples:["csch(2)","1 / sinh(2)"],seealso:["sech","coth","sinh"]}},function(t,e){t.exports={name:"sec",category:"Trigonometry",syntax:["sec(x)"],description:"Compute the secant of x in radians. Defined as 1/cos(x)",examples:["sec(2)","1 / cos(2)"],seealso:["cot","csc","cos"]}},function(t,e){t.exports={name:"sech",category:"Trigonometry",syntax:["sech(x)"],description:"Compute the hyperbolic secant of x in radians. Defined as 1/cosh(x)",examples:["sech(2)","1 / cosh(2)"],seealso:["coth","csch","cosh"]}},function(t,e){t.exports={name:"sin",category:"Trigonometry",syntax:["sin(x)"],description:"Compute the sine of x in radians.",examples:["sin(2)","sin(pi / 4) ^ 2","sin(90 deg)","sin(30 deg)","sin(0.2)^2 + cos(0.2)^2"],seealso:["asin","cos","tan"]}},function(t,e){t.exports={name:"sinh",category:"Trigonometry",syntax:["sinh(x)"],description:"Compute the hyperbolic sine of x in radians.",examples:["sinh(0.5)"],seealso:["cosh","tanh"]}},function(t,e){t.exports={name:"tan",category:"Trigonometry",syntax:["tan(x)"],description:"Compute the tangent of x in radians.",examples:["tan(0.5)","sin(0.5) / cos(0.5)","tan(pi / 4)","tan(45 deg)"],seealso:["atan","sin","cos"]}},function(t,e){t.exports={name:"tanh",category:"Trigonometry",syntax:["tanh(x)"],description:"Compute the hyperbolic tangent of x in radians.",examples:["tanh(0.5)","sinh(0.5) / cosh(0.5)"],seealso:["sinh","cosh"]}},function(t,e){t.exports={name:"to",category:"Units",syntax:["x to unit","to(x, unit)"],description:"Change the unit of a value.",examples:["5 inch to cm","3.2kg to g","16 bytes in bits"],seealso:[]}},function(t,e){t.exports={name:"clone",category:"Utils",syntax:["clone(x)"],description:"Clone a variable. Creates a copy of primitive variables,and a deep copy of matrices",examples:["clone(3.5)","clone(2 - 4i)","clone(45 deg)","clone([1, 2; 3, 4])",'clone("hello world")'],seealso:[]}},function(t,e){t.exports={name:"format",category:"Utils",syntax:["format(value)","format(value, precision)"],description:"Format a value of any type as string.",examples:["format(2.3)","format(3 - 4i)","format([])","format(pi, 3)"],seealso:["print"]}},function(t,e){t.exports={name:"isNaN",category:"Utils",syntax:["isNaN(x)"],description:"Test whether a value is NaN (not a number)",examples:["isNaN(2)","isNaN(0 / 0)","isNaN(NaN)","isNaN(Infinity)"],seealso:["isNegative","isNumeric","isPositive","isZero"]}},function(t,e){t.exports={name:"isInteger",category:"Utils",syntax:["isInteger(x)"],description:"Test whether a value is an integer number.",examples:["isInteger(2)","isInteger(3.5)","isInteger([3, 0.5, -2])"],seealso:["isNegative","isNumeric","isPositive","isZero"]}},function(t,e){t.exports={name:"isNegative",category:"Utils",syntax:["isNegative(x)"],description:"Test whether a value is negative: smaller than zero.",examples:["isNegative(2)","isNegative(0)","isNegative(-4)","isNegative([3, 0.5, -2])"],seealso:["isInteger","isNumeric","isPositive","isZero"]}},function(t,e){t.exports={name:"isNumeric",category:"Utils",syntax:["isNumeric(x)"],description:"Test whether a value is a numeric value. Returns true when the input is a number, BigNumber, Fraction, or boolean.",examples:["isNumeric(2)","isNumeric(0)","isNumeric(bignumber(500))","isNumeric(fraction(0.125))",'isNumeric("3")',"isNumeric(2 + 3i)",'isNumeric([2.3, "foo", false])'],seealso:["isInteger","isZero","isNegative","isPositive","isNaN"]}},function(t,e){t.exports={name:"isPositive",category:"Utils",syntax:["isPositive(x)"],description:"Test whether a value is positive: larger than zero.",examples:["isPositive(2)","isPositive(0)","isPositive(-4)","isPositive([3, 0.5, -2])"],seealso:["isInteger","isNumeric","isNegative","isZero"]}},function(t,e){t.exports={name:"isPrime",category:"Utils",syntax:["isPrime(x)"],description:"Test whether a value is prime: has no divisors other than itself and one.",examples:["isPrime(3)","isPrime(-2)","isPrime([2, 17, 100])"],seealso:["isInteger","isNumeric","isNegative","isZero"]}},function(t,e){t.exports={name:"isZero",category:"Utils",syntax:["isZero(x)"],description:"Test whether a value is zero.",examples:["isZero(2)","isZero(0)","isZero(-4)","isZero([3, 0, -2, 0])"],seealso:["isInteger","isNumeric","isNegative","isPositive"]}},function(t,e){t.exports={name:"typeof",category:"Utils",syntax:["typeof(x)"],description:"Get the type of a variable.",examples:["typeof(3.5)","typeof(2 - 4i)","typeof(45 deg)",'typeof("hello world")'],seealso:[]}},function(t,e,n){t.exports=[n(278),n(301),n(302),n(303),n(304)]},function(t,e,n){"use strict";function r(t,e,r,o){var s=r(n(279));return o("compile",{string:function(t){return s(t).compile()},"Array | Matrix":function(t){return i(t,function(t){return s(t).compile()})}})}var i=n(19);e.name="compile",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,s){function a(e,n){if(1!=arguments.length&&2!=arguments.length)throw new i("parse",arguments.length,1,2);if(xt=n&&n.nodes?n.nodes:{},"string"==typeof e)return yt=e,w();if(Array.isArray(e)||e instanceof t.Matrix)return o(e,function(t){if("string"!=typeof t)throw new TypeError("String expected");return yt=t,w()});throw new TypeError("String or matrix expected")}function l(){Ct=0,wt=yt.charAt(0),St=0,Et=null}function h(){Ct++,wt=yt.charAt(Ct)}function c(){return yt.charAt(Ct+1)}function u(){return yt.charAt(Ct+2)}function d(){for(Mt=ft.NULL,bt="",vt="";x(wt);)h();if("#"==wt)for(;"\n"!=wt&&""!=wt;)vt+=wt,h();if(""==wt)return void(Mt=ft.DELIMITER);if("\n"==wt&&!St)return Mt=ft.DELIMITER,bt=wt,void h();var t=wt+c(),e=t+u();if(3==e.length&&gt[e])return Mt=ft.DELIMITER,bt=e,h(),h(),void h();if(2==t.length&&gt[t])return Mt=ft.DELIMITER,bt=t,h(),void h();if(gt[wt])return Mt=ft.DELIMITER,bt=wt,void h();if(!v(wt)){if(m()){for(;m()||C(wt);)bt+=wt,
h();return void(Mt=mt.hasOwnProperty(bt)?ft.DELIMITER:ft.SYMBOL)}for(Mt=ft.UNKNOWN;""!=wt;)bt+=wt,h();throw Q('Syntax error in part "'+bt+'"')}if(Mt=ft.NUMBER,"."==wt)bt+=wt,h(),C(wt)||(Mt=ft.DELIMITER);else{for(;C(wt);)bt+=wt,h();y(wt,c())&&(bt+=wt,h())}for(;C(wt);)bt+=wt,h();if(t=c(),"E"==wt||"e"==wt)if(C(t)||"-"==t||"+"==t){if(bt+=wt,h(),"+"!=wt&&"-"!=wt||(bt+=wt,h()),!C(wt))throw Q('Digit expected, got "'+wt+'"');for(;C(wt);)bt+=wt,h();if(y(wt,c()))throw Q('Digit expected, got "'+wt+'"')}else if("."==t)throw h(),Q('Digit expected, got "'+wt+'"')}function p(){do d();while("\n"==bt)}function f(){St++}function g(){St--}function m(){var t=yt.charAt(Ct-1),e=yt.charAt(Ct+1),n=function(t){return/^[a-zA-Z_\u00C0-\u02AF\u0370-\u03FF]$/.test(t)},r=function(t,e){return/^[\uD835]$/.test(t)&&/^[\uDC00-\uDFFF]$/.test(e)&&/^[^\uDC55\uDC9D\uDCA0\uDCA1\uDCA3\uDCA4\uDCA7\uDCA8\uDCAD\uDCBA\uDCBC\uDCC4\uDD06\uDD0B\uDD0C\uDD15\uDD1D\uDD3A\uDD3F\uDD45\uDD47-\uDD49\uDD51\uDEA6\uDEA7\uDFCC\uDFCD]$/.test(e)};return n(wt)||r(wt,e)||r(t,wt)}function x(t){return" "==t||"\t"==t||"\n"==t&&St>0}function y(t,e){return"."==t&&!gt[t+e]}function v(t){return t>="0"&&"9">=t||"."==t}function C(t){return t>="0"&&"9">=t}function w(){l(),d();var t=b();if(""!=bt)throw Mt==ft.DELIMITER?K("Unexpected operator "+bt):Q('Unexpected part "'+bt+'"');return t}function b(){var t,e,n=[];if(""==bt)return t=new ot("undefined","undefined"),t.comment=vt,t;for("\n"!=bt&&";"!=bt&&(t=M(),t.comment=vt);"\n"==bt||";"==bt;)0==n.length&&t&&(e=";"!=bt,n.push({node:t,visible:e})),d(),"\n"!=bt&&";"!=bt&&""!=bt&&(t=M(),t.comment=vt,e=";"!=bt,n.push({node:t,visible:e}));return n.length>0?new rt(n):t}function M(){var t,e,n,r,i=S();if("="==bt){if(i&&i.isSymbolNode)return t=i.name,p(),n=M(),new nt(new pt(t),n);if(i&&i.isAccessorNode)return p(),n=M(),new nt(i.object,i.index,n);if(i&&i.isFunctionNode&&(r=!0,e=[],t=i.name,i.args.forEach(function(t,n){t&&t.isSymbolNode?e[n]=t.name:r=!1}),r))return p(),n=M(),new st(t,e,n);throw Q("Invalid left hand side of assignment operator =")}return i}function S(){for(var t=E();"?"==bt;){var e=Et;Et=St,p();var n=t,r=M();if(":"!=bt)throw Q("False part of conditional expression expected");Et=null,p();var i=M();t=new it(n,r,i),Et=e}return t}function E(){for(var t=I();"or"==bt;)p(),t=new ht("or","or",[t,I()]);return t}function I(){for(var t=N();"xor"==bt;)p(),t=new ht("xor","xor",[t,N()]);return t}function N(){for(var t=O();"and"==bt;)p(),t=new ht("and","and",[t,O()]);return t}function O(){for(var t=T();"|"==bt;)p(),t=new ht("|","bitOr",[t,T()]);return t}function T(){for(var t=_();"^|"==bt;)p(),t=new ht("^|","bitXor",[t,_()]);return t}function _(){for(var t=P();"&"==bt;)p(),t=new ht("&","bitAnd",[t,P()]);return t}function P(){var t,e,n,r,i;for(t=A(),e={"==":"equal","!=":"unequal","<":"smaller",">":"larger","<=":"smallerEq",">=":"largerEq"};bt in e;)n=bt,r=e[n],p(),i=[t,A()],t=new ht(n,r,i);return t}function A(){var t,e,n,r,i;for(t=k(),e={"<<":"leftShift",">>":"rightArithShift",">>>":"rightLogShift"};bt in e;)n=bt,r=e[n],p(),i=[t,k()],t=new ht(n,r,i);return t}function k(){var t,e,n,r,i;for(t=R(),e={to:"to","in":"to"};bt in e;)n=bt,r=e[n],p(),"in"===n&&""===bt?t=new ht("*","multiply",[t,new pt("in")],(!0)):(i=[t,R()],t=new ht(n,r,i));return t}function R(){var t,e=[];if(t=":"==bt?new ot("1","number"):z(),":"==bt&&Et!==St){for(e.push(t);":"==bt&&e.length<3;)p(),")"==bt||"]"==bt||","==bt||""==bt?e.push(new pt("end")):e.push(z());t=3==e.length?new dt(e[0],e[2],e[1]):new dt(e[0],e[1])}return t}function z(){var t,e,n,r,i;for(t=B(),e={"+":"add","-":"subtract"};bt in e;)n=bt,r=e[n],p(),i=[t,B()],t=new ht(n,r,i);return t}function B(){var t,e,n,r,i;for(t=L(),e=t,n={"*":"multiply",".*":"dotMultiply","/":"divide","./":"dotDivide","%":"mod",mod:"mod"};;)if(bt in n)r=bt,i=n[r],p(),e=L(),t=new ht(r,i,[t,e]);else{if(!(Mt==ft.SYMBOL||"in"==bt&&t&&t.isConstantNode||Mt==ft.NUMBER&&!e.isConstantNode||"("==bt))break;e=L(),t=new ht("*","multiply",[t,e],(!0))}return t}function L(){var t,e,n={"-":"unaryMinus","+":"unaryPlus","~":"bitNot",not:"not"}[bt];return n?(t=bt,p(),e=[L()],new ht(t,n,e)):D()}function D(){var t,e,n,r;return t=W(),"^"!=bt&&".^"!=bt||(e=bt,n="^"==e?"pow":"dotPow",p(),r=[t,L()],t=new ht(e,n,r)),t}function W(){var t,e,n,r,i;for(t=F(),e={"!":"factorial","'":"transpose"};bt in e;)n=bt,r=e[n],d(),i=[t],t=new ht(n,r,i),t=q(t);return t}function F(){var t,e=[];if(Mt==ft.SYMBOL&&xt[bt]){if(t=xt[bt],d(),"("==bt){if(e=[],f(),d(),")"!=bt)for(e.push(M());","==bt;)d(),e.push(M());if(")"!=bt)throw Q("Parenthesis ) expected");g(),d()}return new t(e)}return V()}function V(){var t,e;return Mt==ft.SYMBOL||Mt==ft.DELIMITER&&bt in mt?(e=bt,d(),t=new pt(e),t=q(t)):H()}function q(t,e){for(var n;!("("!=bt&&"["!=bt&&"."!=bt||e&&-1===e.indexOf(bt));)if(n=[],"("==bt){if(!t.isSymbolNode&&!t.isAccessorNode)return t;if(f(),d(),")"!=bt)for(n.push(M());","==bt;)d(),n.push(M());if(")"!=bt)throw Q("Parenthesis ) expected");g(),d(),t=new ut(t,n)}else if("["==bt){if(f(),d(),"]"!=bt)for(n.push(M());","==bt;)d(),n.push(M());if("]"!=bt)throw Q("Parenthesis ] expected");g(),d(),t=new tt(t,new at(n))}else{if(d(),Mt!=ft.SYMBOL)throw Q("Property name expected after dot");n.push(new ot(bt)),d();var r=!0;t=new tt(t,new at(n,r))}return t}function H(){var t,e;return'"'==bt?(e=U(),t=new ot(e,"string"),t=q(t)):j()}function U(){for(var t="";""!=wt&&'"'!=wt;)"\\"==wt&&(t+=wt,h()),t+=wt,h();if(d(),'"'!=bt)throw Q('End of string " expected');return d(),t}function j(){var t,e,n,r;if("["==bt){if(f(),d(),"]"!=bt){var i=$();if(";"==bt){for(n=1,e=[i];";"==bt;)d(),e[n]=$(),n++;if("]"!=bt)throw Q("End of matrix ] expected");g(),d(),r=e[0].items.length;for(var o=1;n>o;o++)if(e[o].items.length!=r)throw K("Column dimensions mismatch ("+e[o].items.length+" != "+r+")");t=new et(e)}else{if("]"!=bt)throw Q("End of matrix ] expected");g(),d(),t=i}}else g(),d(),t=new et([]);return q(t)}return G()}function $(){for(var t=[M()],e=1;","==bt;)d(),t[e]=M(),e++;return new et(t)}function G(){if("{"==bt){var t,e={};do if(d(),"}"!=bt){if('"'==bt)t=U();else{if(Mt!=ft.SYMBOL)throw Q("Symbol or string expected as object key");t=bt,d()}if(":"!=bt)throw Q("Colon : expected after object key");d(),e[t]=M()}while(","==bt);if("}"!=bt)throw Q("Comma , or bracket } expected after object value");d();var n=new lt(e);return n=q(n)}return Y()}function Y(){var t;return Mt==ft.NUMBER?(t=bt,d(),new ot(t,"number")):J()}function J(){var t;if("("==bt){if(f(),d(),t=M(),")"!=bt)throw Q("Parenthesis ) expected");return g(),d(),t=new ct(t),t=q(t)}return X()}function X(){throw Q(""==bt?"Unexpected end of expression":"Value expected")}function Z(){return Ct-bt.length+1}function Q(t){var e=Z(),n=new SyntaxError(t+" (char "+e+")");return n["char"]=e,n}function K(t){var e=Z(),n=new SyntaxError(t+" (char "+e+")");return n["char"]=e,n}var tt=r(n(280)),et=r(n(286)),nt=r(n(287)),rt=r(n(290)),it=r(n(291)),ot=r(n(292)),st=r(n(293)),at=r(n(294)),lt=r(n(297)),ht=r(n(298)),ct=r(n(300)),ut=r(n(299)),dt=r(n(295)),pt=r(n(296)),ft={NULL:0,DELIMITER:1,NUMBER:2,SYMBOL:3,UNKNOWN:4},gt={",":!0,"(":!0,")":!0,"[":!0,"]":!0,"{":!0,"}":!0,'"':!0,";":!0,"+":!0,"-":!0,"*":!0,".*":!0,"/":!0,"./":!0,"%":!0,"^":!0,".^":!0,"~":!0,"!":!0,"&":!0,"|":!0,"^|":!0,"'":!0,"=":!0,":":!0,"?":!0,"==":!0,"!=":!0,"<":!0,">":!0,"<=":!0,">=":!0,"<<":!0,">>":!0,">>>":!0},mt={mod:!0,to:!0,"in":!0,and:!0,xor:!0,or:!0,not:!0},xt={},yt="",vt="",Ct=0,wt="",bt="",Mt=ft.NULL,St=0,Et=null;return a}var i=n(11),o=n(19);e.name="parse",e.path="expression",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,i){function o(t,e){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");if(!t||!t.isNode)throw new TypeError('Node expected for parameter "object"');if(!e||!e.isIndexNode)throw new TypeError('IndexNode expected for parameter "index"');this.object=t||null,this.index=e,Object.defineProperty(this,"name",{get:function(){return this.index?this.index.isObjectProperty()?this.index.getObjectProperty():"":this.object.name||""}.bind(this),set:function(){throw new Error("Cannot assign a new name, name is read-only")}})}function s(t){return!(t.isAccessorNode||t.isArrayNode||t.isConstantNode||t.isFunctionNode||t.isObjectNode||t.isParenthesisNode||t.isSymbolNode)}var a=r(n(281)),l=r(n(283));return o.prototype=new a,o.prototype.type="AccessorNode",o.prototype.isAccessorNode=!0,o.prototype._compile=function(t,e){t.access=l;var n=this.object._compile(t,e),r=this.index._compile(t,e);return this.index.isObjectProperty()?n+'["'+this.index.getObjectProperty()+'"]':this.index.needsSize()?"(function () {  var object = "+n+";  var size = math.size(object).valueOf();  return access(object, "+r+");})()":"access("+n+", "+r+")"},o.prototype.forEach=function(t){t(this.object,"object",this),t(this.index,"index",this)},o.prototype.map=function(t){return new o(this._ifNode(t(this.object,"object",this)),this._ifNode(t(this.index,"index",this)))},o.prototype.clone=function(){return new o(this.object,this.index)},o.prototype._toString=function(t){var e=this.object.toString(t);return s(this.object)&&(e="("+e+")"),e+this.index.toString(t)},o.prototype._toTex=function(t){var e=this.object.toTex(t);return s(this.object)&&(e="\\left("+e+"\\right)"),e+this.index.toTex(t)},o}e.name="AccessorNode",e.path="expression.node",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r,o){function s(){if(!(this instanceof s))throw new SyntaxError("Constructor must be called with the new operator")}function a(t){for(var e in t)if(t.hasOwnProperty(e)&&e in i)throw new Error('Scope contains an illegal symbol, "'+e+'" is a reserved keyword')}return s.prototype.eval=function(t){return this.compile().eval(t)},s.prototype.type="Node",s.prototype.isNode=!0,s.prototype.comment="",s.prototype.compile=function(){if(arguments.length>0)throw new Error("Calling compile(math) is deprecated. Call the function as compile() instead.");var t={math:o.expression.transform,args:{},_validateScope:a},e={},n=this._compile(t,e),r=Object.keys(t).map(function(t){return"    var "+t+' = defs["'+t+'"];'}),i=r.join(" ")+'return {  "eval": function (scope) {    if (scope) _validateScope(scope);    scope = scope || {};    return '+n+";  }};",s=new Function("defs",i);return s(t)},s.prototype._compile=function(t,e){throw new Error("Cannot compile a Node interface")},s.prototype.forEach=function(t){throw new Error("Cannot run forEach on a Node interface")},s.prototype.map=function(t){throw new Error("Cannot run map on a Node interface")},s.prototype._ifNode=function(t){if(!t||!t.isNode)throw new TypeError("Callback function must return a Node");return t},s.prototype.traverse=function(t){function e(t,n){t.forEach(function(t,r,i){n(t,r,i),e(t,n)})}t(this,null,null),e(this,t)},s.prototype.transform=function(t){function e(t,n){return t.map(function(t,r,i){var o=n(t,r,i);return e(o,n)})}var n=t(this,null,null);return e(n,t)},s.prototype.filter=function(t){var e=[];return this.traverse(function(n,r,i){t(n,r,i)&&e.push(n)}),e},s.prototype.find=function(){throw new Error("Function Node.find is deprecated. Use Node.filter instead.")},s.prototype.match=function(){throw new Error("Function Node.match is deprecated. See functions Node.filter, Node.transform, Node.traverse.")},s.prototype.clone=function(){throw new Error("Cannot clone a Node interface")},s.prototype.toString=function(t){var e;if(t&&"object"==typeof t)switch(typeof t.handler){case"object":case"undefined":break;case"function":e=t.handler(this,t);break;default:throw new TypeError("Object or function expected as callback")}return"undefined"!=typeof e?e:this._toString(t)},s.prototype._toString=function(){throw new Error("_toString not implemented for "+this.type)},s.prototype.toTex=function(t){var e;if(t&&"object"==typeof t)switch(typeof t.handler){case"object":case"undefined":break;case"function":e=t.handler(this,t);break;default:throw new TypeError("Object or function expected as callback")}return"undefined"!=typeof e?e:this._toTex(t)},s.prototype._toTex=function(t){throw new Error("_toTex not implemented for "+this.type)},s.prototype.getIdentifier=function(){return this.type},s.prototype.getContent=function(){return this},s}var i=n(282);n(3).extend,e.name="Node",e.path="expression.node",e.math=!0,e.factory=r},function(t,e){"use strict";t.exports={end:!0}},function(t,e,n){"use strict";function r(t,e,r,o){var s=r(n(285)),a=r(n(52));return function(t,e){try{if(Array.isArray(t))return a(t).subset(e).valueOf();if(t&&"function"==typeof t.subset)return t.subset(e);if("string"==typeof t)return s(t,e);if("object"==typeof t){if(!e.isObjectProperty())throw TypeError("Cannot apply a numeric index as object property");return t[e.getObjectProperty()]}throw new TypeError("Cannot apply index: unsupported type of object")}catch(n){throw i(n)}}}var i=n(284).transform;e.factory=r},function(t,e,n){var r=n(43);e.transform=function(t){return t&&t.isIndexError?new r(t.index+1,t.min+1,void 0!==t.max?t.max+1:void 0):t}},function(t,e,n){"use strict";function r(t,e,r,h){function c(t,e){if(!e||e.isIndex!==!0)throw new TypeError("Index expected");if(1!=e.size().length)throw new l(e.size().length,1);var n=t.length;a(e.min()[0],n),a(e.max()[0],n);var r=e.dimension(0),i="";return r.forEach(function(e){i+=t.charAt(e)}),i}function u(t,e,n,r){if(!e||e.isIndex!==!0)throw new TypeError("Index expected");if(1!=e.size().length)throw new l(e.size().length,1);if(void 0!==r){if("string"!=typeof r||1!==r.length)throw new TypeError("Single character expected as defaultValue")}else r=" ";var i=e.dimension(0),o=i.size()[0];if(o!=n.length)throw new l(i.size()[0],n.length);var s=t.length;a(e.min()[0]),a(e.max()[0]);for(var h=[],c=0;s>c;c++)h[c]=t.charAt(c);if(i.forEach(function(t,e){h[t]=n.charAt(e[0])}),h.length>s)for(c=s-1,o=h.length;o>c;c++)h[c]||(h[c]=r);return h.join("")}var d=r(n(52)),p=h("subset",{"Array, Index":function(t,e){var n=d(t),r=n.subset(e);return r&&r.valueOf()},"Matrix, Index":function(t,e){return t.subset(e)},"Object, Index":i,"string, Index":c,"Array, Index, any":function(t,e,n){return d(s(t)).subset(e,n,void 0).valueOf()},"Array, Index, any, any":function(t,e,n,r){return d(s(t)).subset(e,n,r).valueOf()},"Matrix, Index, any":function(t,e,n){return t.clone().subset(e,n)},"Matrix, Index, any, any":function(t,e,n,r){return t.clone().subset(e,n,r)},"string, Index, string":u,"string, Index, string, string":u,"Object, Index, any":o});return p.toTex=void 0,p}function i(t,e){if(1!==e.size().length)throw new l(e.size(),1);var n=e.dimension(0);if("string"!=typeof n)throw new TypeError("String expected as index to retrieve an object property");return t[n]}function o(t,e,n){if(1!==e.size().length)throw new l(e.size(),1);var r=e.dimension(0);if("string"!=typeof r)throw new TypeError("String expected as index to retrieve an object property");var i=s(t);return i[r]=n,i}var s=n(3).clone,a=n(40).validateIndex,l=n(42);e.name="subset",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,i){function o(t){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");if(this.items=t||[],!Array.isArray(this.items)||!this.items.every(function(t){return t&&t.isNode}))throw new TypeError("Array containing Nodes expected");var e=function(){throw new Error("Property `ArrayNode.nodes` is deprecated, use `ArrayNode.items` instead")};Object.defineProperty(this,"nodes",{get:e,set:e})}var s=r(n(281));return o.prototype=new s,o.prototype.type="ArrayNode",o.prototype.isArrayNode=!0,o.prototype._compile=function(t,e){var n="Array"!==t.math.config().matrix,r=this.items.map(function(n){return n._compile(t,e)});return(n?"math.matrix([":"[")+r.join(",")+(n?"])":"]")},o.prototype.forEach=function(t){for(var e=0;e<this.items.length;e++){var n=this.items[e];t(n,"items["+e+"]",this)}},o.prototype.map=function(t){for(var e=[],n=0;n<this.items.length;n++)e[n]=this._ifNode(t(this.items[n],"items["+n+"]",this));return new o(e)},o.prototype.clone=function(){return new o(this.items.slice(0))},o.prototype._toString=function(t){var e=this.items.map(function(e){return e.toString(t)});return"["+e.join(", ")+"]"},o.prototype._toTex=function(t){var e="\\begin{bmatrix}";return this.items.forEach(function(n){e+=n.items?n.items.map(function(e){return e.toTex(t)}).join("&"):n.toTex(t),e+="\\\\"}),e+="\\end{bmatrix}"},o}e.name="ArrayNode",e.path="expression.node",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,i){function o(t,e,n){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");if(this.object=t,this.index=n?e:null,this.value=n?n:e,!t||!t.isSymbolNode&&!t.isAccessorNode)throw new TypeError('SymbolNode or AccessorNode expected as "object"');if(t&&t.isSymbolNode&&"end"===t.name)throw new Error('Cannot assign to symbol "end"');if(this.index&&!this.index.isIndexNode)throw new TypeError('IndexNode expected as "index"');if(!this.value||!this.value.isNode)throw new TypeError('Node expected as "value"');Object.defineProperty(this,"name",{get:function(){return this.index?this.index.isObjectProperty()?this.index.getObjectProperty():"":this.object.name||""}.bind(this),set:function(){throw new Error("Cannot assign a new name, name is read-only")}})}function s(t,e){e||(e="keep");var n=c.getPrecedence(t,e),r=c.getPrecedence(t.value,e);return"all"===e||null!==r&&n>=r}var a=r(n(281)),l=(r(n(286)),r(n(52)),r(n(288))),h=r(n(283)),c=(n(282),n(289));return o.prototype=new a,o.prototype.type="AssignmentNode",o.prototype.isAssignmentNode=!0,o.prototype._compile=function(t,e){t.assign=l,t.access=h;var n,r=this.object._compile(t,e),i=this.index?this.index._compile(t,e):null,o=this.value._compile(t,e);if(this.index){if(this.index.isObjectProperty())return r+'["'+this.index.getObjectProperty()+'"] = '+o;if(this.object.isSymbolNode)return n=this.index.needsSize()?"var size = math.size(object).valueOf();":"","(function () {  var object = "+r+";  var value = "+o+";  "+n+'  scope["'+this.object.name+'"] = assign(object, '+i+", value);  return value;})()";n=this.index.needsSize()?"var size = math.size(object).valueOf();":"";var s=this.object.object._compile(t,e);if(this.object.index.isObjectProperty()){var a='["'+this.object.index.getObjectProperty()+'"]';return"(function () {  var parent = "+s+";  var object = parent"+a+";  var value = "+o+";"+n+"  parent"+a+" = assign(object, "+i+", value);  return value;})()"}var c=this.object.index.needsSize()?"var size = math.size(parent).valueOf();":"",u=this.object.index._compile(t,e);return"(function () {  var parent = "+s+";  "+c+"  var parentIndex = "+u+";  var object = access(parent, parentIndex);  var value = "+o+";  "+n+"  assign(parent, parentIndex, assign(object, "+i+", value));  return value;})()"}if(!this.object.isSymbolNode)throw new TypeError("SymbolNode expected as object");return'scope["'+this.object.name+'"] = '+o},o.prototype.forEach=function(t){t(this.object,"object",this),this.index&&t(this.index,"index",this),t(this.value,"value",this)},o.prototype.map=function(t){var e=this._ifNode(t(this.object,"object",this)),n=this.index?this._ifNode(t(this.index,"index",this)):null,r=this._ifNode(t(this.value,"value",this));return new o(e,n,r)},o.prototype.clone=function(){return new o(this.object,this.index,this.value)},o.prototype._toString=function(t){var e=this.object.toString(t),n=this.index?this.index.toString(t):"",r=this.value.toString(t);return s(this,t&&t.parenthesis)&&(r="("+r+")"),e+n+" = "+r},o.prototype._toTex=function(t){var e=this.object.toTex(t),n=this.index?this.index.toTex(t):"",r=this.value.toTex(t);return s(this,t&&t.parenthesis)&&(r="\\left("+r+"\\right)"),e+n+":="+r},o}n(32),e.name="AssignmentNode",e.path="expression.node",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,o){var s=r(n(285)),a=r(n(52));return function(t,e,n){try{if(Array.isArray(t))return a(t).subset(e,n).valueOf();if(t&&"function"==typeof t.subset)return t.subset(e,n);if("string"==typeof t)return s(t,e,n);if("object"==typeof t){if(!e.isObjectProperty())throw TypeError("Cannot apply a numeric index as object property");return t[e.getObjectProperty()]=n,t}throw new TypeError("Cannot apply index: unsupported type of object")}catch(r){throw i(r)}}}var i=n(284).transform;e.factory=r},function(t,e){"use strict";function n(t,e){var n=t;"keep"!==e&&(n=t.getContent());for(var r=n.getIdentifier(),i=0;i<o.length;i++)if(r in o[i])return i;return null}function r(t,e){var r=t;"keep"!==e&&(r=t.getContent());var i=r.getIdentifier(),s=n(r,e);if(null===s)return null;var a=o[s][i];if(a.hasOwnProperty("associativity")){if("left"===a.associativity)return"left";if("right"===a.associativity)return"right";throw Error("'"+i+"' has the invalid associativity '"+a.associativity+"'.")}return null}function i(t,e,r){var i=t,s=e;if("keep"!==r)var i=t.getContent(),s=e.getContent();var a=i.getIdentifier(),l=s.getIdentifier(),h=n(i,r);if(null===h)return null;var c=o[h][a];if(c.hasOwnProperty("associativeWith")&&c.associativeWith instanceof Array){for(var u=0;u<c.associativeWith.length;u++)if(c.associativeWith[u]===l)return!0;return!1}return null}var o=[{AssignmentNode:{},FunctionAssignmentNode:{}},{ConditionalNode:{latexLeftParens:!1,latexRightParens:!1,latexParens:!1}},{"OperatorNode:or":{associativity:"left",associativeWith:[]}},{"OperatorNode:xor":{associativity:"left",associativeWith:[]}},{"OperatorNode:and":{associativity:"left",associativeWith:[]}},{"OperatorNode:bitOr":{associativity:"left",associativeWith:[]}},{"OperatorNode:bitXor":{associativity:"left",associativeWith:[]}},{"OperatorNode:bitAnd":{associativity:"left",associativeWith:[]}},{"OperatorNode:equal":{associativity:"left",associativeWith:[]},"OperatorNode:unequal":{associativity:"left",associativeWith:[]},"OperatorNode:smaller":{associativity:"left",associativeWith:[]},"OperatorNode:larger":{associativity:"left",associativeWith:[]},"OperatorNode:smallerEq":{associativity:"left",associativeWith:[]},"OperatorNode:largerEq":{associativity:"left",associativeWith:[]}},{"OperatorNode:leftShift":{associativity:"left",associativeWith:[]},"OperatorNode:rightArithShift":{associativity:"left",associativeWith:[]},"OperatorNode:rightLogShift":{associativity:"left",associativeWith:[]}},{"OperatorNode:to":{associativity:"left",associativeWith:[]}},{RangeNode:{}},{"OperatorNode:add":{associativity:"left",associativeWith:["OperatorNode:add","OperatorNode:subtract"]},"OperatorNode:subtract":{associativity:"left",associativeWith:[]}},{"OperatorNode:multiply":{associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","Operator:dotMultiply","Operator:dotDivide"]},"OperatorNode:divide":{associativity:"left",associativeWith:[],latexLeftParens:!1,latexRightParens:!1,latexParens:!1},"OperatorNode:dotMultiply":{associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","OperatorNode:dotMultiply","OperatorNode:doDivide"]},"OperatorNode:dotDivide":{associativity:"left",associativeWith:[]},"OperatorNode:mod":{associativity:"left",associativeWith:[]}},{"OperatorNode:unaryPlus":{associativity:"right"},"OperatorNode:unaryMinus":{associativity:"right"},"OperatorNode:bitNot":{associativity:"right"},"OperatorNode:not":{associativity:"right"}},{"OperatorNode:pow":{associativity:"right",associativeWith:[],latexRightParens:!1},"OperatorNode:dotPow":{associativity:"right",associativeWith:[]}},{"OperatorNode:factorial":{associativity:"left"}},{"OperatorNode:transpose":{associativity:"left"}}];t.exports.properties=o,t.exports.getPrecedence=n,t.exports.getAssociativity=r,t.exports.isAssociativeWith=i},function(t,e,n){"use strict";function r(t,e,r,i){function o(t){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");if(!Array.isArray(t))throw new Error("Array expected");this.blocks=t.map(function(t){var e=t&&t.node,n=!t||void 0===t.visible||t.visible;if(!e||!e.isNode)throw new TypeError('Property "node" must be a Node');if("boolean"!=typeof n)throw new TypeError('Property "visible" must be a boolean');return{node:e,visible:n}})}var s=r(n(281)),a=r(n(72));return o.prototype=new s,o.prototype.type="BlockNode",o.prototype.isBlockNode=!0,o.prototype._compile=function(t,e){t.ResultSet=a;var n=this.blocks.map(function(n){var r=n.node._compile(t,e);return n.visible?"results.push("+r+");":r+";"});return"(function () {var results = [];"+n.join("")+"return new ResultSet(results);})()"},o.prototype.forEach=function(t){for(var e=0;e<this.blocks.length;e++)t(this.blocks[e].node,"blocks["+e+"].node",this)},o.prototype.map=function(t){for(var e=[],n=0;n<this.blocks.length;n++){var r=this.blocks[n],i=this._ifNode(t(r.node,"blocks["+n+"].node",this));e[n]={node:i,visible:r.visible}}return new o(e)},o.prototype.clone=function(){var t=this.blocks.map(function(t){return{node:t.node,visible:t.visible}});return new o(t)},o.prototype._toString=function(t){return this.blocks.map(function(e){return e.node.toString(t)+(e.visible?"":";")}).join("\n")},o.prototype._toTex=function(t){return this.blocks.map(function(e){return e.node.toTex(t)+(e.visible?"":";")}).join("\\;\\;\n")},o}e.name="BlockNode",e.path="expression.node",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,o){function s(t,e,n){if(!(this instanceof s))throw new SyntaxError("Constructor must be called with the new operator");if(!t||!t.isNode)throw new TypeError("Parameter condition must be a Node");if(!e||!e.isNode)throw new TypeError("Parameter trueExpr must be a Node");if(!n||!n.isNode)throw new TypeError("Parameter falseExpr must be a Node");this.condition=t,this.trueExpr=e,this.falseExpr=n}var a=r(n(281));return s.prototype=new a,s.prototype.type="ConditionalNode",s.prototype.isConditionalNode=!0,s.prototype._compile=function(t,e){return t.testCondition=function(e){if("number"==typeof e||"boolean"==typeof e||"string"==typeof e)return!!e;if(e){if(e.isBigNumber===!0)return!e.isZero();if(e.isComplex===!0)return!(!e.re&&!e.im);if(e.isUnit===!0)return!!e.value}if(null===e||void 0===e)return!1;throw new TypeError('Unsupported type of condition "'+t.math["typeof"](e)+'"')},"testCondition("+this.condition._compile(t,e)+") ? ( "+this.trueExpr._compile(t,e)+") : ( "+this.falseExpr._compile(t,e)+")"},s.prototype.forEach=function(t){t(this.condition,"condition",this),t(this.trueExpr,"trueExpr",this),t(this.falseExpr,"falseExpr",this)},s.prototype.map=function(t){return new s(this._ifNode(t(this.condition,"condition",this)),this._ifNode(t(this.trueExpr,"trueExpr",this)),this._ifNode(t(this.falseExpr,"falseExpr",this)))},s.prototype.clone=function(){return new s(this.condition,this.trueExpr,this.falseExpr)},s.prototype._toString=function(t){var e=t&&t.parenthesis?t.parenthesis:"keep",n=i.getPrecedence(this,e),r=this.condition.toString(t),o=i.getPrecedence(this.condition,e);("all"===e||"OperatorNode"===this.condition.type||null!==o&&n>=o)&&(r="("+r+")");var s=this.trueExpr.toString(t),a=i.getPrecedence(this.trueExpr,e);("all"===e||"OperatorNode"===this.trueExpr.type||null!==a&&n>=a)&&(s="("+s+")");var l=this.falseExpr.toString(t),h=i.getPrecedence(this.falseExpr,e);return("all"===e||"OperatorNode"===this.falseExpr.type||null!==h&&n>=h)&&(l="("+l+")"),r+" ? "+s+" : "+l},s.prototype._toTex=function(t){return"\\begin{cases} {"+this.trueExpr.toTex(t)+"}, &\\quad{\\text{if }\\;"+this.condition.toTex(t)+"}\\\\{"+this.falseExpr.toTex(t)+"}, &\\quad{\\text{otherwise}}\\end{cases}"},s}var i=(n(32),n(289));e.name="ConditionalNode",e.path="expression.node",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,o){function s(t,e){if(!(this instanceof s))throw new SyntaxError("Constructor must be called with the new operator");if(e){if("string"!=typeof e)throw new TypeError('String expected for parameter "valueType"');if("string"!=typeof t)throw new TypeError('String expected for parameter "value"');this.value=t,this.valueType=e}else this.value=t+"",this.valueType=i(t);if(!l[this.valueType])throw new TypeError('Unsupported type of value "'+this.valueType+'"')}var a=r(n(281)),l={number:!0,string:!0,"boolean":!0,undefined:!0,"null":!0};return s.prototype=new a,s.prototype.type="ConstantNode",s.prototype.isConstantNode=!0,s.prototype._compile=function(t,e){switch(this.valueType){case"number":var n=t.math.config().number;return"BigNumber"===n?'math.bignumber("'+this.value+'")':"Fraction"===n?'math.fraction("'+this.value+'")':this.value.replace(/^(0*)[0-9]/,function(t,e){return t.substring(e.length)});case"string":return'"'+this.value+'"';case"boolean":return this.value;case"undefined":return this.value;case"null":return this.value;default:throw new TypeError('Unsupported type of constant "'+this.valueType+'"')}},s.prototype.forEach=function(t){},s.prototype.map=function(t){return this.clone()},s.prototype.clone=function(){return new s(this.value,this.valueType)},s.prototype._toString=function(t){switch(this.valueType){case"string":return'"'+this.value+'"';default:return this.value}},s.prototype._toTex=function(t){var e,n=this.value;switch(this.valueType){case"string":return'\\mathtt{"'+n+'"}';case"number":return e=n.toLowerCase().indexOf("e"),-1!==e?n.substring(0,e)+"\\cdot10^{"+n.substring(e+1)+"}":n;default:return n}},s}var i=n(41).type;e.name="ConstantNode",e.path="expression.node",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,a){function l(t,e,n){if(!(this instanceof l))throw new SyntaxError("Constructor must be called with the new operator");if("string"!=typeof t)throw new TypeError('String expected for parameter "name"');if(!Array.isArray(e))throw new TypeError('Array containing strings or objects expected for parameter "params"');if(!n||!n.isNode)throw new TypeError('Node expected for parameter "expr"');if(t in i)throw new Error('Illegal function name, "'+t+'" is a reserved keyword');this.name=t,this.params=e.map(function(t){return t&&t.name||t}),this.types=e.map(function(t){return t&&t.type||"any"}),this.expr=n}function h(t,e){var n=s.getPrecedence(t,e),r=s.getPrecedence(t.expr,e);return"all"===e||null!==r&&n>=r}var c=r(n(281));return l.prototype=new c,l.prototype.type="FunctionAssignmentNode",l.prototype.isFunctionAssignmentNode=!0,l.prototype._compile=function(t,e){t.typed=a;var n=Object.create(e);this.params.forEach(function(t){n[t]=!0});var r=this.expr._compile(t,n);return'scope["'+this.name+'"] =   (function () {    var fn = typed("'+this.name+'", {      "'+this.types.join(",")+'": function ('+this.params.join(",")+") {        return "+r+'      }    });    fn.syntax = "'+this.name+"("+this.params.join(", ")+')";    return fn;  })()'},l.prototype.forEach=function(t){t(this.expr,"expr",this)},l.prototype.map=function(t){var e=this._ifNode(t(this.expr,"expr",this));return new l(this.name,this.params.slice(0),e)},l.prototype.clone=function(){return new l(this.name,this.params.slice(0),this.expr)},l.prototype._toString=function(t){var e=t&&t.parenthesis?t.parenthesis:"keep",n=this.expr.toString(t);return h(this,e)&&(n="("+n+")"),"function "+this.name+"("+this.params.join(", ")+") = "+n},l.prototype._toTex=function(t){var e=t&&t.parenthesis?t.parenthesis:"keep",n=this.expr.toTex(t);return h(this,e)&&(n="\\left("+n+"\\right)"),"\\mathrm{"+this.name+"}\\left("+this.params.map(o.toSymbol).join(",")+"\\right):="+n},l}var i=n(282),o=n(32),s=n(289);e.name="FunctionAssignmentNode",e.path="expression.node",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,i){function o(t,e){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");if(this.dimensions=t,this.dotNotation=e||!1,!l(t)||!t.every(function(t){return t&&t.isNode}))throw new TypeError('Array containing Nodes expected for parameter "dimensions"');if(this.dotNotation&&!this.isObjectProperty())throw new Error("dotNotation only applicable for object properties");var n=function(){throw new Error("Property `IndexNode.object` is deprecated, use `IndexNode.fn` instead")};Object.defineProperty(this,"object",{get:n,set:n})}var s=r(n(281)),a=(r(n(295)),r(n(296)),r(n(67))),l=Array.isArray;return o.prototype=new s,o.prototype.type="IndexNode",
o.prototype.isIndexNode=!0,o.prototype._compile=function(t,e){var n=Object.create(e);t.range=function(t,e,n){return new a(t&&t.isBigNumber===!0?t.toNumber():t,e&&e.isBigNumber===!0?e.toNumber():e,n&&n.isBigNumber===!0?n.toNumber():n)};var r=this.dimensions.map(function(e,r){return e&&e.isRangeNode?e.needsEnd()?(n.end=!0,"(function () {var end = size["+r+"]; return range("+e.start._compile(t,n)+", "+e.end._compile(t,n)+", "+(e.step?e.step._compile(t,n):"1")+"); })()"):"range("+e.start._compile(t,n)+", "+e.end._compile(t,n)+", "+(e.step?e.step._compile(t,n):"1")+")":e.isSymbolNode&&"end"===e.name?(n.end=!0,"(function () {var end = size["+r+"]; return "+e._compile(t,n)+"; })()"):e._compile(t,n)});return"math.index("+r.join(", ")+")"},o.prototype.forEach=function(t){for(var e=0;e<this.dimensions.length;e++)t(this.dimensions[e],"dimensions["+e+"]",this)},o.prototype.map=function(t){for(var e=[],n=0;n<this.dimensions.length;n++)e[n]=this._ifNode(t(this.dimensions[n],"dimensions["+n+"]",this));return new o(e)},o.prototype.clone=function(){return new o(this.dimensions.slice(0))},o.prototype.isObjectProperty=function(){return 1===this.dimensions.length&&this.dimensions[0].isConstantNode&&"string"===this.dimensions[0].valueType},o.prototype.getObjectProperty=function(){return this.isObjectProperty()?this.dimensions[0].value:null},o.prototype._toString=function(t){return this.dotNotation?"."+this.getObjectProperty():"["+this.dimensions.join(", ")+"]"},o.prototype._toTex=function(t){var e=this.dimensions.map(function(e){return e.toTex(t)});return this.dotNotation?"."+this.getObjectProperty():"_{"+e.join(",")+"}"},o.prototype.needsSize=function(){return this.dimensions.some(function(t){return t.isRangeNode&&t.needsEnd()||t.isSymbolNode&&"end"===t.name})},o}e.name="IndexNode",e.path="expression.node",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,o){function s(t,e,n){if(!(this instanceof s))throw new SyntaxError("Constructor must be called with the new operator");if(!t||!t.isNode)throw new TypeError("Node expected");if(!e||!e.isNode)throw new TypeError("Node expected");if(n&&(!n||!n.isNode))throw new TypeError("Node expected");if(arguments.length>3)throw new Error("Too many arguments");this.start=t,this.end=e,this.step=n||null}function a(t,e){var n=i.getPrecedence(t,e),r={},o=i.getPrecedence(t.start,e);if(r.start=null!==o&&n>=o||"all"===e,t.step){var s=i.getPrecedence(t.step,e);r.step=null!==s&&n>=s||"all"===e}var a=i.getPrecedence(t.end,e);return r.end=null!==a&&n>=a||"all"===e,r}var l=r(n(281));return s.prototype=new l,s.prototype.type="RangeNode",s.prototype.isRangeNode=!0,s.prototype.needsEnd=function(){var t=this.filter(function(t){return t&&t.isSymbolNode&&"end"==t.name});return t.length>0},s.prototype._compile=function(t,e){return"math.range("+this.start._compile(t,e)+", "+this.end._compile(t,e)+(this.step?", "+this.step._compile(t,e):"")+")"},s.prototype.forEach=function(t){t(this.start,"start",this),t(this.end,"end",this),this.step&&t(this.step,"step",this)},s.prototype.map=function(t){return new s(this._ifNode(t(this.start,"start",this)),this._ifNode(t(this.end,"end",this)),this.step&&this._ifNode(t(this.step,"step",this)))},s.prototype.clone=function(){return new s(this.start,this.end,this.step&&this.step)},s.prototype._toString=function(t){var e,n=t&&t.parenthesis?t.parenthesis:"keep",r=a(this,n),i=this.start.toString(t);if(r.start&&(i="("+i+")"),e=i,this.step){var o=this.step.toString(t);r.step&&(o="("+o+")"),e+=":"+o}var s=this.end.toString(t);return r.end&&(s="("+s+")"),e+=":"+s},s.prototype._toTex=function(t){var e=t&&t.parenthesis?t.parenthesis:"keep",n=a(this,e),r=this.start.toTex(t);if(n.start&&(r="\\left("+r+"\\right)"),this.step){var i=this.step.toTex(t);n.step&&(i="\\left("+i+"\\right)"),r+=":"+i}var o=this.end.toTex(t);return n.end&&(o="\\left("+o+"\\right)"),r+=":"+o},s}var i=n(289);e.name="RangeNode",e.path="expression.node",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,o,s){function a(t){if(!(this instanceof a))throw new SyntaxError("Constructor must be called with the new operator");if("string"!=typeof t)throw new TypeError('String expected for parameter "name"');this.name=t}function l(t){throw new Error("Undefined symbol "+t)}var h=r(n(281)),c=r(n(75));return a.prototype=new h,a.prototype.type="SymbolNode",a.prototype.isSymbolNode=!0,a.prototype._compile=function(t,e){return t.undef=l,t.Unit=c,e[this.name]?this.name:this.name in t.math?'("'+this.name+'" in scope ? scope["'+this.name+'"] : math["'+this.name+'"])':'("'+this.name+'" in scope ? scope["'+this.name+'"] : '+(c.isValuelessUnit(this.name)?'new Unit(null, "'+this.name+'")':'undef("'+this.name+'")')+")"},a.prototype.forEach=function(t){},a.prototype.map=function(t){return this.clone()},a.prototype.clone=function(){return new a(this.name)},a.prototype._toString=function(t){return this.name},a.prototype._toTex=function(t){var e=!1;"undefined"==typeof s[this.name]&&c.isValuelessUnit(this.name)&&(e=!0);var n=i.toSymbol(this.name,e);return"\\"===n[0]?n:" "+n},a}var i=n(32);e.name="SymbolNode",e.path="expression.node",e.math=!0,e.factory=r},function(t,e,n){"use strict";function r(t,e,r,i){function o(t){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");if(this.properties=t||{},t&&("object"!=typeof t||Object.keys(t).some(function(e){return!t[e]||!t[e].isNode})))throw new TypeError("Object containing Nodes expected")}var s=r(n(281));return o.prototype=new s,o.prototype.type="ObjectNode",o.prototype.isObjectNode=!0,o.prototype._compile=function(t,e){var n=[];for(var r in this.properties)this.properties.hasOwnProperty(r)&&n.push('"'+r+'": '+this.properties[r]._compile(t,e));return"{"+n.join(", ")+"}"},o.prototype.forEach=function(t){for(var e in this.properties)this.properties.hasOwnProperty(e)&&t(this.properties[e],'properties["'+e+'"]',this)},o.prototype.map=function(t){var e={};for(var n in this.properties)this.properties.hasOwnProperty(n)&&(e[n]=this._ifNode(t(this.properties[n],'properties["'+n+'"]',this)));return new o(e)},o.prototype.clone=function(){var t={};for(var e in this.properties)this.properties.hasOwnProperty(e)&&(t[e]=this.properties[e]);return new o(t)},o.prototype._toString=function(t){var e=[];for(var n in this.properties)this.properties.hasOwnProperty(n)&&e.push('"'+n+'": '+this.properties[n].toString(t));return"{"+e.join(", ")+"}"},o.prototype._toTex=function(t){var e=[];for(var n in this.properties)this.properties.hasOwnProperty(n)&&e.push("\\mathbf{"+n+":} & "+this.properties[n].toTex(t)+"\\\\");return"\\left\\{\\begin{array}{ll}"+e.join("\n")+"\\end{array}\\right\\}"},o}n(23),e.name="ObjectNode",e.path="expression.node",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,s,a){function l(t,e,n,r){if(!(this instanceof l))throw new SyntaxError("Constructor must be called with the new operator");if("string"!=typeof t)throw new TypeError('string expected for parameter "op"');if("string"!=typeof e)throw new TypeError('string expected for parameter "fn"');if(!Array.isArray(n)||!n.every(function(t){return t&&t.isNode}))throw new TypeError('Array containing Nodes expected for parameter "args"');this.implicit=r===!0,this.op=t,this.fn=e,this.args=n||[]}function h(t,e,n,r){var i=o.getPrecedence(t,e),s=o.getAssociativity(t,e);if("all"===e||n.length>2){var a=[];return n.forEach(function(t){switch(t.getContent().type){case"ArrayNode":case"ConstantNode":case"SymbolNode":case"ParenthesisNode":a.push(!1);break;default:a.push(!0)}}),a}switch(n.length){case 0:return[];case 1:var l=o.getPrecedence(n[0],e);if(r&&null!==l){var h,c;if("keep"===e?(h=n[0].getIdentifier(),c=t.getIdentifier()):(h=n[0].getContent().getIdentifier(),c=t.getContent().getIdentifier()),o.properties[i][c].latexLeftParens===!1)return[!1];if(o.properties[l][h].latexParens===!1)return[!1]}return null===l?[!1]:i>=l?[!0]:[!1];case 2:var u,d=o.getPrecedence(n[0],e),p=o.isAssociativeWith(t,n[0],e);u=null!==d&&(d===i&&"right"===s&&!p||i>d);var f,g=o.getPrecedence(n[1],e),m=o.isAssociativeWith(t,n[1],e);if(f=null!==g&&(g===i&&"left"===s&&!m||i>g),r){var c,x,y;"keep"===e?(c=t.getIdentifier(),x=t.args[0].getIdentifier(),y=t.args[1].getIdentifier()):(c=t.getContent().getIdentifier(),x=t.args[0].getContent().getIdentifier(),y=t.args[1].getContent().getIdentifier()),null!==d&&(o.properties[i][c].latexLeftParens===!1&&(u=!1),o.properties[d][x].latexParens===!1&&(u=!1)),null!==g&&(o.properties[i][c].latexRightParens===!1&&(f=!1),o.properties[g][y].latexParens===!1&&(f=!1))}return[u,f]}}var c=r(n(281));return r(n(292)),r(n(296)),r(n(299)),l.prototype=new c,l.prototype.type="OperatorNode",l.prototype.isOperatorNode=!0,l.prototype._compile=function(t,e){if(!t.math[this.fn])throw new Error("Function "+this.fn+' missing in provided namespace "math"');var n=this.args.map(function(n){return n._compile(t,e)});return"math."+this.fn+"("+n.join(", ")+")"},l.prototype.forEach=function(t){for(var e=0;e<this.args.length;e++)t(this.args[e],"args["+e+"]",this)},l.prototype.map=function(t){for(var e=[],n=0;n<this.args.length;n++)e[n]=this._ifNode(t(this.args[n],"args["+n+"]",this));return new l(this.op,this.fn,e)},l.prototype.clone=function(){return new l(this.op,this.fn,this.args.slice(0))},l.prototype._toString=function(t){var e=t&&t.parenthesis?t.parenthesis:"keep",n=t&&t.implicit?t.implicit:"hide",r=this.args,i=h(this,e,r,!1);switch(r.length){case 1:var s=o.getAssociativity(this,e),a=r[0].toString(t);return i[0]&&(a="("+a+")"),"right"===s?this.op+a:"left"===s?a+this.op:a+this.op;case 2:var l=r[0].toString(t),c=r[1].toString(t);return i[0]&&(l="("+l+")"),i[1]&&(c="("+c+")"),this.implicit&&"OperatorNode:multiply"===this.getIdentifier()&&"hide"==n?l+" "+c:l+" "+this.op+" "+c;default:return this.fn+"("+this.args.join(", ")+")"}},l.prototype._toTex=function(t){var e=t&&t.parenthesis?t.parenthesis:"keep",n=t&&t.implicit?t.implicit:"hide",r=this.args,s=h(this,e,r,!0),a=i.operators[this.fn];switch(a="undefined"==typeof a?this.op:a,r.length){case 1:var l=o.getAssociativity(this,e),c=r[0].toTex(t);return s[0]&&(c="\\left("+c+"\\right)"),"right"===l?a+c:"left"===l?c+a:c+a;case 2:var u=r[0],d=u.toTex(t);s[0]&&(d="\\left("+d+"\\right)");var p=r[1],f=p.toTex(t);s[1]&&(f="\\left("+f+"\\right)");var g;switch(g="keep"===e?u.getIdentifier():u.getContent().getIdentifier(),this.getIdentifier()){case"OperatorNode:divide":return a+"{"+d+"}{"+f+"}";case"OperatorNode:pow":switch(d="{"+d+"}",f="{"+f+"}",g){case"ConditionalNode":case"OperatorNode:divide":d="\\left("+d+"\\right)"}case"OperatorNode:multiply":if(this.implicit&&"hide"===n)return d+"~"+f}return d+a+f;default:return"\\mathrm{"+this.fn+"}\\left("+r.map(function(e){return e.toTex(t)}).join(",")+"\\right)"}},l.prototype.getIdentifier=function(){return this.type+":"+this.fn},l}var i=n(32),o=n(289);e.name="OperatorNode",e.path="expression.node",e.math=!0,e.factory=r},function(t,e,n){"use strict";function r(t,e,r,o,s){function a(t,e){if(!(this instanceof a))throw new SyntaxError("Constructor must be called with the new operator");if("string"==typeof t&&(console.warn("WARNING: passing a string to FunctionNode is deprecated, pass a SymbolNode instead."),t=new c(t)),!t||!t.isNode)throw new TypeError('Node expected as parameter "fn"');if(!Array.isArray(e)||!e.every(function(t){return t&&t.isNode}))throw new TypeError('Array containing Nodes expected for parameter "args"');this.fn=t,this.args=e||[],Object.defineProperty(this,"name",{get:function(){return this.fn.name||""}.bind(this),set:function(){throw new Error("Cannot assign a new name, name is read-only")}});var n=function(){throw new Error("Property `FunctionNode.object` is deprecated, use `FunctionNode.fn` instead")};Object.defineProperty(this,"object",{get:n,set:n})}function l(t,e,n){for(var r,i="",o=new RegExp("\\$(?:\\{([a-z_][a-z_0-9]*)(?:\\[([0-9]+)\\])?\\}|\\$)","ig"),s=0;null!==(r=o.exec(t));)if(i+=t.substring(s,r.index),s=r.index,"$$"===r[0])i+="$",s++;else{s+=r[0].length;var a=e[r[1]];if(!a)throw new ReferenceError("Template: Property "+r[1]+" does not exist.");if(void 0===r[2])switch(typeof a){case"string":i+=a;break;case"object":if(a.isNode)i+=a.toTex(n);else{if(!Array.isArray(a))throw new TypeError("Template: "+r[1]+" has to be a Node, String or array of Nodes");i+=a.map(function(t,e){if(t&&t.isNode)return t.toTex(n);throw new TypeError("Template: "+r[1]+"["+e+"] is not a Node.")}).join(",")}break;default:throw new TypeError("Template: "+r[1]+" has to be a Node, String or array of Nodes")}else{if(!a[r[2]]||!a[r[2]].isNode)throw new TypeError("Template: "+r[1]+"["+r[2]+"] is not a Node.");i+=a[r[2]].toTex(n)}}return i+=t.slice(s)}var h=r(n(281)),c=r(n(296));a.prototype=new h,a.prototype.type="FunctionNode",a.prototype.isFunctionNode=!0,a.prototype._compile=function(t,e){var n,r=this.fn._compile(t,e),i=this.args.map(function(n){return n._compile(t,e)});if(this.fn.isSymbolNode){var o=this.fn.name,s=t.math[o],a="function"==typeof s&&1==s.rawArgs;return a?(n=this._getUniqueArgumentsName(t),t[n]=this.args,r+"("+n+", math, scope)"):r+"("+i.join(", ")+")"}if(this.fn.isAccessorNode&&this.fn.index.isObjectProperty()){n=this._getUniqueArgumentsName(t),t[n]=this.args;var l=this.fn.object._compile(t,e),h=this.fn.index.getObjectProperty();return"(function () {var object = "+l+';return (object["'+h+'"] && object["'+h+'"].rawArgs)  ? object["'+h+'"]('+n+', math, scope) : object["'+h+'"]('+i.join(", ")+")})()"}return n=this._getUniqueArgumentsName(t),t[n]=this.args,"(function () {var fn = "+r+";return (fn && fn.rawArgs)  ? fn("+n+", math, scope) : fn("+i.join(", ")+")})()"},a.prototype._getUniqueArgumentsName=function(t){var e,n=0;do e="args"+n,n++;while(e in t);return e},a.prototype.forEach=function(t){for(var e=0;e<this.args.length;e++)t(this.args[e],"args["+e+"]",this)},a.prototype.map=function(t){for(var e=this.fn.map(t),n=[],r=0;r<this.args.length;r++)n[r]=this._ifNode(t(this.args[r],"args["+r+"]",this));return new a(e,n)},a.prototype.clone=function(){return new a(this.fn,this.args.slice(0))};var u=a.prototype.toString;a.prototype.toString=function(t){var e,n=this.fn.toString(t);return t&&"object"==typeof t.handler&&t.handler.hasOwnProperty(n)&&(e=t.handler[n](this,t)),"undefined"!=typeof e?e:u.call(this,t)},a.prototype._toString=function(t){var e=this.args.map(function(e){return e.toString(t)});return this.fn.toString(t)+"("+e.join(", ")+")"};var d=a.prototype.toTex;return a.prototype.toTex=function(t){var e;return t&&"object"==typeof t.handler&&t.handler.hasOwnProperty(this.name)&&(e=t.handler[this.name](this,t)),"undefined"!=typeof e?e:d.call(this,t)},a.prototype._toTex=function(t){var e,n=this.args.map(function(e){return e.toTex(t)});!s[this.name]||"function"!=typeof s[this.name].toTex&&"object"!=typeof s[this.name].toTex&&"string"!=typeof s[this.name].toTex||(e=s[this.name].toTex);var r;switch(typeof e){case"function":r=e(this,t);break;case"string":r=l(e,this,t);break;case"object":switch(typeof e[n.length]){case"function":r=e[n.length](this,t);break;case"string":r=l(e[n.length],this,t)}}return"undefined"!=typeof r?r:l(i.defaultTemplate,this,t)},a.prototype.getIdentifier=function(){return this.type+":"+this.name},a}var i=n(32);e.name="FunctionNode",e.path="expression.node",e.math=!0,e.factory=r},function(t,e,n){"use strict";function r(t,e,r,i){function o(t){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");if(!t||!t.isNode)throw new TypeError('Node expected for parameter "content"');this.content=t}var s=r(n(281));return o.prototype=new s,o.prototype.type="ParenthesisNode",o.prototype.isParenthesisNode=!0,o.prototype._compile=function(t,e){return this.content._compile(t,e)},o.prototype.getContent=function(){return this.content.getContent()},o.prototype.forEach=function(t){t(this.content,"content",this)},o.prototype.map=function(t){var e=t(this.content,"content",this);return new o(e)},o.prototype.clone=function(){return new o(this.content)},o.prototype._toString=function(t){return!t||t&&!t.parenthesis||t&&"keep"===t.parenthesis?"("+this.content.toString(t)+")":this.content.toString(t)},o.prototype._toTex=function(t){return!t||t&&!t.parenthesis||t&&"keep"===t.parenthesis?"\\left("+this.content.toTex(t)+"\\right)":this.content.toTex(t)},o}e.name="ParenthesisNode",e.path="expression.node",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,o){var s=r(n(279));return o("compile",{string:function(t){var e={};return s(t).compile().eval(e)},"string, Object":function(t,e){return s(t).compile().eval(e)},"Array | Matrix":function(t){var e={};return i(t,function(t){return s(t).compile().eval(e)})},"Array | Matrix, Object":function(t,e){return i(t,function(t){return s(t).compile().eval(e)})}})}var i=n(19);e.name="eval",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,i,o){var s=r(n(103));return i("help",{any:function(e){var n,r=e;if("string"!=typeof e)for(n in o)if(o.hasOwnProperty(n)&&e===o[n]){r=n;break}var i=s[r];if(!i)throw new Error('No documentation found on "'+r+'"');return new t.Help(i)}})}e.math=!0,e.name="help",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,i){var o=r(n(279));return i("parse",{"string | Array | Matrix":o,"string | Array | Matrix, Object":o})}e.name="parse",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,i,o){var s=r(n(305));return i("parser",{"":function(){return new s(o)}})}e.name="parser",e.factory=r,e.math=!0},function(t,e,n){"use strict";function r(t,e,r,o,s){function a(){if(!(this instanceof a))throw new SyntaxError("Constructor must be called with the new operator");this.scope={}}var l=r(n(279));return a.prototype.type="Parser",a.prototype.isParser=!0,a.prototype.parse=function(t){throw new Error("Parser.parse is deprecated. Use math.parse instead.")},a.prototype.compile=function(t){throw new Error("Parser.compile is deprecated. Use math.compile instead.")},a.prototype.eval=function(t){return l(t).compile().eval(this.scope)},a.prototype.get=function(t){return this.scope[t]},a.prototype.getAll=function(){return i({},this.scope)},a.prototype.set=function(t,e){return this.scope[t]=e},a.prototype.remove=function(t){delete this.scope[t]},a.prototype.clear=function(){for(var t in this.scope)this.scope.hasOwnProperty(t)&&delete this.scope[t]},a}var i=n(3).extend;e.name="Parser",e.path="expression",e.factory=r,e.math=!0},function(t,e,n){t.exports=[n(280),n(286),n(287),n(290),n(291),n(292),n(294),n(293),n(299),n(281),n(297),n(298),n(300),n(295),n(296),n(307)]},function(t,e){"use strict";function n(t,e,n,r){function i(){throw new Error("UpdateNode is deprecated. Use AssignmentNode instead.")}return i}e.name="UpdateNode",e.path="expression.node",e.factory=n},function(t,e,n){t.exports=[n(309),n(311),n(313),n(315),n(316),n(318),n(324),n(329),n(331),n(333)]},function(t,e,n){"use strict";function r(t,e,r,o){var s=r(n(310));return o("concat",{"...any":function(t){var e=t.length-1,n=t[e];"number"==typeof n?t[e]=n-1:n&&n.isBigNumber===!0&&(t[e]=n.minus(1));try{return s.apply(null,t)}catch(r){throw i(r)}}})}var i=n(284).transform;e.name="concat",e.path="expression.transform",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,c){var u=r(n(52)),d=c("concat",{"...Array | Matrix | number | BigNumber":function(t){var e,n,r=t.length,c=-1,d=!1,p=[];for(e=0;r>e;e++){var f=t[e];if(f&&f.isMatrix===!0&&(d=!0),"number"==typeof f||f&&f.isBigNumber===!0){if(e!==r-1)throw new Error("Dimension must be specified as last argument");if(n=c,c=f.valueOf(),!s(c))throw new TypeError("Integer number expected for dimension");if(0>c||e>0&&c>n)throw new l(c,n+1)}else{var g=o(f).valueOf(),m=a.size(g);if(p[e]=g,n=c,c=m.length-1,e>0&&c!=n)throw new h(n+1,c+1)}}if(0==p.length)throw new SyntaxError("At least one matrix expected");for(var x=p.shift();p.length;)x=i(x,p.shift(),c,0);return d?u(x):x},"...string":function(t){return t.join("")}});return d.toTex=void 0,d}function i(t,e,n,r){if(n>r){if(t.length!=e.length)throw new h(t.length,e.length);for(var o=[],s=0;s<t.length;s++)o[s]=i(t[s],e[s],n,r+1);return o}return t.concat(e)}var o=n(3).clone,s=n(6).isInteger,a=n(40),l=n(43),h=n(42);e.name="concat",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,i){function o(t,e,n){var r,i;if(t[0]&&(r=t[0].compile().eval(n)),t[1])if(t[1]&&t[1].isSymbolNode)i=t[1].compile().eval(n);else{var o=n||{},a=t[1].filter(function(t){return t&&t.isSymbolNode&&!(t.name in e)&&!(t.name in o)})[0],l=Object.create(o),h=t[1].compile();if(!a)throw new Error("No undefined variable found in filter equation");var c=a.name;i=function(t){return l[c]=t,h.eval(l)}}return s(r,i)}var s=r(n(312));return r(n(296)),o.rawArgs=!0,o}n(45).maxArgumentCount,e.name="filter",e.path="expression.transform",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,s){var a=r(n(52)),l=s("filter",{"Array, function":i,"Array, RegExp":o,"Matrix, function":function(t,e){return a(i(t.toArray(),e))},"Matrix, RegExp":function(t,e){return a(o(t.toArray(),e))}});return l.toTex=void 0,l}function i(t,e){if(1!==s(t).length)throw new Error("Only one dimensional matrices supported");var n=a(e);return t.filter(function(t,r,i){return 1===n?e(t):2===n?e(t,[r]):e(t,[r],i)})}function o(t,e){if(1!==s(t).length)throw new Error("Only one dimensional matrices supported");return t.filter(function(t){return e.test(t)})}var s=n(40).size,a=n(45).maxArgumentCount;e.name="filter",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,o){return r(n(314)),o("forEach",{"Array | Matrix, function":function(t,e){var n=i(e),r=function(i,o){Array.isArray(i)?i.forEach(function(t,e){r(t,o.concat(e+1))}):1===n?e(i):2===n?e(i,o):e(i,o,t)};r(t.valueOf(),[])}})}var i=n(45).maxArgumentCount;e.name="forEach",e.path="expression.transform",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("forEach",{"Array, function":i,"Matrix, function":function(t,e){return t.forEach(e)}});return o.toTex=void 0,o}function i(t,e){var n=o(e),r=function(i,o){Array.isArray(i)?i.forEach(function(t,e){r(t,o.concat(e))}):1===n?e(i):2===n?e(i,o):e(i,o,t)};r(t,[])}var o=n(45).maxArgumentCount;e.name="forEach",e.factory=r},function(t,e,n){"use strict";function r(t,e,r){return r(n(68)),function(){for(var e=[],n=0,r=arguments.length;r>n;n++){var i=arguments[n];if(i&&i.isRange===!0)i.start--,i.end-=i.step>0?0:2;else if(i&&i.isSet===!0)i=i.map(function(t){return t-1});else if(i&&(i.isArray===!0||i.isMatrix))i=i.map(function(t){return t-1});else if("number"==typeof i)i--;else if(i&&i.isBigNumber===!0)i=i.toNumber()-1;else if("string"!=typeof i)throw new TypeError("Dimension must be an Array, Matrix, number, string, or Range");e[n]=i}var o=new t.Index;return t.Index.apply(o,e),o}}Array.isArray,e.name="index",e.path="expression.transform",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,o){var s=(r(n(317)),r(n(52)));return o("max",{"Array, function":function(t,e){return i(t,e,t)},"Matrix, function":function(t,e){return s(i(t.valueOf(),e,t))}})}function i(t,e,n){function r(t,o){return Array.isArray(t)?t.map(function(t,e){return r(t,o.concat(e+1))}):1===i?e(t):2===i?e(t,o):e(t,o,n)}var i=o(e);return r(t,[])}var o=n(45).maxArgumentCount;e.name="map",e.path="expression.transform",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("map",{"Array, function":i,"Matrix, function":function(t,e){return t.map(e)}});return o.toTex=void 0,o}function i(t,e){var n=o(e),r=function(i,o){return Array.isArray(i)?i.map(function(t,e){return r(t,o.concat(e))}):1===n?e(i):2===n?e(i,o):e(i,o,t)};return r(t,[])}var o=n(45).maxArgumentCount;e.name="map",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,s){var a=r(n(320));return s("max",{"...any":function(t){if(2==t.length&&o(t[0])){var e=t[1];"number"==typeof e?t[1]=e-1:e&&e.isBigNumber===!0&&(t[1]=e.minus(1))}try{return a.apply(null,t)}catch(n){throw i(n)}}})}var i=n(284).transform,o=n(319);e.name="max",e.path="expression.transform",e.factory=r},function(t,e){"use strict";t.exports=function(t){return Array.isArray(t)||t&&t.isMatrix===!0}},function(t,e,n){"use strict";function r(t,e,r,a){function l(t,e){return c(t,e)?t:e}function h(t){var e=void 0;if(i(t,function(t){(void 0===e||c(t,e))&&(e=t)}),void 0===e)throw new Error("Cannot calculate max of an empty array");return e}var c=r(n(64)),u=a("max",{"Array | Matrix":h,"Array | Matrix, number | BigNumber":function(t,e){return o(t,e.valueOf(),l)},"...":function(t){if(s(t))throw new TypeError("Scalar values expected in function max");return h(t)}});return u.toTex="\\max\\left(${args}\\right)",u}var i=n(321),o=n(322),s=n(323);e.name="max",e.factory=r},function(t,e){"use strict";t.exports=function n(t,e){t&&t.isMatrix===!0&&(t=t.valueOf());for(var r=0,i=t.length;i>r;r++){var o=t[r];Array.isArray(o)?n(o,e):e(o)}}},function(t,e,n){"use strict";function r(t,e,n){var o,s,a,l;if(0>=e){if(Array.isArray(t[0])){for(l=i(t),s=[],o=0;o<l.length;o++)s[o]=r(l[o],e-1,n);return s}for(a=t[0],o=1;o<t.length;o++)a=n(a,t[o]);return a}for(s=[],o=0;o<t.length;o++)s[o]=r(t[o],e-1,n);return s}function i(t){var e,n,r=t.length,i=t[0].length,o=[];for(n=0;i>n;n++){var s=[];for(e=0;r>e;e++)s.push(t[e][n]);o.push(s)}return o}var o=n(40).size,s=n(43);t.exports=function(t,e,n){var i=Array.isArray(t)?o(t):t.size();if(0>e||e>=i.length)throw new s(e,i.length);return t&&t.isMatrix===!0?t.create(r(t.valueOf(),e,n)):r(t,e,n)}},function(t,e,n){"use strict";var r=n(319);t.exports=function(t){for(var e=0;e<t.length;e++)if(r(t[e]))return!0;return!1}},function(t,e,n){"use strict";function r(t,e,r,s){var a=r(n(325));return s("mean",{"...any":function(t){if(2==t.length&&o(t[0])){var e=t[1];"number"==typeof e?t[1]=e-1:e&&e.isBigNumber===!0&&(t[1]=e.minus(1))}try{return a.apply(null,t)}catch(n){throw i(n)}}})}var i=n(284).transform,o=n(319);e.name="mean",e.path="expression.transform",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,l){function h(t,e){var n=s(t,e,u),r=Array.isArray(t)?i(t):t.size();return d(n,r[e])}function c(t){var e=0,n=0;if(o(t,function(t){e=u(e,t),n++}),0===n)throw new Error("Cannot calculate mean of an empty array");return d(e,n)}var u=r(n(51)),d=r(n(326)),p=l("mean",{"Array | Matrix":c,"Array | Matrix, number | BigNumber":h,"...":function(t){if(a(t))throw new TypeError("Scalar values expected in function mean");return c(t)}});return p.toTex=void 0,p}var i=n(40).size,o=n(321),s=n(322),a=n(323);e.name="mean",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,o){var s=r(n(81)),a=r(n(84)),l=r(n(327)),h=r(n(52)),c=r(n(85)),u=r(n(58)),d=o("divide",i({"Array | Matrix, Array | Matrix":function(t,e){return a(t,l(e))},"Matrix, any":function(t,e){var n;switch(t.storage()){case"sparse":n=c(t,e,s,!1);break;case"dense":n=u(t,e,s,!1)}return n},"Array, any":function(t,e){return u(h(t),e,s,!1).valueOf()},"any, Array | Matrix":function(t,e){return a(t,l(e))}},s.signatures));return d.toTex={2:"\\frac{${args[0]}}{${args[1]}}"},d}var i=n(3).extend;e.name="divide",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,o){function s(t,e,n){var r,i,o,s,a;if(1==e){if(s=t[0][0],0==s)throw Error("Cannot calculate inverse, determinant is zero");return[[l(1,s)]]}if(2==e){var f=d(t);if(0==f)throw Error("Cannot calculate inverse, determinant is zero");return[[l(t[1][1],f),l(u(t[0][1]),f)],[l(u(t[1][0]),f),l(t[0][0],f)]]}var g=t.concat();for(r=0;e>r;r++)g[r]=g[r].concat();for(var m=p(e).valueOf(),x=0;n>x;x++){for(r=x;e>r&&0==g[r][x];)r++;if(r==e||0==g[r][x])throw Error("Cannot calculate inverse, determinant is zero");r!=x&&(a=g[x],g[x]=g[r],g[r]=a,a=m[x],m[x]=m[r],m[r]=a);var y=g[x],v=m[x];for(r=0;e>r;r++){var C=g[r],w=m[r];if(r!=x){if(0!=C[x]){for(o=l(u(C[x]),y[x]),i=x;n>i;i++)C[i]=h(C[i],c(o,y[i]));for(i=0;n>i;i++)w[i]=h(w[i],c(o,v[i]))}}else{for(o=y[x],i=x;n>i;i++)C[i]=l(C[i],o);for(i=0;n>i;i++)w[i]=l(w[i],o)}}}return m}var a=r(n(52)),l=r(n(81)),h=r(n(53)),c=r(n(84)),u=r(n(78)),d=r(n(328)),p=r(n(83)),f=o("inv",{"Array | Matrix":function(t){var e=t.isMatrix===!0?t.size():i.array.size(t);switch(e.length){case 1:if(1==e[0])return t.isMatrix===!0?a([l(1,t.valueOf()[0])]):[l(1,t[0])];throw new RangeError("Matrix must be square (size: "+i.string.format(e)+")");case 2:var n=e[0],r=e[1];if(n==r)return t.isMatrix===!0?a(s(t.valueOf(),n,r),t.storage()):s(t,n,r);throw new RangeError("Matrix must be square (size: "+i.string.format(e)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+i.string.format(e)+")")}},any:function(t){return l(1,t)}});return f.toTex={1:"\\left(${args[0]}\\right)^{-1}"},f}var i=n(39);e.name="inv",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,i){function a(t,e,n){if(1==e)return o.clone(t[0][0]);if(2==e)return c(u(t[0][0],t[1][1]),u(t[1][0],t[0][1]));for(var r=function(t){var e,n,r=new Array(t.length),i=0;for(e=1;e<t.length;e++)i=h(i,t[e][e]);for(e=0;e<t.length;e++){for(r[e]=new Array(t.length),r[e][e]=d(i),n=0;e>n;n++)r[e][n]=0;for(n=e+1;n<t.length;n++)r[e][n]=t[e][n];e+1<t.length&&(i=c(i,t[e+1][e+1]))}return r},i=t,s=0;e-1>s;s++)i=u(r(i),t);return e%2==0?d(i[0][0]):i[0][0]}var l=r(n(52)),h=r(n(51)),c=r(n(77)),u=r(n(84)),d=r(n(78)),p=i("det",{any:function(t){return o.clone(t)},"Array | Matrix":function(t){var e;switch(t&&t.isMatrix===!0?e=t.size():Array.isArray(t)?(t=l(t),e=t.size()):e=[],e.length){case 0:return o.clone(t);case 1:if(1==e[0])return o.clone(t.valueOf()[0]);throw new RangeError("Matrix must be square (size: "+s.format(e)+")");case 2:var n=e[0],r=e[1];if(n==r)return a(t.clone().valueOf(),n,r);throw new RangeError("Matrix must be square (size: "+s.format(e)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+s.format(e)+")")}}});return p.toTex={1:"\\det\\left(${args[0]}\\right)"},p}var i=n(39),o=i.object,s=i.string;e.name="det",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,s){var a=r(n(330));return s("min",{"...any":function(t){if(2==t.length&&o(t[0])){var e=t[1];"number"==typeof e?t[1]=e-1:e&&e.isBigNumber===!0&&(t[1]=e.minus(1))}try{return a.apply(null,t)}catch(n){throw i(n)}}})}var i=n(284).transform,o=n(319);e.name="min",e.path="expression.transform",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,a){function l(t,e){return c(t,e)?t:e}function h(t){var e=void 0;if(i(t,function(t){(void 0===e||c(t,e))&&(e=t)}),void 0===e)throw new Error("Cannot calculate min of an empty array");return e}var c=r(n(60)),u=a("min",{"Array | Matrix":h,"Array | Matrix, number | BigNumber":function(t,e){return o(t,e.valueOf(),l)},"...":function(t){if(s(t))throw new TypeError("Scalar values expected in function min");return h(t)}});return u.toTex="\\min\\left(${args}\\right)",u}var i=n(321),o=n(322),s=n(323);e.name="min",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,i){var o=r(n(332));return i("range",{"...any":function(t){var e=t.length-1,n=t[e];return"boolean"!=typeof n&&t.push(!0),o.apply(null,t)}})}e.name="range",e.path="expression.transform",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,i){function o(t){return"Array"===e.matrix?t:d(t)}function s(n,r){var i=u(n);if(!i)throw new SyntaxError('String "'+n+'" is no valid range');var s;return"BigNumber"===e.number?(s=r?c:h,o(s(new t.BigNumber(i.start),new t.BigNumber(i.end),new t.BigNumber(i.step)))):(s=r?l:a,o(s(i.start,i.end,i.step)))}function a(t,e,n){var r=[],i=t;if(n>0)for(;e>i;)r.push(i),i+=n;else if(0>n)for(;i>e;)r.push(i),i+=n;return r}function l(t,e,n){var r=[],i=t;if(n>0)for(;e>=i;)r.push(i),i+=n;else if(0>n)for(;i>=e;)r.push(i),i+=n;return r}function h(t,e,n){var r=[],i=t;if(n.gt(p))for(;i.lt(e);)r.push(i),i=i.plus(n);else if(n.lt(p))for(;i.gt(e);)r.push(i),i=i.plus(n);return r}function c(t,e,n){var r=[],i=t;if(n.gt(p))for(;i.lte(e);)r.push(i),i=i.plus(n);else if(n.lt(p))for(;i.gte(e);)r.push(i),i=i.plus(n);return r}function u(t){var e=t.split(":"),n=e.map(function(t){return Number(t)}),r=n.some(function(t){return isNaN(t)});if(r)return null;switch(n.length){case 2:return{start:n[0],end:n[1],step:1};case 3:return{start:n[0],end:n[2],step:n[1]};default:return null}}var d=r(n(52)),p=new t.BigNumber(0),f=new t.BigNumber(1),g=i("range",{
string:s,"string, boolean":s,"number, number":function(t,e){return o(a(t,e,1))},"number, number, number":function(t,e,n){return o(a(t,e,n))},"number, number, boolean":function(t,e,n){return o(n?l(t,e,1):a(t,e,1))},"number, number, number, boolean":function(t,e,n,r){return o(r?l(t,e,n):a(t,e,n))},"BigNumber, BigNumber":function(t,e){return o(h(t,e,f))},"BigNumber, BigNumber, BigNumber":function(t,e,n){return o(h(t,e,n))},"BigNumber, BigNumber, boolean":function(t,e,n){return o(n?c(t,e,f):h(t,e,f))},"BigNumber, BigNumber, BigNumber, boolean":function(t,e,n,r){return o(r?c(t,e,n):h(t,e,n))}});return g.toTex=void 0,g}e.name="range",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,o){var s=r(n(285));return o("subset",{"...any":function(t){try{return s.apply(null,t)}catch(e){throw i(e)}}})}var i=n(284).transform;e.name="subset",e.path="expression.transform",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,s){function a(t){if(!(this instanceof a))throw new SyntaxError("Constructor must be called with the new operator");if(!t)throw new Error('Argument "doc" missing');this.doc=t}var l=r(n(304))();return a.prototype.type="Help",a.prototype.isHelp=!0,a.prototype.toString=function(){var t=this.doc||{},e="\n";if(t.name&&(e+="Name: "+t.name+"\n\n"),t.category&&(e+="Category: "+t.category+"\n\n"),t.description&&(e+="Description:\n    "+t.description+"\n\n"),t.syntax&&(e+="Syntax:\n    "+t.syntax.join("\n    ")+"\n\n"),t.examples){e+="Examples:\n";for(var n=0;n<t.examples.length;n++){var r=t.examples[n];e+="    "+r+"\n";var i;try{i=l.eval(r)}catch(s){i=s}i&&!i.isHelp&&(e+="        "+o.format(i,{precision:14})+"\n")}e+="\n"}return t.seealso&&(e+="See also: "+t.seealso.join(", ")+"\n"),e},a.prototype.toJSON=function(){var t=i.clone(this.doc);return t.mathjs="Help",t},a.fromJSON=function(t){var e={};for(var n in t)"mathjs"!==n&&(e[n]=t[n]);return new a(e)},a.prototype.valueOf=a.prototype.toString,a}var i=n(3),o=n(23);e.name="Help",e.path="type",e.factory=r},function(t,e,n){t.exports=[n(336),n(363),n(394),n(410),n(419),n(424),n(427),n(433),n(445),n(454),n(458),n(465),n(467),n(493),n(495)]},function(t,e,n){t.exports=[n(337),n(338),n(358),n(360),n(362)]},function(t,e,n){"use strict";function r(t,e,r,i){var s=r(n(52)),a=r(n(86)),l=r(n(53)),h=r(n(81)),c=r(n(80)),u=r(n(77)),d=r(n(64)),p=r(n(48)),f=r(n(78)),g=t.SparseMatrix,m=t.DenseMatrix,x=t.Spa,y=i("lup",{DenseMatrix:function(t){return v(t)},SparseMatrix:function(t){return C(t)},Array:function(t){var e=s(t),n=v(e);return{L:n.L.valueOf(),U:n.U.valueOf(),p:n.p}}}),v=function(t){var e,n,r,i=t._size[0],s=t._size[1],f=Math.min(i,s),g=o.clone(t._data),x=[],y=[i,f],v=[],C=[f,s],w=[];for(e=0;i>e;e++)w[e]=e;for(n=0;s>n;n++){if(n>0)for(e=0;i>e;e++){var b=Math.min(e,n),M=0;for(r=0;b>r;r++)M=l(M,c(g[e][r],g[r][n]));g[e][n]=u(g[e][n],M)}var S=n,E=0,I=0;for(e=n;i>e;e++){var N=g[e][n],O=a(N);d(O,E)&&(S=e,E=O,I=N)}if(n!==S&&(w[n]=[w[S],w[S]=w[n]][0],m._swapRows(n,S,g)),i>n)for(e=n+1;i>e;e++){var T=g[e][n];p(T,0)||(g[e][n]=h(g[e][n],I))}}for(n=0;s>n;n++)for(e=0;i>e;e++)0===n&&(s>e&&(v[e]=[]),x[e]=[]),n>e?(s>e&&(v[e][n]=g[e][n]),i>n&&(x[e][n]=0)):e!==n?(s>e&&(v[e][n]=0),i>n&&(x[e][n]=g[e][n])):(s>e&&(v[e][n]=g[e][n]),i>n&&(x[e][n]=1));var _=new m({data:x,size:y}),P=new m({data:v,size:C}),A=[];for(e=0,f=w.length;f>e;e++)A[w[e]]=e;return{L:_,U:P,p:A,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\nP: "+this.p}}},C=function(t){var e,n,r,i=t._size[0],o=t._size[1],s=Math.min(i,o),l=t._values,u=t._index,m=t._ptr,y=[],v=[],C=[],w=[i,s],b=[],M=[],S=[],E=[s,o],I=[],N=[];for(e=0;i>e;e++)I[e]=e,N[e]=e;var O=function(t,e){var n=N[t],r=N[e];I[n]=e,I[r]=t,N[t]=r,N[e]=n};for(n=0;o>n;n++){var T=new x;i>n&&(C.push(y.length),y.push(1),v.push(n)),S.push(b.length);var _=m[n],P=m[n+1];for(r=_;P>r;r++)e=u[r],T.set(I[e],l[r]);n>0&&T.forEach(0,n-1,function(t,e){g._forEachRow(t,y,v,C,function(n,r){n>t&&T.accumulate(n,f(c(r,e)))})});var A=n,k=T.get(n),R=a(k);T.forEach(n+1,i-1,function(t,e){var n=a(e);d(n,R)&&(A=t,R=n,k=e)}),n!==A&&(g._swapRows(n,A,w[1],y,v,C),g._swapRows(n,A,E[1],b,M,S),T.swap(n,A),O(n,A)),T.forEach(0,i-1,function(t,e){n>=t?(b.push(e),M.push(t)):(e=h(e,k),p(e,0)||(y.push(e),v.push(t)))})}return S.push(b.length),C.push(y.length),{L:new g({values:y,index:v,ptr:C,size:w}),U:new g({values:b,index:M,ptr:S,size:E}),p:I,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\nP: "+this.p}}};return y}var i=n(39),o=i.object;e.name="lup",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,i){var o=r(n(339)),a=r(n(350)),l=i("slu",{"SparseMatrix, number, number":function(t,e,n){if(!s(e)||0>e||e>3)throw new Error("Symbolic Ordering and Analysis order must be an integer number in the interval [0, 3]");if(0>n||n>1)throw new Error("Partial pivoting threshold must be a number from 0 to 1");var r=o(e,t,!1),i=a(t,r,n);return{L:i.L,U:i.U,p:i.pinv,q:r.q,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\np: "+this.p.toString()+(this.q?"\nq: "+this.q.toString():"")+"\n"}}}});return l}var i=n(39),o=i.number,s=o.isInteger;e.name="slu",e.factory=r},function(t,e,n){"use strict";function r(t,e,r){var i=r(n(340)),o=r(n(345)),s=r(n(346)),a=r(n(347)),l=r(n(348)),h=function(t,e,n){var r,h=e._ptr,u=e._size,d=u[1],p={};if(p.q=i(t,e),t&&!p.q)return null;if(n){var f=t?o(e,null,p.q,0):e;p.parent=s(f,1);var g=a(p.parent,d);if(p.cp=l(f,p.parent,g,1),f&&p.parent&&p.cp&&c(f,p))for(p.unz=0,r=0;d>r;r++)p.unz+=p.cp[r]}else p.unz=4*h[d]+d,p.lnz=p.unz;return p},c=function(t,e){var n=t._ptr,r=t._index,i=t._size,o=i[0],s=i[1];e.pinv=[],e.leftmost=[];var a,l,h,c,u,d=e.parent,p=e.pinv,f=e.leftmost,g=[],m=0,x=o,y=o+s,v=o+2*s;for(l=0;s>l;l++)g[x+l]=-1,g[y+l]=-1,g[v+l]=0;for(a=0;o>a;a++)f[a]=-1;for(l=s-1;l>=0;l--)for(c=n[l],u=n[l+1],h=c;u>h;h++)f[r[h]]=l;for(a=o-1;a>=0;a--)p[a]=-1,l=f[a],-1!=l&&(0===g[v+l]++&&(g[y+l]=a),g[m+a]=g[x+l],g[x+l]=a);for(e.lnz=0,e.m2=o,l=0;s>l;l++)if(a=g[x+l],e.lnz++,0>a&&(a=e.m2++),p[a]=l,!(--v[l]<=0)){e.lnz+=g[v+l];var C=d[l];-1!=C&&(0===g[v+C]&&(g[y+C]=g[y+l]),g[m+g[y+l]]=g[x+C],g[x+C]=g[m+a],g[v+C]+=g[v+l])}for(a=0;o>a;a++)p[a]<0&&(p[a]=l++);return!0};return h}e.name="cs_sqr",e.path="sparse",e.factory=r},function(t,e,n){"use strict";function r(t,e,r){var i=r(n(341)),o=r(n(342)),s=r(n(343)),a=r(n(51)),l=r(n(84)),h=r(n(344)),c=function(t,e){if(!e||0>=t||t>3)return null;var n=e._size,r=n[0],a=n[1],l=0,h=Math.max(16,10*Math.sqrt(a));h=Math.min(a-2,h);var c=u(t,e,r,a,h);o(c,g,null);for(var m,x,y,v,C,w,b,M,S,E,I,N,O,T,_,P,A=c._index,k=c._ptr,R=k[a],z=[],B=[],L=0,D=a+1,W=2*(a+1),F=3*(a+1),V=4*(a+1),q=5*(a+1),H=6*(a+1),U=7*(a+1),j=z,$=d(a,k,B,L,F,j,W,U,D,H,V,q),G=p(a,k,B,q,V,H,h,D,F,j,W),Y=0;a>G;){for(y=-1;a>Y&&-1==(y=B[F+Y]);Y++);-1!=B[W+y]&&(j[B[W+y]]=-1),B[F+Y]=B[W+y];var J=B[V+y],X=B[D+y];G+=X;var Z=0;B[D+y]=-X;var Q=k[y],K=0===J?Q:R,tt=K;for(v=1;J+1>=v;v++){for(v>J?(w=y,b=Q,M=B[L+y]-J):(w=A[Q++],b=k[w],M=B[L+w]),C=1;M>=C;C++)m=A[b++],(S=B[D+m])<=0||(Z+=S,B[D+m]=-S,A[tt++]=m,-1!=B[W+m]&&(j[B[W+m]]=j[m]),-1!=j[m]?B[W+j[m]]=B[W+m]:B[F+B[q+m]]=B[W+m]);w!=y&&(k[w]=i(y),B[H+w]=0)}for(0!==J&&(R=tt),B[q+y]=Z,k[y]=K,B[L+y]=tt-K,B[V+y]=-2,$=f($,l,B,H,a),E=K;tt>E;E++)if(m=A[E],!((I=B[V+m])<=0)){S=-B[D+m];var et=$-S;for(Q=k[m],N=k[m]+I-1;N>=Q;Q++)w=A[Q],B[H+w]>=$?B[H+w]-=S:0!==B[H+w]&&(B[H+w]=B[q+w]+et)}for(E=K;tt>E;E++){for(m=A[E],N=k[m],O=N+B[V+m]-1,T=N,_=0,P=0,Q=N;O>=Q;Q++)if(w=A[Q],0!==B[H+w]){var nt=B[H+w]-$;nt>0?(P+=nt,A[T++]=w,_+=w):(k[w]=i(y),B[H+w]=0)}B[V+m]=T-N+1;var rt=T,it=N+B[L+m];for(Q=O+1;it>Q;Q++){x=A[Q];var ot=B[D+x];0>=ot||(P+=ot,A[T++]=x,_+=x)}0===P?(k[m]=i(y),S=-B[D+m],Z-=S,X+=S,G+=S,B[D+m]=0,B[V+m]=-1):(B[q+m]=Math.min(B[q+m],P),A[T]=A[rt],A[rt]=A[N],A[N]=y,B[L+m]=T-N+1,_=(0>_?-_:_)%a,B[W+m]=B[U+_],B[U+_]=m,j[m]=_)}for(B[q+y]=Z,l=Math.max(l,Z),$=f($+l,l,B,H,a),E=K;tt>E;E++)if(m=A[E],!(B[D+m]>=0))for(_=j[m],m=B[U+_],B[U+_]=-1;-1!=m&&-1!=B[W+m];m=B[W+m],$++){for(M=B[L+m],I=B[V+m],Q=k[m]+1;Q<=k[m]+M-1;Q++)B[H+A[Q]]=$;var st=m;for(x=B[W+m];-1!=x;){var at=B[L+x]===M&&B[V+x]===I;for(Q=k[x]+1;at&&Q<=k[x]+M-1;Q++)B[H+A[Q]]!=$&&(at=0);at?(k[x]=i(m),B[D+m]+=B[D+x],B[D+x]=0,B[V+x]=-1,x=B[W+x],B[W+st]=x):(st=x,x=B[W+x])}}for(Q=K,E=K;tt>E;E++)m=A[E],(S=-B[D+m])<=0||(B[D+m]=S,P=B[q+m]+Z-S,P=Math.min(P,a-G-S),-1!=B[F+P]&&(j[B[F+P]]=m),B[W+m]=B[F+P],j[m]=-1,B[F+P]=m,Y=Math.min(Y,P),B[q+m]=P,A[Q++]=m);B[D+y]=X,0===(B[L+y]=Q-K)&&(k[y]=-1,B[H+y]=0),0!==J&&(R=Q)}for(m=0;a>m;m++)k[m]=i(k[m]);for(x=0;a>=x;x++)B[F+x]=-1;for(x=a;x>=0;x--)B[D+x]>0||(B[W+x]=B[F+k[x]],B[F+k[x]]=x);for(w=a;w>=0;w--)B[D+w]<=0||-1!=k[w]&&(B[W+w]=B[F+k[w]],B[F+k[w]]=w);for(y=0,m=0;a>=m;m++)-1==k[m]&&(y=s(m,y,B,F,W,z,H));return z.splice(z.length-1,1),z},u=function(t,e,n,r,i){var o=h(e);if(1===t&&r===n)return a(e,o);if(2==t){for(var s=o._index,c=o._ptr,u=0,d=0;n>d;d++){var p=c[d];if(c[d]=u,!(c[d+1]-p>i))for(var f=c[d+1];f>p;p++)s[u++]=s[p]}return c[n]=u,e=h(o),l(o,e)}return l(o,e)},d=function(t,e,n,r,i,o,s,a,l,h,c,u){for(var d=0;t>d;d++)n[r+d]=e[d+1]-e[d];n[r+t]=0;for(var p=0;t>=p;p++)n[i+p]=-1,o[p]=-1,n[s+p]=-1,n[a+p]=-1,n[l+p]=1,n[h+p]=1,n[c+p]=0,n[u+p]=n[r+p];var g=f(0,0,n,h,t);return n[c+t]=-2,e[t]=-1,n[h+t]=0,g},p=function(t,e,n,r,o,s,a,l,h,c,u){for(var d=0,p=0;t>p;p++){var f=n[r+p];if(0===f)n[o+p]=-2,d++,e[p]=-1,n[s+p]=0;else if(f>a)n[l+p]=0,n[o+p]=-1,d++,e[p]=i(t),n[l+t]++;else{var g=n[h+f];-1!=g&&(c[g]=p),n[u+p]=n[h+f],n[h+f]=p}}return d},f=function(t,e,n,r,i){if(2>t||0>t+e){for(var o=0;i>o;o++)0!==n[r+o]&&(n[r+o]=1);t=2}return t},g=function(t,e){return t!=e};return c}e.name="cs_amd",e.path="sparse",e.factory=r},function(t,e){"use strict";function n(){var t=function(t){return-t-2};return t}e.name="cs_flip",e.path="sparse",e.factory=n},function(t,e){"use strict";function n(){var t=function(t,e,n){for(var r=t._values,i=t._index,o=t._ptr,s=t._size,a=s[1],l=0,h=0;a>h;h++){var c=o[h];for(o[h]=l;c<o[h+1];c++)e(i[c],h,r?r[c]:1,n)&&(i[l]=i[c],r&&(r[l]=r[c]),l++)}return o[a]=l,i.splice(l,i.length-l),r&&r.splice(l,r.length-l),l};return t}e.name="cs_fkeep",e.path="sparse",e.factory=n},function(t,e){"use strict";function n(){var t=function(t,e,n,r,i,o,s){var a=0;for(n[s]=t;a>=0;){var l=n[s+a],h=n[r+l];-1==h?(a--,o[e++]=l):(n[r+l]=n[i+h],++a,n[s+a]=h)}return e};return t}e.name="cs_tdfs",e.path="sparse",e.factory=n},function(t,e,n){"use strict";function r(t,e,r,s){var a=n(32),l=r(n(52)),h=t.DenseMatrix,c=t.SparseMatrix,u=s("transpose",{Array:function(t){return u(l(t)).valueOf()},Matrix:function(t){var e,n=t.size();switch(n.length){case 1:e=t.clone();break;case 2:var r=n[0],i=n[1];if(0===i)throw new RangeError("Cannot transpose a 2D matrix with no columns (size: "+o(n)+")");switch(t.storage()){case"dense":e=d(t,r,i);break;case"sparse":e=p(t,r,i)}break;default:throw new RangeError("Matrix must be a vector or two dimensional (size: "+o(this._size)+")")}return e},any:function(t){return i(t)}}),d=function(t,e,n){for(var r,o=t._data,s=[],a=0;n>a;a++){r=s[a]=[];for(var l=0;e>l;l++)r[l]=i(o[l][a])}return new h({data:s,size:[n,e],datatype:t._datatype})},p=function(t,e,n){for(var r=t._values,o=t._index,s=t._ptr,a=r?[]:void 0,l=[],h=[],u=[],d=0;e>d;d++)u[d]=0;var p,f,g;for(p=0,f=o.length;f>p;p++)u[o[p]]++;for(var m=0,x=0;e>x;x++)h.push(m),m+=u[x],u[x]=h[x];for(h.push(m),g=0;n>g;g++)for(var y=s[g],v=s[g+1],C=y;v>C;C++){var w=u[o[C]]++;l[w]=g,r&&(a[w]=i(r[C]))}return new c({values:a,index:l,ptr:h,size:[n,e],datatype:t._datatype})};return u.toTex={1:"\\left(${args[0]}\\right)"+a.operators.transpose},u}var i=n(3).clone,o=n(23).format;e.name="transpose",e.factory=r},function(t,e){"use strict";function n(t){var e=t.SparseMatrix,n=function(t,n,r,i){for(var o=t._values,s=t._index,a=t._ptr,l=t._size,h=t._datatype,c=l[0],u=l[1],d=i&&t._values?[]:null,p=[],f=[],g=0,m=0;u>m;m++){f[m]=g;for(var x=r?r[m]:m,y=a[x],v=a[x+1],C=y;v>C;C++){var w=n?n[s[C]]:s[C];p[g]=w,d&&(d[g]=o[C]),g++}}return f[u]=g,new e({values:d,index:p,ptr:f,size:[c,u],datatype:h})};return n}e.name="cs_permute",e.path="sparse",e.factory=n},function(t,e){"use strict";function n(){var t=function(t,e){if(!t)return null;var n,r,i=t._index,o=t._ptr,s=t._size,a=s[0],l=s[1],h=[],c=[],u=0,d=l;if(e)for(n=0;a>n;n++)c[d+n]=-1;for(var p=0;l>p;p++){h[p]=-1,c[u+p]=-1;for(var f=o[p],g=o[p+1],m=f;g>m;m++){var x=i[m];for(n=e?c[d+x]:x;-1!=n&&p>n;n=r)r=c[u+n],c[u+n]=p,-1==r&&(h[n]=p);e&&(c[d+x]=p)}}return h};return t}e.name="cs_etree",e.path="sparse",e.factory=n},function(t,e,n){"use strict";function r(t,e,r){var i=r(n(343)),o=function(t,e){if(!t)return null;var n,r=0,o=[],s=[],a=0,l=e,h=2*e;for(n=0;e>n;n++)s[a+n]=-1;for(n=e-1;n>=0;n--)-1!=t[n]&&(s[l+n]=s[a+t[n]],s[a+t[n]]=n);for(n=0;e>n;n++)-1==t[n]&&(r=i(n,r,s,a,l,o,h));return o};return o}e.name="cs_post",e.path="sparse",e.factory=r},function(t,e,n){"use strict";function r(t,e,r){var i=r(n(344)),o=r(n(349)),s=function(t,e,n,r){if(!t||!e||!n)return null;var s,a,l,h,c,u,d,p=t._size,f=p[0],g=p[1],m=4*g+(r?g+f+1:0),x=[],y=0,v=g,C=2*g,w=3*g,b=4*g,M=5*g+1;for(l=0;m>l;l++)x[l]=-1;var S=[],E=i(t),I=E._index,N=E._ptr;for(l=0;g>l;l++)for(a=n[l],S[a]=-1==x[w+a]?1:0;-1!=a&&-1==x[w+a];a=e[a])x[w+a]=l;if(r){for(l=0;g>l;l++)x[n[l]]=l;for(s=0;f>s;s++){for(l=g,u=N[s],d=N[s+1],c=u;d>c;c++)l=Math.min(l,x[I[c]]);x[M+s]=x[b+l],x[b+l]=s}}for(s=0;g>s;s++)x[y+s]=s;for(l=0;g>l;l++){for(a=n[l],-1!=e[a]&&S[e[a]]--,h=r?x[b+l]:a;-1!=h;h=r?x[M+h]:-1)for(c=N[h];c<N[h+1];c++){s=I[c];var O=o(s,a,x,w,v,C,y);O.jleaf>=1&&S[a]++,2==O.jleaf&&S[O.q]--}-1!=e[a]&&(x[y+a]=e[a])}for(a=0;g>a;a++)-1!=e[a]&&(S[e[a]]+=S[a]);return S};return s}e.name="cs_counts",e.path="sparse",e.factory=r},function(t,e){"use strict";function n(){var t=function(t,e,n,r,i,o,s){var a,l,h,c,u=0;if(e>=t||n[r+e]<=n[i+t])return-1;if(n[i+t]=n[r+e],h=n[o+t],n[o+t]=e,-1===h)u=1,c=t;else{for(u=2,c=h;c!=n[s+c];c=n[s+c]);for(a=h;a!=c;a=l)l=n[s+a],n[s+a]=c}return{jleaf:u,q:c}};return t}e.name="cs_leaf",e.path="sparse",e.factory=n},function(t,e,n){"use strict";function r(t,e,r){var i=r(n(86)),o=r(n(81)),s=r(n(84)),a=r(n(64)),l=r(n(351)),h=r(n(352)),c=t.SparseMatrix,u=function(t,e,n){if(!t)return null;var r,u=t._size,d=u[1],p=100,f=100;e&&(r=e.q,p=e.lnz||p,f=e.unz||f);var g,m,x=[],y=[],v=[],C=new c({values:x,index:y,ptr:v,size:[d,d]}),w=[],b=[],M=[],S=new c({values:w,index:b,ptr:M,size:[d,d]}),E=[],I=[],N=[];for(g=0;d>g;g++)I[g]=0,E[g]=-1,v[g+1]=0;p=0,f=0;for(var O=0;d>O;O++){v[O]=p,M[O]=f;var T=r?r[O]:O,_=h(C,t,T,N,I,E,1),P=-1,A=-1;for(m=_;d>m;m++)if(g=N[m],E[g]<0){var k=i(I[g]);a(k,A)&&(A=k,P=g)}else b[f]=E[g],w[f++]=I[g];if(-1==P||0>=A)return null;E[T]<0&&l(i(I[T]),s(A,n))&&(P=T);var R=I[P];for(b[f]=O,w[f++]=R,E[P]=O,y[p]=P,x[p++]=1,m=_;d>m;m++)g=N[m],E[g]<0&&(y[p]=g,x[p++]=o(I[g],R)),I[g]=0}for(v[d]=p,M[d]=f,m=0;p>m;m++)y[m]=E[y[m]];return x.splice(p,x.length-p),y.splice(p,y.length-p),w.splice(f,w.length-f),b.splice(f,b.length-f),{L:C,U:S,pinv:E}};return u}e.name="cs_lu",e.path="sparse",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,s){var a=r(n(52)),l=r(n(61)),h=r(n(62)),c=r(n(63)),u=r(n(57)),d=r(n(58)),p=n(32),f=s("largerEq",{"boolean, boolean":function(t,e){return t>=e},"number, number":function(t,n){return t>=n||i(t,n,e.epsilon)},"BigNumber, BigNumber":function(t,n){return t.gte(n)||o(t,n,e.epsilon)},"Fraction, Fraction":function(t,e){return-1!==t.compare(e)},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return f(t.value,e.value)},"string, string":function(t,e){return t>=e},"Matrix, Matrix":function(t,e){var n;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":n=h(t,e,f);break;default:n=l(e,t,f,!0)}break;default:switch(e.storage()){case"sparse":n=l(t,e,f,!1);break;default:n=u(t,e,f)}}return n},"Array, Array":function(t,e){return f(a(t),a(e)).valueOf()},"Array, Matrix":function(t,e){return f(a(t),e)},"Matrix, Array":function(t,e){return f(t,a(e))},"Matrix, any":function(t,e){var n;switch(t.storage()){case"sparse":n=c(t,e,f,!1);break;default:n=d(t,e,f,!1)}return n},"any, Matrix":function(t,e){var n;switch(e.storage()){case"sparse":n=c(e,t,f,!0);break;default:n=d(e,t,f,!0)}return n},"Array, any":function(t,e){return d(a(t),e,f,!1).valueOf()},"any, Array":function(t,e){return d(a(e),t,f,!0).valueOf()}});return f.toTex={2:"\\left(${args[0]}"+p.operators.largerEq+"${args[1]}\\right)"},f}var i=n(6).nearlyEqual,o=n(49);e.name="largerEq",e.factory=r},function(t,e,n){"use strict";function r(t,e,r){var i=r(n(81)),o=r(n(84)),s=r(n(77)),a=r(n(353)),l=function(t,e,n,r,l,h,c){var u,d,p,f,g=t._values,m=t._index,x=t._ptr,y=t._size,v=y[1],C=e._values,w=e._index,b=e._ptr,M=a(t,e,n,r,h);for(u=M;v>u;u++)l[r[u]]=0;for(d=b[n],p=b[n+1],u=d;p>u;u++)l[w[u]]=C[u];for(var S=M;v>S;S++){var E=r[S],I=h?h[E]:E;if(!(0>I))for(d=x[I],p=x[I+1],l[E]=i(l[E],g[c?d:p-1]),u=c?d+1:d,f=c?p:p-1;f>u;u++){var N=m[u];l[N]=s(l[N],o(g[u],l[E]))}}return M};return l}e.name="cs_spsolve",e.path="sparse",e.factory=r},function(t,e,n){"use strict";function r(t,e,r){var i=r(n(354)),o=r(n(355)),s=r(n(356)),a=function(t,e,n,r,a){var l,h,c,u=t._ptr,d=t._size,p=e._index,f=e._ptr,g=d[1],m=g;for(h=f[n],c=f[n+1],l=h;c>l;l++){var x=p[l];o(u,x)||(m=i(x,t,m,r,a))}for(l=m;g>l;l++)s(u,r[l]);return m};return a}e.name="cs_reach",e.path="sparse",e.factory=r},function(t,e,n){"use strict";function r(t,e,r){var i=r(n(355)),o=r(n(356)),s=r(n(357)),a=function(t,e,n,r,a){var l,h,c,u=e._index,d=e._ptr,p=e._size,f=p[1],g=0;for(r[0]=t;g>=0;){t=r[g];var m=a?a[t]:t;i(d,t)||(o(d,t),r[f+g]=0>m?0:s(d[m]));var x=1;for(h=r[f+g],c=0>m?0:s(d[m+1]);c>h;h++)if(l=u[h],!i(d,l)){r[f+g]=h,r[++g]=l,x=0;break}x&&(g--,r[--n]=t)}return n};return a}e.name="cs_dfs",e.path="sparse",e.factory=r},function(t,e){"use strict";function n(){var t=function(t,e){return t[e]<0};return t}e.name="cs_marked",e.path="sparse",e.factory=n},function(t,e,n){"use strict";function r(t,e,r){var i=r(n(341)),o=function(t,e){t[e]=i(t[e])};return o}e.name="cs_mark",e.path="sparse",e.factory=r},function(t,e,n){"use strict";function r(t,e,r){var i=r(n(341)),o=function(t){return 0>t?i(t):t};return o}e.name="cs_unflip",e.path="sparse",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,i){var o=r(n(52)),s=r(n(81)),a=r(n(80)),l=r(n(77)),h=r(n(48)),c=r(n(359)),u=t.DenseMatrix,d=i("lsolve",{"SparseMatrix, Array | Matrix":function(t,e){return f(t,e)},"DenseMatrix, Array | Matrix":function(t,e){return p(t,e)},"Array, Array | Matrix":function(t,e){var n=o(t),r=p(n,e);return r.valueOf()}}),p=function(t,e){e=c(t,e,!0);for(var n=e._data,r=t._size[0],i=t._size[1],o=[],d=t._data,p=0;i>p;p++){var f,g=n[p][0]||0;if(h(g,0))f=0;else{var m=d[p][p];if(h(m,0))throw new Error("Linear system cannot be solved since matrix is singular");f=s(g,m);for(var x=p+1;r>x;x++)n[x]=[l(n[x][0]||0,a(f,d[x][p]))]}o[p]=[f]}return new u({data:o,size:[r,1]})},f=function(t,e){e=c(t,e,!0);for(var n,r,i=e._data,o=t._size[0],d=t._size[1],p=t._values,f=t._index,g=t._ptr,m=[],x=0;d>x;x++){var y=i[x][0]||0;if(h(y,0))m[x]=[0];else{var v=0,C=[],w=[],b=g[x+1];for(r=g[x];b>r;r++)n=f[r],n===x?v=p[r]:n>x&&(C.push(p[r]),w.push(n));if(h(v,0))throw new Error("Linear system cannot be solved since matrix is singular");var M=s(y,v);for(r=0,b=w.length;b>r;r++)n=w[r],i[n]=[l(i[n][0]||0,a(M,C[r]))];m[x]=[M]}}return new u({data:m,size:[o,1]})};return d}e.name="lsolve",e.factory=r},function(t,e,n){"use strict";function r(t){var e=t.DenseMatrix,n=function(t,n,r){var i=t.size();if(2!==i.length)throw new RangeError("Matrix must be two dimensional (size: "+o.format(i)+")");var l=i[0],h=i[1];if(l!==h)throw new RangeError("Matrix must be square (size: "+o.format(i)+")");var c,u,d;if(n&&n.isMatrix===!0){var p=n.size();if(1===p.length){if(p[0]!==l)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(c=[],d=n._data,u=0;l>u;u++)c[u]=[d[u]];return new e({data:c,size:[l,1],datatype:n._datatype})}if(2===p.length){if(p[0]!==l||1!==p[1])throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");if(n.isDenseMatrix===!0){if(r){for(c=[],d=n._data,u=0;l>u;u++)c[u]=[d[u][0]];return new e({data:c,size:[l,1],datatype:n._datatype})}return n}for(c=[],u=0;l>u;u++)c[u]=[0];for(var f=n._values,g=n._index,m=n._ptr,x=m[1],y=m[0];x>y;y++)u=g[y],c[u][0]=f[y];return new e({data:c,size:[l,1],datatype:n._datatype})}throw new RangeError("Dimension mismatch. Matrix columns must match vector length.")}if(a(n)){var v=s.size(n);if(1===v.length){if(v[0]!==l)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(c=[],u=0;l>u;u++)c[u]=[n[u]];return new e({data:c,size:[l,1]})}if(2===v.length){if(v[0]!==l||1!==v[1])throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(c=[],u=0;l>u;u++)c[u]=[n[u][0]];return new e({data:c,size:[l,1]})}throw new RangeError("Dimension mismatch. Matrix columns must match vector length.")}};return n}var i=n(39),o=i.string,s=i.array,a=Array.isArray;e.factory=r},function(t,e,n){"use strict";function r(t,e,r,o){var s=r(n(52)),a=r(n(337)),l=r(n(338)),h=r(n(361)),c=r(n(359)),u=r(n(362)),d=r(n(358)),p=o("lusolve",{"Array, Array | Matrix":function(t,e){t=s(t);var n=a(t),r=g(n.L,n.U,n.p,null,e);return r.valueOf()},"DenseMatrix, Array | Matrix":function(t,e){var n=a(t);return g(n.L,n.U,n.p,null,e)},"SparseMatrix, Array | Matrix":function(t,e){var n=a(t);return g(n.L,n.U,n.p,null,e)},"SparseMatrix, Array | Matrix, number, number":function(t,e,n,r){var i=l(t,n,r);return g(i.L,i.U,i.p,i.q,e)},"Object, Array | Matrix":function(t,e){return g(t.L,t.U,t.p,t.q,e)}}),f=function(t){if(t&&t.isMatrix===!0)return t;if(i(t))return s(t);throw new TypeError("Invalid Matrix LU decomposition")},g=function(t,e,n,r,i){t=f(t),e=f(e),i=c(t,i,!1),n&&(i._data=h(n,i._data));var o=d(t,i),s=u(e,o);return r&&(s._data=h(r,s._data)),s};return p}var i=Array.isArray;e.name="lusolve",e.factory=r},function(t,e){"use strict";function n(){var t=function(t,e,n){var r,n=e.length,i=[];if(t)for(r=0;n>r;r++)i[t[r]]=e[r];else for(r=0;n>r;r++)i[r]=e[r];return i};return t}e.name="cs_ipvec",e.path="sparse",e.factory=n},function(t,e,n){"use strict";function r(t,e,r,i){var o=r(n(52)),s=r(n(81)),a=r(n(80)),l=r(n(77)),h=r(n(48)),c=r(n(359)),u=t.DenseMatrix,d=i("usolve",{"SparseMatrix, Array | Matrix":function(t,e){return f(t,e)},"DenseMatrix, Array | Matrix":function(t,e){return p(t,e)},"Array, Array | Matrix":function(t,e){var n=o(t),r=p(n,e);return r.valueOf()}}),p=function(t,e){e=c(t,e,!0);for(var n=e._data,r=t._size[0],i=t._size[1],o=[],d=t._data,p=i-1;p>=0;p--){var f,g=n[p][0]||0;if(h(g,0))f=0;else{var m=d[p][p];if(h(m,0))throw new Error("Linear system cannot be solved since matrix is singular");f=s(g,m);for(var x=p-1;x>=0;x--)n[x]=[l(n[x][0]||0,a(f,d[x][p]))]}o[p]=[f]}return new u({data:o,size:[r,1]})},f=function(t,e){e=c(t,e,!0);for(var n,r,i=e._data,o=t._size[0],d=t._size[1],p=t._values,f=t._index,g=t._ptr,m=[],x=d-1;x>=0;x--){var y=i[x][0]||0;if(h(y,0))m[x]=[0];else{var v=0,C=[],w=[],b=g[x],M=g[x+1];for(r=M-1;r>=b;r--)n=f[r],n===x?v=p[r]:x>n&&(C.push(p[r]),w.push(n));if(h(v,0))throw new Error("Linear system cannot be solved since matrix is singular");var S=s(y,v);for(r=0,M=w.length;M>r;r++)n=w[r],i[n]=[l(i[n][0],a(S,C[r]))];m[x]=[S]}}return new u({data:m,size:[o,1]})};return d}e.name="usolve",e.factory=r},function(t,e,n){t.exports=[n(86),n(51),n(53),n(364),n(366),n(367),n(326),n(368),n(370),n(372),n(373),n(87),n(374),n(375),n(376),n(379),n(382),n(383),n(384),n(84),n(385),n(387),n(82),n(388),n(390),n(377),n(391),n(77),n(78),n(392),n(393)]},function(t,e,n){"use strict";function r(t,e,r,s){function a(n,r){var i=n.arg()/3,s=n.abs(),a=new t.Complex(o(s),0).mul(new t.Complex(0,i).exp());if(r){var l=[a,new t.Complex(o(s),0).mul(new t.Complex(0,i+2*Math.PI/3).exp()),new t.Complex(o(s),0).mul(new t.Complex(0,i-2*Math.PI/3).exp())];return"Array"===e.matrix?l:u(l)}return a}function l(e){if(e.value&&e.value.isComplex){var n=e.clone();return n.value=1,n=n.pow(1/3),n.value=a(e.value),n}var r=c(e.value);r&&(e.value=h(e.value));var i;i=e.value&&e.value.isBigNumber?new t.BigNumber(1).div(3):e.value&&e.value.isFraction?new t.Fraction(1,3):1/3;var n=e.pow(i);return r&&(n.value=h(n.value)),n}var h=r(n(78)),c=r(n(365)),u=r(n(52)),d=s("cbrt",{number:o,Complex:a,"Complex, boolean":a,BigNumber:function(t){return t.cbrt()},Unit:l,"Array | Matrix":function(t){return i(t,d,!0)}});return d.toTex={1:"\\sqrt[3]{${args[0]}}"},d}var i=n(19),o=Math.cbrt||function(t){if(0===t)return t;var e,n=0>t;return n&&(t=-t),isFinite(t)?(e=Math.exp(Math.log(t)/3),e=(t/(e*e)+2*e)/3):e=t,n?-e:e};e.name="cbrt",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("isNegative",{number:function(t){return 0>t},BigNumber:function(t){return t.isNeg()&&!t.isZero()&&!t.isNaN()},Fraction:function(t){return t.s<0},Unit:function(t){return o(t.value)},"Array | Matrix":function(t){return i(t,o)}});return o}var i=n(19);n(6),e.name="isNegative",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("ceil",{number:Math.ceil,Complex:function(t){return t.ceil()},BigNumber:function(t){return t.ceil()},Fraction:function(t){return t.ceil()},"Array | Matrix":function(t){return i(t,o,!0)}});return o.toTex={1:"\\left\\lceil${args[0]}\\right\\rceil"},o}var i=n(19);e.name="ceil",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("cube",{number:function(t){return t*t*t},Complex:function(t){return t.mul(t).mul(t)},BigNumber:function(t){return t.times(t).times(t)},Fraction:function(t){return t.pow(3)},"Array | Matrix":function(t){return i(t,o,!0)},Unit:function(t){return t.pow(3)}});return o.toTex={1:"\\left(${args[0]}\\right)^3"},o}var i=n(19);e.name="cube",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,i){var o=r(n(52)),s=r(n(81)),a=n(32),l=r(n(369)),h=r(n(61)),c=r(n(62)),u=r(n(85)),d=r(n(63)),p=r(n(57)),f=r(n(58)),g=i("dotDivide",{"any, any":s,"Matrix, Matrix":function(t,e){var n;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":n=c(t,e,s,!1);break;default:n=l(e,t,s,!0)}break;default:switch(e.storage()){case"sparse":n=h(t,e,s,!1);break;default:n=p(t,e,s)}}return n},"Array, Array":function(t,e){return g(o(t),o(e)).valueOf()},"Array, Matrix":function(t,e){return g(o(t),e)},"Matrix, Array":function(t,e){return g(t,o(e))},"Matrix, any":function(t,e){var n;switch(t.storage()){case"sparse":n=u(t,e,s,!1);break;default:n=f(t,e,s,!1)}return n},"any, Matrix":function(t,e){var n;switch(e.storage()){case"sparse":n=d(e,t,s,!0);break;default:n=f(e,t,s,!0)}return n},"Array, any":function(t,e){return f(o(t),e,s,!1).valueOf()},"any, Array":function(t,e){return f(o(e),t,s,!0).valueOf()}});return g.toTex={2:"\\left(${args[0]}"+a.operators.dotDivide+"${args[1]}\\right)"},g}e.name="dotDivide",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,o){var s=r(n(48)),a=t.SparseMatrix,l=function(t,e,n,r){var l=t._data,h=t._size,c=t._datatype,u=e._values,d=e._index,p=e._ptr,f=e._size,g=e._datatype;if(h.length!==f.length)throw new i(h.length,f.length);if(h[0]!==f[0]||h[1]!==f[1])throw new RangeError("Dimension mismatch. Matrix A ("+h+") must match Matrix B ("+f+")");if(!u)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var m,x=h[0],y=h[1],v=s,C=0,w=n;"string"==typeof c&&c===g&&(m=c,v=o.find(s,[m,m]),C=o.convert(0,m),w=o.find(n,[m,m]));for(var b=[],M=[],S=[],E=0;y>E;E++){S[E]=M.length;for(var I=p[E],N=p[E+1],O=I;N>O;O++){var T=d[O],_=r?w(u[O],l[T][E]):w(l[T][E],u[O]);v(_,C)||(M.push(T),b.push(_))}}return S[y]=M.length,new a({values:b,index:M,ptr:S,size:[x,y],datatype:m})};return l}var i=n(42);e.name="algorithm02",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,i){var o=r(n(52)),s=r(n(80)),a=n(32),l=r(n(369)),h=r(n(371)),c=r(n(85)),u=r(n(57)),d=r(n(58)),p=i("dotMultiply",{"any, any":s,"Matrix, Matrix":function(t,e){var n;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":n=h(t,e,s,!1);break;default:n=l(e,t,s,!0)}break;default:switch(e.storage()){case"sparse":n=l(t,e,s,!1);break;default:n=u(t,e,s)}}return n},"Array, Array":function(t,e){return p(o(t),o(e)).valueOf()},"Array, Matrix":function(t,e){return p(o(t),e)},"Matrix, Array":function(t,e){return p(t,o(e))},"Matrix, any":function(t,e){var n;switch(t.storage()){case"sparse":n=c(t,e,s,!1);break;default:n=d(t,e,s,!1)}return n},"any, Matrix":function(t,e){var n;switch(e.storage()){case"sparse":n=c(e,t,s,!0);break;default:n=d(e,t,s,!0)}return n},"Array, any":function(t,e){return d(o(t),e,s,!1).valueOf()},"any, Array":function(t,e){return d(o(e),t,s,!0).valueOf()}});return p.toTex={2:"\\left(${args[0]}"+a.operators.dotMultiply+"${args[1]}\\right)"},p}e.name="dotMultiply",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,o){var s=r(n(48)),a=t.SparseMatrix,l=function(t,e,n){var r=t._values,l=t._index,h=t._ptr,c=t._size,u=t._datatype,d=e._values,p=e._index,f=e._ptr,g=e._size,m=e._datatype;if(c.length!==g.length)throw new i(c.length,g.length);if(c[0]!==g[0]||c[1]!==g[1])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+g+")");var x,y=c[0],v=c[1],C=s,w=0,b=n;"string"==typeof u&&u===m&&(x=u,C=o.find(s,[x,x]),w=o.convert(0,x),b=o.find(n,[x,x]));var M,S,E,I,N,O=r&&d?[]:void 0,T=[],_=[],P=new a({values:O,index:T,ptr:_,size:[y,v],datatype:x}),A=O?[]:void 0,k=[];for(S=0;v>S;S++){_[S]=T.length;var R=S+1;if(A)for(I=f[S],N=f[S+1],E=I;N>E;E++)M=p[E],k[M]=R,A[M]=d[E];for(I=h[S],N=h[S+1],E=I;N>E;E++)if(M=l[E],A){var z=k[M]===R?A[M]:w,B=b(r[E],z);C(B,w)||(T.push(M),O.push(B))}else T.push(M)}return _[v]=T.length,P};return l}var i=n(42);e.name="algorithm09",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,i){var o=r(n(52)),s=r(n(82)),a=n(32),l=r(n(61)),h=r(n(62)),c=r(n(85)),u=r(n(63)),d=r(n(57)),p=r(n(58)),f=i("dotPow",{"any, any":s,"Matrix, Matrix":function(t,e){var n;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":n=h(t,e,s,!1);break;default:n=l(e,t,s,!0)}break;default:switch(e.storage()){case"sparse":n=l(t,e,s,!1);break;default:n=d(t,e,s)}}return n},"Array, Array":function(t,e){return f(o(t),o(e)).valueOf()},"Array, Matrix":function(t,e){return f(o(t),e)},"Matrix, Array":function(t,e){return f(t,o(e))},"Matrix, any":function(t,e){var n;switch(t.storage()){case"sparse":n=c(t,e,f,!1);break;default:n=p(t,e,f,!1)}return n},"any, Matrix":function(t,e){var n;switch(e.storage()){case"sparse":n=u(e,t,f,!0);break;default:n=p(e,t,f,!0)}return n},"Array, any":function(t,e){return p(o(t),e,f,!1).valueOf()},"any, Array":function(t,e){return p(o(e),t,f,!0).valueOf()}});return f.toTex={2:"\\left(${args[0]}"+a.operators.dotPow+"${args[1]}\\right)"},f}e.name="dotPow",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("exp",{number:Math.exp,Complex:function(t){return t.exp()},BigNumber:function(t){return t.exp()},"Array | Matrix":function(t){return i(t,o)}});return o.toTex={1:"\\exp\\left(${args[0]}\\right)"},o}var i=n(19);e.name="exp",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("floor",{number:Math.floor,Complex:function(t){return t.floor()},BigNumber:function(t){return t.floor()},Fraction:function(t){return t.floor()},"Array | Matrix":function(t){return i(t,o,!0)}});return o.toTex={1:"\\left\\lfloor${args[0]}\\right\\rfloor"},o}var i=n(19);e.name="floor",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,o){function s(e,n){if(!e.isInt()||!n.isInt())throw new Error("Parameters in function gcd must be integer numbers");for(var r=new t.BigNumber(0);!n.isZero();){var i=e.mod(n);e=n,n=i}return e.lt(r)?e.neg():e}var a=r(n(52)),l=r(n(54)),h=r(n(55)),c=r(n(56)),u=r(n(57)),d=r(n(58)),p=o("gcd",{"number, number":i,"BigNumber, BigNumber":s,"Fraction, Fraction":function(t,e){return t.gcd(e)},"Matrix, Matrix":function(t,e){var n;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":n=h(t,e,p);break;default:n=l(e,t,p,!0)}break;default:switch(e.storage()){case"sparse":n=l(t,e,p,!1);break;default:n=u(t,e,p)}}return n},"Array, Array":function(t,e){return p(a(t),a(e)).valueOf()},"Array, Matrix":function(t,e){
return p(a(t),e)},"Matrix, Array":function(t,e){return p(t,a(e))},"Matrix, number | BigNumber":function(t,e){var n;switch(t.storage()){case"sparse":n=c(t,e,p,!1);break;default:n=d(t,e,p,!1)}return n},"number | BigNumber, Matrix":function(t,e){var n;switch(e.storage()){case"sparse":n=c(e,t,p,!0);break;default:n=d(e,t,p,!0)}return n},"Array, number | BigNumber":function(t,e){return d(a(t),e,p,!1).valueOf()},"number | BigNumber, Array":function(t,e){return d(a(e),t,p,!0).valueOf()},"Array | Matrix | number | BigNumber, Array | Matrix | number | BigNumber, ...Array | Matrix | number | BigNumber":function(t,e,n){for(var r=p(t,e),i=0;i<n.length;i++)r=p(r,n[i]);return r}});return p.toTex="\\gcd\\left(${args}\\right)",p}function i(t,e){if(!o(t)||!o(e))throw new Error("Parameters in function gcd must be integer numbers");for(var n;0!=e;)n=t%e,t=e,e=n;return 0>t?-t:t}var o=n(6).isInteger;e.name="gcd",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,o){function s(t){for(var e=0,n=0,r=0;r<t.length;r++){var i=a(t[r]);d(n,i)?(e=c(e,c(h(n,i),h(n,i))),e=l(e,1),n=i):e=l(e,p(i)?c(h(i,n),h(i,n)):i)}return c(n,u(e))}var a=r(n(86)),l=r(n(53)),h=r(n(81)),c=r(n(80)),u=r(n(377)),d=r(n(60)),p=r(n(378)),f=o("hypot",{"... number | BigNumber":s,Array:function(t){return f.apply(f,i(t))},Matrix:function(t){return f.apply(f,i(t.toArray()))}});return f.toTex="\\hypot\\left(${args}\\right)",f}var i=n(40).flatten;e.name="hypot",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){function o(n){return n>=0||e.predictable?Math.sqrt(n):new t.Complex(n,0).sqrt()}var s=r("sqrt",{number:o,Complex:function(t){return t.sqrt()},BigNumber:function(t){return!t.isNegative()||e.predictable?t.sqrt():o(t.toNumber())},"Array | Matrix":function(t){return i(t,s,!0)},Unit:function(t){return t.pow(.5)}});return s.toTex={1:"\\sqrt{${args[0]}}"},s}var i=n(19);e.name="sqrt",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("isPositive",{number:function(t){return t>0},BigNumber:function(t){return!t.isNeg()&&!t.isZero()&&!t.isNaN()},Fraction:function(t){return t.s>0&&t.n>0},Unit:function(t){return o(t.value)},"Array | Matrix":function(t){return i(t,o)}});return o}var i=n(19);n(6),e.name="isPositive",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,o){function s(e,n){if(!e.isInt()||!n.isInt())throw new Error("Parameters in function lcm must be integer numbers");if(e.isZero()||n.isZero())return new t.BigNumber(0);for(var r=e.times(n);!n.isZero();){var i=n;n=e.mod(i),e=i}return r.div(e).abs()}var a=r(n(52)),l=r(n(369)),h=r(n(380)),c=r(n(85)),u=r(n(57)),d=r(n(58)),p=o("lcm",{"number, number":i,"BigNumber, BigNumber":s,"Fraction, Fraction":function(t,e){return t.lcm(e)},"Matrix, Matrix":function(t,e){var n;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":n=h(t,e,p);break;default:n=l(e,t,p,!0)}break;default:switch(e.storage()){case"sparse":n=l(t,e,p,!1);break;default:n=u(t,e,p)}}return n},"Array, Array":function(t,e){return p(a(t),a(e)).valueOf()},"Array, Matrix":function(t,e){return p(a(t),e)},"Matrix, Array":function(t,e){return p(t,a(e))},"Matrix, number | BigNumber":function(t,e){var n;switch(t.storage()){case"sparse":n=c(t,e,p,!1);break;default:n=d(t,e,p,!1)}return n},"number | BigNumber, Matrix":function(t,e){var n;switch(e.storage()){case"sparse":n=c(e,t,p,!0);break;default:n=d(e,t,p,!0)}return n},"Array, number | BigNumber":function(t,e){return d(a(t),e,p,!1).valueOf()},"number | BigNumber, Array":function(t,e){return d(a(e),t,p,!0).valueOf()},"Array | Matrix | number | BigNumber, Array | Matrix | number | BigNumber, ...Array | Matrix | number | BigNumber":function(t,e,n){for(var r=p(t,e),i=0;i<n.length;i++)r=p(r,n[i]);return r}});return p.toTex=void 0,p}function i(t,e){if(!o(t)||!o(e))throw new Error("Parameters in function lcm must be integer numbers");if(0==t||0==e)return 0;for(var n,r=t*e;0!=e;)n=e,e=t%n,t=n;return Math.abs(r/t)}var o=n(6).isInteger;e.name="lcm",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,s){var a=r(n(48)),l=t.SparseMatrix,h=function(t,e,n){var r=t._values,h=t._size,c=t._datatype,u=e._values,d=e._size,p=e._datatype;if(h.length!==d.length)throw new o(h.length,d.length);if(h[0]!==d[0]||h[1]!==d[1])throw new RangeError("Dimension mismatch. Matrix A ("+h+") must match Matrix B ("+d+")");var f,g=h[0],m=h[1],x=a,y=0,v=n;"string"==typeof c&&c===p&&(f=c,x=s.find(a,[f,f]),y=s.convert(0,f),v=s.find(n,[f,f]));for(var C=r&&u?[]:void 0,w=[],b=[],M=new l({values:C,index:w,ptr:b,size:[g,m],datatype:f}),S=C?[]:void 0,E=[],I=[],N=0;m>N;N++){b[N]=w.length;var O=N+1;if(i(t,N,E,S,I,O,M,v),i(e,N,E,S,I,O,M,v),S)for(var T=b[N];T<w.length;){var _=w[T];if(I[_]===O){var P=S[_];x(P,y)?w.splice(T,1):(C.push(P),T++)}else w.splice(T,1)}else for(var A=b[N];A<w.length;){var k=w[A];I[k]!==O?w.splice(A,1):A++}}return b[m]=w.length,M};return h}var i=n(381),o=n(42);e.name="algorithm06",e.factory=r},function(t,e){"use strict";t.exports=function(t,e,n,r,i,o,s,a,l,h,c){var u,d,p,f,g=t._values,m=t._index,x=t._ptr,y=s._index;if(r)for(d=x[e],p=x[e+1],u=d;p>u;u++)f=m[u],n[f]!==o?(n[f]=o,y.push(f),h?(r[f]=l?a(g[u],c):a(c,g[u]),i[f]=o):r[f]=g[u]):(r[f]=l?a(g[u],r[f]):a(r[f],g[u]),i[f]=o);else for(d=x[e],p=x[e+1],u=d;p>u;u++)f=m[u],n[f]!==o?(n[f]=o,y.push(f)):i[f]=o}},function(t,e,n){"use strict";function r(t,e,r,o){var s=r(n(81)),a=o("log",{number:function(n){return n>=0||e.predictable?Math.log(n):new t.Complex(n,0).log()},Complex:function(t){return t.log()},BigNumber:function(n){return!n.isNegative()||e.predictable?n.ln():new t.Complex(n.toNumber(),0).log()},"Array | Matrix":function(t){return i(t,a)},"any, any":function(t,e){return s(a(t),a(e))}});return a.toTex={1:"\\ln\\left(${args[0]}\\right)",2:"\\log_{${args[1]}}\\left(${args[0]}\\right)"},a}var i=n(19);e.name="log",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var s=r("log10",{number:function(n){return n>=0||e.predictable?o(n):new t.Complex(n,0).log().div(Math.LN10)},Complex:function(e){return new t.Complex(e).log().div(Math.LN10)},BigNumber:function(n){return!n.isNegative()||e.predictable?n.log():new t.Complex(n.toNumber(),0).log().div(Math.LN10)},"Array | Matrix":function(t){return i(t,s)}});return s.toTex={1:"\\log_{10}\\left(${args[0]}\\right)"},s}var i=n(19),o=Math.log10||function(t){return Math.log(t)/Math.LN10};e.name="log10",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,i){function o(t,e){if(e>0)return t-e*Math.floor(t/e);if(0===e)return t;throw new Error("Cannot calculate mod for a negative divisor")}var s=r(n(52)),a=n(32),l=r(n(369)),h=r(n(61)),c=r(n(79)),u=r(n(85)),d=r(n(63)),p=r(n(57)),f=r(n(58)),g=i("mod",{"number, number":o,"BigNumber, BigNumber":function(t,e){return e.isZero()?t:t.mod(e)},"Fraction, Fraction":function(t,e){return t.mod(e)},"Matrix, Matrix":function(t,e){var n;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":n=c(t,e,g,!1);break;default:n=l(e,t,g,!0)}break;default:switch(e.storage()){case"sparse":n=h(t,e,g,!1);break;default:n=p(t,e,g)}}return n},"Array, Array":function(t,e){return g(s(t),s(e)).valueOf()},"Array, Matrix":function(t,e){return g(s(t),e)},"Matrix, Array":function(t,e){return g(t,s(e))},"Matrix, any":function(t,e){var n;switch(t.storage()){case"sparse":n=u(t,e,g,!1);break;default:n=f(t,e,g,!1)}return n},"any, Matrix":function(t,e){var n;switch(e.storage()){case"sparse":n=d(e,t,g,!0);break;default:n=f(e,t,g,!0)}return n},"Array, any":function(t,e){return f(s(t),e,g,!1).valueOf()},"any, Array":function(t,e){return f(s(e),t,g,!0).valueOf()}});return g.toTex={2:"\\left(${args[0]}"+a.operators.mod+"${args[1]}\\right)"},g}e.name="mod",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,i){function o(t,e){var n=t.size();if(1==n.length){if(e===Number.POSITIVE_INFINITY||"inf"===e){var r=0;return t.forEach(function(t){var e=s(t);d(e,r)&&(r=e)},!0),r}if(e===Number.NEGATIVE_INFINITY||"-inf"===e){var i;return t.forEach(function(t){var e=s(t);i&&!p(e,i)||(i=e)},!0),i||0}if("fro"===e)return o(t,2);if("number"==typeof e&&!isNaN(e)){if(!u(e,0)){var f=0;return t.forEach(function(t){f=a(l(s(t),e),f)},!0),l(f,1/e)}return Number.POSITIVE_INFINITY}throw new Error("Unsupported parameter value")}if(2==n.length){if(1===e){var x=[],y=0;return t.forEach(function(t,e){var n=e[1],r=a(x[n]||0,s(t));d(r,y)&&(y=r),x[n]=r},!0),y}if(e===Number.POSITIVE_INFINITY||"inf"===e){var v=[],C=0;return t.forEach(function(t,e){var n=e[0],r=a(v[n]||0,s(t));d(r,C)&&(C=r),v[n]=r},!0),C}if("fro"===e)return h(g(c(m(t),t)));if(2===e)throw new Error("Unsupported parameter value, missing implementation of matrix singular value decomposition");throw new Error("Unsupported parameter value")}}var s=r(n(86)),a=r(n(51)),l=r(n(82)),h=r(n(377)),c=r(n(84)),u=r(n(48)),d=r(n(64)),p=r(n(60)),f=r(n(52)),g=r(n(386)),m=r(n(344)),x=i("norm",{number:Math.abs,Complex:function(t){return t.abs()},BigNumber:function(t){return t.abs()},"boolean | null":function(t){return Math.abs(t)},Array:function(t){return o(f(t),2)},Matrix:function(t){return o(t,2)},"number | Complex | BigNumber | boolean | null, number | BigNumber | string":function(t){return x(t)},"Array, number | BigNumber | string":function(t,e){return o(f(t),e)},"Matrix, number | BigNumber | string":function(t,e){return o(t,e)}});return x.toTex={1:"\\left\\|${args[0]}\\right\\|",2:void 0},x}e.name="norm",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,s){var a=r(n(52)),l=r(n(51)),h=s("trace",{Array:function(t){return h(a(t))},Matrix:function(t){var e;switch(t.storage()){case"dense":e=c(t);break;case"sparse":e=u(t)}return e},any:i}),c=function(t){var e=t._size,n=t._data;switch(e.length){case 1:if(1==e[0])return i(n[0]);throw new RangeError("Matrix must be square (size: "+o(e)+")");case 2:var r=e[0],s=e[1];if(r===s){for(var a=0,h=0;r>h;h++)a=l(a,n[h][h]);return a}throw new RangeError("Matrix must be square (size: "+o(e)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+o(e)+")")}},u=function(t){var e=t._values,n=t._index,r=t._ptr,i=t._size,s=i[0],a=i[1];if(s===a){var h=0;if(e.length>0)for(var c=0;a>c;c++)for(var u=r[c],d=r[c+1],p=u;d>p;p++){var f=n[p];if(f===c){h=l(h,e[p]);break}if(f>c)break}return h}throw new RangeError("Matrix must be square (size: "+o(i)+")")};return h.toTex={1:"\\mathrm{tr}\\left(${args[0]}\\right)"},h}var i=n(3).clone,o=n(23).format;e.name="trace",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,s){function a(e,n){var r=t.BigNumber.precision,i=t.BigNumber.clone({precision:r+2}),o=new t.BigNumber(0),s=new i(1),a=n.isNegative();if(a&&(n=n.neg()),n.isZero())throw new Error("Root must be non-zero");if(e.isNegative()&&!n.abs().mod(2).equals(1))throw new Error("Root must be odd when a is negative.");if(e.isZero())return a?new i(1/0):0;if(!e.isFinite())return a?o:e;var l=e.abs().pow(s.div(n));return l=e.isNeg()?l.neg():l,new t.BigNumber((a?s.div(l):l).toPrecision(r))}var l=r(n(52)),h=r(n(54)),c=r(n(369)),u=r(n(380)),d=r(n(85)),p=r(n(57)),f=r(n(58)),g=s("nthRoot",{number:function(t){return i(t,2)},"number, number":i,BigNumber:function(e){return a(e,new t.BigNumber(2))},Complex:function(t){return o(t,2)},"Complex, number":o,"BigNumber, BigNumber":a,"Array | Matrix":function(t){return g(t,2)},"Matrix, Matrix":function(t,e){var n;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":if(1!==e.density())throw new Error("Root must be non-zero");n=u(t,e,g);break;default:n=c(e,t,g,!0)}break;default:switch(e.storage()){case"sparse":if(1!==e.density())throw new Error("Root must be non-zero");n=h(t,e,g,!1);break;default:n=p(t,e,g)}}return n},"Array, Array":function(t,e){return g(l(t),l(e)).valueOf()},"Array, Matrix":function(t,e){return g(l(t),e)},"Matrix, Array":function(t,e){return g(t,l(e))},"Matrix, number | BigNumber":function(t,e){var n;switch(t.storage()){case"sparse":n=d(t,e,g,!1);break;default:n=f(t,e,g,!1)}return n},"number | BigNumber, Matrix":function(t,e){var n;switch(e.storage()){case"sparse":if(1!==e.density())throw new Error("Root must be non-zero");n=d(e,t,g,!0);break;default:n=f(e,t,g,!0)}return n},"Array, number | BigNumber":function(t,e){return g(l(t),e).valueOf()},"number | BigNumber, Array":function(t,e){return g(t,l(e)).valueOf()}});return g.toTex={2:"\\sqrt[${args[1]}]{${args[0]}}"},g}function i(t,e){var n=0>e;if(n&&(e=-e),0===e)throw new Error("Root must be non-zero");if(0>t&&Math.abs(e)%2!=1)throw new Error("Root must be odd when a is negative.");if(0==t)return n?1/0:0;if(!isFinite(t))return n?0:t;var r=Math.pow(Math.abs(t),1/e);return r=0>t?-r:r,n?1/r:r}function o(t,e){if(0>e)throw new Error("Root must be greater than zero");if(0===e)throw new Error("Root must be non-zero");if(e%1!==0)throw new Error("Root must be an integer");for(var n=t.arg(),r=t.abs(),i=[],o=Math.pow(r,1/e),s=0;e>s;s++)i.push({r:o,phi:(n+2*Math.PI*s)/e});return i}e.name="nthRoot",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,s){var h=r(n(52)),c=r(n(48)),u=r(n(389)),d=r(n(85)),p=r(n(63)),f=r(n(58)),g=s("round",{number:Math.round,"number, number":function(t,e){if(!o(e))throw new TypeError(l);if(0>e||e>15)throw new Error("Number of decimals in function round must be in te range of 0-15");return i(t,e)},Complex:function(t){return t.round()},"Complex, number":function(t,e){if(e%1)throw new TypeError(l);return t.round(e)},"Complex, BigNumber":function(t,e){if(!e.isInteger())throw new TypeError(l);var n=e.toNumber();return t.round(n)},"number, BigNumber":function(e,n){if(!n.isInteger())throw new TypeError(l);return new t.BigNumber(e).toDecimalPlaces(n.toNumber())},BigNumber:function(t){return t.toDecimalPlaces(0)},"BigNumber, BigNumber":function(t,e){if(!e.isInteger())throw new TypeError(l);return t.toDecimalPlaces(e.toNumber())},Fraction:function(t){return t.round()},"Fraction, number":function(t,e){if(e%1)throw new TypeError(l);return t.round(e)},"Array | Matrix":function(t){return a(t,g,!0)},"Matrix, number | BigNumber":function(t,e){var n;switch(t.storage()){case"sparse":n=d(t,e,g,!1);break;default:n=f(t,e,g,!1)}return n},"number | Complex | BigNumber, Matrix":function(t,e){if(!c(t,0)){var n;switch(e.storage()){case"sparse":n=p(e,t,g,!0);break;default:n=f(e,t,g,!0)}return n}return u(e.size(),e.storage())},"Array, number | BigNumber":function(t,e){return f(h(t),e,g,!1).valueOf()},"number | Complex | BigNumber, Array":function(t,e){return f(h(e),t,g,!0).valueOf()}});return g.toTex={1:"\\left\\lfloor${args[0]}\\right\\rceil",2:void 0},g}function i(t,e){return parseFloat(s(t,e))}var o=n(6).isInteger,s=n(6).toFixed,a=n(19),l="Number of decimals in function round must be an integer";e.name="round",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,s){function a(e,n){var r=l(e),i=r?new t.BigNumber(0):0;if(h(e),n){var s=c(n);return e.length>0?s.resize(e,i):s}var a=[];return e.length>0?o(a,e,i):a}function l(t){var e=!1;return t.forEach(function(t,n,r){t&&t.isBigNumber===!0&&(e=!0,r[n]=t.toNumber())}),e}function h(t){t.forEach(function(t){if("number"!=typeof t||!i(t)||0>t)throw new Error("Parameters in function zeros must be positive integers")})}var c=r(n(52)),u=s("zeros",{"":function(){return"Array"===e.matrix?a([]):a([],"default")},"...number | BigNumber | string":function(t){var n=t[t.length-1];if("string"==typeof n){var r=t.pop();return a(t,r)}return"Array"===e.matrix?a(t):a(t,"default")},Array:a,Matrix:function(t){var e=t.storage();return a(t.valueOf(),e)},"Array | Matrix, string":function(t,e){return a(t.valueOf(),e)}});return u.toTex=void 0,u}var i=n(6).isInteger,o=n(40).resize;e.name="zeros",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var s=r("sign",{number:i.sign,Complex:function(t){return t.sign()},BigNumber:function(e){return new t.BigNumber(e.cmp(0))},Fraction:function(e){return new t.Fraction(e.s,1)},"Array | Matrix":function(t){return o(t,s,!0)},Unit:function(t){return s(t.value)}});return s.toTex={1:"\\mathrm{${name}}\\left(${args[0]}\\right)"},s}var i=n(6),o=n(19);e.name="sign",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("square",{number:function(t){return t*t},Complex:function(t){return t.mul(t)},BigNumber:function(t){return t.times(t)},Fraction:function(t){return t.mul(t)},"Array | Matrix":function(t){return i(t,o,!0)},Unit:function(t){return t.pow(2)}});return o.toTex={1:"\\left(${args[0]}\\right)^2"},o}var i=n(19);e.name="square",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,o){var s=n(32),a=o("unaryPlus",{number:function(t){return t},Complex:function(t){return t},BigNumber:function(t){return t},Fraction:function(t){return t},Unit:function(t){return t.clone()},"Array | Matrix":function(t){return i(t,a,!0)},"boolean | string | null":function(n){return"BigNumber"==e.number?new t.BigNumber((+n)):+n}});return a.toTex={1:s.operators.unaryPlus+"\\left(${args[0]}\\right)"},a}var i=n(19);e.name="unaryPlus",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,o){function s(t,n){var r,o,s,a=0,h=1,c=1,u=0;if(!i(t)||!i(n))throw new Error("Parameters in function xgcd must be integer numbers");for(;n;)o=Math.floor(t/n),s=t%n,r=a,a=h-o*a,h=r,r=c,c=u-o*c,u=r,t=n,n=s;var d;return d=0>t?[-t,-h,-u]:[t,t?h:0,u],"Array"===e.matrix?d:l(d)}function a(n,r){var i,o,s,a=new t.BigNumber(0),h=new t.BigNumber(1),c=a,u=h,d=h,p=a;if(!n.isInt()||!r.isInt())throw new Error("Parameters in function xgcd must be integer numbers");for(;!r.isZero();)o=n.div(r).floor(),s=n.mod(r),i=c,c=u.minus(o.times(c)),u=i,i=d,d=p.minus(o.times(d)),p=i,n=r,r=s;var f;return f=n.lt(a)?[n.neg(),u.neg(),p.neg()]:[n,n.isZero()?0:u,p],"Array"===e.matrix?f:l(f)}var l=r(n(52)),h=o("xgcd",{"number, number":s,"BigNumber, BigNumber":a});return h.toTex=void 0,h}var i=n(6).isInteger;e.name="xgcd",e.factory=r},function(t,e,n){t.exports=[n(395),n(399),n(400),n(402),n(404),n(407),n(409)]},function(t,e,n){"use strict";function r(t,e,r,s){var a=n(32),l=r(n(52)),h=r(n(369)),c=r(n(380)),u=r(n(85)),d=r(n(57)),p=r(n(58)),f=s("bitAnd",{"number, number":function(t,e){if(!i(t)||!i(e))throw new Error("Integers expected in function bitAnd");return t&e},"BigNumber, BigNumber":o,"Matrix, Matrix":function(t,e){var n;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":n=c(t,e,f,!1);break;default:n=h(e,t,f,!0)}break;default:switch(e.storage()){case"sparse":n=h(t,e,f,!1);break;default:n=d(t,e,f)}}return n},"Array, Array":function(t,e){return f(l(t),l(e)).valueOf()},"Array, Matrix":function(t,e){return f(l(t),e)},"Matrix, Array":function(t,e){return f(t,l(e))},"Matrix, any":function(t,e){var n;switch(t.storage()){case"sparse":n=u(t,e,f,!1);break;default:n=p(t,e,f,!1)}return n},"any, Matrix":function(t,e){var n;switch(e.storage()){case"sparse":n=u(e,t,f,!0);break;default:n=p(e,t,f,!0)}return n},"Array, any":function(t,e){return p(l(t),e,f,!1).valueOf()},"any, Array":function(t,e){return p(l(e),t,f,!0).valueOf()}});return f.toTex={2:"\\left(${args[0]}"+a.operators.bitAnd+"${args[1]}\\right)"},f}var i=n(6).isInteger,o=n(396);e.name="bitAnd",e.factory=r},function(t,e,n){var r=n(397);t.exports=function(t,e){if(t.isFinite()&&!t.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function bitAnd");var n=t.constructor;if(t.isNaN()||e.isNaN())return new n(NaN);if(t.isZero()||e.eq(-1)||t.eq(e))return t;if(e.isZero()||t.eq(-1))return e;if(!t.isFinite()||!e.isFinite()){if(!t.isFinite()&&!e.isFinite())return t.isNegative()==e.isNegative()?t:new n(0);if(!t.isFinite())return e.isNegative()?t:t.isNegative()?new n(0):e;if(!e.isFinite())return t.isNegative()?e:e.isNegative()?new n(0):t}return r(t,e,function(t,e){return t&e})}},function(t,e,n){function r(t){for(var e=t.d,n=e[0]+"",r=1;r<e.length;++r){for(var i=e[r]+"",o=7-i.length;o--;)i="0"+i;n+=i}var s;for(s=n.length-1;"0"==n.charAt(s);--s);var a=t.e,l=n.slice(0,s+1||1),h=l.length;if(a>0)if(++a>h)for(a-=h;a--;l+="0");else h>a&&(l=l.slice(0,a)+"."+l.slice(a));for(var c=[0],r=0;r<l.length;){for(var u=c.length;u--;c[u]*=10);c[0]+=l.charAt(r++)<<0;for(var s=0;s<c.length;++s)c[s]>1&&(null==c[s+1]&&(c[s+1]=0),c[s+1]+=c[s]>>1,c[s]&=1)}return c.reverse()}var i=n(398);t.exports=function(t,e,n){var o,s,a=t.constructor,l=+(t.s<0),h=+(e.s<0);if(l){o=r(i(t));for(var c=0;c<o.length;++c)o[c]^=1}else o=r(t);if(h){s=r(i(e));for(var c=0;c<s.length;++c)s[c]^=1}else s=r(e);var u,d,p;o.length<=s.length?(u=o,d=s,p=l):(u=s,d=o,p=h);var f=u.length,g=d.length,m=1^n(l,h),x=new a(1^m),y=new a(1),v=new a(2),C=a.precision;for(a.config({precision:1e9});f>0;)n(u[--f],d[--g])==m&&(x=x.plus(y)),y=y.times(v);for(;g>0;)n(p,d[--g])==m&&(x=x.plus(y)),y=y.times(v);return a.config({precision:C}),0==m&&(x.s=-x.s),x}},function(t,e){t.exports=function(t){if(t.isFinite()&&!t.isInteger())throw new Error("Integer expected in function bitNot");var e=t.constructor,n=e.precision;e.config({precision:1e9});var t=t.plus(new e(1));return t.s=-t.s||null,e.config({precision:n}),t}},function(t,e,n){"use strict";function r(t,e,r,a){var l=n(32),h=a("bitNot",{number:function(t){if(!s(t))throw new Error("Integer expected in function bitNot");return~t},BigNumber:o,"Array | Matrix":function(t){return i(t,h)}});return h.toTex={1:l.operators.bitNot+"\\left(${args[0]}\\right)"},h}var i=n(19),o=n(398),s=n(6).isInteger;e.name="bitNot",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,s){var a=n(32),l=r(n(52)),h=r(n(54)),c=r(n(55)),u=r(n(56)),d=r(n(57)),p=r(n(58)),f=s("bitOr",{"number, number":function(t,e){if(!i(t)||!i(e))throw new Error("Integers expected in function bitOr");return t|e},"BigNumber, BigNumber":o,"Matrix, Matrix":function(t,e){var n;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":n=c(t,e,f);break;default:n=h(e,t,f,!0)}break;default:switch(e.storage()){case"sparse":n=h(t,e,f,!1);break;default:n=d(t,e,f)}}return n},"Array, Array":function(t,e){return f(l(t),l(e)).valueOf()},"Array, Matrix":function(t,e){return f(l(t),e)},"Matrix, Array":function(t,e){return f(t,l(e))},"Matrix, any":function(t,e){var n;switch(t.storage()){case"sparse":n=u(t,e,f,!1);break;default:n=p(t,e,f,!1)}return n},"any, Matrix":function(t,e){var n;switch(e.storage()){case"sparse":n=u(e,t,f,!0);break;default:n=p(e,t,f,!0)}return n},"Array, any":function(t,e){return p(l(t),e,f,!1).valueOf()},"any, Array":function(t,e){return p(l(e),t,f,!0).valueOf()}});return f.toTex={2:"\\left(${args[0]}"+a.operators.bitOr+"${args[1]}\\right)"},f}var i=n(6).isInteger,o=n(401);e.name="bitOr",e.factory=r},function(t,e,n){var r=n(397);t.exports=function(t,e){if(t.isFinite()&&!t.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function bitOr");var n=t.constructor;if(t.isNaN()||e.isNaN())return new n(NaN);var i=new n((-1));return t.isZero()||e.eq(i)||t.eq(e)?e:e.isZero()||t.eq(i)?t:t.isFinite()&&e.isFinite()?r(t,e,function(t,e){return t|e}):!t.isFinite()&&!t.isNegative()&&e.isNegative()||t.isNegative()&&!e.isNegative()&&!e.isFinite()?i:t.isNegative()&&e.isNegative()?t.isFinite()?t:e:t.isFinite()?e:t}},function(t,e,n){"use strict";function r(t,e,r,s){var a=n(32),l=r(n(52)),h=r(n(61)),c=r(n(62)),u=r(n(63)),d=r(n(57)),p=r(n(58)),f=s("bitXor",{"number, number":function(t,e){if(!i(t)||!i(e))throw new Error("Integers expected in function bitXor");return t^e},"BigNumber, BigNumber":o,"Matrix, Matrix":function(t,e){var n;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":n=c(t,e,f);break;default:n=h(e,t,f,!0)}break;default:switch(e.storage()){case"sparse":n=h(t,e,f,!1);break;default:n=d(t,e,f)}}return n},"Array, Array":function(t,e){return f(l(t),l(e)).valueOf()},"Array, Matrix":function(t,e){return f(l(t),e)},"Matrix, Array":function(t,e){return f(t,l(e))},"Matrix, any":function(t,e){var n;switch(t.storage()){case"sparse":n=u(t,e,f,!1);break;default:n=p(t,e,f,!1)}return n},"any, Matrix":function(t,e){var n;switch(e.storage()){case"sparse":n=u(e,t,f,!0);break;default:n=p(e,t,f,!0)}return n},"Array, any":function(t,e){return p(l(t),e,f,!1).valueOf()},"any, Array":function(t,e){return p(l(e),t,f,!0).valueOf()}});return f.toTex={2:"\\left(${args[0]}"+a.operators.bitXor+"${args[1]}\\right)"},f}var i=n(6).isInteger,o=n(403);e.name="bitXor",e.factory=r},function(t,e,n){var r=n(397),i=n(398);t.exports=function(t,e){if(t.isFinite()&&!t.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function bitXor");var n=t.constructor;if(t.isNaN()||e.isNaN())return new n(NaN);if(t.isZero())return e;if(e.isZero())return t;if(t.eq(e))return new n(0);var o=new n((-1));return t.eq(o)?i(e):e.eq(o)?i(t):t.isFinite()&&e.isFinite()?r(t,e,function(t,e){return t^e}):t.isFinite()||e.isFinite()?new n(t.isNegative()==e.isNegative()?1/0:-(1/0)):o}},function(t,e,n){"use strict";function r(t,e,r,s){var a=n(32),l=r(n(52)),h=r(n(48)),c=r(n(389)),u=r(n(54)),d=r(n(369)),p=r(n(406)),f=r(n(56)),g=r(n(85)),m=r(n(57)),x=r(n(58)),y=s("leftShift",{"number, number":function(t,e){if(!i(t)||!i(e))throw new Error("Integers expected in function leftShift");return t<<e},"BigNumber, BigNumber":o,"Matrix, Matrix":function(t,e){var n;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":n=p(t,e,y,!1);break;default:n=d(e,t,y,!0)}break;default:switch(e.storage()){case"sparse":n=u(t,e,y,!1);break;default:n=m(t,e,y)}}return n},"Array, Array":function(t,e){return y(l(t),l(e)).valueOf()},"Array, Matrix":function(t,e){return y(l(t),e)},"Matrix, Array":function(t,e){return y(t,l(e))},"Matrix, number | BigNumber":function(t,e){if(!h(e,0)){var n;switch(t.storage()){case"sparse":n=g(t,e,y,!1);break;default:n=x(t,e,y,!1)}return n}return t.clone()},"number | BigNumber, Matrix":function(t,e){if(!h(t,0)){var n;switch(e.storage()){case"sparse":n=f(e,t,y,!0);break;default:n=x(e,t,y,!0)}return n}return c(e.size(),e.storage())},"Array, number | BigNumber":function(t,e){return y(l(t),e).valueOf()},"number | BigNumber, Array":function(t,e){return y(t,l(e)).valueOf()}});return y.toTex={2:"\\left(${args[0]}"+a.operators.leftShift+"${args[1]}\\right)"},y}var i=n(6).isInteger,o=n(405);e.name="leftShift",e.factory=r},function(t,e){t.exports=function(t,e){if(t.isFinite()&&!t.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function leftShift");var n=t.constructor;return t.isNaN()||e.isNaN()||e.isNegative()&&!e.isZero()?new n(NaN):t.isZero()||e.isZero()?t:t.isFinite()||e.isFinite()?e.lt(55)?t.times(Math.pow(2,e.toNumber())+""):t.times(new n(2).pow(e)):new n(NaN)}},function(t,e,n){"use strict";function r(t,e,r,o){var s=r(n(48)),a=t.SparseMatrix,l=function(t,e,n){var r=t._values,l=t._index,h=t._ptr,c=t._size,u=t._datatype,d=e._values,p=e._index,f=e._ptr,g=e._size,m=e._datatype;if(c.length!==g.length)throw new i(c.length,g.length);if(c[0]!==g[0]||c[1]!==g[1])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+g+")");if(!r||!d)throw new Error("Cannot perform operation on Pattern Sparse Matrices");var x,y=c[0],v=c[1],C=s,w=0,b=n;"string"==typeof u&&u===m&&(x=u,C=o.find(s,[x,x]),w=o.convert(0,x),b=o.find(n,[x,x]));for(var M,S,E,I,N=[],O=[],T=[],_=new a({values:N,index:O,ptr:T,size:[y,v],datatype:x}),P=[],A=[],k=0;v>k;k++){T[k]=O.length;var R=k+1;for(S=h[k],E=h[k+1],M=S;E>M;M++)I=l[M],A[I]=R,P[I]=r[M],O.push(I);for(S=f[k],E=f[k+1],M=S;E>M;M++)I=p[M],A[I]===R&&(P[I]=b(P[I],d[M]));for(M=T[k];M<O.length;){I=O[M];var z=P[I];C(z,w)?O.splice(M,1):(N.push(z),M++)}}return T[v]=O.length,_};return l}var i=n(42);e.name="algorithm08",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,s){var a=n(32),l=r(n(52)),h=r(n(48)),c=r(n(389)),u=r(n(54)),d=r(n(369)),p=r(n(406)),f=r(n(56)),g=r(n(85)),m=r(n(57)),x=r(n(58)),y=s("rightArithShift",{"number, number":function(t,e){if(!i(t)||!i(e))throw new Error("Integers expected in function rightArithShift");return t>>e},"BigNumber, BigNumber":o,"Matrix, Matrix":function(t,e){var n;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":n=p(t,e,y,!1);break;default:n=d(e,t,y,!0)}break;default:switch(e.storage()){case"sparse":n=u(t,e,y,!1);break;default:n=m(t,e,y)}}return n},"Array, Array":function(t,e){return y(l(t),l(e)).valueOf()},"Array, Matrix":function(t,e){return y(l(t),e)},"Matrix, Array":function(t,e){return y(t,l(e))},"Matrix, number | BigNumber":function(t,e){if(!h(e,0)){var n;switch(t.storage()){case"sparse":n=g(t,e,y,!1);break;default:n=x(t,e,y,!1)}return n}return t.clone()},"number | BigNumber, Matrix":function(t,e){if(!h(t,0)){var n;switch(e.storage()){case"sparse":n=f(e,t,y,!0);break;default:n=x(e,t,y,!0)}return n}return c(e.size(),e.storage())},"Array, number | BigNumber":function(t,e){return y(l(t),e).valueOf()},"number | BigNumber, Array":function(t,e){return y(t,l(e)).valueOf()}});return y.toTex={2:"\\left(${args[0]}"+a.operators.rightArithShift+"${args[1]}\\right)"},y}var i=n(6).isInteger,o=n(408);e.name="rightArithShift",e.factory=r},function(t,e){t.exports=function(t,e){if(t.isFinite()&&!t.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function rightArithShift");var n=t.constructor;return t.isNaN()||e.isNaN()||e.isNegative()&&!e.isZero()?new n(NaN):t.isZero()||e.isZero()?t:e.isFinite()?e.lt(55)?t.div(Math.pow(2,e.toNumber())+"").floor():t.div(new n(2).pow(e)).floor():new n(t.isNegative()?-1:t.isFinite()?0:NaN)}},function(t,e,n){"use strict";function r(t,e,r,o){var s=n(32),a=r(n(52)),l=r(n(48)),h=r(n(389)),c=r(n(54)),u=r(n(369)),d=r(n(406)),p=r(n(56)),f=r(n(85)),g=r(n(57)),m=r(n(58)),x=o("rightLogShift",{"number, number":function(t,e){if(!i(t)||!i(e))throw new Error("Integers expected in function rightLogShift");return t>>>e},"Matrix, Matrix":function(t,e){var n;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":n=d(t,e,x,!1);break;default:n=u(e,t,x,!0)}break;default:switch(e.storage()){case"sparse":n=c(t,e,x,!1);break;default:n=g(t,e,x)}}return n},"Array, Array":function(t,e){return x(a(t),a(e)).valueOf()},"Array, Matrix":function(t,e){return x(a(t),e)},"Matrix, Array":function(t,e){return x(t,a(e))},"Matrix, number | BigNumber":function(t,e){if(!l(e,0)){var n;switch(t.storage()){case"sparse":n=f(t,e,x,!1);break;default:n=m(t,e,x,!1)}return n}return t.clone()},"number | BigNumber, Matrix":function(t,e){if(!l(t,0)){var n;switch(e.storage()){case"sparse":n=p(e,t,x,!0);break;default:n=m(e,t,x,!0)}return n}return h(e.size(),e.storage())},"Array, number | BigNumber":function(t,e){return x(a(t),e).valueOf()},"number | BigNumber, Array":function(t,e){return x(t,a(e)).valueOf()}});return x.toTex={2:"\\left(${args[0]}"+s.operators.rightLogShift+"${args[1]}\\right)"},x}var i=n(6).isInteger;e.name="rightLogShift",e.factory=r},function(t,e,n){t.exports=[n(411),n(417),n(412),n(418)]},function(t,e,n){"use strict";function r(t,e,r,i){var o=r(n(51)),s=r(n(412)),a=r(n(365)),l=r(n(416)),h=i("bellNumbers",{"number | BigNumber":function(t){if(!l(t)||a(t))throw new TypeError("Non-negative integer value expected in function bellNumbers");for(var e=0,n=0;t>=n;n++)e=o(e,s(t,n));return e}});return h.toTex={1:"\\mathrm{B}_{${args[0]}}"},h}e.name="bellNumbers",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,i){var o=r(n(51)),s=r(n(77)),a=r(n(84)),l=r(n(326)),h=r(n(82)),c=r(n(413)),u=r(n(415)),d=r(n(365)),p=r(n(416)),f=r(n(64)),g=i("stirlingS2",{"number | BigNumber, number | BigNumber":function(t,e){if(!p(t)||d(t)||!p(e)||d(e))throw new TypeError("Non-negative integer value expected in function stirlingS2");if(f(e,t))throw new TypeError("k must be less than or equal to n in function stirlingS2");for(var n=c(e),r=0,i=0;e>=i;i++){var g=h(-1,s(e,i)),m=u(e,i),x=h(i,t);r=o(r,a(a(m,x),g))}return l(r,n)}});return g.toTex={2:"\\mathrm{S}\\left(${args}\\right)"},g}e.name="stirlingS2",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,o){var s=r(n(414)),a=n(32),l=o("factorial",{number:function(t){if(0>t)throw new Error("Value must be non-negative");return s(t+1)},BigNumber:function(t){if(t.isNegative())throw new Error("Value must be non-negative");return s(t.plus(1))},"Array | Matrix":function(t){return i(t,l)}});return l.toTex={1:"\\left(${args[0]}\\right)"+a.operators.factorial},l}var i=n(19);e.name="factorial",e.factory=r},function(t,e,n){"use strict";
function r(t,e,r,l){function h(n){if(n.isZero())return new t.BigNumber(1);for(var r=e.precision+(0|Math.log(n.toNumber())),i=t.BigNumber.clone({precision:r}),o=new i(n),s=n.toNumber()-1;s>1;)o=o.times(s),s--;return new t.BigNumber(o.toPrecision(t.BigNumber.precision))}var c=r(n(84)),u=r(n(82)),d=l("gamma",{number:function(t){var e,n;if(o(t)){if(0>=t)return isFinite(t)?1/0:NaN;if(t>171)return 1/0;for(var r=t-2,i=t-1;r>1;)i*=r,r--;return 0==i&&(i=1),i}if(.5>t)return Math.PI/(Math.sin(Math.PI*t)*d(1-t));if(t>=171.35)return 1/0;if(t>85){var l=t*t,h=l*t,c=h*t,u=c*t;return Math.sqrt(2*Math.PI/t)*Math.pow(t/Math.E,t)*(1+1/(12*t)+1/(288*l)-139/(51840*h)-571/(2488320*c)+163879/(209018880*u)+5246819/(75246796800*u*t))}--t,n=a[0];for(var p=1;p<a.length;++p)n+=a[p]/(t+p);return e=t+s+.5,Math.sqrt(2*Math.PI)*Math.pow(e,t+.5)*Math.exp(-e)*n},Complex:function(e){var n,r;if(0==e.im)return d(e.re);e=new t.Complex(e.re-1,e.im),r=new t.Complex(a[0],0);for(var i=1;i<a.length;++i){var o=e.re+i,l=o*o+e.im*e.im;0!=l?(r.re+=a[i]*o/l,r.im+=-(a[i]*e.im)/l):r.re=a[i]<0?-(1/0):1/0}n=new t.Complex(e.re+s+.5,e.im);var h=Math.sqrt(2*Math.PI);e.re+=.5;var p=u(n,e);0==p.im?p.re*=h:0==p.re?p.im*=h:(p.re*=h,p.im*=h);var f=Math.exp(-n.re);return n.re=f*Math.cos(-n.im),n.im=f*Math.sin(-n.im),c(c(p,n),r)},BigNumber:function(e){if(e.isInteger())return e.isNegative()||e.isZero()?new t.BigNumber(1/0):h(e.minus(1));if(!e.isFinite())return new t.BigNumber(e.isNegative()?NaN:1/0);throw new Error("Integer BigNumber expected")},"Array | Matrix":function(t){return i(t,d)}});return d.toTex={1:"\\Gamma\\left(${args[0]}\\right)"},d}var i=n(19),o=n(6).isInteger,s=4.7421875,a=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];e.name="gamma",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var s=r("combinations",{"number, number":function(t,e){var n,r,i;if(!o(t)||0>t)throw new TypeError("Positive integer value expected in function combinations");if(!o(e)||0>e)throw new TypeError("Positive integer value expected in function combinations");if(e>t)throw new TypeError("k must be less than or equal to n");for(n=Math.max(e,t-e),r=1,i=1;t-n>=i;i++)r=r*(n+i)/i;return r},"BigNumber, BigNumber":function(e,n){var r,o,s,a,l=new t.BigNumber(1);if(!i(e)||!i(n))throw new TypeError("Positive integer value expected in function combinations");if(n.gt(e))throw new TypeError("k must be less than n in function combinations");for(r=e.minus(n),n.lt(r)&&(r=n),o=l,s=l,a=e.minus(r);s.lte(a);s=s.plus(1))o=o.times(r.plus(s)).dividedBy(s);return o}});return s.toTex={2:"\\binom{${args[0]}}{${args[1]}}"},s}function i(t){return t.isInteger()&&t.gte(0)}var o=n(6).isInteger;e.name="combinations",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var s=r("isInteger",{number:o.isInteger,BigNumber:function(t){return t.isInt()},Fraction:function(t){return 1===t.d&&isFinite(t.n)},"Array | Matrix":function(t){return i(t,s)}});return s}var i=n(19),o=n(6);e.name="isInteger",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,i){var o=r(n(415)),s=r(n(53)),a=r(n(378)),l=r(n(416)),h=r(n(64)),c=i("composition",{"number | BigNumber, number | BigNumber":function(t,e){if(!(l(t)&&a(t)&&l(e)&&a(e)))throw new TypeError("Positive integer value expected in function composition");if(h(e,t))throw new TypeError("k must be less than or equal to n in function composition");return o(s(t,-1),s(e,-1))}});return c.toTex=void 0,c}e.name="composition",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,i){var o=r(n(51)),s=r(n(326)),a=r(n(84)),l=r(n(415)),h=r(n(365)),c=r(n(416)),u=i("catalan",{"number | BigNumber":function(t){if(!c(t)||h(t))throw new TypeError("Non-negative integer value expected in function catalan");return s(l(a(t,2),t),o(t,1))}});return u.toTex={1:"\\mathrm{C}_{${args[0]}}"},u}e.name="catalan",e.factory=r},function(t,e,n){t.exports=[n(420),n(421),n(422),n(423)]},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("arg",{number:function(t){return Math.atan2(0,t)},Complex:function(t){return t.arg()},"Array | Matrix":function(t){return i(t,o)}});return o.toTex={1:"\\arg\\left(${args[0]}\\right)"},o}var i=n(19);e.name="arg",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("conj",{number:function(t){return t},BigNumber:function(t){return t},Complex:function(t){return t.conjugate()},"Array | Matrix":function(t){return i(t,o)}});return o.toTex={1:"\\left(${args[0]}\\right)^*"},o}var i=n(19);e.name="conj",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("im",{number:function(t){return 0},BigNumber:function(e){return new t.BigNumber(0)},Complex:function(t){return t.im},"Array | Matrix":function(t){return i(t,o)}});return o.toTex={1:"\\Im\\left\\lbrace${args[0]}\\right\\rbrace"},o}var i=n(19);e.name="im",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("re",{number:function(t){return t},BigNumber:function(t){return t},Complex:function(t){return t.re},"Array | Matrix":function(t){return i(t,o)}});return o.toTex={1:"\\Re\\left\\lbrace${args[0]}\\right\\rbrace"},o}var i=n(19);e.name="re",e.factory=r},function(t,e,n){t.exports=[n(425),n(426)]},function(t,e,n){"use strict";function r(t,e,r,i){function o(t){return 2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]}function s(t){return 3===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]&&"number"==typeof t[2]}function a(t){return 4===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]&&"number"==typeof t[2]&&"number"==typeof t[3]}function l(t,n,r,i){var o=t,s=r,a=g(o,n),l=g(s,i),h=a[0]*l[1]-l[0]*a[1];if(u(h)<e.epsilon)return null;var c=(l[0]*o[1]-l[1]*o[0]-l[0]*s[1]+l[1]*s[0])/h;return d(f(a,c),o)}function h(t,e,n,r,i,o,s,a,l,h,c,u){var d=(t-s)*(h-s)+(e-a)*(c-a)+(n-l)*(u-l),p=(h-s)*(r-t)+(c-a)*(i-e)+(u-l)*(o-n),f=(t-s)*(r-t)+(e-a)*(i-e)+(n-l)*(o-n),g=(h-s)*(h-s)+(c-a)*(c-a)+(u-l)*(u-l),m=(r-t)*(r-t)+(i-e)*(i-e)+(o-n)*(o-n),x=(d*p-f*g)/(m*g-p*p),y=(d+x*p)/g,v=t+x*(r-t),C=e+x*(i-e),w=n+x*(o-n),b=s+y*(h-s),M=a+y*(c-a),S=l+y*(u-l);return v===b&&C===M&&w===S?[v,C,w]:null}function c(t,e,n,r,i,o,s,a,l,h){var c=(h-t*s-e*a-n*l)/(r*s+i*a+o*l-t-e-n),u=t+c*(r-t),d=e+c*(i-e),p=n+c*(o-n);return[u,d,p]}var u=r(n(86)),d=r(n(51)),p=r(n(52)),f=r(n(84)),g=r(n(77)),m=i("intersect",{"Array, Array, Array":function(t,e,n){if(!s(t))throw new TypeError("Array with 3 numbers expected for first argument");if(!s(e))throw new TypeError("Array with 3 numbers expected for second argument");if(!a(n))throw new TypeError("Array with 4 numbers expected as third argument");return c(t[0],t[1],t[2],e[0],e[1],e[2],n[0],n[1],n[2],n[3])},"Array, Array, Array, Array":function(t,e,n,r){if(2===t.length){if(!o(t))throw new TypeError("Array with 2 numbers expected for first argument");if(!o(e))throw new TypeError("Array with 2 numbers expected for second argument");if(!o(n))throw new TypeError("Array with 2 numbers expected for third argument");if(!o(r))throw new TypeError("Array with 2 numbers expected for fourth argument");return l(t,e,n,r)}if(3===t.length){if(!s(t))throw new TypeError("Array with 3 numbers expected for first argument");if(!s(e))throw new TypeError("Array with 3 numbers expected for second argument");if(!s(n))throw new TypeError("Array with 3 numbers expected for third argument");if(!s(r))throw new TypeError("Array with 3 numbers expected for fourth argument");return h(t[0],t[1],t[2],e[0],e[1],e[2],n[0],n[1],n[2],r[0],r[1],r[2])}throw new TypeError("Arrays with two or thee dimensional points expected")},"Matrix, Matrix, Matrix":function(t,e,n){return p(m(t.valueOf(),e.valueOf(),n.valueOf()))},"Matrix, Matrix, Matrix, Matrix":function(t,e,n,r){return p(m(t.valueOf(),e.valueOf(),n.valueOf(),r.valueOf()))}});return m}e.name="intersect",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,a){var f=(r(n(52)),a("distance",{"Array, Array, Array":function(t,e,n){if(2==t.length&&2==e.length&&2==n.length){if(!i(t))throw new TypeError("Array with 2 numbers expected for first argument");if(!i(e))throw new TypeError("Array with 2 numbers expected for second argument");if(!i(n))throw new TypeError("Array with 2 numbers expected for third argument");var r=(n[1]-n[0])/(e[1]-e[0]),o=r*r*e[0],s=-1*(r*e[0]),a=t[1];return h(t[0],t[1],o,s,a)}throw new TypeError("Invalid Arguments: Try again")},"Object, Object, Object":function(t,e,n){if(2==Object.keys(t).length&&2==Object.keys(e).length&&2==Object.keys(n).length){if(!i(t))throw new TypeError("Values of pointX and pointY should be numbers");if(!i(e))throw new TypeError("Values of lineOnePtX and lineOnePtY should be numbers");if(!i(n))throw new TypeError("Values of lineTwoPtX and lineTwoPtY should be numbers");if(t.hasOwnProperty("pointX")&&t.hasOwnProperty("pointY")&&e.hasOwnProperty("lineOnePtX")&&e.hasOwnProperty("lineOnePtY")&&n.hasOwnProperty("lineTwoPtX")&&n.hasOwnProperty("lineTwoPtY")){var r=(n.lineTwoPtY-n.lineTwoPtX)/(e.lineOnePtY-e.lineOnePtX),o=r*r*e.lineOnePtX,s=-1*(r*e.lineOnePtX),a=t.pointX;return h(t.pointX,t.pointY,o,s,a)}throw new TypeError("Key names do not match")}throw new TypeError("Invalid Arguments: Try again")},"Array, Array":function(t,e){if(2==t.length&&3==e.length){if(!i(t))throw new TypeError("Array with 2 numbers expected for first argument");if(!o(e))throw new TypeError("Array with 3 numbers expected for second argument");return h(t[0],t[1],e[0],e[1],e[2])}if(3==t.length&&6==e.length){if(!o(t))throw new TypeError("Array with 3 numbers expected for first argument");if(!s(e))throw new TypeError("Array with 6 numbers expected for second argument");return c(t[0],t[1],t[2],e[0],e[1],e[2],e[3],e[4],e[5])}if(2==t.length&&2==e.length){if(!i(t))throw new TypeError("Array with 2 numbers expected for first argument");if(!i(e))throw new TypeError("Array with 2 numbers expected for second argument");return u(t[0],t[1],e[0],e[1])}if(3==t.length&&3==e.length){if(!o(t))throw new TypeError("Array with 3 numbers expected for first argument");if(!o(e))throw new TypeError("Array with 3 numbers expected for second argument");return d(t[0],t[1],t[2],e[0],e[1],e[2])}throw new TypeError("Invalid Arguments: Try again")},"Object, Object":function(t,e){if(2==Object.keys(t).length&&3==Object.keys(e).length){if(!i(t))throw new TypeError("Values of pointX and pointY should be numbers");if(!o(e))throw new TypeError("Values of xCoeffLine, yCoeffLine and constant should be numbers");if(t.hasOwnProperty("pointX")&&t.hasOwnProperty("pointY")&&e.hasOwnProperty("xCoeffLine")&&e.hasOwnProperty("yCoeffLine")&&e.hasOwnProperty("yCoeffLine"))return h(t.pointX,t.pointY,e.xCoeffLine,e.yCoeffLine,e.constant);throw new TypeError("Key names do not match")}if(3==Object.keys(t).length&&6==Object.keys(e).length){if(!o(t))throw new TypeError("Values of pointX, pointY and pointZ should be numbers");if(!s(e))throw new TypeError("Values of x0, y0, z0, a, b and c should be numbers");if(t.hasOwnProperty("pointX")&&t.hasOwnProperty("pointY")&&e.hasOwnProperty("x0")&&e.hasOwnProperty("y0")&&e.hasOwnProperty("z0")&&e.hasOwnProperty("a")&&e.hasOwnProperty("b")&&e.hasOwnProperty("c"))return c(t.pointX,t.pointY,t.pointZ,e.x0,e.y0,e.z0,e.a,e.b,e.c);throw new TypeError("Key names do not match")}if(2==Object.keys(t).length&&2==Object.keys(e).length){if(!i(t))throw new TypeError("Values of pointOneX and pointOneY should be numbers");if(!i(e))throw new TypeError("Values of pointTwoX and pointTwoY should be numbers");if(t.hasOwnProperty("pointOneX")&&t.hasOwnProperty("pointOneY")&&e.hasOwnProperty("pointTwoX")&&e.hasOwnProperty("pointTwoY"))return u(t.pointOneX,t.pointOneY,e.pointTwoX,e.pointTwoY);throw new TypeError("Key names do not match")}if(3==Object.keys(t).length&&3==Object.keys(e).length){if(!o(t))throw new TypeError("Values of pointOneX, pointOneY and pointOneZ should be numbers");if(!o(e))throw new TypeError("Values of pointTwoX, pointTwoY and pointTwoZ should be numbers");if(t.hasOwnProperty("pointOneX")&&t.hasOwnProperty("pointOneY")&&t.hasOwnProperty("pointOneZ")&&e.hasOwnProperty("pointTwoX")&&e.hasOwnProperty("pointTwoY")&&e.hasOwnProperty("pointTwoZ"))return d(t.pointOneX,t.pointOneY,t.pointOneZ,e.pointTwoX,e.pointTwoY,e.pointTwoZ);throw new TypeError("Key names do not match")}throw new TypeError("Invalid Arguments: Try again")},Array:function(t){if(!l(t))throw new TypeError("Incorrect array format entered for pairwise distance calculation");return p(t)}}));return f}function i(t){return t.constructor!==Array&&(t=a(t)),"number"==typeof t[0]&&"number"==typeof t[1]}function o(t){return t.constructor!==Array&&(t=a(t)),"number"==typeof t[0]&&"number"==typeof t[1]&&"number"==typeof t[2]}function s(t){return t.constructor!==Array&&(t=a(t)),"number"==typeof t[0]&&"number"==typeof t[1]&&"number"==typeof t[2]&&"number"==typeof t[3]&&"number"==typeof t[4]&&"number"==typeof t[5]}function a(t){for(var e=Object.keys(t),n=[],r=0;r<e.length;r++)n.push(t[e[r]]);return n}function l(t){if(2==t[0].length&&"number"==typeof t[0][0]&&"number"==typeof t[0][1]){for(var e in t)if(2!=t[e].length||"number"!=typeof t[e][0]||"number"!=typeof t[e][1])return!1}else{if(3!=t[0].length||"number"!=typeof t[0][0]||"number"!=typeof t[0][1]||"number"!=typeof t[0][2])return!1;for(var e in t)if(3!=t[e].length||"number"!=typeof t[e][0]||"number"!=typeof t[e][1]||"number"!=typeof t[e][2])return!1}return!0}function h(t,e,n,r,i){var o=Math.abs(n*t+r*e+i),s=Math.pow(n*n+r*r,.5),a=o/s;return a}function c(t,e,n,r,i,o,s,a,l){var h=[(i-e)*l-(o-n)*a,(o-n)*s-(r-t)*l,(r-t)*a-(i-e)*s];h=Math.pow(h[0]*h[0]+h[1]*h[1]+h[2]*h[2],.5);var c=Math.pow(s*s+a*a+l*l,.5),u=h/c;return u}function u(t,e,n,r){var i=r-e,o=n-t,s=i*i+o*o,a=Math.pow(s,.5);return a}function d(t,e,n,r,i,o){var s=o-n,a=i-e,l=r-t,h=s*s+a*a+l*l,c=Math.pow(h,.5);return c}function p(t){for(var e=[],n=0;n<t.length-1;n++)for(var r=n+1;r<t.length;r++)2==t[0].length?e.push(u(t[n][0],t[n][1],t[r][0],t[r][1])):3==t[0].length&&e.push(d(t[n][0],t[n][1],t[n][2],t[r][0],t[r][1],t[r][2]));return e}e.name="distance",e.factory=r},function(t,e,n){t.exports=[n(428),n(429),n(431),n(432)]},function(t,e,n){"use strict";function r(t,e,r,i){var o=n(32),s=r(n(52)),a=r(n(389)),l=r(n(429)),h=(r(n(430)),r(n(369))),c=r(n(380)),u=r(n(85)),d=r(n(57)),p=r(n(58)),f=i("and",{"number, number":function(t,e){return!(!t||!e)},"Complex, Complex":function(t,e){return!(0===t.re&&0===t.im||0===e.re&&0===e.im)},"BigNumber, BigNumber":function(t,e){return!(t.isZero()||e.isZero()||t.isNaN()||e.isNaN())},"Unit, Unit":function(t,e){return f(t.value,e.value)},"Matrix, Matrix":function(t,e){var n;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":n=c(t,e,f,!1);break;default:n=h(e,t,f,!0)}break;default:switch(e.storage()){case"sparse":n=h(t,e,f,!1);break;default:n=d(t,e,f)}}return n},"Array, Array":function(t,e){return f(s(t),s(e)).valueOf()},"Array, Matrix":function(t,e){return f(s(t),e)},"Matrix, Array":function(t,e){return f(t,s(e))},"Matrix, any":function(t,e){if(l(e))return a(t.size(),t.storage());var n;switch(t.storage()){case"sparse":n=u(t,e,f,!1);break;default:n=p(t,e,f,!1)}return n},"any, Matrix":function(t,e){if(l(t))return a(t.size(),t.storage());var n;switch(e.storage()){case"sparse":n=u(e,t,f,!0);break;default:n=p(e,t,f,!0)}return n},"Array, any":function(t,e){return f(s(t),e).valueOf()},"any, Array":function(t,e){return f(t,s(e)).valueOf()}});return f.toTex={2:"\\left(${args[0]}"+o.operators.and+"${args[1]}\\right)"},f}e.name="and",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,o){var s=n(32),a=o("not",{number:function(t){return!t},Complex:function(t){return 0===t.re&&0===t.im},BigNumber:function(t){return t.isZero()||t.isNaN()},Unit:function(t){return a(t.value)},"Array | Matrix":function(t){return i(t,a)}});return a.toTex={1:s.operators.not+"\\left(${args[0]}\\right)"},a}var i=n(19);e.name="not",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("isZero",{number:function(t){return 0===t},BigNumber:function(t){return t.isZero()},Complex:function(t){return 0===t.re&&0===t.im},Fraction:function(t){return 1===t.d&&0===t.n},Unit:function(t){return o(t.value)},"Array | Matrix":function(t){return i(t,o)}});return o}var i=n(19);n(6),e.name="isZero",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,i){var o=n(32),s=r(n(52)),a=r(n(61)),l=r(n(79)),h=r(n(63)),c=r(n(57)),u=r(n(58)),d=i("or",{"number, number":function(t,e){return!(!t&&!e)},"Complex, Complex":function(t,e){return 0!==t.re||0!==t.im||0!==e.re||0!==e.im},"BigNumber, BigNumber":function(t,e){return!t.isZero()&&!t.isNaN()||!e.isZero()&&!e.isNaN()},"Unit, Unit":function(t,e){return d(t.value,e.value)},"Matrix, Matrix":function(t,e){var n;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":n=l(t,e,d);break;default:n=a(e,t,d,!0)}break;default:switch(e.storage()){case"sparse":n=a(t,e,d,!1);break;default:n=c(t,e,d)}}return n},"Array, Array":function(t,e){return d(s(t),s(e)).valueOf()},"Array, Matrix":function(t,e){return d(s(t),e)},"Matrix, Array":function(t,e){return d(t,s(e))},"Matrix, any":function(t,e){var n;switch(t.storage()){case"sparse":n=h(t,e,d,!1);break;default:n=u(t,e,d,!1)}return n},"any, Matrix":function(t,e){var n;switch(e.storage()){case"sparse":n=h(e,t,d,!0);break;default:n=u(e,t,d,!0)}return n},"Array, any":function(t,e){return u(s(t),e,d,!1).valueOf()},"any, Array":function(t,e){return u(s(e),t,d,!0).valueOf()}});return d.toTex={2:"\\left(${args[0]}"+o.operators.or+"${args[1]}\\right)"},d}e.name="or",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,i){var o=n(32),s=r(n(52)),a=r(n(61)),l=r(n(62)),h=r(n(63)),c=r(n(57)),u=r(n(58)),d=i("xor",{"number, number":function(t,e){return!!(!!t^!!e)},"Complex, Complex":function(t,e){return(0!==t.re||0!==t.im)!=(0!==e.re||0!==e.im)},"BigNumber, BigNumber":function(t,e){return(!t.isZero()&&!t.isNaN())!=(!e.isZero()&&!e.isNaN())},"Unit, Unit":function(t,e){return d(t.value,e.value)},"Matrix, Matrix":function(t,e){var n;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":n=l(t,e,d);break;default:n=a(e,t,d,!0)}break;default:switch(e.storage()){case"sparse":n=a(t,e,d,!1);break;default:n=c(t,e,d)}}return n},"Array, Array":function(t,e){return d(s(t),s(e)).valueOf()},"Array, Matrix":function(t,e){return d(s(t),e)},"Matrix, Array":function(t,e){return d(t,s(e))},"Matrix, any":function(t,e){var n;switch(t.storage()){case"sparse":n=h(t,e,d,!1);break;default:n=u(t,e,d,!1)}return n},"any, Matrix":function(t,e){var n;switch(e.storage()){case"sparse":n=h(e,t,d,!0);break;default:n=u(e,t,d,!0)}return n},"Array, any":function(t,e){return u(s(t),e,d,!1).valueOf()},"any, Array":function(t,e){return u(s(e),t,d,!0).valueOf()}});return d.toTex={2:"\\left(${args[0]}"+o.operators.xor+"${args[1]}\\right)"},d}e.name="xor",e.factory=r},function(t,e,n){t.exports=[n(310),n(434),n(328),n(435),n(436),n(83),n(312),n(437),n(314),n(327),n(317),n(438),n(439),n(332),n(441),n(442),n(443),n(444),n(285),n(386),n(344),n(389)]},function(t,e,n){"use strict";function r(t,e,r,o){function s(t,e){var n=i(t),r=i(e);if(1!=n.length||1!=r.length||3!=n[0]||3!=r[0])throw new RangeError("Vectors with length 3 expected (Size A = ["+n.join(", ")+"], B = ["+r.join(", ")+"])");return[l(h(t[1],e[2]),h(t[2],e[1])),l(h(t[2],e[0]),h(t[0],e[2])),l(h(t[0],e[1]),h(t[1],e[0]))]}var a=r(n(52)),l=r(n(77)),h=r(n(84)),c=o("cross",{"Matrix, Matrix":function(t,e){return a(s(t.toArray(),e.toArray()))},"Matrix, Array":function(t,e){return a(s(t.toArray(),e))},"Array, Matrix":function(t,e){return a(s(t,e.toArray()))},"Array, Array":s});return c.toTex={2:"\\left(${args[0]}\\right)\\times\\left(${args[1]}\\right)"},c}var i=n(40).size;e.name="cross",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,s){function a(t,e,n,r){if(!o(e))throw new TypeError("Second parameter in function diag must be an integer");var i=e>0?e:0,s=0>e?-e:0;switch(n.length){case 1:return l(t,e,r,n[0],s,i);case 2:return h(t,e,r,n,s,i)}throw new RangeError("Matrix for function diag must be 2 dimensional")}function l(e,n,r,i,o,s){var a=[i+o,i+s],l=t.Matrix.storage(r||"dense"),h=l.diagonal(a,e,n);return null!==r?h:h.valueOf()}function h(t,e,n,r,i,o){if(t&&t.isMatrix===!0){var s=t.diagonal(e);return null!==n?n!==s.storage()?c(s,n):s:s.valueOf()}for(var a=Math.min(r[0]-i,r[1]-o),l=[],h=0;a>h;h++)l[h]=t[h+i][h+o];return null!==n?c(l):l}var c=r(n(52)),u=s("diag",{Array:function(t){return a(t,0,i.size(t),null)},"Array, number":function(t,e){return a(t,e,i.size(t),null)},"Array, BigNumber":function(t,e){return a(t,e.toNumber(),i.size(t),null)},"Array, string":function(t,e){return a(t,0,i.size(t),e)},"Array, number, string":function(t,e,n){return a(t,e,i.size(t),n)},"Array, BigNumber, string":function(t,e,n){return a(t,e.toNumber(),i.size(t),n)},Matrix:function(t){return a(t,0,t.size(),t.storage())},"Matrix, number":function(t,e){return a(t,e,t.size(),t.storage())},"Matrix, BigNumber":function(t,e){return a(t,e.toNumber(),t.size(),t.storage())},"Matrix, string":function(t,e){return a(t,0,t.size(),e)},"Matrix, number, string":function(t,e,n){return a(t,e,t.size(),n)},"Matrix, BigNumber, string":function(t,e,n){return a(t,e.toNumber(),t.size(),n)}});return u.toTex=void 0,u}var i=n(40),o=(n(3).clone,n(6).isInteger);e.name="diag",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,o){function s(t,e){var n=i(t),r=i(e),o=n[0];if(1!==n.length||1!==r.length)throw new RangeError("Vector expected");if(n[0]!=r[0])throw new RangeError("Vectors must have equal length ("+n[0]+" != "+r[0]+")");if(0==o)throw new RangeError("Cannot calculate the dot product of empty vectors");for(var s=0,h=0;o>h;h++)s=a(s,l(t[h],e[h]));return s}var a=r(n(51)),l=r(n(84)),h=o("dot",{"Matrix, Matrix":function(t,e){return s(t.toArray(),e.toArray())},"Matrix, Array":function(t,e){return s(t.toArray(),e)},"Array, Matrix":function(t,e){return s(t,e.toArray())},"Array, Array":s});return h.toTex={2:"\\left(${args[0]}\\cdot${args[1]}\\right)"},h}var i=n(40).size;e.name="dot",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,s){var a=r(n(52)),l=s("flatten",{Array:function(t){return o(i(t))},Matrix:function(t){var e=o(i(t.toArray()));return a(e)}});return l.toTex=void 0,l}var i=n(3).clone,o=n(40).flatten;e.name="flatten",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,s){function a(e,n){var r=l(e),i=r?new t.BigNumber(1):1;if(h(e),n){var s=c(n);return e.length>0?s.resize(e,i):s}var a=[];return e.length>0?o(a,e,i):a}function l(t){var e=!1;return t.forEach(function(t,n,r){t&&t.isBigNumber===!0&&(e=!0,r[n]=t.toNumber())}),e}function h(t){t.forEach(function(t){if("number"!=typeof t||!i(t)||0>t)throw new Error("Parameters in function ones must be positive integers")})}var c=r(n(52)),u=s("ones",{"":function(){return"Array"===e.matrix?a([]):a([],"default")},"...number | BigNumber | string":function(t){var n=t[t.length-1];if("string"==typeof n){var r=t.pop();return a(t,r)}return"Array"===e.matrix?a(t):a(t,"default")},Array:a,Matrix:function(t){var e=t.storage();return a(t.valueOf(),e)},"Array | Matrix, string":function(t,e){return a(t.valueOf(),e)}});return u.toTex=void 0,u}var i=n(6).isInteger,o=n(40).resize;e.name="ones",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,o){function s(t,e){return-h(t,e)}function a(t,e,n){if(!i(e)||0>e)throw new Error("k must be a non-negative integer");if(t&&t.isMatrix){var r=t.size();if(r.length>1)throw new Error("Only one dimensional matrices supported");return l(t.valueOf(),e,n)}return Array.isArray(t)?l(t,e,n):void 0}function l(t,e,n){if(e>=t.length)throw new Error("k out of bounds");for(var r=0,i=t.length-1;i>r;){for(var o=r,s=i,a=t[Math.floor(Math.random()*(i-r+1))+r];s>o;)if(n(t[o],a)>=0){var l=t[s];t[s]=t[o],t[o]=l,--s}else++o;n(t[o],a)>0&&--o,o>=e?i=o:r=o+1}return t[e]}var h=r(n(440));return o("partitionSelect",{"Array | Matrix, number":function(t,e){return a(t,e,h)},"Array | Matrix, number, string":function(t,e,n){if("asc"===n)return a(t,e,h);if("desc"===n)return a(t,e,s);throw new Error('Compare string must be "asc" or "desc"')},"Array | Matrix, number, function":a})}var i=n(6).isInteger;e.name="partitionSelect",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,s){var a=r(n(52)),l=r(n(61)),h=r(n(79)),c=r(n(63)),u=r(n(57)),d=r(n(58)),p=s("compare",{"boolean, boolean":function(t,e){return t===e?0:t>e?1:-1},"number, number":function(t,n){return t===n||i(t,n,e.epsilon)?0:t>n?1:-1},"BigNumber, BigNumber":function(n,r){return n.eq(r)||o(n,r,e.epsilon)?new t.BigNumber(0):new t.BigNumber(n.cmp(r))},"Fraction, Fraction":function(e,n){return new t.Fraction(e.compare(n))},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return p(t.value,e.value)},"string, string":function(t,e){return t===e?0:t>e?1:-1},"Matrix, Matrix":function(t,e){var n;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":n=h(t,e,p);break;default:n=l(e,t,p,!0)}break;default:switch(e.storage()){case"sparse":n=l(t,e,p,!1);break;default:n=u(t,e,p)}}return n},"Array, Array":function(t,e){return p(a(t),a(e)).valueOf()},"Array, Matrix":function(t,e){return p(a(t),e)},"Matrix, Array":function(t,e){return p(t,a(e))},"Matrix, any":function(t,e){var n;switch(t.storage()){case"sparse":n=c(t,e,p,!1);break;default:n=d(t,e,p,!1)}return n},"any, Matrix":function(t,e){var n;switch(e.storage()){case"sparse":n=c(e,t,p,!0);break;default:n=d(e,t,p,!0)}return n},"Array, any":function(t,e){return d(a(t),e,p,!1).valueOf()},"any, Array":function(t,e){return d(a(e),t,p,!0).valueOf()}});return p.toTex=void 0,p}var i=n(6).nearlyEqual,o=n(49);e.name="compare",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,c){function u(t,e,n){if(void 0!==n){if("string"!=typeof n||1!==n.length)throw new TypeError("Single character expected as defaultValue")}else n=" ";if(1!==e.length)throw new i(e.length,1);var r=e[0];if("number"!=typeof r||!s(r))throw new TypeError("Invalid size, must contain positive integers (size: "+a(e)+")");if(t.length>r)return t.substring(0,r);if(t.length<r){for(var o=t,l=0,h=r-t.length;h>l;l++)o+=n;return o}return t}var d=r(n(52)),p=function(t,n,r){if(2!=arguments.length&&3!=arguments.length)throw new o("resize",arguments.length,2,3);if(n&&n.isMatrix===!0&&(n=n.valueOf()),n.length&&n[0]&&n[0].isBigNumber===!0&&(n=n.map(function(t){return t&&t.isBigNumber===!0?t.toNumber():t})),t&&t.isMatrix===!0)return t.resize(n,r,!0);if("string"==typeof t)return u(t,n,r);var i=!Array.isArray(t)&&"Array"!==e.matrix;if(0==n.length){for(;Array.isArray(t);)t=t[0];return l(t)}Array.isArray(t)||(t=[t]),t=l(t);var s=h.resize(t,n,r);return i?d(s):s};return p.toTex=void 0,p}var i=n(42),o=n(11),s=n(6).isInteger,a=n(23).format,l=n(3).clone,h=n(40);e.name="resize",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,o){var s=r(n(52)),a=o("size",{Matrix:function(t){return s(t.size())},Array:i.size,string:function(t){return"Array"===e.matrix?[t.length]:s([t.length])},"number | Complex | BigNumber | Unit | boolean | null":function(t){return"Array"===e.matrix?[]:s([])}});return a.toTex=void 0,a}var i=n(40);e.name="size",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,o){function s(t){if("asc"===t)return c;if("desc"===t)return u;throw new Error('String "asc" or "desc" expected')}function a(t){if(1!==i(t).length)throw new Error("One dimensional array expected")}function l(t){if(1!==t.size().length)throw new Error("One dimensional matrix expected")}var h=r(n(52)),c=r(n(440)),u=function(t,e){return-c(t,e)},d=o("sort",{Array:function(t){return a(t),t.sort(c)},Matrix:function(t){return l(t),h(t.toArray().sort(c),t.storage())},"Array, function":function(t,e){return a(t),t.sort(e)},"Matrix, function":function(t,e){return l(t),h(t.toArray().sort(e),t.storage())},"Array, string":function(t,e){return a(t),t.sort(s(e))},"Matrix, string":function(t,e){return l(t),h(t.toArray().sort(s(e)),t.storage())}});return d.toTex=void 0,d}var i=n(40).size;e.name="sort",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,s){var a=r(n(52)),l=s("squeeze",{Array:function(t){return o.squeeze(i.clone(t))},Matrix:function(t){var e=o.squeeze(t.toArray());return Array.isArray(e)?a(e):e},any:function(t){return i.clone(t)}});return l.toTex=void 0,l}var i=n(3),o=n(40);e.name="squeeze",e.factory=r},function(t,e,n){t.exports=[n(415),n(413),n(414),n(446),n(448),n(449),n(450),n(452),n(453)]},function(t,e,n){"use strict";function r(t,e,r,i){function o(t,e){var n=e.size().length,r=t.size().length;if(n>1)throw new Error("first object must be one dimensional");if(r>1)throw new Error("second object must be one dimensional");if(n!==r)throw new Error("Length of two vectors must be equal");var i=l(t);if(0===i)throw new Error("Sum of elements in first object must be non zero");var o=l(e);if(0===o)throw new Error("Sum of elements in second object must be non zero");var s=a(t,l(t)),p=a(e,l(e)),f=l(h(s,u(c(s,p))));return d(f)?f:Number.NaN}var s=r(n(52)),a=r(n(326)),l=r(n(447)),h=r(n(84)),c=r(n(368)),u=r(n(382)),d=r(n(89)),p=i("kldivergence",{"Array, Array":function(t,e){return o(s(t),s(e))},"Matrix, Array":function(t,e){return o(t,s(e))},"Array, Matrix":function(t,e){return o(s(t),e)},"Matrix, Matrix":function(t,e){return o(t,e)}});return p}e.name="kldivergence",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,o){function s(n){var r=void 0;if(i(n,function(t){r=void 0===r?t:a(r,t)}),void 0===r)switch(e.number){case"number":return 0;case"BigNumber":return new t.BigNumber(0);case"Fraction":return new t.Fraction(0);default:return 0}return r}var a=r(n(53)),l=o("sum",{"Array | Matrix":function(t){return s(t)},"Array | Matrix, number | BigNumber":function(){throw new Error("sum(A, dim) is not yet supported")},"...":function(t){return s(t)}});return l.toTex=void 0,l}var i=n(321);e.name="sum",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,o){var s=r(n(51)),a=r(n(84)),l=r(n(326)),h=r(n(413)),c=r(n(416)),u=r(n(378));return o("multinomial",{"Array | Matrix":function(t){var e=0,n=1;return i(t,function(t){if(!c(t)||!u(t))throw new TypeError("Positive integer value expected in function multinomial");e=s(e,t),n=a(n,h(t))}),l(h(e),n)}})}var i=n(321);e.name="multinomial",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,s){var a=r(n(413)),l=s("permutations",{"number | BigNumber":a,"number, number":function(t,e){var n,r;if(!o(t)||0>t)throw new TypeError("Positive integer value expected in function permutations");if(!o(e)||0>e)throw new TypeError("Positive integer value expected in function permutations");if(e>t)throw new TypeError("second argument k must be less than or equal to first argument n");for(n=1,r=t-e+1;t>=r;r++)n*=r;return n},"BigNumber, BigNumber":function(e,n){var r,o;if(!i(e)||!i(n))throw new TypeError("Positive integer value expected in function permutations");if(n.gt(e))throw new TypeError("second argument k must be less than or equal to first argument n");for(r=new t.BigNumber(1),o=e.minus(n).plus(1);o.lte(e);o=o.plus(1))r=r.times(o);return r}});return l.toTex=void 0,l}function i(t){return t.isInteger()&&t.gte(0)}var o=n(6).isInteger;e.name="permutations",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,i){var o=r(n(451)),s=o("uniform").pickRandom;return s.toTex=void 0,s}e.name="pickRandom",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,s){function a(t){if(!c.hasOwnProperty(t))throw new Error("Unknown distribution "+t);var e=Array.prototype.slice.call(arguments,1),n=c[t].apply(this,e);return function(t){var e={random:function(t,e,r){var a,h,c;if(arguments.length>3)throw new i("random",arguments.length,0,3);if(1===arguments.length?o(t)?a=t:c=t:2===arguments.length?o(t)?(a=t,c=e):(h=t,c=e):(a=t,h=e,c=r),void 0===c&&(c=1),void 0===h&&(h=0),void 0!==a){var u=s(a.valueOf(),h,c,n);
return a&&a.isMatrix===!0?l(u):u}return n(h,c)},randomInt:function(t,e,n){var a,h,c;if(arguments.length>3||arguments.length<1)throw new i("randomInt",arguments.length,1,3);if(1===arguments.length?o(t)?a=t:c=t:2===arguments.length?o(t)?(a=t,c=e):(h=t,c=e):(a=t,h=e,c=n),void 0===h&&(h=0),void 0!==a){var u=s(a.valueOf(),h,c,r);return a&&a.isMatrix===!0?l(u):u}return r(h,c)},pickRandom:function(t){if(1!==arguments.length)throw new i("pickRandom",arguments.length,1);if(t&&t.isMatrix===!0)t=t.valueOf();else if(!Array.isArray(t))throw new TypeError("Unsupported type of value in function pickRandom");if(h.size(t).length>1)throw new Error("Only one dimensional vectors supported");return t[Math.floor(Math.random()*t.length)]}},n=function(e,n){return e+t()*(n-e)},r=function(e,n){return Math.floor(e+t()*(n-e))},s=function(t,e,n,r){var i,o,a=[];if(t=t.slice(0),t.length>1)for(o=0,i=t.shift();i>o;o++)a.push(s(t,e,n,r));else for(o=0,i=t.shift();i>o;o++)a.push(r(e,n));return a};return e}(n)}var l=r(n(52)),h=n(40),c={uniform:function(){return Math.random},normal:function(){return function(){for(var t,e,n=-1;0>n||n>1;)t=Math.random(),e=Math.random(),n=1/6*Math.pow(-2*Math.log(t),.5)*Math.cos(2*Math.PI*e)+.5;return n}}};return a.toTex=void 0,a}var i=n(11),o=n(319);e.name="distribution",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,i){var o=r(n(451)),s=o("uniform").random;return s.toTex=void 0,s}e.name="random",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,i){var o=r(n(451)),s=o("uniform").randomInt;return s.toTex=void 0,s}e.name="randomInt",e.factory=r},function(t,e,n){t.exports=[n(440),n(455),n(88),n(64),n(351),n(60),n(456),n(457)]},function(t,e,n){"use strict";function r(t,e,r,i){function o(t,e){if(Array.isArray(t)){if(Array.isArray(e)){var n=t.length;if(n!==e.length)return!1;for(var r=0;n>r;r++)if(!o(t[r],e[r]))return!1;return!0}return!1}return!Array.isArray(e)&&s(t,e)}var s=r(n(88)),a=i("deepEqual",{"any, any":function(t,e){return o(t.valueOf(),e.valueOf())}});return a.toTex=void 0,a}e.name="deepEqual",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,s){var a=r(n(52)),l=r(n(61)),h=r(n(62)),c=r(n(63)),u=r(n(57)),d=r(n(58)),p=n(32),f=s("smallerEq",{"boolean, boolean":function(t,e){return e>=t},"number, number":function(t,n){return n>=t||i(t,n,e.epsilon)},"BigNumber, BigNumber":function(t,n){return t.lte(n)||o(t,n,e.epsilon)},"Fraction, Fraction":function(t,e){return 1!==t.compare(e)},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return f(t.value,e.value)},"string, string":function(t,e){return e>=t},"Matrix, Matrix":function(t,e){var n;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":n=h(t,e,f);break;default:n=l(e,t,f,!0)}break;default:switch(e.storage()){case"sparse":n=l(t,e,f,!1);break;default:n=u(t,e,f)}}return n},"Array, Array":function(t,e){return f(a(t),a(e)).valueOf()},"Array, Matrix":function(t,e){return f(a(t),e)},"Matrix, Array":function(t,e){return f(t,a(e))},"Matrix, any":function(t,e){var n;switch(t.storage()){case"sparse":n=c(t,e,f,!1);break;default:n=d(t,e,f,!1)}return n},"any, Matrix":function(t,e){var n;switch(e.storage()){case"sparse":n=c(e,t,f,!0);break;default:n=d(e,t,f,!0)}return n},"Array, any":function(t,e){return d(a(t),e,f,!1).valueOf()},"any, Array":function(t,e){return d(a(e),t,f,!0).valueOf()}});return f.toTex={2:"\\left(${args[0]}"+p.operators.smallerEq+"${args[1]}\\right)"},f}var i=n(6).nearlyEqual,o=n(49);e.name="smallerEq",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,s){var a=r(n(52)),l=r(n(61)),h=r(n(62)),c=r(n(63)),u=r(n(57)),d=r(n(58)),p=n(32),f=s("unequal",{"any, any":function(t,e){return null===t?null!==e:null===e?null!==t:void 0===t?void 0!==e:void 0===e?void 0!==t:g(t,e)},"Matrix, Matrix":function(t,e){var n;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":n=h(t,e,g);break;default:n=l(e,t,g,!0)}break;default:switch(e.storage()){case"sparse":n=l(t,e,g,!1);break;default:n=u(t,e,g)}}return n},"Array, Array":function(t,e){return f(a(t),a(e)).valueOf()},"Array, Matrix":function(t,e){return f(a(t),e)},"Matrix, Array":function(t,e){return f(t,a(e))},"Matrix, any":function(t,e){var n;switch(t.storage()){case"sparse":n=c(t,e,g,!1);break;default:n=d(t,e,g,!1)}return n},"any, Matrix":function(t,e){var n;switch(e.storage()){case"sparse":n=c(e,t,g,!0);break;default:n=d(e,t,g,!0)}return n},"Array, any":function(t,e){return d(a(t),e,g,!1).valueOf()},"any, Array":function(t,e){return d(a(e),t,g,!0).valueOf()}}),g=s("_unequal",{"boolean, boolean":function(t,e){return t!==e},"number, number":function(t,n){return!i(t,n,e.epsilon)},"BigNumber, BigNumber":function(t,n){return!o(t,n,e.epsilon)},"Fraction, Fraction":function(t,e){return!t.equals(e)},"Complex, Complex":function(t,e){return!t.equals(e)},"Unit, Unit":function(t,e){if(!t.equalBase(e))throw new Error("Cannot compare units with different base");return f(t.value,e.value)},"string, string":function(t,e){return t!==e}});return f.toTex={2:"\\left(${args[0]}"+p.operators.unequal+"${args[1]}\\right)"},f}var i=n(6).nearlyEqual,o=n(49);e.name="unequal",e.factory=r},function(t,e,n){t.exports=[n(320),n(325),n(459),n(330),n(460),n(461),n(462),n(463),n(447),n(464)]},function(t,e,n){"use strict";function r(t,e,r,s){function a(t){t=i(t.valueOf());var e=t.length;if(0==e)throw new Error("Cannot calculate median of an empty array");if(e%2==0){for(var n=e/2-1,r=u(t,n+1),o=t[n],s=0;n>s;++s)c(t[s],o)>0&&(o=t[s]);return f(o,r)}var a=u(t,(e-1)/2);return p(a)}var l=r(n(53)),h=r(n(81)),c=r(n(440)),u=r(n(439)),d=s("median",{"Array | Matrix":a,"Array | Matrix, number | BigNumber":function(t,e){throw new Error("median(A, dim) is not yet supported")},"...":function(t){if(o(t))throw new TypeError("Scalar values expected in function median");return a(t)}}),p=s({"number | BigNumber | Unit":function(t){return t}}),f=s({"number | BigNumber | Unit, number | BigNumber | Unit":function(t,e){return h(l(t,e),2)}});return d.toTex=void 0,d}var i=n(40).flatten,o=(n(322),n(323));e.name="median",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){function o(t){t=i(t.valueOf());var e=t.length;if(0==e)throw new Error("Cannot calculate mode of an empty array");var n={},r=[],o=0;for(var s in t)t[s]in n||(n[t[s]]=0),n[t[s]]++,n[t[s]]==o?r.push(t[s]):n[t[s]]>o&&(o=n[t[s]],r=[t[s]]);return r}var s=r("mode",{"Array | Matrix":o,"...":function(t){return o(t)}});return s}var i=n(40).flatten;e.name="mode",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,o){function s(t){var e=void 0;if(i(t,function(t){e=void 0===e?t:a(e,t)}),void 0===e)throw new Error("Cannot calculate prod of an empty array");return e}var a=r(n(80)),l=o("prod",{"Array | Matrix":s,"Array | Matrix, number | BigNumber":function(t,e){throw new Error("prod(A, dim) is not yet supported")},"...":function(t){return s(t)}});return l.toTex=void 0,l}var i=n(321);e.name="prod",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,l){function h(e,n,r){var s,l,h;if(arguments.length<2||arguments.length>3)throw new SyntaxError("Function quantileSeq requires two or three parameters");if(a(e)){if(r=r||!1,"boolean"==typeof r){if(l=e.valueOf(),o(n)){if(0>n)throw new Error("N/prob must be non-negative");if(1>=n)return c(l,n,r);if(n>1){if(!i(n))throw new Error("N must be a positive integer");var u=n+1;s=new Array(n);for(var d=0;n>d;)s[d]=c(l,++d/u,r);return s}}if(n&&n.isBigNumber){if(n.isNegative())throw new Error("N/prob must be non-negative");if(h=new n.constructor(1),n.lte(h))return c(l,n,r);if(n.gt(h)){if(!n.isInteger())throw new Error("N must be a positive integer");var p=n.toNumber();if(p>4294967295)throw new Error("N must be less than or equal to 2^32-1, as that is the maximum length of an Array");var u=new t.BigNumber(p+1);s=new Array(p);for(var d=0;p>d;)s[d]=c(l,new t.BigNumber((++d)).div(u),r);return s}}if(Array.isArray(n)){s=new Array(n.length);for(var d=0;d<s.length;++d){var f=n[d];if(o(f)){if(0>f||f>1)throw new Error("Probability must be between 0 and 1, inclusive")}else{if(!f||!f.isBigNumber)throw new TypeError("Unexpected type of argument in function quantileSeq");if(h=new f.constructor(1),f.isNegative()||f.gt(h))throw new Error("Probability must be between 0 and 1, inclusive")}s[d]=c(l,f,r)}return s}throw new TypeError("Unexpected type of argument in function quantileSeq")}throw new TypeError("Unexpected type of argument in function quantileSeq")}throw new TypeError("Unexpected type of argument in function quantileSeq")}function c(t,e,n){var r=s(t),i=r.length;if(0===i)throw new Error("Cannot calculate quantile of an empty sequence");if(o(e)){var a=e*(i-1),l=a%1;if(0===l){var h=n?r[a]:p(r,a);return g(h),h}var c,m,x=Math.floor(a);if(n)c=r[x],m=r[x+1];else{m=p(r,x+1),c=r[x];for(var y=0;x>y;++y)f(r[y],c)>0&&(c=r[y])}return g(c),g(m),u(d(c,1-l),d(m,l))}var a=e.times(i-1);if(a.isInteger()){a=a.toNumber();var h=n?r[a]:p(r,a);return g(h),h}var c,m,x=a.floor(),l=a.minus(x),v=x.toNumber();if(n)c=r[v],m=r[v+1];else{m=p(r,v+1),c=r[v];for(var y=0;v>y;++y)f(r[y],c)>0&&(c=r[y])}g(c),g(m);var C=new l.constructor(1);return u(d(c,C.minus(l)),d(m,l))}var u=r(n(51)),d=r(n(84)),p=r(n(439)),f=r(n(440)),g=l({"number | BigNumber | Unit":function(t){return t}});return h}var i=n(6).isInteger,o=n(6).isNumber,s=n(40).flatten,a=n(319);e.name="quantileSeq",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,i){function o(t,e){if(0==t.length)throw new SyntaxError("Function std requires one or more parameters (0 provided)");return s(a.apply(null,arguments))}var s=r(n(377)),a=r(n(464)),l=i("std",{"Array | Matrix":o,"Array | Matrix, string":o,"...":function(t){return o(t)}});return l.toTex=void 0,l}e.name="std",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,s){function a(e,n){var r=0,i=0;if(0==e.length)throw new SyntaxError("Function var requires one or more parameters (0 provided)");if(o(e,function(t){r=l(r,t),i++}),0===i)throw new Error("Cannot calculate var of an empty array");var s=u(r,i);switch(r=0,o(e,function(t){var e=h(t,s);r=l(r,c(e,e))}),n){case"uncorrected":return u(r,i);case"biased":return u(r,i+1);case"unbiased":var a=r&&r.isBigNumber===!0?new t.BigNumber(0):0;return 1==i?a:u(r,i-1);default:throw new Error('Unknown normalization "'+n+'". Choose "unbiased" (default), "uncorrected", or "biased".')}}var l=r(n(53)),h=r(n(77)),c=r(n(80)),u=r(n(81)),d=s("variance",{"Array | Matrix":function(t){return a(t,i)},"Array | Matrix, string":a,"...":function(t){return a(t,i)}});return d.toTex="\\mathrm{Var}\\left(${args}\\right)",d}var i="unbiased",o=n(321);e.name="var",e.factory=r},function(t,e,n){t.exports=[n(90),n(466)]},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("print",{"string, Object":i,"string, Object, number | Object":i});return o.toTex=void 0,o}function i(t,e,n){return t.replace(/\$([\w\.]+)/g,function(t,r){for(var i=r.split("."),a=e[i.shift()];i.length&&void 0!==a;){var l=i.shift();a=l?a[l]:a+"."}return void 0!==a?o(a)?a:s(a,n):t})}var o=n(23).isString,s=n(23).format;e.name="print",e.factory=r},function(t,e,n){t.exports=[n(468),n(469),n(470),n(471),n(472),n(473),n(474),n(475),n(476),n(477),n(478),n(479),n(480),n(481),n(482),n(483),n(484),n(485),n(486),n(487),n(488),n(489),n(490),n(491),n(492)]},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("acos",{number:function(n){return n>=-1&&1>=n||e.predictable?Math.acos(n):new t.Complex(n,0).acos()},Complex:function(t){return t.acos()},BigNumber:function(t){return t.acos()},"Array | Matrix":function(t){return i(t,o)}});return o.toTex={1:"\\cos^{-1}\\left(${args[0]}\\right)"},o}var i=n(19);e.name="acos",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var s=r("acosh",{number:function(n){return n>=1||e.predictable?o(n):-1>=n?new t.Complex(Math.log(Math.sqrt(n*n-1)-n),Math.PI):new t.Complex(n,0).acosh()},Complex:function(t){return t.acosh()},BigNumber:function(t){return t.acosh()},"Array | Matrix":function(t){return i(t,s)}});return s.toTex={1:"\\cosh^{-1}\\left(${args[0]}\\right)"},s}var i=n(19),o=Math.acosh||function(t){return Math.log(Math.sqrt(t*t-1)+t)};e.name="acosh",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("acot",{number:function(t){return Math.atan(1/t)},Complex:function(t){return t.acot()},BigNumber:function(e){return new t.BigNumber(1).div(e).atan()},"Array | Matrix":function(t){return i(t,o)}});return o.toTex={1:"\\cot^{-1}\\left(${args[0]}\\right)"},o}var i=n(19);e.name="acot",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("acoth",{number:function(n){return n>=1||-1>=n||e.predictable?isFinite(n)?(Math.log((n+1)/n)+Math.log(n/(n-1)))/2:0:new t.Complex(n,0).acoth()},Complex:function(t){return t.acoth()},BigNumber:function(e){return new t.BigNumber(1).div(e).atanh()},"Array | Matrix":function(t){return i(t,o)}});return o.toTex={1:"\\coth^{-1}\\left(${args[0]}\\right)"},o}var i=n(19);e.name="acoth",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("acsc",{number:function(n){return-1>=n||n>=1||e.predictable?Math.asin(1/n):new t.Complex(n,0).acsc()},Complex:function(t){return t.acsc()},BigNumber:function(e){return new t.BigNumber(1).div(e).asin()},"Array | Matrix":function(t){return i(t,o)}});return o.toTex={1:"\\csc^{-1}\\left(${args[0]}\\right)"},o}var i=n(19);e.name="acsc",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("acsch",{number:function(t){return t=1/t,Math.log(t+Math.sqrt(t*t+1))},Complex:function(t){return t.acsch()},BigNumber:function(e){return new t.BigNumber(1).div(e).asinh()},"Array | Matrix":function(t){return i(t,o)}});return o.toTex={1:"\\mathrm{csch}^{-1}\\left(${args[0]}\\right)"},o}var i=n(19);e.name="acsch",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("asec",{number:function(n){return-1>=n||n>=1||e.predictable?Math.acos(1/n):new t.Complex(n,0).asec()},Complex:function(t){return t.asec()},BigNumber:function(e){return new t.BigNumber(1).div(e).acos()},"Array | Matrix":function(t){return i(t,o)}});return o.toTex={1:"\\sec^{-1}\\left(${args[0]}\\right)"},o}var i=n(19);e.name="asec",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,o){var s=(o.find(r(n(469)),["Complex"]),o("asech",{number:function(n){if(1>=n&&n>=-1||e.predictable){n=1/n;var r=Math.sqrt(n*n-1);return n>0||e.predictable?Math.log(r+n):new t.Complex(Math.log(r-n),Math.PI)}return new t.Complex(n,0).asech()},Complex:function(t){return t.asech()},BigNumber:function(e){return new t.BigNumber(1).div(e).acosh()},"Array | Matrix":function(t){return i(t,s)}}));return s.toTex={1:"\\mathrm{sech}^{-1}\\left(${args[0]}\\right)"},s}var i=n(19);e.name="asech",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("asin",{number:function(n){return n>=-1&&1>=n||e.predictable?Math.asin(n):new t.Complex(n,0).asin()},Complex:function(t){return t.asin()},BigNumber:function(t){return t.asin()},"Array | Matrix":function(t){return i(t,o,!0)}});return o.toTex={1:"\\sin^{-1}\\left(${args[0]}\\right)"},o}var i=n(19);e.name="asin",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("asinh",{number:Math.asinh||function(t){return Math.log(Math.sqrt(t*t+1)+t)},Complex:function(t){return t.asinh()},BigNumber:function(t){return t.asinh()},"Array | Matrix":function(t){return i(t,o,!0)}});return o.toTex={1:"\\sinh^{-1}\\left(${args[0]}\\right)"},o}var i=n(19);e.name="asinh",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("atan",{number:function(t){return Math.atan(t)},Complex:function(t){return t.atan()},BigNumber:function(t){return t.atan()},"Array | Matrix":function(t){return i(t,o,!0)}});return o.toTex={1:"\\tan^{-1}\\left(${args[0]}\\right)"},o}var i=n(19);e.name="atan",e.factory=r},function(t,e,n){"use strict";function r(t,e,r,i){var o=r(n(52)),s=r(n(369)),a=r(n(61)),l=r(n(371)),h=r(n(85)),c=r(n(63)),u=r(n(57)),d=r(n(58)),p=i("atan2",{"number, number":Math.atan2,"BigNumber, BigNumber":function(e,n){return t.BigNumber.atan2(e,n)},"Matrix, Matrix":function(t,e){var n;switch(t.storage()){case"sparse":switch(e.storage()){case"sparse":n=l(t,e,p,!1);break;default:n=s(e,t,p,!0)}break;default:switch(e.storage()){case"sparse":n=a(t,e,p,!1);break;default:n=u(t,e,p)}}return n},"Array, Array":function(t,e){return p(o(t),o(e)).valueOf()},"Array, Matrix":function(t,e){return p(o(t),e)},"Matrix, Array":function(t,e){return p(t,o(e))},"Matrix, number | BigNumber":function(t,e){var n;switch(t.storage()){case"sparse":n=h(t,e,p,!1);break;default:n=d(t,e,p,!1)}return n},"number | BigNumber, Matrix":function(t,e){var n;switch(e.storage()){case"sparse":n=c(e,t,p,!0);break;default:n=d(e,t,p,!0)}return n},"Array, number | BigNumber":function(t,e){return d(o(t),e,p,!1).valueOf()},"number | BigNumber, Array":function(t,e){return d(o(e),t,p,!0).valueOf()}});return p.toTex={2:"\\mathrm{atan2}\\left(${args}\\right)"},p}e.name="atan2",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var s=r("atanh",{number:function(n){return 1>=n&&n>=-1||e.predictable?o(n):new t.Complex(n,0).atanh()},Complex:function(t){return t.atanh()},BigNumber:function(t){return t.atanh()},"Array | Matrix":function(t){return i(t,s,!0)}});return s.toTex={1:"\\tanh^{-1}\\left(${args[0]}\\right)"},s}var i=n(19),o=Math.atanh||function(t){return Math.log((1+t)/(1-t))/2};e.name="atanh",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("cos",{number:Math.cos,Complex:function(t){return t.cos()},BigNumber:function(t){return t.cos()},Unit:function(e){if(!e.hasBase(t.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cos is no angle");return o(e.value)},"Array | Matrix":function(t){return i(t,o)}});return o.toTex={1:"\\cos\\left(${args[0]}\\right)"},o}var i=n(19);e.name="cos",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var s=r("cosh",{number:o,Complex:function(t){return t.cosh()},BigNumber:function(t){return t.cosh()},Unit:function(e){if(!e.hasBase(t.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cosh is no angle");return s(e.value)},"Array | Matrix":function(t){return i(t,s)}});return s.toTex={1:"\\cosh\\left(${args[0]}\\right)"},s}var i=n(19),o=Math.cosh||function(t){return(Math.exp(t)+Math.exp(-t))/2};e.name="cosh",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("cot",{number:function(t){return 1/Math.tan(t)},Complex:function(t){return t.cot()},BigNumber:function(e){return new t.BigNumber(1).div(e.tan())},Unit:function(e){if(!e.hasBase(t.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cot is no angle");return o(e.value)},"Array | Matrix":function(t){return i(t,o)}});return o.toTex={1:"\\cot\\left(${args[0]}\\right)"},o}var i=n(19);e.name="cot",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var s=r("coth",{number:i,Complex:function(t){return t.coth()},BigNumber:function(e){return new t.BigNumber(1).div(e.tanh())},Unit:function(e){if(!e.hasBase(t.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function coth is no angle");return s(e.value)},"Array | Matrix":function(t){return o(t,s)}});return s.toTex={1:"\\coth\\left(${args[0]}\\right)"},s}function i(t){var e=Math.exp(2*t);return(e+1)/(e-1)}var o=n(19);e.name="coth",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("csc",{number:function(t){return 1/Math.sin(t)},Complex:function(t){return t.csc()},BigNumber:function(e){return new t.BigNumber(1).div(e.sin())},Unit:function(e){if(!e.hasBase(t.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function csc is no angle");return o(e.value)},"Array | Matrix":function(t){return i(t,o)}});return o.toTex={1:"\\csc\\left(${args[0]}\\right)"},o}var i=n(19);e.name="csc",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var s=r("csch",{number:i,Complex:function(t){return t.csch()},BigNumber:function(e){return new t.BigNumber(1).div(e.sinh())},Unit:function(e){if(!e.hasBase(t.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function csch is no angle");return s(e.value)},"Array | Matrix":function(t){return o(t,s)}});return s.toTex={1:"\\mathrm{csch}\\left(${args[0]}\\right)"},s}function i(t){return 0==t?Number.POSITIVE_INFINITY:Math.abs(2/(Math.exp(t)-Math.exp(-t)))*s(t)}var o=n(19),s=n(6).sign;e.name="csch",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("sec",{number:function(t){return 1/Math.cos(t)},Complex:function(t){return t.sec()},BigNumber:function(e){return new t.BigNumber(1).div(e.cos())},Unit:function(e){if(!e.hasBase(t.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sec is no angle");return o(e.value)},"Array | Matrix":function(t){return i(t,o)}});return o.toTex={1:"\\sec\\left(${args[0]}\\right)"},o}var i=n(19);e.name="sec",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var s=r("sech",{number:i,Complex:function(t){return t.sech()},BigNumber:function(e){return new t.BigNumber(1).div(e.cosh())},Unit:function(e){if(!e.hasBase(t.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sech is no angle");return s(e.value)},"Array | Matrix":function(t){return o(t,s)}});return s.toTex={1:"\\mathrm{sech}\\left(${args[0]}\\right)"},s}function i(t){return 2/(Math.exp(t)+Math.exp(-t))}var o=n(19);e.name="sech",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("sin",{number:Math.sin,Complex:function(t){return t.sin()},BigNumber:function(t){return t.sin()},Unit:function(e){if(!e.hasBase(t.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sin is no angle");return o(e.value)},"Array | Matrix":function(t){return i(t,o,!0)}});return o.toTex={1:"\\sin\\left(${args[0]}\\right)"},o}var i=n(19);e.name="sin",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var s=r("sinh",{number:o,Complex:function(t){return t.sinh()},BigNumber:function(t){return t.sinh()},Unit:function(e){if(!e.hasBase(t.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sinh is no angle");return s(e.value)},"Array | Matrix":function(t){return i(t,s,!0)}});return s.toTex={1:"\\sinh\\left(${args[0]}\\right)"},s}var i=n(19),o=Math.sinh||function(t){return(Math.exp(t)-Math.exp(-t))/2};e.name="sinh",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("tan",{number:Math.tan,Complex:function(t){return t.tan()},BigNumber:function(t){return t.tan()},Unit:function(e){if(!e.hasBase(t.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function tan is no angle");return o(e.value)},"Array | Matrix":function(t){return i(t,o,!0)}});return o.toTex={1:"\\tan\\left(${args[0]}\\right)"},o}var i=n(19);e.name="tan",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var s=r("tanh",{number:o,Complex:function(t){return t.tanh()},BigNumber:function(t){return t.tanh()},Unit:function(e){if(!e.hasBase(t.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function tanh is no angle");return s(e.value)},"Array | Matrix":function(t){return i(t,s,!0)}});return s.toTex={1:"\\tanh\\left(${args[0]}\\right)"},s}var i=n(19),o=Math.tanh||function(t){var e=Math.exp(2*t);return(e-1)/(e+1)};e.name="tanh",e.factory=r},function(t,e,n){t.exports=[n(494)]},function(t,e,n){"use strict";function r(t,e,r,i){var o=n(32),s=r(n(52)),a=r(n(57)),l=r(n(58)),h=i("to",{"Unit, Unit | string":function(t,e){return t.to(e)},"Matrix, Matrix":function(t,e){return a(t,e,h)},"Array, Array":function(t,e){return h(s(t),s(e)).valueOf()},"Array, Matrix":function(t,e){return h(s(t),e)},"Matrix, Array":function(t,e){return h(t,s(e))},"Matrix, any":function(t,e){return l(t,e,h,!1)},"any, Matrix":function(t,e){return l(e,t,h,!0)},"Array, any":function(t,e){return l(s(t),e,h,!1).valueOf()},"any, Array":function(t,e){return l(s(e),t,h,!0).valueOf()}});return h.toTex={2:"\\left(${args[0]}"+o.operators.to+"${args[1]}\\right)"},h}e.name="to",e.factory=r},function(t,e,n){t.exports=[n(496),n(416),n(365),n(89),n(378),n(497),n(430),n(498),n(91)]},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("clone",{any:i.clone});return o.toTex=void 0,o}var i=n(3);e.name="clone",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("isPrime",{number:function(t){if(2>t)return!1;if(2==t)return!0;if(t%2==0)return!1;for(var e=3;t>=e*e;e+=2)if(t%e==0)return!1;return!0},BigNumber:function(e){if(e.lt(2))return!1;if(e.equals(2))return!0;if(e.mod(2).isZero())return!1;for(var n=t.BigNumber(3);n.times(n).lte(e);n=n.plus(1))if(e.mod(n).isZero())return!1;return!0},"Array | Matrix":function(t){return i(t,o)}});return o}var i=n(19);e.name="isPrime",e.factory=r},function(t,e,n){"use strict";function r(t,e,n,r){var o=r("isNaN",{number:function(t){return Number.isNaN(t)},BigNumber:function(t){return t.isNaN()},Fraction:function(t){return!1},Complex:function(t){return Number.isNaN(t.re)&&Number.isNaN(t.im)},Unit:function(t){return Number.isNaN(t.value)},"Array | Matrix":function(t){return i(t,Number.isNaN)}});return o}var i=n(19);n(6),e.name="isNaN",e.factory=r},function(t,e,n){t.exports=[n(500)]},function(t,e){"use strict";function n(t,e,n,r){return function(e,n){var r=t[n&&n.mathjs];return r&&"function"==typeof r.fromJSON?r.fromJSON(n):n}}e.name="reviver",e.path="json",e.factory=n},function(t,e,n){"use strict";var r=n(11),i=n(42),o=n(43);t.exports=[{name:"ArgumentsError",path:"error",factory:function(){return r}},{name:"DimensionError",path:"error",factory:function(){return i}},{name:"IndexError",path:"error",factory:function(){return o}}]}]);Controller.StudentError=Controller.StudentError||{},function(){function t(t){return"BigNumber"!==math["typeof"](t)?t:math.number(t)}Controller.StudentError.parseRuleLogic=function(e,n){n||(n={}),math.config({number:"BigNumber"});var r=math.eval(e,n);return"Matrix"===math["typeof"](r)&&(r=r.toArray(),r=_.map(r,function(e){return t(e)})),r=t(r)}}(),function(){Controller.StudentError.parseRule=function(t,e,n,r){if("string"==typeof e)try{e=JSON.parse(e)}catch(i){}if(""===t)return!0;var o=Controller.StudentError.parseRuleLogic(t,r);return o===!0||o===!1?o:_.isEqual(o,e)}}(),function(){function t(t){if(_.isNumber(t))return t;var e=_.toNumber(t);return isNaN(e)||""===t?t:e}function e(e,n){return _(n).reduce(function(n,r,i){return n[e+(i+1)]=t(r),n},{})}Controller.StudentError.createRuleScope=function(t,n,r){return _.assign({},e("attr",t),e("ans",n),e("input",r))}}(),Controller.BaseControlModel=Backbone.Model.extend({defaults:{x:0,y:0,w:0,h:0,attachedHintBubbleCid:!1,studentErrorBubbleCid:!1},initialize:function(){this.listenTo(this,"add",this.addHintBubble)},addHintBubble:function(){var t=this.get("hint");if(t){t.type="hintBubble",t.hintType="attached",t.hintIdentifier="("+this.get("x")+","+this.get("y")+")",t.x=this.get("x")+this.get("w"),t.y=this.get("y");var e=this.collection.add(t);this.set({attachedHintBubbleCid:e.cid})}this.unset("hint")},parse:function(t){return t},getResources:function(){return this.resources||[]},loadResource:function(t){this.trigger("loaded-resource")},loadAssets:function(){this.trigger("loaded-assets")},isInputControl:function(){return this.get("inputControl")},isValid:function(){if(void 0!==this.get("mcValue")){var t=this.get("answerIndex");return this.collection.some(function(e){return e.get("_mcSelected")&&t===e.get("answerIndex")})}return!0},isCorrect:function(t){return this.get("_mcSelected")!==!0||this.get("mcValue")===t[this.get("answerIndex")-1]},getInput:function(){if(this.get("_mcSelected")===!0)return this.get("mcValue")},setInput:function(t){var e=this.get("mcValue");_.isUndefined(e)||e!==t[this.get("answerIndex")-1]||this._mcSelect()},enableInput:function(){this.trigger("enable-input")},disableInput:function(){this.trigger("disable-input")},displayAnswer:function(t){var e=this.get("mcValue");void 0!==e&&(e===t[this.get("answerIndex")-1]?this.trigger("highlight-correct"):this.get("_mcSelected")&&this.trigger("highlight-incorrect"))},displayResult:function(t){void 0!==this.get("mcValue")?this.get("_mcSelected")&&(this.isCorrect(t)?this.trigger("highlight-correct"):this.trigger("highlight-incorrect")):this.isInputControl()&&(this.isCorrect(t)?this.trigger("highlight-correct"):this.trigger("highlight-incorrect"))},displayHighlight:function(){var t=this.get("answers");this.displayResult(t)},hasInputChanged:function(t){function e(t,e){return t&&t.hasOwnProperty(e)}var n=this.getInput(),r=e(n,"answerIndex")?n.answerIndex:this.get("answerIndex")||1,i=e(n,"answerSubIndex")?n.answerSubIndex:this.get("answerSubIndex"),o=e(n,"input")?n.input:n;try{var s=i?t[r-1][i-1]:t[r-1];return!_.isEqual(o,s)}catch(a){return!0}},_mcSelect:function(){this.get("_mcSelected")===!1&&(this.collection.each(function(t){t.get("_mcSelected")&&(t.set({_mcSelected:!1}),t.trigger("remove-highlight"))}),this.set({_mcSelected:!0}))},_recordMove:function(t){this.set({_x:t.x,_y:t.y}),this.collection.each(function(t){t.get("_lastMoved")&&t.set({_lastMoved:!1},{silent:!0})}),this.set({_lastMoved:!0})},get:function(t){switch(t){case"answers":return this.collection.answers||[];case"splitTestingSignature":return this.collection.splitTestingSignature||0;default:return Backbone.Model.prototype.get.call(this,t)}},setAttachedHintBubbleVisibilityTo:function(t){var e=this.get("attachedHintBubbleCid");if(e){var n=this.collection.get(e);n.set({isVisible:t})}},addStudentErrorBubble:function(t,e,n){this.removeStudentErrorBubble(),this.isInputControl()&&"hintBubble"!==this.get("type")&&!this.isCorrect(this.get("answers"))&&(this.setAttachedHintBubbleVisibilityTo(!1),_.forEach(t,function(t){var r=this.get("answers")[this.get("answerIndex")-1],i=Controller.StudentError.parseRule(t.logic,n,r,e);if(i){var o=this._getStudentErrorBubbleSettings(t,e),s=this.collection.add(o);return this.set({studentErrorBubbleCid:s.cid}),!1}}.bind(this)))},removeStudentErrorBubble:function(){var t=this.get("studentErrorBubbleCid");t&&(this.setAttachedHintBubbleVisibilityTo(!0),this.collection.remove(t),this.set({studentErrorBubbleCid:!1}))},_getStudentErrorBubbleSettings:function(t,e){return{type:"studentErrorBubble",hintType:"attached",w:250,x:this.get("x")+this.get("w"),y:this.get("y"),direction:t.direction,value:this._getFormattedStudentErrorBubbleValue(t,e),attachedControl:this}},_getFormattedStudentErrorBubbleValue:function(t,e){return t.message?t.message.replace(/#input\d+/g,function(t){const n=e[t.substr(1)];return void 0!==n?_.truncate(n,{length:50}):t}):""}}),Controller.BaseControlView=function(t){Backbone.View.apply(this,[t])},_.extend(Controller.BaseControlView.prototype,Backbone.View.prototype,{className:"control",initialize:function(){this.listenTo(this.model,"enable-input",this.enableInput),this.listenTo(this.model,"disable-input",this.disableInput),this.listenTo(this.model,"highlight-correct",this.highlightCorrect),this.listenTo(this.model,"highlight-incorrect",this.highlightIncorrect),this.listenTo(this.model,"remove-highlight",this.removeHighlight),this.model.isInputControl()||(void 0!==this.model.get("mcValue")&&(this.model.set({inputControl:!0,_mcSelected:!1},{silent:!0}),this.events={mousedown:"_mcSelect"},this.listenTo(this.model,"change:_mcSelected",this._changeMcSelected),this.$el.addClass("mc-option")),this.model.get("draggable")&&(this.model.set({inputControl:!0,_lastMoved:!1,_targetIndex:void 0},{silent:!0}),this.events={mousedown:"_dragMouse"},this.listenTo(this.model,"_change-target",this._changeTarget))),this.model.isInputControl()&&(this.model.set({answerIndex:this.model.get("answerIndex")||1}),this.$el.addClass("input-control")),this.listenTo(this.model,"remove",this.close),this.delegateEvents()},render:function(){this.$el.css({left:this.model.get("x")+"px",top:this.model.get("y")+"px",height:this.model.get("h")+"px",width:this.model.get("w")+"px"})},postRender:function(){},close:function(){this.disableInput(),this.$el.empty().detach()},getAbsoluteWidth:function(){return Math.max(0,this.model.get("x")+this.$el.outerWidth())},getAbsoluteHeight:function(){return Math.max(0,this.model.get("y")+this.$el.outerHeight())},enableInput:function(){
this.$el.removeClass("input-disabled"),this.delegateEvents()},disableInput:function(){this.$el.addClass("input-disabled"),this.undelegateEvents()},highlightCorrect:function(){this.$el.removeClass("highlight-incorrect").addClass("highlight-correct")},highlightIncorrect:function(){this.$el.removeClass("highlight-correct").addClass("highlight-incorrect")},removeHighlight:function(){this.$el.removeClass("highlight-correct").removeClass("highlight-incorrect")},_mcSelect:function(){this.model._mcSelect()},_changeMcSelected:function(){this.model.get("_mcSelected")?this.$el.addClass("mc-selected"):this.$el.removeClass("mc-selected")},_dragStart:function(t){t.preventDefault(),this.model.unset("_targetIndex"),$(".control.draggable").removeClass("draggable"),this.$el.addClass("draggable")},_dragMouse:function(t){this._dragStart(t);var e=this.model.collection,n=e.containerId?$("#"+e.containerId):document;$(n).trigger("mouseleave").off("mousemove mouseup mouseleave").on({mousemove:function(t){t.preventDefault();var e,n=$(".control.draggable")[0];n&&(e=n.getBoundingClientRect(),$(n).offset({top:t.pageY-e.height/2,left:t.pageX-e.width/2}))},"mouseup mouseleave":function(t){t.preventDefault();var e=$(".control.draggable").position(),r=this.el.getBoundingClientRect().width/this.el.offsetWidth;e&&(this.model._recordMove({x:this.model.get("x")+e.left/r,y:this.model.get("y")+e.top/r}),$(".control.draggable").removeClass("draggable"),$(n).off("mousemove mouseup mouseleave"))}.bind(this)})},_changeTarget:function(t){this.$el.css({top:t.y,left:t.x}),this.model.set({targetIndex:t.index})}}),Controller.BaseControlView.extend=Backbone.View.extend,Controller.DomControlModel=Controller.BaseControlModel.extend({}),Controller.DomControlView=Controller.BaseControlView.extend({initialize:function(){if(this.model.isInputControl())for(var t in this.events)(function(t){var e=this.events[t],n=this[e];this[e]=function(t){if(t){var e=this.$el.offset(),r=this.el.getBoundingClientRect().width/this.el.offsetWidth,i=(t.pageX-e.left)/r,o=(t.pageY-e.top)/r;t.elementX=i,t.elementY=o}n.apply(this,arguments)}}).bind(this)(t);Controller.BaseControlView.prototype.initialize.call(this)},template:_.template(""),renderTemplate:function(){var t=this.model.attributes;this.$el.html(this.template(t))},render:function(){this.renderTemplate(),Controller.BaseControlView.prototype.render.apply(this)}}),Controller.PictureModel=Controller.DomControlModel.extend({parse:function(t){var e=t.value,n=["Alligator","Alligator2","BlueSmile","Car","CarBlue","CarGreen","CarOrange","Cat","Cow","Dice1","Dice2","Dice3","Dice4","Dice5","Dice6","Duck","edge","face","GreenSmile","IceCreamCone","interiorangle","leftright","Lion","Monkey","NotePadClosed","NotePadOpen","Owl","Pencil","PencilLong","Pig","PinkSmile","PurpleSmile","Rabbit","RedSmile","rightangle","Ruler2","symmetry","Thermometer","Thermometer-Mercury","Thermometer-Transparent","vertex","YellowSmile"];if(e){e=e.split(",");var r=e[0],i=_.includes(n,r)?r+".png":r+".gif";t.src=Controller.IMAGE_PATH+i,t.rotation=e[1]||0,t.width=parseInt(e[2]),t.height=parseInt(e[3])}return t.src=t.src||Controller.IMAGE_PATH+"default.gif",t.width=t.width||t.w,t.height=t.height||t.h,Controller.DomControlModel.prototype.parse.call(this,t)},loadAssets:function(){this.picture=new Image(this.get("width"),this.get("height")),this.picture.onload=function(){this.picture.onload=null,this.picture.onerror=null,this.trigger("loaded-assets")}.bind(this),this.picture.onerror=function(){console.warn("Image "+this.get("src")+" failed to load."),this.picture.onload=null,this.picture.onerror=null,this.picture.src=Controller.IMAGE_PATH+"default.gif",this.trigger("loaded-assets")}.bind(this),this.picture.src=this.get("src")}}),Controller.PictureView=Controller.DomControlView.extend({renderTemplate:function(){this.model.picture.style["-webkit-transform"]="rotate("+this.model.get("rotation")+"deg)",this.model.picture.style.transform="rotate("+this.model.get("rotation")+"deg)",this.$el.append(this.model.picture)}}),Controller.TableModel=Controller.DomControlModel.extend({defaults:{textColor:Controller.COLORS.charcoal,bgColor:Controller.COLORS.white,borderColor:Controller.COLORS.charcoal,labelBgColor:Controller.COLORS.teal,labelColor:Controller.COLORS.white},parse:function(t){var e=JSON.parse("["+t.value.replace(/'/g,'"')+"]");return t.cellWidths=e[0]||[],t.cellHeights=e[1]||[],t.tableContents=e[2]||[],Controller.DomControlModel.prototype.parse.call(this,t)},isLabelCell:function(t,e){switch(this.get("labelAlign")){case 1:return 0===t;case 2:return 0===e;case 3:return 0===t||0===e;default:return!1}},getOffset:function(){var t=this.get("cellHeights"),e=this.get("cellWidths"),n=function(t,e){return t+e},r=t.reduce(n,0)+t.length-1,i=e.reduce(n,0)+e.length-1;return this.get("unbordered")||(r+=2,i+=2),{y:Math.max(0,this.get("h")-r)/2,x:Math.max(0,this.get("w")-i)/2}},addTextBox:function(t){this.get("unbordered")||t.x++,this.collection.add({type:"textBox",value:"",align:1,x:this.get("x")+t.x,y:this.get("y")+t.y,w:t.w,h:t.h,answerIndex:this.get("answerIndex"),answerSubIndex:t.answerSubIndex})}}),Controller.TableView=Controller.DomControlView.extend({template:function(t){for(var e=this.model.getOffset(),n=1,r=function(t,e){return t+e},i='<table style="position:absolute; top:'+e.y+"px; left:"+e.x+'px; width:auto">',o=0;o<t.cellHeights.length;o++){i+='<tr style="height:'+t.cellHeights[o]+'px;">';for(var s=0;s<t.cellWidths.length;s++)i+=(this.model.isLabelCell(o,s)?'<th style="':'<td style = "')+"font-size: 1em; height:"+t.cellHeights[o]+"px; width:"+(t.cellWidths[s]-1)+"px; min-width:"+(t.cellWidths[s]-1)+"px; max-width:"+(t.cellWidths[s]-1)+'px;">',t.tableContents[o]&&void 0!==t.tableContents[o][s]&&("_"===t.tableContents[o][s]?this.model.addTextBox({x:t.cellWidths.slice(0,s).reduce(r,0)+2+e.x,y:t.cellHeights.slice(0,o).reduce(r,0)+2+e.y,w:t.cellWidths[s]-4,h:t.cellHeights[o]-2,answerSubIndex:n++}):i+=t.tableContents[o][s]),i+="</td>";i+="</tr>"}return i+="</table>",_.template(i)(t)},render:function(){this.$el.css({"align-items":"center","font-family":"Roboto","font-size":"16px",color:this.model.get("textColor")}),Controller.DomControlView.prototype.render.apply(this),this.$("table").css({margin:"0px",width:"initial","table-layout":"fixed","border-collapse":"collapse","border-bottom":"1px solid "+this.model.get("borderColor"),"box-sizing":"content-box"}),this.$("table tr").css({overflow:"hidden",display:"block","background-color":this.model.get("bgColor")}),this.$("table th, table td").css({"text-align":"center",margin:"0px",padding:"0px",overflow:"hidden",border:"1px solid "+this.model.get("borderColor")}),this.$("table th").css({"background-color":this.model.get("labelBgColor"),color:this.model.get("labelColor"),"font-weight":"bold","text-shadow":"-1px -1px 0 "+this.model.get("textColor")+", 1px -1px 0 "+this.model.get("textColor")+",-1px 1px 0 "+this.model.get("textColor")+", 1px 1px 0 "+this.model.get("textColor"),"font-size":"19px"}),this.model.get("unbordered")&&(this.$("table tr:first-child th, table tr:first-child td").css({"border-top":0}),this.$("table, table tr:last-child th, table tr:last-child td").css({"border-bottom":0}),this.$("table tr th:first-child, table tr td:first-child").css({"border-left":0}),this.$("table tr th:last-child, table tr td:last-child").css({"border-right":0}))}}),Controller.TextBlockModel=Controller.DomControlModel.extend({defaults:{hints:[],hintsEnabledFlag:!0},initialize:function(){this.listenTo(this,"add",this.addHintSubModels),this.addHintSubModels(),Controller.DomControlModel.prototype.initialize.apply(this,arguments)},disableInput:function(){},addHintSubModels:function(){for(var t,e=Object.keys(this.attributes),n=e.filter(function(t){return/^hint\d+$/.test(t)}),r=[],i=[],o=/(?:{hint \w})(.*?)(?:{\/hint})/g;t=o.exec(this.get("value"));)i.push(t[1].trim());for(var s,a,l=0;l<n.length;l++)s=this.get(n[l])||{},a=parseInt(n[l].substring(4)),s.type="hintBubble",s.x=0,s.y=-6,s.hintType="inline",s.identifier=JSON.stringify({x:this.get("x"),y:this.get("y"),n:a}),r[a]=new Controller.HintBubbleModel(s,{parse:!0,collection:this.collection});this.set("hints",r)},disableHintBubbles:function(){this.set("hintsEnabledFlag",!1)},setTrackCallback:function(t){var e=this.get("hints");e.forEach(function(e){e.set("trackCallback",t)})},parse:function(t){switch(t.align){case 2:t.alignment="right";break;case 1:t.alignment="center";break;default:t.alignment="left"}return Controller.DomControlModel.prototype.parse(t)},isNumeric:function(){var t=this.get("numeric")||/^((\+|-|x|×|÷|=) ?)?-?((\d|_|‗)*|((\d|_|‗){1,3}(,(\d|_|‗){3})*))\.?(\d|_|‗)*$/.test(this.get("value"));return t&&this.set({value:this.get("value").replace(/_/g,"‗")}),t},isLine:function(){return"----"===this.get("value")},formatText:function(t){return this.isLine&&this.isLine()?"":(this.get("fraction")&&(t=t.replace(/{fraction}(.*?){\/fraction}|((-?\d+ )?-?\d+\/-?\d+)/g,function(){return"{fraction}"+(arguments[1]||arguments[2])+"{/fraction}"})),t.replace(/{i}(.*?){\/i}/g,"<i>$1</i>").replace(/{b}(.*?){\/b}/g,"<b>$1</b>").replace(/{u}(.*?){\/u}/g,"<u>$1</u>").replace(/{\^}(.*?){\/\^}/g,"<sup>$1</sup>").replace(/{overline}(.*?){\/overline}/g,"<span style='text-decoration: overline'>$1</span>").replace(/{s (\d+)}(.*?){\/s}/g,"<span style='font-size:$1px'>$2</span>").replace(/{c (\d+),(\d+),(\d+)}(.*?){\/c}/g,"<span style='color:rgb($1,$2,$3)'>$4</span>").replace(/{c (\w+)}(.*?){\/c}/g,function(){var t=Controller.COLORS[arguments[1]]||"",e=arguments[2];return"<span style='color:"+t+"'>"+e+"</span>"}).replace(/{newline}/g,"<br>").replace(/{n}/g,"<br>").replace(/{p}(.*?){\/p}/g,"<p>$1</p>").replace(/{fraction}([^\[][^\/s]*\s)?((\[(.*?)\])|([^\/]+))\/(\[(.*?)\]|([^{]+)){\/fraction}/g,function(){var t=(arguments[1]||"").trim(),e=arguments[4]||arguments[5]||"",n=arguments[7]||arguments[8]||"";return'<span class="fraction">'+t+'<span class="fractional-part"><sup class="numerator">'+e+'</sup><sub class="denominator">'+n+"</sub></span></span>"}).replace(/{q}(.*?){\/q}/g,"<span class='question'>$1</span>").replace(/{em}(.*?){\/em}/g,"<span class='emphasis'>$1</span>").replace(/{note}(.*?){\/note}/g,"<span class='note'>$1</span>").replace(/{hint (\d+)}(.*?){\/hint}/g,'<span class="hint" data-hint-number="$1">$2 </span>'))}}),Controller.TextBlockView=Controller.DomControlView.extend({className:Controller.DomControlView.prototype.className+" text-block",initialize:function(){this.listenTo(this.model,"change:hintsEnabledFlag",this.renderHintBubbles),this.listenTo(this.model,"change:hints",this.renderHintBubbles),Controller.DomControlView.prototype.initialize.apply(this,arguments)},template:function(t){return t.text=this.model.formatText(t.value),_.template("<%= text %>")(t)},render:function(){this.$el.css({"text-align":this.model.get("alignment")}),this.model.isNumeric()?this.$el.addClass("number").css("padding-top","3px"):this.$el.addClass("text"),this.model.isLine()&&this.$el.addClass("line"),Controller.DomControlView.prototype.render.apply(this),this.renderHintBubbles()},renderHintBubbles:function(){var t=this.model.get("hints"),e=this.model.get("hintsEnabledFlag");this.hintViews=[],t.forEach(function(t,n){if(t.hasNoContent()||!e)this.$('.hint[data-hint-number="'+n+'"]').removeClass("hint").removeData("hint-number").find(".hint-bubble").empty().detach();else{var r=new Controller.HintBubbleView({model:t}),i=this.$('.hint[data-hint-number="'+n+'"]');r.render(),i.find(".hint-bubble").empty().detach(),i.append(r.$el),this.hintViews[n]=r}}.bind(this))},getVerticalPadding:function(t){return _.isEmpty(this.hintViews)?0:_.maxBy(this.hintViews.map(function(e){return _.isFunction(e.getVerticalPadding)?e.getVerticalPadding(t):0}))},getHorizontalPadding:function(t){return _.isEmpty(this.hintViews)?0:_.maxBy(this.hintViews.map(function(e){return _.isFunction(e.getHorizontalPadding)?e.getHorizontalPadding(t):0}))},events:{"mouseup .hint":"toggleHintBubble"},toggleHintBubble:function(t){var e=$(t.target).attr("data-hint-number");this.hintViews&&this.hintViews[e]&&this.hintViews[e].toggleHintBubble()}}),Controller.TextBoxModel=Controller.DomControlModel.extend({defaults:{inputControl:!0},parse:function(t){switch(t.align){case 3:t.alignment="justify";break;case 2:t.alignment="right";break;case 1:t.alignment="center";break;default:t.alignment="left"}return Controller.DomControlModel.prototype.parse(t)},isValid:function(){var t=this.get("input");return!_.isUndefined(t)&&""!==t.toString().trim()},isCorrect:function(t){function e(t){return t=t.toString().trim(),"-"!==t&&/^-?(\d*|([1-9]\d{0,2}(,(\d){3})*))(\.(\d)+)?$/.test(t)?(t=t.trim().replace(/,/g,""),parseFloat(t)):Controller.Math.RationalNumber.isFraction(t)?Controller.Math.RationalNumber.trim(t):t}var n=this.getData(this.get("answers")),r=this.getInput();return n=e(n),r=e(r),n===r},getInput:function(){var t=this.get("input")||"";return this.get("reversed")?t.split("").reverse().join(""):t},getData:function(t){var e=this.get("answerIndex")||1,n=this.get("answerSubIndex"),r=n?t[e-1][n-1]:t[e-1];return _.isUndefined(r)?"":r},setInput:function(t){var e=this.getData(t);e=this.get("reversed")?e.toString().split("").reverse().join(""):e,this.set({input:e.toString()}),this.trigger("set-input")},displayAnswer:function(t){this.setInput(t),this.trigger("highlight-correct")}}),Controller.TextBoxView=Controller.DomControlView.extend({tagName:"textarea",initialize:function(){this.listenTo(this.model,"set-input",this.setInputtedText),this.listenTo(this.model,"qi-blur",this.blur),Controller.DomControlView.prototype.initialize.apply(this)},events:{mouseup:"touchFocus","qi-focus":"focus",keypress:"checkInput",input:"recordInput","qi-input":"typeInput"},touchFocus:function(t,e){return e&&e.isTouch?this.$el.prop("readOnly",!0).trigger("qi-focus"):setTimeout(function(){this.$el.prop("readOnly",!1).focus().trigger("qi-focus")}.bind(this),0),!1},focus:function(t){this.model.trigger("TextBox:focused"),this.model.collection.each(function(t){"textBox"===t.get("type")&&t.trigger("qi-blur")}),this.$el.addClass("focus");try{var e=this.$el.val();this.el.setSelectionRange(e.length,e.length)}catch(t){}},typeInput:function(t,e){if(this.$el.hasClass("focus")){var n=this.$el.val();if("DEL"===e)n=n.slice(0,-1);else{var r=this.$el.attr("maxLength"),i=_.isUndefined(r)?Number.POSITIVE_INFINITY:parseInt(r);e=e.toString(),n.length+e.length<=i?n+=e:(this.$el.removeClass("restrict-input"),setTimeout(function(){this.$el.addClass("restrict-input")}.bind(this),0))}this.$el.val(n).scrollLeft(n.length*(this.$el.hasClass("reverse")?-20:20)),this.model.set({input:n}),this.removeHighlight()}},checkInput:function(t){var e=this.$el.attr("maxLength"),n=this.model.get("input"),r=this.$el.val();_.isUndefined(e)||8===t.keyCode||n===r&&r.length===parseInt(e)&&(this.$el.removeClass("restrict-input"),setTimeout(function(){this.$el.addClass("restrict-input")}.bind(this),0)),this.$el.val(r),this.model.set({input:r})},recordInput:function(){this.model.set({input:this.$el.val()}),this.removeHighlight()},blur:function(t){this.$el.removeClass("focus").blur()},setInputtedText:function(){this.$el.val(this.model.get("input"))},enableInput:function(){this.$el.removeClass("input-disabled"),this.$el.removeAttr("readOnly")},disableInput:function(){this.$el.addClass("input-disabled"),this.$el.attr("readOnly","true")},render:function(){if(this.$el.addClass("number").css({"line-height":this.model.get("h")+"px","text-align":this.model.get("alignment")}),this.model.get("w")<30){var t=this.model.get("w")<20?1:2,e=1;this.$el.attr("maxLength",Math.max(t,e))}this.model.get("reversed")?this.$el.addClass("reverse"):this.$el.removeClass("reverse"),Controller.DomControlView.prototype.render.apply(this)}}),Controller.DropDownModel=Controller.DomControlModel.extend({defaults:{selectedOption:"",dropUp:!1,inputControl:!0},parse:function(t){var e=JSON.parse("["+t.value.replace(/'/g,'"')+"]");return t.options=e[0]||[""],Controller.DomControlModel.prototype.parse.call(this,t)},selectOption:function(t){this.set({selectedOption:t})},isValid:function(){return""!==this.get("selectedOption")},isCorrect:function(t){var e=this.get("answerIndex")||1,n=t[e-1];return n.toString()===this.get("selectedOption")},getInput:function(){return this.get("selectedOption")},setInput:function(t){var e=this.get("answerIndex")||1;this.selectOption(t[e-1])},displayAnswer:function(t){var e=this.get("answerIndex")||1;this.set({selectedOption:t[e-1]}),this.trigger("highlight-correct")}}),Controller.DropDownView=Controller.DomControlView.extend({className:Controller.DomControlView.prototype.className+" dropdown",template:function(t){for(var e='<div class="dropdown-main sub-input" style="width:<%= w %>px; height:<%= h %>px; line-height:<%= h %>px;"><div class="dropdown-contents" style="width:<%= (w-25) %>px; height:<%= h %>px"></div><div style="position:absolute; right: 0px; padding-right:4px; font-size:8px">'+(t.dropUp?"▲":"▼")+'</div></div><div class="dropdown-options" style="'+(t.dropUp?"bottom:<%= h %>px; -webkit-transform-origin: 50% 100%; transform-origin: 50% 100%":"-webkit-transform-origin: 50% 0%; transform-origin: 50% 0%;")+'">',n=0;n<t.options.length;n++)e+='<div class="dropdown-option" style="width:<%= (w - 12) %>px"><span>'+t.options[n]+"</span></div>";return e+="</div>",_.template(e)(t)},initialize:function(){this.listenTo(this.model,"change:selectedOption",this.changeOption),this.listenTo(this.model,"highlight-correct",this.displayAnswer),this.listenTo(this.model,"highlight-incorrect",this.displayInput),this.$el.addClass("text"),Controller.DomControlView.prototype.initialize.apply(this)},events:{"mousedown .dropdown-main":"toggleDropDown","mousedown .dropdown-option":"highlightOption","mousemove .dropdown-option":"highlightOption","mouseup .dropdown-option":"selectOption"},getAbsoluteHeight:function(){var t=this.$(".dropdown-main").outerHeight()+5;return this.model.get("dropUp")||(t+=this.$(".dropdown-options").outerHeight()),Math.max(0,this.model.get("y")+t)},disableInput:function(){this.$el.addClass("input-disabled"),this.delegateEvents(_.omit(this.events,["mousedown .dropdown-option","mousemove .dropdown-option","mouseup .dropdown-option"]))},toggleDropDown:function(t){this.$(".dropdown-options").toggleClass("visible"),this.$(".dropdown-option").toggleClass("sub-input")},highlightOption:function(t){var e=this.$(".dropdown-options").css("transform")||this.$(".dropdown-options").css("-webkit-transform");this.$(".dropdown-options").hasClass("visible")&&"1"===e.match(/-?[\d\.]+/g)[6]&&(this.$(".highlight").removeClass("highlight"),$(t.target).addClass("highlight"))},selectOption:function(t){if(this.$(".dropdown-options").hasClass("visible")){var e=this.$(".highlight")||$(t.target);this.model.selectOption(e.find("span").text()),this.toggleDropDown(t),this.removeHighlight()}},changeOption:function(){$(this.$(".dropdown-contents")[0]).text(this.model.get("selectedOption"))}}),Controller.SortingChartModel=Controller.DomControlModel.extend({defaults:{textColor:Controller.COLORS.charcoal,bgColor:Controller.COLORS.white,borderColor:Controller.COLORS.charcoal,labelBgColor:Controller.COLORS.teal,labelColor:Controller.COLORS.white,inputControl:!0},parse:function(t){var e=JSON.parse("["+t.value.replace(/'/g,'"')+"]");return t.cellWidths=e[0]||[],t.cellHeights=e[1]||[],t.tableContents=e[2]||[],Controller.DomControlModel.prototype.parse.call(this,t)},isLabelCell:function(t,e){switch(this.get("labelAlign")){case 1:return 0===t;case 2:return 0===e;case 3:return 0===t||0===e;default:return!1}}}),Controller.SortingChartView=Controller.DomControlView.extend({initialize:function(){this.listenTo(this.model.collection,"change:_lastMoved",this._moveTarget),Controller.DomControlView.prototype.initialize.call(this),this.$el.css({"z-index":-1})},template:function(t){for(var e='<table style="width:auto">',n=0;n<t.cellHeights.length;n++){e+='<tr style="height:'+t.cellHeights[n]+'px">';for(var r=0;r<t.cellWidths.length;r++)e+=(this.model.isLabelCell(n,r)?'<th style="':'<td style = "')+"height:"+t.cellHeights[n]+"px; width:"+(t.cellWidths[r]-1)+"px; min-width:"+(t.cellWidths[r]-1)+"px; max-width:"+(t.cellWidths[r]-1)+'px;">',t.tableContents[n]&&void 0!==t.tableContents[n][r]&&(e+=t.tableContents[n][r]),e+="</td>";e+="</tr>"}return e+="</table>",_.template(e)(t)},render:function(){this.$el.css({display:"flex","align-items":"center","font-family":"Roboto","font-size":"16px",color:this.model.get("textColor")}),Controller.DomControlView.prototype.render.apply(this),this.$("table").css({"text-align":"center",margin:"0 auto","table-layout":"fixed","border-collapse":"collapse","border-bottom":"1px solid "+this.model.get("borderColor"),"background-color":this.model.get("bgColor")}),this.$("table tr").css({overflow:"hidden",display:"block"}),this.$("table th, table td").css({margin:"0px",padding:"0px",overflow:"hidden",border:"1px solid "+this.model.get("borderColor")}),this.$("table th").css({"background-color":this.model.get("labelBgColor"),color:this.model.get("labelColor"),"font-weight":"bold","text-shadow":"-1px -1px 0 "+this.model.get("textColor")+", 1px -1px 0 "+this.model.get("textColor")+",-1px 1px 0 "+this.model.get("textColor")+", 1px 1px 0 "+this.model.get("textColor"),"font-size":"19px"}),this.model.get("unbordered")&&(this.$("table tr:first-child th, table tr:first-child td").css({"border-top":0}),this.$("table, table tr:last-child th, table tr:last-child td").css({"border-bottom":0}),this.$("table tr th:first-child, table tr td:first-child").css({"border-left":0}),this.$("table tr th:last-child, table tr td:last-child").css({"border-right":0}))},_moveTarget:function(){var t=this.model.collection.find(function(t){return t.get("draggable")&&t.get("_lastMoved")});if(t){for(var e,n,r,i,o,s,a,o,s,l=this.model.get("cellWidths").length,h=this.el.getBoundingClientRect().width/this.el.offsetWidth,c=Number.POSITIVE_INFINITY,u=0;u<l;u++)e=this.$("table tr:eq(1) > td:eq("+u+")"),n=e.position(),o=this.model.get("x")+n.left/h,s=this.model.get("y")+n.top/h,r=Controller.Math.intersect({type:"rectangle",x:o,y:s,w:e.width(),h:e.height()},{type:"rectangle",x:t.get("_x"),y:t.get("_y"),w:t.get("w"),h:t.get("h")}),r&&(i=Controller.Math.distanceFromPoint({type:"rectangle",xMin:o,xMax:o+e.width(),yMin:s,yMax:s+e.height()},{x:t.get("_x")+t.get("w")/2,y:t.get("_y")+t.get("h")/2}),i<c&&(c=i,a=e));a&&(n=a.position(),o=this.model.get("x")+n.left/h,s=this.model.get("y")+n.top/h,o=Math.min(Math.max(o,t.get("_x")),o+a.width()-t.get("w")),s=Math.min(Math.max(s,t.get("_y")),s+a.height()-t.get("h")),t.trigger("_change-target",{x:o,y:s,index:u}))}}}),Controller.InteractiveClockModel=Controller.DomControlModel.extend({defaults:{startHour:12,startMinute:60,restrictInterval:15,inputControl:0,faceType:12,hourDragging:!1,minuteDragging:!1,borderWidth:10,correctness:[],correctnessDetermined:!1,shouldAnswerDisplay:!1},parse:function(t){var e=t.value.split(",");return t.startHour=parseInt(e[0])||this.defaults.startHour,t.startMinute=parseInt(e[1])||this.defaults.startMinute,t.startMinute=this.resetMinute(t.startMinute),t.faceType=parseInt(e[2])||this.defaults.faceType,t.restrictInterval=parseInt(e[3])||this.defaults.restrictInterval,t.hourCurrent=t.startHour,t.minuteCurrent=t.startMinute,t.hourDegree=this.getAngleFromHour(t.hourCurrent,t.minuteCurrent),t.minuteDegree=this.getAngleFromMinute(t.minuteCurrent),t.inputControl="undefined"!=typeof t.inputControl?t.inputControl:this.defaults.inputControl,t.inputControl=parseInt(t.inputControl),t.staticMode=0===t.inputControl?"static":"not-static",Controller.DomControlModel.prototype.parse.call(this,t)},resetMinute:function(t){return t%60},getAngleFromHour:function(t,e){return 30*t+e/2},getAngleFromMinute:function(t){return 6*t},getHourFromAngle:function(t){var e,n;n=Math.floor(t/30),e=n<1?n+12:n,this.set("hourCurrent",e),this.set("hourDegree",this.getAngleFromHour(this.get("hourCurrent"),this.get("minuteCurrent")))},getMinuteFromAngle:function(t){var e,n,r=this.get("restrictInterval");n=t/6,n=Math.round(n/r)*r,e=n<1?n+60:n,e=this.resetMinute(e),console.log(e),this.set("minuteCurrent",e),this.set("minuteDegree",this.getAngleFromMinute(this.get("minuteCurrent")))},setCorrectness:function(t){var e=this.getAnswer(t);this.set({correctness:{hour:e[0]===this.get("hourCurrent"),minute:this.resetMinute(e[1])===this.resetMinute(this.get("minuteCurrent"))}})},calculateAngle:function(t,e){var n=Math.atan2(e-this.get("h")/2,t-this.get("w")/2);return n*=180/Math.PI,n+=90},handleMouseDownHour:function(t,e){this.set({draggingHour:!0}),this.set({hourDegree:this.calculateAngle(t,e)})},handleMouseDownMinute:function(t,e){this.set({draggingMinute:!0}),this.set({minuteDegree:this.calculateAngle(t,e)})},handleMouseMove:function(t,e){this.get("draggingHour")?this.set({hourDegree:this.calculateAngle(t,e)}):this.get("draggingMinute")&&this.set({minuteDegree:this.calculateAngle(t,e)})},handleMouseUp:function(t,e){this.get("draggingHour")?(this.getHourFromAngle(this.get("hourDegree")),this.set("draggingHour",!1),this.set("removeCorrectness","hour hand")):this.get("draggingMinute")&&(this.getMinuteFromAngle(this.get("minuteDegree")),this.getHourFromAngle(this.get("hourDegree")),this.set("draggingMinute",!1),this.set("removeCorrectness","minute hand"))},isValid:function(){return this.get("hourCurrent")!==this.get("startHour")||this.get("minuteCurrent")!==this.get("startMinute")},isCorrect:function(t){this.setCorrectness(t);var e=this.get("correctness");return console.log(e),e.hour&&e.minute},getInput:function(){return[this.get("hourCurrent"),this.get("minuteCurrent")]},setInput:function(t){console.log(t);var e=this.get("answerIndex")||1,n=t[e-1][0],r=t[e-1][1];this.set({hourCurrent:n,minuteCurrent:r}),this.set({hourDegree:this.getAngleFromHour(this.get("hourCurrent"),this.get("minuteCurrent"))}),this.set({minuteDegree:this.getAngleFromMinute(this.get("minuteCurrent"))}),this.set("removeCorrectness","both hands")},getAnswer:function(t){t="undefined"==typeof t?this.collection.answers:t;var e=this.get("answerIndex")||1;return t[e-1]},displayAnswer:function(){var t=this.getAnswer(),e=t[0],n=t[1];this.set({hourCurrent:e,hourDegree:this.getAngleFromHour(e,n),minuteCurrent:n,minuteDegree:this.getAngleFromMinute(n)}),this.set("removeCorrectness","no hands"),this.set({shouldAnswerDisplay:!0})},displayResult:function(){this.setCorrectness(),this.set("removeCorrectness","no hands"),this.unset("correctnessDetermined"),this.set("correctnessDetermined",!0)},enableInput:function(){this.set({staticMode:"not-static"})},disableInput:function(){this.set({staticMode:"static"})}}),Controller.InteractiveClockView=Controller.DomControlView.extend({initialize:function(t){this.listenTo(this.model,"change:hourDegree",this.renderHourHand),this.listenTo(this.model,"change:minuteDegree",this.renderMinuteHand),this.listenTo(this.model,"change:staticMode",this.renderStaticness),this.listenTo(this.model,"change:correctnessDetermined",this.renderCorrectAndIncorrect),this.listenTo(this.model,"change:shouldAnswerDisplay",this.renderAnswer),this.listenTo(this.model,"change:removeCorrectness",this.removeCorrectness),this.digitEdgeOffset=30,this.border=this.model.get("borderWidth"),this.width=this.model.get("w")-2*this.border,this.height=this.model.get("h")-2*this.border,Controller.DomControlView.prototype.initialize.apply(this,t)},events:{"mousedown .hand.hour .handle":"handleMouseDownHour","mousedown .hand.minute .handle":"handleMouseDownMinute",mouseup:"handleMouseUp",mousemove:"handleMouseMove"},renderCorrectAndIncorrect:function(){var t,e,n=this.model.get("correctness");t=n.hour?"correct":"incorrect",e=n.minute?"correct":"incorrect",this.$(".hand").removeClass("correct incorrect"),this.$(".hour.hand").addClass(t),this.$(".minute.hand").addClass(e)},removeCorrectness:function(){switch(this.model.get("removeCorrectness")){case"hour hand":this.$(".hour.hand").removeClass("correct incorrect");break;case"minute hand":this.$(".minute.hand").removeClass("correct incorrect");break;case"both hands":this.$(".hand").removeClass("correct incorrect");break;case"no hands":}},renderStaticness:function(){this.$(".handle").addClass(this.model.get("staticMode"))},renderAnswer:function(){this.$(".hand").removeClass("incorrect").addClass("correct")},renderHourHand:function(t,e){this.$(".hour.hand").css({transform:"rotateZ("+this.model.get("hourDegree")+"deg)"})},renderMinuteHand:function(t){this.$(".minute.hand").css({transform:"rotateZ("+this.model.get("minuteDegree")+"deg)"})},render:function(){Controller.DomControlView.prototype.render.apply(this);var t=this.model.get("minuteCurrent"),e=this.model.get("hourCurrent");this.renderHourHand(e,t),this.renderMinuteHand(t),this.renderStaticness(),this.$(".clock-face").css({width:this.width+"px",height:this.height+"px","border-radius":"50%",border:this.border+"px solid "+Controller.COLORS.charcoal,position:"relative"});for(var n,r,i=1;i<=12;i++)n=i/6*Math.PI,this.$(".digit-"+i).css({position:"absolute",left:this.width/2+Math.sin(n)*(this.width/2-this.digitEdgeOffset),top:this.height/2-Math.cos(n)*(this.height/2-this.digitEdgeOffset)});this.$(".tick").css({position:"absolute",width:.5*this.width/100+"px",height:2*this.height/100+"px"});for(var o,s,a,i=1;i<=60;i++)r=i/30*Math.PI,i%15===0?(o=Controller.COLORS.charcoal,a=2,s=10):i%5===0?(o=Controller.COLORS.charcoal,a=1,s=6):(o=Controller.COLORS.charcoal,a=.5,s=4),this.$(".tick-"+i+"-container").css({left:(this.width+Math.sin(r)*this.width)/2,top:(this.height-Math.cos(r)*this.height)/2}),this.$(".tick-"+i).css({transform:"rotateZ("+6*i+"deg) translate(-50%, -50%)",background:o,width:this.width*(a/100)+"px",height:this.height*(s/100)+"px"})},className:Controller.DomControlView.prototype.className+" interactive-clock text",makeNumbersTemplate:function(t){var e,n="";if(0!==t)for(var r=1;r<=t;r++)e=12/t*r,n+='<div class="digit-'+e+'"><div class="digit">'+e+"</div></div>";return n},makeTicksTemplate:function(){for(var t="",e=1;e<=60;e++)t+='<div class="tick-'+e+'-container tick-container"><div class="tick-'+e+' tick"></div></div>';return t},template:function(t){var e='<div class="clock-face control"><div class="clock-center"></div><div class="hour hand"><div class="the-hand-itself hand-component"></div><div class="handle hand-component sub-input"><div class="actual-handle"></div></div></div><div class="minute hand"><div class="the-hand-itself hand-component"></div><div class="handle hand-component sub-input"><div class="actual-handle"></div></div></div><div class="digits-container">'+this.makeNumbersTemplate(t.faceType)+'</div><div class="ticks-container">'+this.makeTicksTemplate()+"</div></div>";return _.template(e)(t)},handleMouseDownHour:function(t){this.model.handleMouseDownHour(t.elementX,t.elementY)},handleMouseDownMinute:function(t){this.model.handleMouseDownMinute(t.elementX,t.elementY)},handleMouseUp:function(t){this.model.handleMouseUp(t.elementX,t.elementY)},handleMouseMove:function(t){this.model.handleMouseMove(t.elementX,t.elementY)},disableInput:function(){this.$el.addClass("input-disabled"),this.delegateEvents(_.omit(this.events,[]))}}),Controller.HintBubbleModel=Controller.DomControlModel.extend({defaults:function(){return _.assign({},Controller.DomControlModel.prototype.defaults,{openFlag:!1,openCount:0,trackCallback:void 0,hintType:"standalone",hintBubbleIcon:"lightbulb",isVisible:!0})},initialize:function(){this.changeHintBubbleIcon()},changeHintBubbleIcon:function(){this.collection&&!_.isUndefined(this.collection.hintBubbleIcon)&&this.set({hintBubbleIcon:this.collection.hintBubbleIcon})},parse:function(t){function e(t,e){var n=e instanceof jQuery?void 0:150,r=_.isNumber(t)||_.isUndefined(t);return r?t||n:(console.error("[Hint Bubble] The given width ("+t+") is invalid. Widths should be numerical values. Defaulting to a width of "+n+"px."),n)}function n(t,e){var n=void 0,r=_.isNumber(t)||_.isUndefined(t);return r?t:(console.warn("[Hint Bubble] The given height ("+t+") is invalid. Heights should be numerical values. Defaulting to automatically calculated height."),
n)}function r(t){var e="up",n=_.isUndefined(t)||"up"===t||"down"===t||"right"===t||"left"===t;return n?t||e:(console.warn("[Hint Bubble] The given direction ("+t+") is invalid. Valid directions include up, right, down, left. Defaulting to "+e+"."),e)}function i(t){return _.isArray(t)?this.get("splitTestingSignature")%t.length:void 0}function o(t,e){function n(t,e){return _.isUndefined(e)?t:t[e]}var r=n(t,e);if(_.isString(r)){if(!/^#hint\d+$/.test(r))return Controller.TextBlockModel.prototype.formatText.bind(this)(r);var i=parseInt(r.substring(5))-1,o=this.collection.getHintTemplateAtIndex(i);if(o)return controls=new Controller.ControlsCollection(null,{}),controlsView=new Controller.ControlsView({collection:controls}),controls.reset(JSON.parse(o.toString()),{parse:!0}),controlsView.render(),controlsView.resize=function(){},controlsView.resetScaleDimensions=function(){},controlsView.$el.css({transform:"scale(1)"});Fidenti}return r}function s(){var t=this.get("splitTestingSignature"),e=["lightbulb","question-mark"],n=e[t%e.length];return n}return t.hintBubbleIcon=s.bind(this)(),t.contentIndex=i.bind(this)(t.value),t.content=o.bind(this)(t.value,t.contentIndex),t.bubbleWidth=t.bubbleWidth||e(t.w,t.content),t.bubbleHeight=t.bubbleHeight||n(t.h,t.content),t.direction=r(t.direction),delete t.w,delete t.h,Controller.DomControlModel.prototype.parse.call(this,t)},toggleHintBubble:function(){if(this.set("openFlag",!this.get("openFlag")),this.get("openFlag")){this.set({openCount:this.get("openCount")+1});var t=this.get("trackCallback");if(_.isFunction(t)){var e=this.getHintBubbleTrackingObject();t(e)}}},getHintBubbleTrackingObject:function(){var t=this.get("hintType"),e=this.get("contentIndex"),n=_.isUndefined(e)?0:e+1,r=this.get("identifier")||JSON.stringify({x:this.get("x"),y:this.get("y")});return{type:"HintBubble"+_.capitalize(t),identifier:r,icon:this.get("hintBubbleIcon"),contentNumber:n}},hasNoContent:function(){return _.isEmpty(this.get("content"))},disableInput:function(){}}),Controller.HintBubbleView=Controller.DomControlView.extend({className:Controller.DomControlView.prototype.className+" hint-bubble hint-bubble--main",template:_.template('<div class="trigger sub-input"></div><div class="bubble" data-direction="<%= direction %>" style="width:<%= bubbleWidth %>px;height:<%= bubbleHeight %>px"></div>'),events:{"mouseup .trigger":"toggleHintBubble"},toggleHintBubble:function(t,e){(!e||e&&!e.manipulative)&&this.model.toggleHintBubble()},initialize:function(){this.listenTo(this.model,"change:openFlag",this.updateOpenVisuals),this.listenTo(this.model,"change:isVisible",this.toggleVisibility),this.toggleVisibility(),Controller.DomControlView.prototype.initialize.apply(this)},render:function(){this.model.hasNoContent()?this.$el.empty():(Controller.DomControlView.prototype.render.apply(this),this.$(".bubble").html(this.model.get("content")),this.updateOpenVisuals())},updateOpenVisuals:function(){function t(){var t=this.$el.parent().find(".hint-bubble"),e=t.map(function(){return parseInt($(this).css("z-index"))}),n=_.maxBy(e);return n+1}if(this.model.get("openFlag"))this.$el.addClass("active").css("z-index",t.bind(this)()),this.$(".trigger").html('<i class="fa fa-close"></i>');else switch(this.$el.removeClass("active"),this.model.get("hintBubbleIcon")){case"question-mark":this.$(".trigger").html('<i class="fa fa-question"></i>');break;case"lightbulb":default:this.$(".trigger").html('<i class="fa fa-lightbulb-o"></i>')}},toggleVisibility:function(){this.$el.toggleClass("hint-bubble--is-hidden",!this.model.get("isVisible"))},getAbsoluteHeight:function(){return this.model.hasNoContent()?0:this.model.get("y")},getAbsoluteWidth:function(){return this.model.hasNoContent()?0:this.model.get("x")},_getLength:function(t){var e=20,n=this.model.get("direction"),r=this.$(".bubble").outerHeight(),i=this.$(".trigger").outerHeight(),o=this.$(".bubble").outerWidth(),s=this.$(".trigger").outerWidth();switch(n){case"up":case"down":switch(t){case"side":return.5*Math.max(s,o);case"bubble":return r+e+.5*i;case"trigger":return.5*i}case"right":case"left":switch(t){case"side":return.5*Math.max(i,r);case"bubble":return o+e+.5*s;case"trigger":return.5*s}}},getVerticalPadding:function(t){function e(){switch(o){case"up":return a("bubble");case"down":return a("trigger");case"right":case"left":return a("side")}}function n(){return s-t.offsetTop}function r(){switch(o){case"up":return a("trigger");case"down":return a("bubble");case"right":case"left":return a("side")}}function i(){return t.offsetTop+t.height-s}if(this.model.hasNoContent())return 0;if(!this.model.get("isVisible"))return 0;var o=this.model.get("direction"),s=this.$el.offset().top/t.scale,a=this._getLength.bind(this),l=e()-n(),h=r()-i();return _.maxBy([0,l,h])},getHorizontalPadding:function(t){function e(){switch(o){case"up":case"down":return a("side");case"right":return a("bubble");case"left":return a("trigger")}}function n(){return t.offsetLeft+t.width-s}function r(){switch(o){case"up":case"down":return a("side");case"right":return a("trigger");case"left":return a("bubble")}}function i(){return s-t.offsetLeft}if(this.model.hasNoContent())return 0;if(!this.model.get("isVisible"))return 0;var o=this.model.get("direction"),s=this.$el.offset().left/t.scale,a=this._getLength.bind(this),l=e()-n(),h=r()-i();return _.maxBy([0,l,h])}}),Controller.StudentErrorBubbleModel=Controller.HintBubbleModel.extend({initialize:function(){var t=this.get("attachedControl");return this.listenTo(t,"TextBox:focused",this.automaticallyShowStudentErrorBubbleOnce),Controller.HintBubbleModel.prototype.initialize.call(this)},automaticallyShowStudentErrorBubbleOnce:function(){this.get("openFlag")||0!==this.get("openCount")||this.toggleHintBubble()}}),Controller.StudentErrorBubbleView=Controller.HintBubbleView.extend({className:Controller.DomControlView.prototype.className+" hint-bubble hint-bubble--student-error"}),Controller.ImageSubtractionModel=Controller.DomControlModel.extend({defaults:{isManyImageSize:60,isManyImageColumnPadding:16,isManyImageRowPadding:22,isNotManyImageSize:44,isNotManyImageColumnPadding:14,isNotManyImageRowPadding:14,isNotManyAmountLimit:10},parse:function(t){var e=JSON.parse("["+t.value.replace(/'/g,'"')+"]");return t.imageType=e[0]||"monkey",t.amount=e[1]||0,t.numSubtracted=e[2]||0,t.numColumns=e[3]||1,Controller.DomControlModel.prototype.parse.call(this,t)},getProperties:function(){var t=this.get("amount"),e=t/this.get("numColumns")>=1?this.get("numColumns"):t,n=t>this.get("isNotManyAmountLimit");if(n)var r=this.get("isNotManyImageSize"),i=this.get("isNotManyImageColumnPadding"),o=this.get("isNotManyImageRowPadding");else var r=this.get("isManyImageSize"),i=this.get("isManyImageColumnPadding"),o=this.get("isManyImageRowPadding");for(;e*r+(e-1)*i>this.get("w");)e--;var s=e*r+(e-1)*i,a=Math.ceil(t/e),l=a*r+(a-1)*o;if(e<=0||l>this.get("h"))throw new Error("The control specified does not fit within the container size.");return{w:s,columnPadding:i,rowPadding:o,imageSize:r}},getImagePaths:function(t){var e=Controller.IMAGE_PATH+this.get("imageType").toLowerCase()+"-icon";if(e+=t?"-small.png":"-large.png",t)var n=Controller.IMAGE_PATH+"red-strike-small.png";else var n=Controller.IMAGE_PATH+"red-strike-large.png";return{icon:e,strike:n}}}),Controller.ImageSubtractionView=Controller.DomControlView.extend({template:function(t){for(var e=t.amount,n=t.numSubtracted,r=this.model.getImagePaths(e>this.model.get("isNotManyAmountLimit")),i='<div class="wrapper"><div class="inner-wrapper">',o=0;o<e;o++)i+='<div class="item">',o>=e-n&&(i+="<img src="+r.strike+">"),i+="</div>";return i+="</div></div>",_.template(i)(t)},render:function(){Controller.DomControlView.prototype.render.apply(this);var t=this.model.getProperties(),e=this.model.get("amount"),n=this.model.getImagePaths(e>this.model.get("isNotManyAmountLimit"));this.$(".wrapper").css({width:t.w+"px",height:this.model.get("h"),margin:"0 auto",display:"flex","align-items":"center","font-size":"0"}),this.$(".inner-wrapper").css({"margin-left":-t.columnPadding+"px","margin-bottom":-t.rowPadding+"px"}),this.$(".item").css({width:t.imageSize+"px",height:t.imageSize+"px",display:"inline-block","margin-left":t.columnPadding+"px","margin-bottom":t.rowPadding+"px","background-image":"url("+n.icon+")","background-size":"100% auto"}),this.$("img").css({display:"block",width:"100%"})}}),Controller.GridModel=Controller.DomControlModel.extend({INPUT_CONTROL_OPTIONS:{REVERSABLE:1,EXACT:2,ANY_MULTIPLE:3},defaults:{answerIndex:1,inputControl:1,selectedCoords:[],showRowColumnLabels:!1,showNumbersInChart:!1,highlightCorrect:!1,highlightIncorrect:!1},parse:function(t){if(t.value="["+t.value+"]",t.value=JSON.parse(t.value),2!==t.value.length)throw new Error("You need to specify showRowColumnLabels and showNumbersInChart options for grid");if(t.w!==t.h)throw new Error("The grid is a square and therefore requires width and height to be equal.");return t.showRowColumnLabels=!!t.value[0],t.showNumbersInChart=!!t.value[1],t},isValid:function(){return!!this.get("selectedCoords").length},isCorrect:function(t){var e=t[this.get("answerIndex")-1],n=this.get("selectedCoords");switch(this.get("inputControl")){case this.INPUT_CONTROL_OPTIONS.REVERSABLE:return this._isCorrectReverseable(n,e);case this.INPUT_CONTROL_OPTIONS.EXACT:return this._isCorrectExact(n,e);case this.INPUT_CONTROL_OPTIONS.ANY_MULTIPLE:return this._isCorrectAnyMultiple(n,e)}return!1},setInput:function(t){var e=this.get("answerIndex");this.set({selectedCoords:t[e-1]})},getInput:function(){return this.get("selectedCoords")},displayAnswer:function(t){this.setInput(t),this.set({highlightCorrect:!0,highlightIncorrect:!1})},displayResult:function(t){this.isCorrect(t)?this.set({highlightCorrect:!0}):this.set({highlightIncorrect:!0})},cellShouldBeActive:function(t,e){if(this.get("selectedCoords").length){var n=this.get("selectedCoords")[0],r=this.get("selectedCoords")[1];return t<=n&&e<=r}return!1},_isCorrectReverseable:function(t,e){return _.isEqual(t,e)||_.isEqual(t.slice(0).reverse(),e)},_isCorrectExact:function(t,e){return _.isEqual(t,e)},_isCorrectAnyMultiple:function(t,e){var n=t[0]*t[1],r=e[0]*e[1];return n===r}}),Controller.GridView=Controller.DomControlView.extend({BASE_WIDTH:400,initialize:function(t){var e=["selectedCoords","highlightCorrect","highlightIncorrect"].map(function(t){return t="change:"+t}).join(" ");this.listenTo(this.model,e,this.render),this.listenTo(this.model,"enable-input",this.handleEnableInput),this.listenTo(this.model,"disable-input",this.handleDisableInput),Controller.DomControlView.prototype.initialize.apply(this,t)},events:{"mousedown .control-grid__cell":"handleCellClick"},handleCellClick:function(t){var e=$(t.currentTarget),n=e.data("row"),r=e.data("col");this.model.set({selectedCoords:[n,r],highlightIncorrect:!1,highlightCorrect:!1})},handleDisableInput:function(){this.$el.append('<div class="control-grid__disabled"></div>')},handleEnableInput:function(){this.$(".control-grid__disabled").remove()},template:function(t){var e=$('<table class="control-grid"><tbody></tbody></table>');const n=this._getScalingFactor();if(n<50)throw new Error("You can't make a Grid that that is that small. It's too hard to interact with.");return e.css({width:this.model.get("w"),height:this.model.get("h"),fontSize:this._getScalingFactor()+"%"}),this.model.get("showRowColumnLabels")&&this._addHeaderToTable(e),this._addRowsToTable(e.find("tbody")),e},_getScalingFactor:function(){const t=this.model.get("showRowColumnLabels"),e=this.model.get("showNumbersInChart");return t||e?this.model.get("w")/this.BASE_WIDTH*100:100},_addHeaderToTable:function(t){for(var e=$("<thead><tr><th></th></tr></thead>"),n=1;n<=10;n++)e.find("tr").append("<th>"+n+"</th>");t.prepend(e)},_addRowsToTable:function(t){for(var e=1;e<=10;e++){var n=$("<tr></tr>");this.model.get("showRowColumnLabels")&&n.append("<th>"+e+"</th>"),n.append(this._addColumnsToRow(n,e)),t.append(n)}},_addColumnsToRow:function(t,e){for(var n=1;n<=10;n++){var r=$('<td class="control-grid__cell sub-input"></td>');this.model.get("showNumbersInChart")&&r.text(e*n),r.attr("data-row",e),r.attr("data-col",n),this._addOrRemoveCssClassesToCell(r,e,n),t.append(r)}},_addOrRemoveCssClassesToCell:function(t,e,n){this.model.cellShouldBeActive(e,n)&&(t.addClass("control-grid__cell--is-active"),this.model.get("highlightCorrect")?t.addClass("control-grid__cell--is-correct"):t.removeClass("control-grid__cell--is-correct"),this.model.get("highlightIncorrect")?t.addClass("control-grid__cell--is-incorrect"):t.removeClass("control-grid__cell--is-incorrect"))}}),Controller.PictographModel=function(){"use strict";return Controller.DomControlModel.extend({defaults:{numImagesPerRow:6},loadAssets:function(){var t=new FontFaceObserver("Roboto"),e=new FontFaceObserver("Roboto",{weight:"bold"}),n=new Promise(function(t,e){var n=new Image;n.onload=function(){t()},n.onerror=function(){n.src=Controller.IMAGE_PATH+"default.gif",e("Specified image for pictograph failed to load.")},n.src=this.get("imgSrc")}.bind(this));Promise.all([t.load(),e.load(),n]).then(function(){this.trigger("loaded-assets")}.bind(this))["catch"](function(t){throw this.trigger("loaded-assets"),t}.bind(this))},parse:function(t){var e=t.value;if(e){if(e=e.replace(/([^,\]\[]+)/g,function(t){return t=t.trim(),"''"===t.replace(/ /g,"")?'""':(t=t.substring(t.startsWith("'")?1:0,t.endsWith("'")?t.length-1:t.length),isNaN(t)&&"true"!==t&&"false"!==t?'"'+t+'"':t)}),e=JSON.parse("["+e+"]"),t.title=e[0]||"",_.isArray(e[1])){t.labelHeader="",t.amountHeader="";var n=2}else{t.labelHeader=e[1]||"",t.amountHeader=e[2]||"";var n=0}t.legend=e[3-n]||[],t.imgSrc=this._getImagePath(t.legend[0]),t.content=e[4-n]||[];for(var r=0;r<t.content.length/2;r++){var i=parseInt(t.legend[1]);if(t.content[2*r+1]=new Controller.Math.RationalNumber(t.content[2*r+1]).divide(i),t.content[2*r+1].toFloat()%.5!==0)throw new Error("The amount specified must be a half fraction or a whole.")}}return Controller.CanvasControlModel.prototype.parse.call(this,t)},_getImagePath:function(t){var e={pig:"pig-icon-small.png",cow:"cow-icon-small.png",lion:"lion-icon-small.png",monkey:"monkey-icon-small.png",owl:"owl-icon-small.png",coin:"generic-coin.png",smile:"YellowSmile.png"};return Controller.IMAGE_PATH+e[t.toLowerCase()]}})}(),Controller.PictographView=Controller.DomControlView.extend({template:function(t){var e=t.title,n=t.labelHeader,r=t.amountHeader,i=t.legend,o=t.imgSrc,s=t.content,a='<div class="pictograph"><div class="pictograph__inner"><table class="pictograph__inner__table">';a+='<tr><td colspan="2" class="pictograph__inner__table__title"><span>'+e+'</span></td></tr><tbody class="pictograph__inner__table__content">',n.length>0&&r.length>0&&(a+='<tr class="pictograph__inner__table__content__header"><td class="pictograph__inner__table__content__header__label"><span>'+n+'</span></td><td class="pictograph__inner__table__content__header__symbol"><span>'+r+"</span></td></tr>");for(var l=this.model.get("numImagesPerRow"),h=0;h<s.length/2;h++){var c=s[2*h],u=s[2*h+1].toFloat(),d=Math.ceil(u);a+='<tr class="pictograph__inner__table__content__row"><td class="pictograph__inner__table__content__row__label"><span>'+c+'</span></td><td class="pictograph__inner__table__content__row__symbol">';for(var p=0;p<d;p++)p%l===0&&(a+='<div class="pictograph__inner__table__content__row__symbol__group">'),a+=u-p>=1?'<div class="pictograph__inner__table__content__row__symbol__group__image pictograph__inner__table__content__row__symbol__group__image--whole"><img src='+o+"></div>":'<div class="pictograph__inner__table__content__row__symbol__group__image pictograph__inner__table__content__row__symbol__group__image--half"><img src='+o+"></div>",p%l!==l-1&&p!=d-1||(a+="</div>");a+="</td></tr>"}return a+='</tbody></tr></table><div class="pictograph__inner__key"><img class="pictograph__inner__key__symbol" src='+o+'><span class="pictograph__inner__key__symbol__text">= '+i[1]+"</span></div></div></div>",_.template(a)(t)},className:Controller.DomControlView.prototype.className+" pictograph",render:function(){Controller.DomControlView.prototype.render.apply(this),this.$(".pictograph").css({width:this.model.get("w")+"px",height:this.model.get("h")+"px"})},postRender:function(){var t=this.$(".pictograph__inner"),e=2;(t.outerWidth()>this.model.get("w")-e||t.outerHeight()>this.model.get("h")-e)&&console.error("The pictograph specified may not fit perfectly across all browsers.")}}),Controller.CanvasComponentModel=Backbone.Model.extend({defaults:{x:0,y:0,w:0,h:0},loadAssets:function(){this.trigger("loaded-assets")},distance:function(t,e){var n=this.get("x"),r=this.get("y"),i=n+this.get("w"),o=r+this.get("h");return t<n?e<r?Controller.Math.euclideanDistance(t,e,n,r):e>o?Controller.Math.euclideanDistance(t,e,n,o):Math.abs(n-t):t>i?e<r?Controller.Math.euclideanDistance(t,e,i,r):e>o?Controller.Math.euclideanDistance(t,e,i,o):Math.abs(t-i):e<r?Math.abs(r-e):e>o?Math.abs(e-o):0},translate:function(t,e){this.set({x:this.get("x")+t,y:this.get("y")+e})}}),Controller.CanvasComponentView=Backbone.View.extend({initialize:function(t){this.context=t.context},render:function(){if(this.context.save(),this.model.get("fillStyle")&&(this.context.globalAlpha=this.model.get("opacity"),this.context.fillStyle=this.model.get("fillStyle"),this.context.fill()),this.model.get("lineWidth")>0){switch(this.context.strokeStyle=this.model.get("strokeStyle"),this.context.lineWidth=this.model.get("lineWidth"),this.model.get("lineStyle")){case"dashed":this.context.setLineDash(this.model.get("lineStyleAttributes"));break;case"dotted":}this.context.stroke()}this.context.restore()}}),Controller.CanvasRectangleModel=Controller.CanvasComponentModel.extend({defaults:{strokeStyle:Controller.COLORS.charcoal,lineWidth:0,opacity:1}}),Controller.CanvasRectangleView=Controller.CanvasComponentView.extend({render:function(){this.context.beginPath();var t=this.model.get("lineWidth")?this.model.get("lineWidth")/2:0,e=this.model.get("x")+t,n=this.model.get("y")+t,r=this.model.get("w")-2*t,i=this.model.get("h")-2*t;this.context.rect(e,n,r,i),this.context.closePath(),Controller.CanvasComponentView.prototype.render.apply(this)}}),Controller.CanvasRoundedRectangleModel=Controller.CanvasComponentModel.extend({defaults:{lineWidth:0,opacity:1,cornerRadius:0,backgroundColor:Controller.COLORS.lightgrey,outlineColor:Controller.COLORS.charcoal}}),Controller.CanvasRoundedRectangleView=Controller.CanvasComponentView.extend({render:function(){this.context.beginPath();var t=this.model.get("lineWidth")?this.model.get("lineWidth")/2:0,e=this.model.get("x")+t,n=this.model.get("y")+t,r=this.model.get("w")-2*t,i=this.model.get("h")-2*t,o=this.model.get("cornerRadius");this.context.miterLimit=1,this.context.strokeStyle=this.model.get("outlineColor"),this.context.fillStyle=this.model.get("backgroundColor"),this.context.moveTo(e+o,n),this.context.lineTo(e+r-o,n),this.context.quadraticCurveTo(e+r,n,e+r,n+o),this.context.lineTo(e+r,n+i-o),this.context.quadraticCurveTo(e+r,n+i,e+r-o,n+i),this.context.lineTo(e+o,n+i),this.context.quadraticCurveTo(e,n+i,e,n+i-o),this.context.lineTo(e,n+o),this.context.quadraticCurveTo(e,n,e+o,n),this.context.fill(),this.context.closePath(),Controller.CanvasComponentView.prototype.render.apply(this)}}),Controller.CanvasImageModel=Controller.CanvasComponentModel.extend({loadAssets:function(){this.picture=new Image(this.get("w"),this.get("h")),this.picture.onload=function(){this.picture.onload=null,this.picture.onerror=null,this.trigger("loaded-assets")}.bind(this),this.picture.onerror=function(){console.warn("Image "+this.get("source")+" failed to load."),this.picture.onload=null,this.picture.onerror=null,this.picture.src=Controller.IMAGE_PATH+"default.gif",this.trigger("loaded-assets")}.bind(this),this.picture.src=this.get("source")},defaults:{angle:0,xTranslate:0,yTranlate:0}}),Controller.CanvasImageView=Controller.CanvasComponentView.extend({render:function(){this.context.save(),0!=this.model.get("angle")?(this.context.translate(this.model.picture.width/2,this.model.picture.height/2),this.context.rotate(this.model.get("angle")),this.context.drawImage(this.model.picture,-this.model.picture.width/2,-this.model.picture.height/2,this.model.get("w"),this.model.get("h"))):this.model.get("xTranslate")>0||this.model.get("yTranslate")>0?this.context.drawImage(this.model.picture,this.model.get("xTranslate"),this.model.get("yTranslate"),this.model.get("w"),this.model.get("h")):this.context.drawImage(this.model.picture,0,0,this.model.get("w"),this.model.get("h")),this.context.restore()}}),Controller.CanvasArrowModel=Controller.CanvasComponentModel.extend({parse:function(t){return t.xStart=t.xStart||0,t.yStart=t.yStart||0,t.xMid=void 0!==t.xMid?t.xMid:t.xStart,t.yMid=void 0!==t.yMid?t.yMid:t.yStart,t.xEnd=t.xEnd||0,t.yEnd=t.yEnd||0,Controller.CanvasComponentModel.prototype.parse.call(this,t)},defaults:{strokeStyle:Controller.COLORS.charcoal,lineWidth:1,arrowWidth:8}}),Controller.CanvasArrowView=Controller.CanvasComponentView.extend({render:function(){var t=this.model.get("xMid"),e=this.model.get("xEnd"),n=this.model.get("yMid"),r=this.model.get("yEnd"),i=Math.atan2(t-e,n-r)+Math.PI,o=this.model.get("arrowWidth");this.context.beginPath(),this.context.moveTo(this.model.get("xStart"),this.model.get("yStart")),this.context.quadraticCurveTo(t,n,e,r),this.context.moveTo(e-o*Math.sin(i-Math.PI/6),r-o*Math.cos(i-Math.PI/6)),this.context.lineTo(e,r),this.context.lineTo(e-o*Math.sin(i+Math.PI/6),r-o*Math.cos(i+Math.PI/6)),Controller.CanvasComponentView.prototype.render.apply(this)}}),Controller.CanvasLineModel=Controller.CanvasComponentModel.extend({defaults:{xStart:0,yStart:0,xEnd:20,yEnd:20,strokeStyle:Controller.COLORS.charcoal,lineWidth:1,lineStyle:"",lineStyleAttributes:""},distance:function(t,e){var n=this.get("xStart"),r=this.get("yStart"),i=this.get("xEnd"),o=this.get("yEnd"),s=Controller.Math.euclideanDistance(n,r,i,o);if(0===s)return Controller.Math.euclideanDistance(t,e,n,r);var a=((t-n)*(i-n)+(e-r)*(o-r))/s;return a<0?Controller.Math.euclideanDistance(t,e,n,r):a>1?Controller.Math.euclideanDistance(t,e,i,o):Controller.Math.euclideanDistance(t,e,n+a*(i-n),r+a*(o-r))}}),Controller.CanvasLineView=Controller.CanvasComponentView.extend({render:function(){this.context.save(),this.context.lineWidth=this.model.get("lineWidth"),this.context.strokeStyle=this.model.get("strokeStyle"),this.context.beginPath(),this.context.moveTo(this.model.get("xStart"),this.model.get("yStart")),this.context.lineTo(this.model.get("xEnd"),this.model.get("yEnd")),"dashed"===this.model.get("lineStyle")&&this.context.setLineDash(this.model.get("lineStyleAttributes")),this.context.stroke(),this.context.closePath(),this.context.restore()}}),Controller.CanvasTextModel=Controller.CanvasComponentModel.extend({defaults:{textColor:Controller.COLORS.charcoal,strokeStyle:Controller.COLORS.charcoal,textStyle:"normal",textSize:"16px",textFont:"monospacetypewriterregular, monospace",lineWidth:0,textAlign:"center",textBaseline:"middle",text:""}}),Controller.CanvasTextView=Controller.CanvasComponentView.extend({render:function(){this.context.fillStyle=this.model.get("textColor"),this.context.font=this.model.get("textStyle")+" "+this.model.get("textSize")+" "+this.model.get("textFont"),this.context.textAlign=this.model.get("textAlign"),this.context.textBaseline=this.model.get("textBaseline"),this.context.strokeStyle=this.model.get("strokeStyle"),this.context.lineWidth=this.model.get("lineWidth"),this.context.lineJoin="miter",this.context.miterLimit=2;var t=this.model.get("text"),e=parseFloat(this.model.get("textSize")),n=this.model.get("lineWidth"),r=n>0,i=this.model.get("x"),o=this.model.get("y");if(t instanceof Controller.Math.RationalNumber){var s=t.copy(),a=this.model.get("fractionOptions");"decimal"===a.format?s=a.signed&&!s.isNegative?"+"+s.toFloat():s.toFloat():(s.convert(a),0!==s.numerator&&1!==s.denominator||("mixed"===a.format||a.reduced)&&(s.convert({format:"mixed"}),s=s.isNegative?-s.coefficient:a.signed?"+"+s.coefficient:s.coefficient)),t=s}if(this.context.save(),this.model.get("angle")&&(this.context.translate(i,o),this.context.rotate(this.model.get("angle")),i=0,o=0),t instanceof Controller.Math.RationalNumber){var l,h,s=t;switch(s.coefficient=s.coefficient||"",s.isNegative?s.coefficient="-"+s.coefficient:this.model.get("fractionOptions").signed&&(s.coefficient="+"+s.coefficient),l=this.context.measureText(s.coefficient).width,s.coefficient&&(l+=n+1),h=Math.max(this.context.measureText(s.numerator).width,this.context.measureText(s.denominator).width),this.context.textAlign){case"center":i-=(l+h)/2;break;case"right":i-=l+h}this.context.textAlign="left";var c=Math.max(Math.floor(e/10),1);switch(this.context.textBaseline){case"top":o+=(e+2+c+n)/2,r&&this.context.strokeText(s.coefficient,i,o-.5),this.context.fillText(s.coefficient,i,o),o+=.5*e;break;case"bottom":o-=(e+2+c+n)/2,r&&this.context.strokeText(s.coefficient,i,o-.5),this.context.fillText(s.coefficient,i,o),o-=.5*e;break;default:r&&this.context.strokeText(s.coefficient,i,o-.5),this.context.fillText(s.coefficient,i,o)}this.context.textAlign="center",this.context.textBaseline="middle",i+=l,this.context.beginPath(),this.context.rect(i,o-c/2,h,c),r&&this.context.stroke(),this.context.fill(),i+=h/2,r&&this.context.strokeText(s.numerator,i,o-(e+c+n)/2),this.context.fillText(s.numerator,i,o-(e+c+n)/2+.5),r&&this.context.strokeText(s.denominator,i,o+(e+c+n)/2+.5),this.context.fillText(s.denominator,i,o+(e+2+c+n)/2)}else r&&this.context.strokeText(t,i,o),this.context.fillText(t,i,o);this.context.restore()}}),Controller.CanvasTriangleModel=Controller.CanvasComponentModel.extend({defaults:{strokeStyle:Controller.COLORS.charcoal,lineWidth:1}}),Controller.CanvasTriangleView=Controller.CanvasComponentView.extend({render:function(){this.context.beginPath(),this.context.moveTo(this.model.get("x1"),this.model.get("y1")),this.context.lineTo(this.model.get("x2"),this.model.get("y2")),this.context.lineTo(this.model.get("x3"),this.model.get("y3")),this.context.closePath(),Controller.CanvasComponentView.prototype.render.apply(this)}}),Controller.CanvasCircleModel=Controller.CanvasComponentModel.extend({defaults:{strokeStyle:Controller.COLORS.charcoal,lineWidth:0,x:0,y:0,r:3,startAngle:0,endAngle:2*Math.PI,centreLine:!1,stroke:!1},distance:function(t,e){return Math.max(Controller.Math.euclideanDistance(t,e,this.get("x"),this.get("y"))-this.get("r"),0)}}),Controller.CanvasCircleView=Controller.CanvasComponentView.extend({render:function(){this.context.beginPath(),this.context.arc(this.model.get("x"),this.model.get("y"),this.model.get("r"),this.model.get("startAngle"),this.model.get("endAngle")),this.model.get("centreLine")&&(this.context.lineTo(this.model.get("x"),this.model.get("y")),this.context.closePath(),this.context.fillStyle=this.model.get("fillStyle"),this.context.fill()),this.model.get("stroke")&&(this.context.lineWidth=this.model.get("lineWidth"),this.context.strokeStyle=this.model.get("strokeStyle"),this.context.stroke()),Controller.CanvasComponentView.prototype.render.apply(this)}}),Controller.CanvasShapeModel=Controller.CanvasComponentModel.extend({defaults:{lineWidth:0,fillStyle:Controller.COLORS.charcoal,coordinates:[[0,0],[0,0]],strokeStyle:Controller.COLORS.charcoal,angle:0,bgTransparency:1}}),Controller.CanvasShapeView=Controller.CanvasComponentView.extend({render:function(){var t=this.model.get("coordinates");this.context.beginPath(),this.model.get("bgTransparency")<1&&(this.context.globalAlpha=this.model.get("bgTransparency"));for(var e in t)this.context.lineTo(t[e][0],t[e][1]);this.context.closePath(),this.context.lineWidth=this.model.get("lineWidth"),this.context.fillStyle=this.model.get("fillStyle"),this.context.fill(),Controller.CanvasComponentView.prototype.render.apply(this),this.model.get("bgTransparency")<1&&(this.context.globalAlpha=1)}}),Controller.CanvasGridModel=Controller.CanvasComponentModel.extend({defaults:{strokeStyle:Controller.COLORS.charcoal,lineWidth:1,numRows:0,numColumns:0,displayBorder:!0,borderStrokeStyle:Controller.COLORS.red},getCanvasCoords:function(t){var e=this.get("numColumns"),n=this.get("numRows"),r=this.get("x"),i=this.get("y"),o=this.get("w"),s=this.get("h"),a=o/e,l=s/n,h=t.gridCoord%1;if(1===t.quadrants){var c=r,u=i+s;return t.gridCoord=Math.floor(t.gridCoord),{x:c+(t.gridCoord-t.xStart)/t.labelIncrement*t.gridIncrement*a+t.gridIncrement/t.labelIncrement*h*a,y:u-(t.gridCoord-t.yStart)/t.labelIncrement*t.gridIncrement*l-t.gridIncrement/t.labelIncrement*h*l}}if(4===t.quadrants){var c=r+o/2,u=i+s/2;if(t.gridCoord>=0)return t.gridCoord=Math.floor(t.gridCoord),{x:c+(t.gridCoord-t.xStart)/t.labelIncrement*t.gridIncrement*a+t.gridIncrement/t.labelIncrement*h*a,y:u-(t.gridCoord-t.yStart)/t.labelIncrement*t.gridIncrement*l-t.gridIncrement/t.labelIncrement*h*l};if(t.gridCoord<0)return t.gridCoord=Math.ceil(t.gridCoord),{x:c+(t.gridCoord+t.xStart)/t.labelIncrement*t.gridIncrement*a+t.gridIncrement/t.labelIncrement*h*a,y:u-(t.gridCoord+t.yStart)/t.labelIncrement*t.gridIncrement*l-t.gridIncrement/t.labelIncrement*h*l}}},getGridCoords:function(t){var e=t.canvasCoord,n=t.xOrigin,r=t.yOrigin,i=t.boxWidthHeight,o=t.boxWidthHeight;return{x:(e.x-n)/i,y:(r-e.y)/o}},getGridIntersection:function(t,e){t-=this.get("x"),e-=this.get("y");var n=this.get("w")/this.get("numColumns"),r=this.get("h")/this.get("numRows"),i=Math.min(this.get("numColumns"),Math.max(0,Math.round(t/n))),o=Math.min(this.get("numRows"),Math.max(0,Math.round(e/r)));return{columnIndex:i,rowIndex:o}},getIntersectingGraphCoord:function(t,e){var n=new Controller.Math.RationalNumber(this.get("xMin")),r=new Controller.Math.RationalNumber(this.get("yMin")),i=new Controller.Math.RationalNumber(this.get("xIncrement")),o=new Controller.Math.RationalNumber(this.get("yIncrement")),s=this.getGridIntersection(t,e);return{x:n.add(i.multiply(s.columnIndex)),y:r.add(o.multiply(this.get("numRows")-s.rowIndex))}},getIntersectingCanvasCoord:function(t,e){var n=this.get("w")/this.get("numColumns"),r=this.get("h")/this.get("numRows"),i=this.getGridIntersection(t,e);return{x:this.get("x")+n*i.columnIndex,y:this.get("y")+r*i.rowIndex}},getInputCanvasCoord:function(t,e){var n=this.get("w")/this.get("numColumns"),r=this.get("h")/this.get("numRows"),t=new Controller.Math.RationalNumber(t),e=new Controller.Math.RationalNumber(e),i=this.get("xIncrement"),o=this.get("yIncrement"),s=this.get("xMin"),a=this.get("yMin"),l=this.get("numRows");return{x:this.get("x")+t.subtract(s).divide(i).multiply(n).toFloat(),y:this.get("y")-e.subtract(a).divide(o).subtract(l).multiply(r).toFloat()}},getInputCellCanvasCoord:function(t){var e=this.get("numColumns"),n=this.get("w")/e,r=this.get("h")/this.get("numRows");return{x:this.get("x")+(t-1)%e*n,y:this.get("y")+Math.floor((t-1)/e)*r}},getCellDimensions:function(){return{w:this.get("w")/this.get("numColumns"),h:this.get("h")/this.get("numRows")}},getInputCellCenterCanvasCoord:function(t){var e=this.get("lineWidth"),n=this.get("w"),r=(n-(this.get("numColumns")+1)*e)/this.get("numColumns"),i=this.get("h"),o=(i-(this.get("numRows")+1)*e)/this.get("numRows");return{x:this.get("x")+e+r/2+(t-1)%this.get("numColumns")*(e+r),y:this.get("y")+e+o/2+Math.floor((t-1)/this.get("numColumns"))*(e+o)}}}),Controller.CanvasGridView=Controller.CanvasComponentView.extend({render:function(){if(this.model.get("numRows")&&this.model.get("numColumns")){this.context.beginPath();var t=this.model.get("lineWidth")?this.model.get("lineWidth")/2:0,e=this.model.get("x")+t,n=this.model.get("y")+t,r=this.model.get("w")-2*t,i=this.model.get("h")-2*t,o=this.model.get("borderLineWidth"),s=this.model.get("fillStyle"),a=this.model.get("lineWidth");o&&(this.model.unset("lineWidth"),this.model.set({fillStyle:this.model.get("borderStrokeStyle")}),this.context.beginPath(),this.context.rect(e-o,n-o,r+2*o,i+2*o),this.context.closePath(),Controller.CanvasComponentView.prototype.render.apply(this),
this.model.unset("fillStyle"),this.model.set({lineWidth:a})),this.model.get("displayBorder")&&(this.model.set({fillStyle:s}),this.context.beginPath(),this.context.rect(e,n,r,i),this.context.closePath(),Controller.CanvasComponentView.prototype.render.apply(this));for(var l=i/this.model.get("numRows"),h=1;h<this.model.get("numRows");h++)this.context.moveTo(e,n+h*l),this.context.lineTo(e+r,n+h*l);for(var c=r/this.model.get("numColumns"),h=1;h<this.model.get("numColumns");h++)this.context.moveTo(e+h*c,n),this.context.lineTo(e+h*c,n+i);this.model.set({fillStyle:this.model.get("fillStyle")}),Controller.CanvasComponentView.prototype.render.apply(this)}}}),Controller.CanvasCylinderModel=Controller.CanvasComponentModel.extend({defaults:{strokeStyle:Controller.COLORS.charcoal,color:Controller.COLORS.red,lineWidth:1,x:100,y:50,d:100,h:200,rotation:0,sizeID:1}}),Controller.CanvasCylinderView=Controller.CanvasComponentView.extend({render:function(){var t=this.model.get("x"),e=this.model.get("y"),n=this.model.get("d"),r=this.model.get("h"),i=n/5;if(this.model.get("color")===Controller.COLORS.red){var o=this.context.createLinearGradient(t,e,t,e+n);o.addColorStop(0,Controller.COLORS.darkred),o.addColorStop(.4,Controller.COLORS.pink),o.addColorStop(.5,Controller.COLORS.pink),o.addColorStop(.6,Controller.COLORS.pink),o.addColorStop(1,Controller.COLORS.darkred);var s=Controller.COLORS.red}if(this.model.get("color")===Controller.COLORS.blue){var o=this.context.createLinearGradient(t,e,t,e+n);o.addColorStop(0,Controller.COLORS.darkblue),o.addColorStop(.4,Controller.COLORS.lightblue),o.addColorStop(.5,Controller.COLORS.lightblue),o.addColorStop(.6,Controller.COLORS.lightblue),o.addColorStop(1,Controller.COLORS.darkblue);var s=Controller.COLORS.blue}if(this.model.get("color")===Controller.COLORS.green){var o=this.context.createLinearGradient(t,e,t,e+n);o.addColorStop(0,Controller.COLORS.darkgreen),o.addColorStop(.4,Controller.COLORS.lightgreen),o.addColorStop(.5,Controller.COLORS.lightgreen),o.addColorStop(.6,Controller.COLORS.lightgreen),o.addColorStop(1,Controller.COLORS.darkgreen);var s=Controller.COLORS.green}if(this.model.get("color")===Controller.COLORS.orange){var o=this.context.createLinearGradient(t,e,t,e+n);o.addColorStop(0,"#FF9900"),o.addColorStop(.4,Controller.COLORS.lightorange),o.addColorStop(.5,Controller.COLORS.lightorange),o.addColorStop(.6,Controller.COLORS.lightorange),o.addColorStop(1,"#FF9900");var s=Controller.COLORS.orange}1===this.model.get("rotation")&&(this.context.moveTo(0,0),this.context.save(),this.context.translate(this.model.get("containerW")/2,this.model.get("containerH")/2),this.context.rotate(90*Math.PI/180),this.context.translate(-this.model.get("containerH")/2,-this.model.get("containerW")/2)),2===this.model.get("rotation")&&(this.context.moveTo(0,0),this.context.save(),this.context.translate(t+r/2,e+n/2),this.context.rotate(180*Math.PI/180),this.context.translate(-(t+r/2),-(e+n/2))),3===this.model.get("rotation")&&(this.context.moveTo(0,0),this.context.save(),this.context.translate(this.model.get("containerW")/2,this.model.get("containerH")/2),this.context.rotate(270*Math.PI/180),this.context.translate(-this.model.get("containerH")/2,-this.model.get("containerW")/2)),this.context.beginPath(),this.context.moveTo(t,e),this.context.lineTo(t+r,e);for(var a,l=0,h=t+r,c=e+n/2,u=n/2,d=i,p=0,f=-Math.PI/2;f<Math.PI/2;f+=.1)a=h-u*Math.sin(f)*Math.sin(p*Math.PI)+d*Math.cos(f)*Math.cos(p*Math.PI),l=c+d*Math.cos(f)*Math.sin(p*Math.PI)+u*Math.sin(f)*Math.cos(p*Math.PI),0===f?this.context.moveTo(a,l):this.context.lineTo(a,l);this.context.lineTo(t,e+n),this.context.moveTo(t,e);for(var a,l=0,h=t,c=e+n/2,u=n/2,d=i,p=0,f=-Math.PI/2;f<Math.PI/2;f+=.1)a=h-u*Math.sin(f)*Math.sin(p*Math.PI)+d*Math.cos(f)*Math.cos(p*Math.PI),l=c+d*Math.cos(f)*Math.sin(p*Math.PI)+u*Math.sin(f)*Math.cos(p*Math.PI),f===-Math.PI/2?this.context.moveTo(a,l):this.context.lineTo(a,l);this.context.closePath(),this.model.set({fillStyle:o}),Controller.CanvasComponentView.prototype.render.apply(this),this.context.beginPath(),this.context.moveTo(t,e);for(var a,l=0,h=t,c=e+n/2,u=n/2,d=i,p=0,f=0;f<2*Math.PI;f+=.1)a=h-u*Math.sin(f)*Math.sin(p*Math.PI)+d*Math.cos(f)*Math.cos(p*Math.PI),l=c+d*Math.cos(f)*Math.sin(p*Math.PI)+u*Math.sin(f)*Math.cos(p*Math.PI),0===f?this.context.moveTo(a,l):this.context.lineTo(a,l);this.context.closePath(),this.model.set({fillStyle:s}),Controller.CanvasComponentView.prototype.render.apply(this),this.context.beginPath(),this.context.moveTo(t+r,e+n);for(var a,l=0,h=t+r,c=e+n/2,u=n/2,d=i,p=0,f=Math.PI/2;f<3*Math.PI/2;f+=.1)a=h-u*Math.sin(f)*Math.sin(p*Math.PI)+d*Math.cos(f)*Math.cos(p*Math.PI),l=c+d*Math.cos(f)*Math.sin(p*Math.PI)+u*Math.sin(f)*Math.cos(p*Math.PI),f===Math.PI/2?this.context.moveTo(a,l):this.context.lineTo(a,l);this.context.moveTo(t+r,e),this.context.closePath(),this.model.set({lineStyle:"dashed"}),this.model.set({lineStyleAttributes:[n/20,n/10]}),this.model.unset("fillStyle"),Controller.CanvasComponentView.prototype.render.apply(this),this.context.restore(),this.model.unset("lineStyle"),this.model.unset("lineStyleAttributes"),this.context.restore()}}),Controller.CanvasCylinderNetModel=Controller.CanvasComponentModel.extend({defaults:{strokeStyle:Controller.COLORS.charcoal,color:"",lineWidth:1,xStart:100,yStart:75,d:50,h:25,rotation:0,sizeID:1,orientation:0}}),Controller.CanvasCylinderNetView=Controller.CanvasComponentView.extend({render:function(){var t=this.model.get("xStart"),e=this.model.get("yStart"),n=this.model.get("d"),r=this.model.get("h"),i=this.model.get("color"),o=Math.PI*n,s=this.model.get("orientation");1!==this.model.get("rotation")&&3!==this.model.get("rotation")||(this.context.moveTo(0,0),this.context.save(),this.context.translate(this.model.get("containerW")/2,this.model.get("containerH")/2),this.context.rotate(90*Math.PI/180),this.context.translate(-this.model.get("containerH")/2,-this.model.get("containerW")/2)),this.context.beginPath(),this.context.moveTo(t,e),this.context.lineTo(t+r,e),this.context.lineTo(t+r,e+o),this.context.lineTo(t,e+o),this.context.lineTo(t,e),this.model.set({fillStyle:i}),Controller.CanvasComponentView.prototype.render.apply(this),s?(this.context.beginPath(),this.context.arc(t+r+n/2,e+o/2,n/2,0,2*Math.PI),Controller.CanvasComponentView.prototype.render.apply(this),this.context.beginPath(),this.context.arc(t-n/2,e+o/2,n/2,0,2*Math.PI),Controller.CanvasComponentView.prototype.render.apply(this)):(this.context.beginPath(),this.context.arc(t+r+n/2,e+n/2,n/2,0,2*Math.PI),Controller.CanvasComponentView.prototype.render.apply(this),this.context.beginPath(),this.context.arc(t-n/2,e+o-n/2,n/2,0,2*Math.PI),Controller.CanvasComponentView.prototype.render.apply(this)),this.model.unset("fillStyle")}}),Controller.CanvasFractionModel=Controller.CanvasComponentModel.extend({defaults:{textColor:Controller.COLORS.white,strokeStyle:Controller.COLORS.charcoal,lineWidth:1,denominator:1,containerWidth:240,showText:1,h:40},parse:function(t){var e=t.containerWidth||this.defaults.containerWidth;switch(t.w=e/Math.max(t.denominator,1),t.h=40,t.denominator){case 1:t.fillStyle=Controller.COLORS.lightnavy;break;case 2:t.fillStyle=Controller.COLORS.darkblue;break;case 3:t.fillStyle=Controller.COLORS.teal;break;case 4:t.fillStyle=Controller.COLORS.darkgreen;break;case 5:t.fillStyle=Controller.COLORS.lightbrown;break;case 6:t.fillStyle=Controller.COLORS.orange;break;case 8:t.fillStyle=Controller.COLORS.pink;break;case 10:t.fillStyle=Controller.COLORS.lightred;break;case 12:t.fillStyle=Controller.COLORS.darkpurple}return Controller.CanvasComponentModel.prototype.parse.call(this,t)}}),Controller.CanvasFractionView=Controller.CanvasComponentView.extend({render:function(){this.context.beginPath(),this.context.rect(this.model.get("x"),this.model.get("y"),this.model.get("w"),this.model.get("h")-1),this.context.closePath(),Controller.CanvasComponentView.prototype.render.apply(this),this.context.fillStyle=this.model.get("textColor"),this.context.font="bold 18px monospace",this.context.textAlign="center",this.context.textBaseline="middle",this.context.strokeStyle=this.model.get("strokeStyle"),this.model.get("showText")&&(this.context.fillText(1,this.model.get("x")+this.model.get("w")/2,this.model.get("y")+.26*this.model.get("h")),this.context.fillText("_",this.model.get("x")+this.model.get("w")/2,this.model.get("y")+.26*this.model.get("h")),this.context.fillText(this.model.get("denominator"),this.model.get("x")+this.model.get("w")/2,this.model.get("y")+.7*this.model.get("h")))}}),Controller.CanvasFractionContainerModel=Controller.CanvasComponentModel.extend({defaults:{strokeStyle:Controller.COLORS.black,lineWidth:5,x:0,y:0,w:250,h:41}}),Controller.CanvasTextBoxModel=Controller.CanvasComponentModel.extend({defaults:{w:30,h:30,answerIndex:1,textAlign:"center",textBaseline:"middle",text:"",readOnly:0,leadingTrailingFont:"monospacetypewriterregular",backgroundColor:Controller.COLORS.white},addTextBox:function(){if(!this.get("rendered")){var t=this.get("canvasControl").get("x")+this.get("x"),e=this.get("canvasControl").get("y")+this.get("y"),n=this.get("w");switch(this.get("textAlign")){case"center":t-=n/2;break;case"right":t-=n}switch(this.get("textBaseline")){case"middle":e-=this.get("h")/2;break;case"bottom":e-=this.get("h")}this.collection.controls.add({type:"textBox",x:t,y:e,w:n,h:this.get("h"),value:"",align:1,answerIndex:this.get("answerIndex"),answerSubIndex:this.get("answerSubIndex")}),this.set({rendered:!0})}}}),Controller.CanvasTextBoxView=Controller.CanvasComponentView.extend({render:function(){if(this.model.get("readOnly")){var t=this.model.get("x"),e=this.model.get("y"),n=this.model.get("w"),r=this.model.get("h"),i=this.model.get("text"),o=5;this.context.beginPath(),this.context.moveTo(t-n/2,e),this.context.lineTo(t-n/2,e-r/2+o),this.context.arcTo(t-n/2,e-r/2,t-n/2+o,e-r/2,o),this.context.lineTo(t+n/2-o,e-r/2),this.context.arcTo(t+n/2,e-r/2,t+n/2,e-r/2+o,o),this.context.lineTo(t+n/2,e+r/2-5),this.context.arcTo(t+n/2,e+r/2,t+n/2-o,e+r/2,o),this.context.lineTo(t-n/2+o,e+r/2),this.context.arcTo(t-n/2,e+r/2,t-n/2,e+r/2-o,o),this.context.lineTo(t-n/2,e),this.model.set({fillStyle:this.model.get("backgroundColor")}),Controller.CanvasComponentView.prototype.render.apply(this),this.context.font="14px Roboto",this.context.lineJoin="miter",this.context.miterLimit=2,this.context.textAlign="center",this.context.textBaseline="middle",this.context.strokeStyle=this.model.get("strokeStyle"),this.context.fillStyle=this.model.get("fillStyle"),this.context.lineWidth=4,this.context.strokeText(i,t,e),this.context.fillText(i,t,e)}else if(this.context.font="18px monospacetypewriterregular, monospace",this.model.set({w:Math.max(this.model.get("w"),Math.ceil(this.context.measureText(this.model.get("text")).width)+2)}),this.model.addTextBox(),this.model.get("leadingText")||this.model.get("trailingText")){if(this.model.get("leadingText")){var t=this.model.get("x"),e=this.model.get("y"),n=this.model.get("w"),r=this.model.get("h");switch(this.model.get("textAlign")){case"center":t-=n/2;break;case"right":t-=n}switch(this.model.get("textBaseline")){case"left":e+=r/2;break;case"bottom":e-=r/2}t-=2,this.context.font=this.model.get("textSize")+" "+this.model.get("leadingTrailingFont"),this.context.fillStyle=this.model.get("textColor"),this.context.strokeStyle=this.model.get("strokeStyle"),this.context.lineWidth=this.model.get("lineWidth"),this.context.textAlign="right",this.context.textBaseline="middle",this.context.lineWidth&&this.context.strokeText(this.model.get("leadingText"),t,e),this.context.fillText(this.model.get("leadingText"),t,e)}if(this.model.get("trailingText")){var t=this.model.get("x"),e=this.model.get("y"),n=this.model.get("w"),r=this.model.get("h");switch(this.model.get("textAlign")){case"center":t+=n/2;break;case"left":t+=n}switch(this.model.get("textBaseline")){case"left":e+=r/2;break;case"bottom":e-=r/2}t+=2,this.context.font=this.model.get("textSize")+" "+this.model.get("leadingTrailingFont"),this.context.fillStyle=this.model.get("textColor"),this.context.strokeStyle=this.model.get("strokeStyle"),this.context.lineWidth=this.model.get("lineWidth"),this.context.textAlign="left",this.context.textBaseline="middle",this.context.lineWidth&&this.context.strokeText(this.model.get("trailingText"),t,e),this.context.fillText(this.model.get("trailingText"),t,e)}}}}),Controller.CanvasSphereModel=Controller.CanvasComponentModel.extend({defaults:{strokeStyle:Controller.COLORS.charcoal,color:Controller.COLORS.red,lineWidth:1,xCenter:250,yCenter:150,diameter:200,sizeID:1}}),Controller.CanvasSphereView=Controller.CanvasComponentView.extend({render:function(){this.context.beginPath();var t;t=this.context.createRadialGradient(this.model.get("xCenter")-this.model.get("diameter")/4,this.model.get("yCenter")-this.model.get("diameter")/4,1,this.model.get("xCenter")-this.model.get("diameter")/4,this.model.get("yCenter")-this.model.get("diameter")/4,this.model.get("diameter")/2),this.model.get("color")===Controller.COLORS.red&&(t.addColorStop(0,Controller.COLORS.pink),t.addColorStop(1,Controller.COLORS.darkred)),this.model.get("color")===Controller.COLORS.blue&&(t.addColorStop(0,Controller.COLORS.lightblue),t.addColorStop(1,Controller.COLORS.darkblue)),this.model.get("color")===Controller.COLORS.green&&(t.addColorStop(0,Controller.COLORS.lightgreen),t.addColorStop(1,Controller.COLORS.darkgreen)),this.model.get("color")===Controller.COLORS.orange&&(t.addColorStop(0,Controller.COLORS.lightorange),t.addColorStop(1,"#FF9900")),this.context.arc(this.model.get("xCenter"),this.model.get("yCenter"),this.model.get("diameter")/2,0,2*Math.PI),this.context.fillStyle=t,this.context.fill(),this.context.closePath(),Controller.CanvasComponentView.prototype.render.apply(this)}}),Controller.CanvasConeModel=Controller.CanvasComponentModel.extend({defaults:{strokeStyle:Controller.COLORS.charcoal,color:Controller.COLORS.red,lineWidth:1,x:100,y:50,d:100,h:200,rotation:0,sizeID:1}}),Controller.CanvasConeView=Controller.CanvasComponentView.extend({render:function(){var t,e=this.model.get("x"),n=this.model.get("y"),r=this.model.get("d"),i=this.model.get("h"),o=r/15;this.model.get("color")===Controller.COLORS.red&&(t=this.context.createLinearGradient(e-r/2,n,e+r/2,n),t.addColorStop(0,Controller.COLORS.darkred),t.addColorStop(.5,Controller.COLORS.pink),t.addColorStop(1,Controller.COLORS.darkred)),this.model.get("color")===Controller.COLORS.blue&&(t=this.context.createLinearGradient(e-r/2,n,e+r/2,n),t.addColorStop(0,Controller.COLORS.darkblue),t.addColorStop(.5,Controller.COLORS.lightblue),t.addColorStop(1,Controller.COLORS.darkblue)),this.model.get("color")===Controller.COLORS.green&&(t=this.context.createLinearGradient(e-r/2,n,e+r/2,n),t.addColorStop(0,Controller.COLORS.darkgreen),t.addColorStop(.5,Controller.COLORS.lightgreen),t.addColorStop(1,Controller.COLORS.darkgreen)),this.model.get("color")===Controller.COLORS.orange&&(t=this.context.createLinearGradient(e-r/2,n,e+r/2,n),t.addColorStop(0,"#FF9900"),t.addColorStop(.5,Controller.COLORS.lightorange),t.addColorStop(1,"#FF9900")),1===this.model.get("rotation")&&(this.context.moveTo(0,0),this.context.save(),this.context.translate(this.model.get("containerW")/2,this.model.get("containerH")/2),this.context.rotate(90*Math.PI/180),this.context.translate(-this.model.get("containerH")/2,-this.model.get("containerW")/2)),2===this.model.get("rotation")&&(this.context.moveTo(0,0),this.context.save(),this.context.translate(this.model.get("containerW")/2,this.model.get("containerH")/2),this.context.rotate(180*Math.PI/180),this.context.translate(-this.model.get("containerW")/2,-this.model.get("containerH")/2)),3===this.model.get("rotation")&&(this.context.moveTo(0,0),this.context.save(),this.context.translate(this.model.get("containerW")/2,this.model.get("containerH")/2),this.context.rotate(270*Math.PI/180),this.context.translate(-this.model.get("containerH")/2,-this.model.get("containerW")/2)),this.context.beginPath(),this.context.moveTo(e,n),this.context.lineTo(e+r/2,n+i);for(var s=e,a=n+i,l=r/2,h=o,c=0,u=0,d=0,p=0;p<Math.PI;p+=.1)u=s-h*Math.sin(p)*Math.sin(c*Math.PI)+l*Math.cos(p)*Math.cos(c*Math.PI),d=a+l*Math.cos(p)*Math.sin(c*Math.PI)+h*Math.sin(p)*Math.cos(c*Math.PI),0===p?this.context.moveTo(u,d):this.context.lineTo(u,d);this.context.lineTo(e,n),this.context.closePath(),this.model.set({fillStyle:t}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("fillStyle"),this.context.beginPath(),this.context.moveTo(e+r/2,n+i);for(var s=e,a=n+i+2,l=r/2,h=o,c=0,u=0,d=0,p=Math.PI+.2;p<2*Math.PI-.2;p+=.1)u=s-h*Math.sin(p)*Math.sin(c*Math.PI)+l*Math.cos(p)*Math.cos(c*Math.PI),d=a+l*Math.cos(p)*Math.sin(c*Math.PI)+h*Math.sin(p)*Math.cos(c*Math.PI),p===Math.PI+.2?this.context.moveTo(u,d):this.context.lineTo(u,d);this.model.set({lineStyle:"dashed"}),this.model.set({lineStyleAttributes:[r/20,r/10]}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("lineStyle"),this.model.unset("lineStyleAttributes"),this.context.restore(),this.context.restore()}}),Controller.CanvasConeNetModel=Controller.CanvasComponentModel.extend({defaults:{strokeStyle:Controller.COLORS.charcoal,color:"",lineWidth:1,xStart:150,yStart:75,d:50,h:25,rotation:0,sizeID:1,orientation:0}}),Controller.CanvasConeNetView=Controller.CanvasComponentView.extend({render:function(){var t=this.model.get("xStart"),e=this.model.get("yStart"),n=this.model.get("d"),r=(this.model.get("h"),this.model.get("color")),i=(Math.PI*n,this.model.get("orientation"));if(1===this.model.get("rotation")&&(this.context.moveTo(0,0),this.context.save(),this.context.translate(this.model.get("containerW")/2,this.model.get("containerH")/2),this.context.rotate(90*Math.PI/180),this.context.translate(-this.model.get("containerH")/2,-this.model.get("containerW")/2)),2===this.model.get("rotation")&&(this.context.moveTo(0,0),this.context.save(),this.context.translate(this.model.get("containerW")/2,this.model.get("containerH")/2),this.context.rotate(180*Math.PI/180),this.context.translate(-this.model.get("containerW")/2,-this.model.get("containerH")/2)),3===this.model.get("rotation")&&(this.context.moveTo(0,0),this.context.save(),this.context.translate(this.model.get("containerW")/2,this.model.get("containerH")/2),this.context.rotate(270*Math.PI/180),this.context.translate(-this.model.get("containerH")/2,-this.model.get("containerW")/2)),1===this.model.get("sizeID")){var o={x:t,y:e};this.context.beginPath(),this.context.moveTo(o.x,o.y);for(var s=0,a=0,l=o.x,h=o.y,c=2*n,u=n,d=0,p=30,f=0+p*Math.PI/180;f<Math.PI-p*Math.PI/180;f+=.1)s=l-u*Math.sin(f)*Math.sin(d*Math.PI)+c*Math.cos(f)*Math.cos(d*Math.PI),a=h+c*Math.cos(f)*Math.sin(d*Math.PI)+u*Math.sin(f)*Math.cos(d*Math.PI),f===0+p*Math.PI/180?this.context.lineTo(s,a):this.context.lineTo(s,a);if(this.context.lineTo(o.x,o.y),this.model.set({fillStyle:r}),Controller.CanvasComponentView.prototype.render.apply(this),i){var g,m=[],x=[];this.context.beginPath();for(var s=0,a=0,l=o.x,h=o.y,c=2*n,u=n,d=0,f=0;f<(p+20)*Math.PI/180;f+=.1)s=l-u*Math.sin(f)*Math.sin(d*Math.PI)+c*Math.cos(f)*Math.cos(d*Math.PI),a=h+c*Math.cos(f)*Math.sin(d*Math.PI)+u*Math.sin(f)*Math.cos(d*Math.PI),this.context.moveTo(s,a),g=180*Math.abs(Math.atan((o.y-a)/(o.x-s)))/Math.PI,m.push(s),x.push(a);var y=Math.abs(180*Math.atan((m[m.length-1]-m[m.length-2])/(x[x.length-1]-x[x.length-2]))/Math.PI),v={x:s+n/2*Math.cos(y*Math.PI/180),y:a+n/2*Math.sin(y*Math.PI/180)};this.context.beginPath(),this.context.arc(v.x,v.y,n/2,0,2*Math.PI),Controller.CanvasComponentView.prototype.render.apply(this)}else{var v={x:t,y:e+n+n/2};this.context.beginPath(),this.context.arc(v.x,v.y,n/2,0,2*Math.PI),Controller.CanvasComponentView.prototype.render.apply(this)}}if(2===this.model.get("sizeID")){var o={x:t,y:e};this.context.beginPath(),this.context.moveTo(o.x,o.y);for(var s=0,a=0,l=o.x,h=o.y,c=3*n,u=2*n,d=0,p=45,f=0+p*Math.PI/180;f<Math.PI-p*Math.PI/180;f+=.1)s=l-u*Math.sin(f)*Math.sin(d*Math.PI)+c*Math.cos(f)*Math.cos(d*Math.PI),a=h+c*Math.cos(f)*Math.sin(d*Math.PI)+u*Math.sin(f)*Math.cos(d*Math.PI),f===0+p*Math.PI/180?this.context.lineTo(s,a):this.context.lineTo(s,a);if(this.context.lineTo(o.x,o.y),this.model.set({fillStyle:r}),Controller.CanvasComponentView.prototype.render.apply(this),i){var g,m=[],x=[];this.context.beginPath();for(var s=0,a=0,l=o.x,h=o.y,c=3*n,u=2*n,d=0,f=0;f<(p+20)*Math.PI/180;f+=.1)s=l-u*Math.sin(f)*Math.sin(d*Math.PI)+c*Math.cos(f)*Math.cos(d*Math.PI),a=h+c*Math.cos(f)*Math.sin(d*Math.PI)+u*Math.sin(f)*Math.cos(d*Math.PI),this.context.moveTo(s,a),g=180*Math.abs(Math.atan((o.y-a)/(o.x-s)))/Math.PI,m.push(s),x.push(a);var y=Math.abs(180*Math.atan((m[m.length-1]-m[m.length-2])/(x[x.length-1]-x[x.length-2]))/Math.PI),v={x:s+n/2*Math.cos(y*Math.PI/180),y:a+n/2*Math.sin(y*Math.PI/180)};this.context.beginPath(),this.context.arc(v.x,v.y,n/2,0,2*Math.PI),Controller.CanvasComponentView.prototype.render.apply(this)}else{var v={x:t,y:e+2*n+n/2};this.context.beginPath(),this.context.arc(v.x,v.y,n/2,0,2*Math.PI),Controller.CanvasComponentView.prototype.render.apply(this)}}if(3===this.model.get("sizeID")){var o={x:t,y:e};this.context.beginPath(),this.context.moveTo(o.x,o.y);for(var s=0,a=0,l=o.x,h=o.y,c=4*n,u=4*n,d=0,p=60,f=0+p*Math.PI/180;f<Math.PI-p*Math.PI/180;f+=.1)s=l-u*Math.sin(f)*Math.sin(d*Math.PI)+c*Math.cos(f)*Math.cos(d*Math.PI),a=h+c*Math.cos(f)*Math.sin(d*Math.PI)+u*Math.sin(f)*Math.cos(d*Math.PI),f===0+p*Math.PI/180?this.context.lineTo(s,a):this.context.lineTo(s,a);if(this.context.lineTo(o.x,o.y),this.model.set({fillStyle:r}),Controller.CanvasComponentView.prototype.render.apply(this),i){var g,m=[],x=[];this.context.beginPath();for(var s=0,a=0,l=o.x,h=o.y,c=4*n,u=4*n,d=0,f=0;f<(p+20)*Math.PI/180;f+=.1)s=l-u*Math.sin(f)*Math.sin(d*Math.PI)+c*Math.cos(f)*Math.cos(d*Math.PI),a=h+c*Math.cos(f)*Math.sin(d*Math.PI)+u*Math.sin(f)*Math.cos(d*Math.PI),this.context.moveTo(s,a),g=180*Math.abs(Math.atan((o.y-a)/(o.x-s)))/Math.PI,m.push(s),x.push(a);var y=Math.abs(180*Math.atan((m[m.length-1]-m[m.length-2])/(x[x.length-1]-x[x.length-2]))/Math.PI),v={x:s+n/2*Math.cos(y*Math.PI/180),y:a+n/2*Math.sin(y*Math.PI/180)};this.context.beginPath(),this.context.arc(v.x,v.y,n/2,0,2*Math.PI),Controller.CanvasComponentView.prototype.render.apply(this)}else{var v={x:t,y:e+4*n+n/2};this.context.beginPath(),this.context.arc(v.x,v.y,n/2,0,2*Math.PI),Controller.CanvasComponentView.prototype.render.apply(this)}}}}),Controller.CanvasSquareBasedPyramidModel=Controller.CanvasComponentModel.extend({defaults:{strokeStyle:Controller.COLORS.charcoal,color:Controller.COLORS.red,lineWidth:1,xStart:150,yStart:10,height:50,base:100,length:0,sizeID:1,baseRotation:30}}),Controller.CanvasSquareBasedPyramidView=Controller.CanvasComponentView.extend({render:function(){var t=this.model.get("xStart"),e=this.model.get("yStart"),n=this.model.get("base"),r=this.model.get("height"),i=this.model.get("baseRotation"),o=.75*n,s=(Math.sqrt(5/4*(n*n)-n*n*Math.cos(i*Math.PI/180-180*Math.PI/180)),{x:t,y:e}),a={x:t,y:e+r},l={x:a.x-n/2-o/2*Math.cos(i*Math.PI/180),y:a.y+o/2*Math.sin(i*Math.PI/180)},h={x:l.x+n,y:l.y},c={x:l.x+n+o*Math.cos(i*Math.PI/180),y:l.y-o*Math.sin(i*Math.PI/180)},u={x:l.x+o*Math.cos(i*Math.PI/180),y:l.y-o*Math.sin(i*Math.PI/180)};90===this.model.get("rotation")&&(this.context.moveTo(0,0),this.context.save(),this.context.translate(this.model.get("containerW")/2,this.model.get("containerH")/2),this.context.rotate(90*Math.PI/180),this.context.translate(-this.model.get("containerH")/2,-this.model.get("containerW")/2)),180===this.model.get("rotation")&&(this.context.moveTo(0,0),this.context.save(),this.context.translate(this.model.get("containerW")/2,this.model.get("containerH")/2),this.context.rotate(180*Math.PI/180),this.context.translate(-this.model.get("containerW")/2,-this.model.get("containerH")/2)),270===this.model.get("rotation")&&(this.context.moveTo(0,0),this.context.save(),this.context.translate(this.model.get("containerW")/2,this.model.get("containerH")/2),this.context.rotate(270*Math.PI/180),this.context.translate(-this.model.get("containerH")/2,-this.model.get("containerW")/2)),this.context.beginPath(),this.context.moveTo(l.x,l.y),this.context.lineTo(h.x,h.y),this.context.lineTo(s.x,s.y),this.context.lineTo(l.x,l.y),this.model.set({fillStyle:this.model.get("color")}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("fillStyle"),this.context.moveTo(s.x,s.y),this.context.lineTo(c.x,c.y),this.context.lineTo(h.x,h.y),this.model.set({fillStyle:this.model.get("color")}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("fillStyle"),this.context.beginPath(),this.context.moveTo(l.x,l.y),this.context.lineTo(u.x,u.y),this.context.lineTo(c.x,c.y),this.context.moveTo(u.x,u.y),this.context.lineTo(s.x,s.y),this.model.set({lineStyle:"dashed"}),this.model.set({lineStyleAttributes:[n/20,n/10]}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("lineStyle"),this.model.unset("lineStyleAttributes"),this.context.restore()}}),Controller.CanvasSquareBasedPyramidNetModel=Controller.CanvasComponentModel.extend({defaults:{strokeStyle:Controller.COLORS.charcoal,color:"",lineWidth:1,xStart:150,yStart:10,h:25,b:50,sizeID:1,orientation:0,rotation:0}}),Controller.CanvasSquareBasedPyramidNetView=Controller.CanvasComponentView.extend({render:function(){var t=this.model.get("h"),e=this.model.get("b"),n=Math.sqrt(t*t+.5*e*(.5*e)),r=this.model.get("xStart"),i=this.model.get("yStart"),o=this.model.get("orientation");if(1===this.model.get("rotation")&&(this.context.moveTo(0,0),this.context.save(),this.context.translate(this.model.get("containerW")/2,this.model.get("containerH")/2),this.context.rotate(90*Math.PI/180),this.context.translate(-this.model.get("containerH")/2,-this.model.get("containerW")/2)),2===this.model.get("rotation")&&(this.context.moveTo(0,0),this.context.save(),this.context.translate(this.model.get("containerW")/2,this.model.get("containerH")/2),this.context.rotate(180*Math.PI/180),this.context.translate(-this.model.get("containerW")/2,-this.model.get("containerH")/2)),3===this.model.get("rotation")&&(this.context.moveTo(0,0),this.context.save(),this.context.translate(this.model.get("containerW")/2,this.model.get("containerH")/2),this.context.rotate(270*Math.PI/180),this.context.translate(-this.model.get("containerH")/2,-this.model.get("containerW")/2)),!o){var s={x:r-e/2,y:i+n},a={x:s.x+e,y:s.y},l={x:a.x,y:a.y+e},h={x:s.x,y:s.y+e};this.context.beginPath(),this.context.moveTo(r,i),this.context.lineTo(s.x,s.y),this.context.moveTo(r,i),this.context.lineTo(a.x,a.y),this.context.lineTo(a.x+n,a.y+e/2),this.context.lineTo(l.x,l.y),this.context.lineTo(r,l.y+n),this.context.lineTo(h.x,h.y),this.context.lineTo(h.x-n,h.y-e/2),this.context.lineTo(s.x,s.y),this.model.set({fillStyle:this.model.get("color")}),Controller.CanvasComponentView.prototype.render.apply(this),this.context.beginPath(),this.context.moveTo(s.x,s.y),this.context.lineTo(a.x,a.y),this.context.lineTo(l.x,l.y),this.context.lineTo(h.x,h.y),this.context.lineTo(s.x,s.y),this.model.set({lineStyle:"dashed"}),this.model.set({lineStyleAttributes:[e/20,e/10]}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("lineStyle"),this.model.unset("lineStyleAttributes")}if(o){var c={x:r,y:i},s={x:c.x+n,y:c.y-e/2},a={x:s.x+e,y:s.y},l={x:a.x,y:a.y+e},h={x:s.x,y:s.y+e},u={x:a.x+n,y:a.y+e/2},d=180*Math.atan(e/2/n)/Math.PI,p=180*Math.atan(n/(e/2))/Math.PI;this.context.beginPath(),this.context.moveTo(s.x,s.y),this.context.lineTo(s.x-e*Math.cos((p-d)*Math.PI/180),s.y-e*Math.sin((p-d)*Math.PI/180)),this.context.lineTo(c.x,c.y),this.context.lineTo(h.x,h.y),this.context.lineTo(l.x,l.y),this.context.lineTo(l.x+e*Math.cos((p-d)*Math.PI/180),l.y+e*Math.sin((p-d)*Math.PI/180)),this.context.lineTo(u.x,u.y),this.context.lineTo(a.x,a.y),this.context.lineTo(s.x,s.y),this.model.set({fillStyle:this.model.get("color")}),Controller.CanvasComponentView.prototype.render.apply(this),this.context.beginPath(),this.context.moveTo(a.x,a.y),this.context.lineTo(l.x,l.y),this.context.lineTo(l.x+n,l.y-e/2),this.model.set({lineStyle:"dashed"}),this.model.set({lineStyleAttributes:[e/20,e/10]}),Controller.CanvasComponentView.prototype.render.apply(this),this.context.beginPath(),this.context.moveTo(h.x,h.y),this.context.lineTo(s.x,s.y),this.context.lineTo(s.x-n,s.y+e/2),this.model.set({lineStyle:"dashed"}),this.model.set({lineStyleAttributes:[e/20,e/10]}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("lineStyle"),this.model.unset("lineStyleAttributes")}}}),Controller.CanvasTriangularPrismModel=Controller.CanvasComponentModel.extend({defaults:{strokeStyle:Controller.COLORS.charcoal,color:Controller.COLORS.red,lineWidth:1,xStart:100,yStart:150,h:50,b:50,w:100,l:200,rotation:1,sizeID:1,baseRotation:30}}),Controller.CanvasTriangularPrismView=Controller.CanvasComponentView.extend({render:function(){var t=this.model.get("xStart"),e=this.model.get("yStart"),n=.2,r=this.model.get("baseRotation"),t=this.model.get("xStart"),e=this.model.get("yStart"),i=this.model.get("h"),o=this.model.get("b"),s=this.model.get("w"),a=this.model.get("l"),l=this.model.get("color"),h=this.model.get("rotation");if(!h){var c={x:t,y:e},u={x:t-o/2,y:e+i},d={x:t+o/2,y:e+i},p={x:t+s*Math.cos(r*Math.PI/180),y:e-s*Math.sin(r*Math.PI/180)},f={x:p.x-o/2,y:p.y+i},g={x:p.x+o/2,y:p.y+i};this.context.beginPath(),this.context.moveTo(c.x,c.y),this.context.lineTo(u.x,u.y),this.context.lineTo(d.x,d.y),this.context.lineTo(c.x,c.y),this.context.lineTo(p.x,p.y),this.context.lineTo(g.x,g.y),this.context.lineTo(d.x,d.y),this.context.closePath(),this.model.set({fillStyle:l}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("fillStyle"),this.context.beginPath(),this.context.moveTo(p.x,p.y),this.context.lineTo(f.x,f.y),this.context.lineTo(g.x,g.y),this.context.moveTo(f.x,f.y),this.context.lineTo(u.x,u.y),this.model.set({lineStyle:"dashed"}),this.model.set({lineStyleAttributes:[o/20,o/10]}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("lineStyle"),this.model.unset("lineStyleAttributes")}if(h){var m=180*Math.atan(i/(o/2))/Math.PI;if(1===this.model.get("sizeID")||2===this.model.get("sizeID")||3===this.model.get("sizeID"))var c={x:t,y:e},u={x:t,y:e+s},d={x:u.x+o*Math.cos(r*Math.PI/180),y:u.y+o*Math.sin(r*Math.PI/180)-n*s},p={x:u.x+o*Math.cos(r*Math.PI/180),y:d.y-s},f={x:c.x+a*Math.cos((m-r)*Math.PI/180),y:c.y-a*Math.sin((m-r)*Math.PI/180)},g={x:f.x,y:f.y+s};else var c={x:t,y:e},u={x:t,y:e+s},d={x:u.x+o*Math.cos(r*Math.PI/180),y:u.y+o*Math.sin(r*Math.PI/180)},p={x:u.x+o*Math.cos(r*Math.PI/180),y:d.y-s},f={x:c.x+a*Math.cos((m-r)*Math.PI/180),y:c.y-a*Math.sin((m-r)*Math.PI/180)},g={x:f.x,y:f.y+s};this.context.beginPath(),this.context.moveTo(c.x,c.y),this.context.lineTo(u.x,u.y),this.context.lineTo(d.x,d.y),this.context.lineTo(g.x,g.y),this.context.lineTo(f.x,f.y),this.context.lineTo(c.x,c.y),this.model.set({fillStyle:l}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("fillStyle"),this.context.beginPath(),this.context.moveTo(c.x,c.y),this.context.lineTo(p.x,p.y),this.context.lineTo(f.x,f.y),this.context.moveTo(p.x,p.y),this.context.lineTo(d.x,d.y),Controller.CanvasComponentView.prototype.render.apply(this),this.context.beginPath(),this.context.moveTo(u.x,u.y),this.context.lineTo(g.x,g.y),this.model.set({lineStyle:"dashed"}),this.model.set({lineStyleAttributes:[o/20,o/10]}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("lineStyle"),this.model.unset("lineStyleAttributes")}}}),Controller.CanvasTriangularPrismNetModel=Controller.CanvasComponentModel.extend({defaults:{strokeStyle:Controller.COLORS.charcoal,color:"",lineWidth:1,xStart:100,yStart:150,h:50,b:50,w:100,d:200,rotation:1,sizeID:1,orientation:0}}),Controller.CanvasTriangularPrismNetView=Controller.CanvasComponentView.extend({
render:function(){var t=this.model.get("xStart"),e=this.model.get("yStart"),n=this.model.get("b"),r=this.model.get("w"),i=this.model.get("d"),o=this.model.get("color"),s=this.model.get("h"),a=this.model.get("orientation");if(1!==this.model.get("rotation")&&3!==this.model.get("rotation")||(this.context.moveTo(0,0),this.context.save(),this.context.translate(this.model.get("containerW")/2,this.model.get("containerH")/2),this.context.rotate(90*Math.PI/180),this.context.translate(-this.model.get("containerH")/2,-this.model.get("containerW")/2)),a){var l=180*Math.atan(s/(n/2))/Math.PI;this.context.beginPath(),this.context.moveTo(t,e),this.context.lineTo(t,e+r),this.context.lineTo(t+i+n,e+r),this.context.lineTo(t+i+n+n*Math.cos(l*Math.PI/180),e+r+n*Math.sin(l*Math.PI/180)),this.context.lineTo(t+i+n+i,e+r),this.context.lineTo(t+i+n+i,e),this.context.lineTo(t+i,e),this.context.lineTo(t+i-n*Math.cos(l*Math.PI/180),e-n*Math.sin(l*Math.PI/180)),this.context.lineTo(t,e),this.model.set({fillStyle:o}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("fillStyle"),this.context.beginPath(),this.context.moveTo(t,e),this.context.lineTo(t+i,e),this.context.lineTo(t+i,e+r),this.context.moveTo(t+i+n,e),this.context.lineTo(t+i+n,e+r),this.context.lineTo(t+i+n+i,e+r),this.model.set({lineStyle:"dashed"}),this.model.set({lineStyleAttributes:[n/20,n/10]}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("lineStyle"),this.model.unset("lineStyleAttributes")}else this.context.beginPath(),this.context.moveTo(t,e),this.context.lineTo(t+n/2,e+s),this.context.lineTo(t+n/2+i,e+s),this.context.lineTo(t+n/2+i,e+s+r),this.context.lineTo(t+n/2,e+s+r),this.context.lineTo(t,e+s+r+s),this.context.lineTo(t-n/2,e+s+r),this.context.lineTo(t-n/2-i,e+s+r),this.context.lineTo(t-n/2-i,e+s),this.context.lineTo(t-n/2,e+s),this.context.lineTo(t,e),this.model.set({fillStyle:o}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("fillStyle"),this.context.beginPath(),this.context.moveTo(t-n/2,e+s),this.context.lineTo(t-n/2,e+s+r),this.context.moveTo(t+n/2,e+s),this.context.lineTo(t+n/2,e+s+r),this.context.moveTo(t-n/2,e+s),this.context.lineTo(t+n/2,e+s),this.context.moveTo(t-n/2,e+s+r),this.context.lineTo(t+n/2,e+s+r),this.model.set({lineStyle:"dashed"}),this.model.set({lineStyleAttributes:[n/20,n/10]}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("lineStyle"),this.model.unset("lineStyleAttributes")}}),Controller.CanvasRectangularPrismModel=Controller.CanvasComponentModel.extend({defaults:{strokeStyle:Controller.COLORS.charcoal,color:Controller.COLORS.red,lineWidth:1,xStart:50,yStart:150,h:50,b:100,w:100,rotation:0,sizeID:1,baseRotation:30}}),Controller.CanvasRectangularPrismView=Controller.CanvasComponentView.extend({render:function(){var t=this.model.get("baseRotation"),e=this.model.get("xStart"),n=this.model.get("yStart"),r=this.model.get("h"),i=this.model.get("b"),o=this.model.get("w"),s=this.model.get("color"),a=this.model.get("rotation"),l=.6;if(a)var h={x:e,y:n},c={x:h.x+r,y:h.y},u={x:c.x,y:c.y+i},d={x:h.x,y:h.y+i},p={x:h.x+o*l*Math.cos(t*Math.PI/180),y:h.y-o*l*Math.sin(t*Math.PI/180)},f={x:p.x+r,y:p.y},g={x:f.x,y:f.y+i},m={x:p.x,y:p.y+i};if(!a)var h={x:e,y:n},c={x:h.x+i,y:h.y},u={x:c.x,y:c.y+r},d={x:h.x,y:h.y+r},p={x:h.x+o*l*Math.cos(t*Math.PI/180),y:h.y-o*l*Math.sin(t*Math.PI/180)},f={x:p.x+i,y:p.y},g={x:f.x,y:f.y+r},m={x:p.x,y:p.y+r};this.context.beginPath(),this.context.moveTo(h.x,h.y),this.context.lineTo(d.x,d.y),this.context.lineTo(u.x,u.y),this.context.lineTo(g.x,g.y),this.context.lineTo(f.x,f.y),this.context.lineTo(p.x,p.y),this.context.lineTo(h.x,h.y),this.model.set({fillStyle:s}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("fillStyle"),this.context.beginPath(),this.context.moveTo(c.x,c.y),this.context.lineTo(f.x,f.y),this.context.moveTo(h.x,h.y),this.context.lineTo(c.x,c.y),this.context.lineTo(u.x,u.y),Controller.CanvasComponentView.prototype.render.apply(this),this.context.beginPath(),this.context.moveTo(p.x,p.y),this.context.lineTo(m.x,m.y),this.context.lineTo(g.x,g.y),this.context.moveTo(m.x,m.y),this.context.lineTo(d.x,d.y),this.model.set({lineStyle:"dashed"}),this.model.set({lineStyleAttributes:[i/20,i/10]}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("lineStyle"),this.model.unset("lineStyleAttributes")}}),Controller.CanvasRectangularPrismNetModel=Controller.CanvasComponentModel.extend({defaults:{strokeStyle:Controller.COLORS.charcoal,color:Controller.COLORS.red,lineWidth:1,xStart:50,yStart:150,h:50,b:100,w:100,rotation:0,sizeID:1,orientation:0}}),Controller.CanvasRectangularPrismNetView=Controller.CanvasComponentView.extend({render:function(){var t=this.model.get("orientation"),e=this.model.get("xStart"),n=this.model.get("yStart"),r=this.model.get("h"),i=this.model.get("b"),o=this.model.get("w"),s=this.model.get("color");this.model.get("rotation");1===this.model.get("rotation")&&(this.context.moveTo(0,0),this.context.save(),this.context.translate(this.model.get("containerW")/2,this.model.get("containerH")/2),this.context.rotate(90*Math.PI/180),this.context.translate(-this.model.get("containerH")/2,-this.model.get("containerW")/2)),2===this.model.get("rotation")&&(this.context.moveTo(0,0),this.context.save(),this.context.translate(this.model.get("containerW")/2,this.model.get("containerH")/2),this.context.rotate(180*Math.PI/180),this.context.translate(-this.model.get("containerH")/2,-this.model.get("containerW")/2)),3===this.model.get("rotation")&&(this.context.moveTo(0,0),this.context.save(),this.context.translate(this.model.get("containerW")/2,this.model.get("containerH")/2),this.context.rotate(270*Math.PI/180),this.context.translate(-this.model.get("containerH")/2,-this.model.get("containerW")/2)),t?(this.context.beginPath(),this.context.moveTo(e,n),this.context.lineTo(e+i,n),this.context.lineTo(e+i,n+r),this.context.lineTo(e+i+r,n+r),this.context.lineTo(e+i+r,n+r+o),this.context.lineTo(e+i,n+r+o),this.context.lineTo(e+i,n+2*r+2*o),this.context.lineTo(e,n+2*r+2*o),this.context.lineTo(e-r,n+2*r+2*o),this.context.lineTo(e-r,n+2*r+o),this.context.lineTo(e,n+2*r+o),this.context.lineTo(e,n),this.model.set({fillStyle:s}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("fillStyle"),this.context.beginPath(),this.context.moveTo(e,n+r),this.context.lineTo(e+i,n+r),this.context.lineTo(e+i,n+r+o),this.context.lineTo(e,n+r+o),this.context.moveTo(e,n+2*r+o),this.context.lineTo(e+i,n+2*r+o),this.context.moveTo(e,n+2*r+o),this.context.lineTo(e,n+2*r+2*o),this.model.set({lineStyle:"dashed"}),this.model.set({lineStyleAttributes:[i/20,i/10]}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("lineStyle"),this.model.unset("lineStyleAttributes")):(this.context.beginPath(),this.context.moveTo(e,n),this.context.lineTo(e+i,n),this.context.lineTo(e+i,n+r),this.context.lineTo(e+i+r,n+r),this.context.lineTo(e+i+r,n+r+o),this.context.lineTo(e+i,n+r+o),this.context.lineTo(e+i,n+2*r+2*o),this.context.lineTo(e,n+2*r+2*o),this.context.lineTo(e,n+r+o),this.context.lineTo(e-r,n+r+o),this.context.lineTo(e-r,n+r),this.context.lineTo(e,n+r),this.context.lineTo(e,n),this.model.set({fillStyle:s}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("fillStyle"),this.context.beginPath(),this.context.moveTo(e,n+r),this.context.lineTo(e+i,n+r),this.context.lineTo(e+i,n+r+o),this.context.lineTo(e,n+r+o),this.context.lineTo(e,n+r),this.context.moveTo(e,n+2*r+o),this.context.lineTo(e+i,n+2*r+o),this.model.set({lineStyle:"dashed"}),this.model.set({lineStyleAttributes:[i/20,i/10]}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("lineStyle"),this.model.unset("lineStyleAttributes"))}}),Controller.CanvasTriangularBasedPyramidModel=Controller.CanvasComponentModel.extend({defaults:{strokeStyle:Controller.COLORS.charcoal,color:Controller.COLORS.red,lineWidth:1,xStart:100,yStart:250,h:50,b:100,sizeID:1,baseRotation:30}}),Controller.CanvasTriangularBasedPyramidView=Controller.CanvasComponentView.extend({render:function(){var t=this.model.get("xStart"),e=this.model.get("yStart"),n=this.model.get("b"),r=this.model.get("h"),i=(this.model.get("baseRotation"),this.model.get("color")),o=(this.model.get("sizeID"),20),s=85,a=.7,l={x:t,y:e},h={x:t+n*Math.cos(o*Math.PI/180),y:e+n*Math.sin(o*Math.PI/180)},c={x:h.x+a*n*Math.cos(s*Math.PI/180),y:h.y-a*n*Math.sin(s*Math.PI/180)},u={xStart:l.x,yStart:l.y,xEnd:(h.x+c.x)/2,yEnd:(h.y+c.y)/2},d=(u.yEnd-u.yStart)/(u.xEnd-u.xStart),p=l.y-d*l.x,f={xStart:h.x,yStart:h.y,xEnd:(l.x+c.x)/2,yEnd:(l.y+c.y)/2},g=(f.yEnd-f.yStart)/(f.xEnd-f.xStart),m=h.y-g*h.x,x=(m-p)/(d-g),y=d*x+p,v={x:x,y:y-r};this.context.beginPath(),this.context.moveTo(l.x,l.y),this.context.lineTo(h.x,h.y),this.context.lineTo(c.x,c.y),this.context.lineTo(v.x,v.y),this.context.lineTo(l.x,l.y),this.model.set({fillStyle:i}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("fillStyle"),this.context.moveTo(h.x,h.y),this.context.lineTo(v.x,v.y),Controller.CanvasComponentView.prototype.render.apply(this),this.context.beginPath(),this.context.moveTo(l.x,l.y),this.context.lineTo(c.x,c.y),this.model.set({lineStyle:"dashed"}),this.model.set({lineStyleAttributes:[n/20,n/10]}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("lineStyle"),this.model.unset("lineStyleAttributes")}}),Controller.CanvasTriangularBasedPyramidNetModel=Controller.CanvasComponentModel.extend({defaults:{strokeStyle:Controller.COLORS.charcoal,color:"",lineWidth:1,xStart:100,yStart:250,h:50,b:100,sizeID:1,orientation:0,rotation:0}}),Controller.CanvasTriangularBasedPyramidNetView=Controller.CanvasComponentView.extend({render:function(){var t=this.model.get("xStart"),e=this.model.get("yStart"),n=this.model.get("b"),r=this.model.get("l"),i=this.model.get("orientation"),o=this.model.get("color"),s=(this.model.get("sizeID"),Math.sqrt(n/2*(n/2)+r*r)),a=180*Math.atan(r/(n/2))/Math.PI;1===this.model.get("rotation")&&(this.context.moveTo(0,0),this.context.save(),this.context.translate(this.model.get("containerW")/2,this.model.get("containerH")/2),this.context.rotate(90*Math.PI/180),this.context.translate(-this.model.get("containerH")/2,-this.model.get("containerW")/2)),2===this.model.get("rotation")&&(this.context.moveTo(0,0),this.context.save(),this.context.translate(this.model.get("containerW")/2,this.model.get("containerH")/2),this.context.rotate(180*Math.PI/180),this.context.translate(-this.model.get("containerH")/2,-this.model.get("containerW")/2)),3===this.model.get("rotation")&&(this.context.moveTo(0,0),this.context.save(),this.context.translate(this.model.get("containerW")/2,this.model.get("containerH")/2),this.context.rotate(270*Math.PI/180),this.context.translate(-this.model.get("containerH")/2,-this.model.get("containerW")/2)),i?(this.context.beginPath(),this.context.moveTo(t+s*Math.cos((a-60)*Math.PI/180),e-s*Math.sin((a-60)*Math.PI/180)),this.context.lineTo(t+n*Math.cos(60*Math.PI/180),e+n*Math.sin(60*Math.PI/180)),this.context.lineTo(t,e+Math.sqrt(n*n-n/2*(n/2))+r),this.context.lineTo(t-n*Math.cos(60*Math.PI/180),e+n*Math.sin(60*Math.PI/180)),this.context.lineTo(t,e),this.context.lineTo(t+n*Math.cos((2*a-60)*Math.PI/180),e-n*Math.sin((2*a-60)*Math.PI/180)),this.context.lineTo(t+s*Math.cos((a-60)*Math.PI/180),e-s*Math.sin((a-60)*Math.PI/180)),this.model.set({fillStyle:o}),Controller.CanvasComponentView.prototype.render.apply(this),this.context.beginPath(),this.context.moveTo(t+s*Math.cos((a-60)*Math.PI/180),e-s*Math.sin((a-60)*Math.PI/180)),this.context.lineTo(t,e),this.context.lineTo(t+n*Math.cos(60*Math.PI/180),e+n*Math.sin(60*Math.PI/180)),this.context.lineTo(t-n*Math.cos(60*Math.PI/180),e+n*Math.sin(60*Math.PI/180)),this.model.set({lineStyle:"dashed"}),this.model.set({lineStyleAttributes:[n/20,n/10]}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("lineStyle"),this.model.unset("lineStyleAttributes")):(this.context.beginPath(),this.context.moveTo(t,e),this.context.lineTo(t+s*Math.cos((a-60)*Math.PI/180),e-s*Math.sin((a-60)*Math.PI/180)),this.context.lineTo(t+n*Math.cos(60*Math.PI/180),e+n*Math.sin(60*Math.PI/180)),this.context.lineTo(t,e+Math.sqrt(n*n-n/2*(n/2))+r),this.context.lineTo(t-n*Math.cos(60*Math.PI/180),e+n*Math.sin(60*Math.PI/180)),this.context.lineTo(t-s*Math.cos((a-60)*Math.PI/180),e-s*Math.sin((a-60)*Math.PI/180)),this.context.lineTo(t,e),this.model.set({fillStyle:o}),Controller.CanvasComponentView.prototype.render.apply(this),this.context.beginPath(),this.context.moveTo(t,e),this.context.lineTo(t+n*Math.cos(60*Math.PI/180),e+n*Math.sin(60*Math.PI/180)),this.context.lineTo(t-n*Math.cos(60*Math.PI/180),e+n*Math.sin(60*Math.PI/180)),this.context.lineTo(t,e),this.model.set({lineStyle:"dashed"}),this.model.set({lineStyleAttributes:[n/20,n/10]}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("lineStyle"),this.model.unset("lineStyleAttributes"))}}),Controller.CanvasFractionCircleModel=Controller.CanvasComponentModel.extend({defaults:{textColor:Controller.COLORS.white,strokeStyle:Controller.COLORS.charcoal,lineWidth:1,style:0,rotation:0,denominator:[2],colors:"",xCenter:0,yCenter:0,r:100,bgColor:Controller.COLORS.white}}),Controller.CanvasFractionCircleView=Controller.CanvasComponentView.extend({render:function(){var t=this.model.get("denominator"),e=0,n=this.model.get("style"),r=this.model.get("rotation"),i=this.model.get("labelIndicator"),o=this.model.get("xCenter"),s=this.model.get("yCenter"),a=this.model.get("r");this.model.unset("lineWidth");var l={1:{angle:0,color:Controller.COLORS.lightnavy},2:{angle:180,color:Controller.COLORS.darkblue},3:{angle:120,color:Controller.COLORS.teal},4:{angle:90,color:Controller.COLORS.darkgreen},5:{angle:72,color:Controller.COLORS.lightbrown},6:{angle:60,color:Controller.COLORS.orange},8:{angle:45,color:Controller.COLORS.pink},10:{angle:36,color:Controller.COLORS.lightred},12:{angle:30,color:Controller.COLORS.darkpurple}},h=90-r;if(this.context.moveTo(0,0),this.context.save(),this.context.translate(o,s),this.context.rotate(-h*Math.PI/180),this.context.translate(-o,-s),Controller.CanvasComponentView.prototype.render.apply(this),n){this.context.beginPath(),this.context.arc(o,s,a,0,2*Math.PI),this.model.set({fillStyle:this.model.get("bgColor")}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("fillStyle");var c=[];(n>1||1===n&&t.length>0)&&c.push(0);for(var u=0,d=0;d<t.length;d++)e+l[t[d]].angle<=360&&(this.context.beginPath(),this.context.moveTo(o,s),this.context.arc(o,s,a,e*Math.PI/180,(e+l[t[d]].angle)*Math.PI/180),e+=l[t[d]].angle,c.push(e),this.model.set({fillStyle:l[t[d]].color}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("fillStyle"),u+=l[t[d]].angle);if(e<360)var p=c.length;else var p=c.length-1;for(var d=0;d<p;d++)this.context.beginPath(),this.context.moveTo(o,s),this.context.lineTo(o+a*Math.cos(c[d]*Math.PI/180),s+a*Math.sin(c[d]*Math.PI/180)),this.model.set({lineWidth:2}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("lineWidth");for(var d=0;d<n;d++)this.context.beginPath(),this.context.moveTo(o,s),d*l[n].angle>u&&this.context.lineTo(o+a*Math.cos(d*l[n].angle*Math.PI/180),s+a*Math.sin(d*l[n].angle*Math.PI/180)),this.model.set({lineWidth:2}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("lineWidth");this.context.beginPath(),this.context.arc(o,s,a,0,2*Math.PI),this.model.set({lineWidth:4}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("lineWidth"),this.context.restore()}else{var c=[];t.length>0&&c.push(0);for(var d=0;d<t.length;d++)e+l[t[d]].angle<=360&&(this.context.beginPath(),this.context.moveTo(o,s),this.context.arc(o,s,a,e*Math.PI/180,(e+l[t[d]].angle)*Math.PI/180),e+=l[t[d]].angle,c.push(e),this.model.set({fillStyle:l[t[d]].color}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("fillStyle"));if(e<360)var p=c.length;else var p=c.length-1;for(var d=0;d<p;d++)this.context.beginPath(),this.context.moveTo(o,s),this.context.lineTo(o+a*Math.cos(c[d]*Math.PI/180),s+a*Math.sin(c[d]*Math.PI/180)),this.model.set({lineWidth:2}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("lineWidth");this.context.beginPath(),this.context.arc(o,s,a,0,2*Math.PI),this.model.set({lineWidth:5}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("lineWidth"),this.context.restore()}if(i){for(var f=[],e=0,d=0;d<t.length;d++)e+l[t[d]].angle<=360&&(f.push(l[t[d]].angle/2+e),e+=l[t[d]].angle);this.context.fillStyle=this.model.get("textColor"),this.context.font="bold 18px monospace",this.context.textAlign="center",this.context.textBaseline="middle",this.context.strokeStyle=this.model.get("strokeStyle");for(var d=0;d<f.length;d++)this.context.fillText(1,o+.6*a*Math.cos((f[d]-h)*Math.PI/180),s+.6*a*Math.sin((f[d]-h)*Math.PI/180)-10),this.context.fillText("_",o+.6*a*Math.cos((f[d]-h)*Math.PI/180),s+.6*a*Math.sin((f[d]-h)*Math.PI/180)-10),this.context.fillText(t[d],o+.6*a*Math.cos((f[d]-h)*Math.PI/180),s+.6*a*Math.sin((f[d]-h)*Math.PI/180)+7)}}}),Controller.CanvasBlendColorsModel=Controller.CanvasComponentModel.extend({defaults:{color1:"",color2:"",color3:"",x:0,y:0,w:30,h:30,lineWidth:0,strokeStyle:Controller.COLORS.charcoal}}),Controller.CanvasBlendColorsView=Controller.CanvasComponentView.extend({render:function(){var t=this.model.get("colors"),e=this.model.get("lineWidth")?this.model.get("lineWidth")/2:0,n=this.model.get("x")+e,r=this.model.get("y")+e,i=this.model.get("w")-2*e,o=this.model.get("h")-2*e;2===t.length&&(this.model.set({lineWidth:0}),this.context.beginPath(),this.context.moveTo(n+1,r),this.context.lineTo(n+i+1,r+o),this.context.lineTo(n,r+o),this.context.lineTo(n,r),this.model.set({fillStyle:t[0]}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("fillStyle"),this.context.beginPath(),this.context.moveTo(n,r),this.context.lineTo(n+i,r),this.context.lineTo(n+i,r+o),this.context.lineTo(n,r),this.model.set({fillStyle:t[1]}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("fillStyle")),3===t.length&&(this.model.set({lineWidth:0}),this.context.beginPath(),this.context.moveTo(n,r+i/3),this.context.lineTo(n,r+o),this.context.lineTo(n+(i-i/3),r+o),this.context.lineTo(n,r+i/3),this.model.set({fillStyle:t[0]}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("fillStyle"),this.context.beginPath(),this.context.moveTo(n,r),this.context.lineTo(n,r+i/3+1),this.context.lineTo(n+(i-i/3)-1,r+o),this.context.lineTo(n+i,r+o),this.context.lineTo(n+i,r+o-i/3-1),this.context.lineTo(n+i/3+1,r),this.context.lineTo(n,r),this.model.set({fillStyle:t[1]}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("fillStyle"),this.context.beginPath(),this.context.moveTo(n+i/3,r),this.context.lineTo(n+i,r+(o-i/3)),this.context.lineTo(n+i,r+i/3),this.context.lineTo(n+i,r),this.context.lineTo(n+i/3,r),this.model.set({fillStyle:t[2]}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("fillStyle")),4===t.length&&(this.model.set({lineWidth:0}),this.context.beginPath(),this.context.moveTo(n,r+i/2),this.context.lineTo(n,r+o),this.context.lineTo(n+(i-i/2),r+o),this.context.lineTo(n,r+i/2),this.model.set({fillStyle:t[0]}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("fillStyle"),this.context.beginPath(),this.context.moveTo(n,r),this.context.lineTo(n,r+i/2+1),this.context.lineTo(n+i/2-1,r+o),this.context.lineTo(n+i+1,r+o),this.context.lineTo(n+1,r),this.model.set({fillStyle:t[1]}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("fillStyle"),this.context.beginPath(),this.context.moveTo(n,r),this.context.lineTo(n+i,r+o),this.context.lineTo(n+i,r+i/2-1),this.context.lineTo(n+i/2+1,r),this.context.lineTo(n,r),this.model.set({fillStyle:t[2]}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("fillStyle"),this.context.beginPath(),this.context.moveTo(n+i/2,r),this.context.lineTo(n+i,r+i/2),this.context.lineTo(n+i,r),this.context.lineTo(n+i/2,r),this.model.set({fillStyle:t[3]}),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("fillStyle")),e>0&&(this.model.set({lineWidth:2*e}),this.context.beginPath(),this.context.rect(n,r,i,o),this.context.closePath(),Controller.CanvasComponentView.prototype.render.apply(this))}}),Controller.CanvasButtonModel=Controller.CanvasComponentModel.extend({defaults:{color:Controller.COLORS.charcoal,lineWidth:1,x:0,y:0,w:80,h:80,"class":"up"}}),Controller.CanvasButtonView=Controller.CanvasComponentView.extend({render:function(){var t=this.model.get("x"),e=this.model.get("y"),n=this.model.get("w"),r=this.model.get("h"),i=Math.min(n-15,r-15)/3,o=Math.min(n-15,r-15)/8;if(this.context.beginPath(),this.context.lineWidth=this.model.get("lineWidth"),this.context.strokeStyle=this.model.get("color"),this.model.set({fillStyle:this.model.get("color")}),"up"===this.model.get("class")){var s=t+n/2,a=e+7.5,l=r-15;this.context.moveTo(s+l/12,a+l/12),this.context.lineTo(s+i+l/6,a+l/2),this.context.arcTo(s+i+l/4,a+3*l/4,s+i,a+2*l/3,5),this.context.lineTo(s+o+l/12,a+l/2),this.context.arcTo(s+o,a+l/2,s+o,a+13*l/24,2),this.context.lineTo(s+o,a+l),this.context.arcTo(s,a+l+5,s-o,a+l,7),this.context.lineTo(s-o,a+13*l/24),this.context.arcTo(s-o,a+l/2,s-o-l/12,a+l/2,2),this.context.lineTo(s-i,a+2*l/3),this.context.arcTo(s-i-l/3,a+2*l/3,s-i-l/6,a+l/2,5),this.context.lineTo(s-l/12,a+l/12),this.context.arcTo(s,a,s+l/12,a+l/12,5)}else if("down"===this.model.get("class")){var s=t+n/2,a=e+r-7.5,l=r-15;this.context.moveTo(s+l/12,a-l/12),this.context.lineTo(s+i+l/6,a-l/2),this.context.arcTo(s+i+l/4,a-3*l/4,s+i,a-2*l/3,5),this.context.lineTo(s+o+l/12,a-l/2),this.context.arcTo(s+o,a-l/2,s+o,a-13*l/24,2),this.context.lineTo(s+o,a-l),this.context.arcTo(s,a-l-5,s-o,a-l,7),this.context.lineTo(s-o,a-13*l/24),this.context.arcTo(s-o,a-l/2,s-o-l/12,a-l/2,2),this.context.lineTo(s-i,a-2*l/3),this.context.arcTo(s-i-l/3,a-2*l/3,s-i-l/6,a-l/2,5),this.context.lineTo(s-l/12,a-l/12),this.context.arcTo(s,a,s+l/12,a-l/12,5)}Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("fillStyle")}}),Controller.CanvasUndoButtonModel=Controller.CanvasComponentModel.extend({defaults:{arrowColor:Controller.COLORS.white,buttonColor:Controller.COLORS.teal,outlineColor:Controller.COLORS.charcoal,outlineWidth:3,x:0,y:0,r:80,enabled:!0},parse:function(t){return t.arrowColor=t.enabled?t.arrowColor:Controller.COLORS.lightgrey,t.buttonColor=t.enabled?t.buttonColor:Controller.COLORS.darkgrey,Controller.CanvasControlModel.prototype.parse.call(this,t)},distance:function(t,e){return Math.max(Controller.Math.euclideanDistance(t,e,this.get("x"),this.get("y"))-this.get("r"),0)}}),Controller.CanvasUndoButtonView=Controller.CanvasComponentView.extend({render:function(){var t=this.model.get("x"),e=this.model.get("y"),n=this.model.get("r");this.context.beginPath(),this.model.set({fillStyle:this.model.get("buttonColor")}),this.model.set({lineWidth:this.model.get("outlineWidth")}),this.model.set({strokeStyle:this.model.get("outlineColor")}),this.context.arc(t,e,n,0,2*Math.PI),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("fillStyle"),this.model.unset("lineWidth"),this.model.unset("strokeStyle"),this.context.beginPath(),this.model.set({lineWidth:2}),this.model.set({strokeStyle:this.model.get("arrowColor")}),this.context.moveTo(t-n/3,e+2*n/3),this.context.lineTo(t-n/3,e+n/3),this.context.lineTo(t-n/4,e+n/3),this.context.arcTo(t+n/3,e+n/3,t+n/3,e+n/3-n/8,n/4),this.context.arcTo(t+n/3,e+n/3-n/2,t-n/4,e+n/3-n/2,n/4),this.context.lineTo(t-n/3,e+n/3-n/2),this.context.lineTo(t-n/3,e+n/3-n/2-n/3),this.context.lineTo(t-n/4,e+n/3-n/2-n/3),this.context.arcTo(t+2*n/3,e+n/3-n/2-n/3,t+2*n/3,e+n/3,n/4+n/3),this.context.arcTo(t+2*n/3,e+2*n/3,t-n/3,e+2*n/3,n/4+n/3),this.context.lineTo(t-n/3-1,e+2*n/3),this.model.set({fillStyle:this.model.get("arrowColor")}),Controller.CanvasComponentView.prototype.render.apply(this),this.context.beginPath(),this.context.moveTo(t-n/3,e+n/3-n/2-n/3),this.context.lineTo(t-n/3,e+n/3-n/2-n/3-n/4),this.context.lineTo(t-2*n/3,e+n/3-n/2-n/6),this.context.lineTo(t-n/3,e+n/3-n/2+n/4),this.context.lineTo(t-n/3,e+n/3-n/2),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("fillStyle")}}),Controller.CanvasArrowButtonModel=Controller.CanvasComponentModel.extend({defaults:{arrowColor:Controller.COLORS.white,buttonColor:Controller.COLORS.blue,outlineColor:Controller.COLORS.charcoal,outlineWidth:3,x:0,y:0,r:80,"class":"up",isEnabled:!0},distance:function(t,e){return Math.max(Controller.Math.euclideanDistance(t,e,this.get("x"),this.get("y"))-this.get("r"),0)}}),Controller.CanvasArrowButtonView=Controller.CanvasComponentView.extend({render:function(){var t=this.model.get("x"),e=this.model.get("y"),n=this.model.get("r"),r=this.model.get("isEnabled")?this.model.get("buttonColor"):Controller.COLORS.darkgrey,i=this.model.get("isEnabled")?this.model.get("arrowColor"):Controller.COLORS.lightgrey;this.context.beginPath(),this.model.set({fillStyle:r}),this.context.imageSmoothingEnabled=!0,this.context.arc(t,e,n,0,2*Math.PI),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("fillStyle");var o="up"===this.model.get("class")?n:n*-1,s="up"===this.model.get("class")?n/8:n/8*-1;this.context.beginPath(),this.model.set({fillStyle:i}),this.context.moveTo(t-n/8,e-n/2+s),this.context.lineTo(t-n/8,e+n/2+s),this.context.lineTo(t+n/8,e+n/2+s),this.context.lineTo(t+n/8,e-n/2+s),Controller.CanvasComponentView.prototype.render.apply(this),this.context.beginPath(),this.context.moveTo(t,e-o/2+s),this.context.lineTo(t,e-o/2-o/3+s),this.context.lineTo(t-n/2,e-o/3+s),this.context.lineTo(t-n/2,e+s),Controller.CanvasComponentView.prototype.render.apply(this),this.context.beginPath(),this.context.moveTo(t,e-o/2+s),this.context.lineTo(t,e-o/2-o/3+s),this.context.lineTo(t+n/2,e-o/3+s),this.context.lineTo(t+n/2,e+s),Controller.CanvasComponentView.prototype.render.apply(this),this.model.unset("fillStyle")}}),Controller.CanvasPlusSignModel=Controller.CanvasComponentModel.extend({defaults:{size:5,lineWidth:4,strokeStyle:Controller.COLORS.charcoal,lineCap:"square",rotation:0}}),Controller.CanvasPlusSignView=Controller.CanvasComponentView.extend({render:function(){this.context.save(),this.context.lineWidth=this.model.get("lineWidth"),this.context.strokeStyle=this.model.get("strokeStyle"),this.context.beginPath(),this.context.lineCap=this.model.get("lineCap"),this.context.moveTo(this.model.get("x")-this.model.get("size")*Math.sin(this.model.get("rotation")*Math.PI/180),this.model.get("y")-this.model.get("size")*Math.cos(this.model.get("rotation")*Math.PI/180)),this.context.lineTo(this.model.get("x")+this.model.get("size")*Math.sin(this.model.get("rotation")*Math.PI/180),this.model.get("y")+this.model.get("size")*Math.cos(this.model.get("rotation")*Math.PI/180)),this.context.stroke(),this.context.closePath(),this.context.beginPath(),this.context.lineCap=this.model.get("lineCap"),this.context.moveTo(this.model.get("x")-this.model.get("size")*Math.sin((this.model.get("rotation")+90)*Math.PI/180),this.model.get("y")-this.model.get("size")*Math.cos((this.model.get("rotation")+90)*Math.PI/180)),this.context.lineTo(this.model.get("x")+this.model.get("size")*Math.sin((this.model.get("rotation")+90)*Math.PI/180),this.model.get("y")+this.model.get("size")*Math.cos((this.model.get("rotation")+90)*Math.PI/180)),this.context.stroke(),this.context.closePath(),this.context.restore()}}),Controller.CanvasTextWrapModel=Controller.CanvasComponentModel.extend({defaults:{textColor:Controller.COLORS.charcoal,strokeStyle:Controller.COLORS.charcoal,textStyle:"normal",textSize:"10px",textFont:"monospacetypewriterregular, monospace",lineWidth:0,textAlign:"center",textBaseline:"middle",textArray:[],w:30,offset:60,exact:!1},getHeight:function(){if(this.get("exact")){for(var t,e,n,r,i=document.createElement("canvas"),o=i.getContext("2d"),s=0,a=[],l=[];s<this.get("textArray").length;s++)if(a=this.get("textArray")[s].split(" "),1===a.length&&""===a[0])l.push(0);else{for(var h=0,c=0;h<a.length;h++)0===h&&(t=a[0],e=h!==a.length-1?" "+a[1]:"",n=o.measureText(t).width,r=o.measureText(e).width),h===a.length-1||r+n>this.get("w")?(t=h!==a.length-1?a[h+1]:"",e=h+2<=a.length-1?" "+a[h+2]:"",n=o.measureText(t).width,r=o.measureText(e).width,c++):(t+=e,e=h+2<=a.length-1?" "+a[h+2]:"",n=o.measureText(t).width,r=o.measureText(e).width);l.push(c)}o=null}else for(var t,e,n,r,u=Math.floor(2*this.get("w")/parseInt(this.get("textSize"))),s=0,a=[],l=[];s<this.get("textArray").length;s++)if(a=this.get("textArray")[s].split(" "),1===a.length&&""===a[0])l.push(0);else{for(var h=0,c=0;h<a.length;h++)0===h&&(t=a[0],e=h!==a.length-1?" "+a[1]:"",n=t.length,r=e.length),h===a.length-1||r+n>u?(t=h!==a.length-1?a[h+1]:"",e=h+2<=a.length-1?" "+a[h+2]:"",n=t.length,r=e.length,c++):(t+=e,e=h+2<=a.length-1?" "+a[h+2]:"",n=t.length,r=e.length);l.push(c)}return l.length?_.maxBy(l)*(parseInt(this.get("textSize"))+this.get("lineWidth")):0}}),Controller.CanvasTextWrapView=Controller.CanvasComponentView.extend({render:function(){this.context.fillStyle=this.model.get("textColor"),this.context.font=this.model.get("textStyle")+" "+this.model.get("textSize")+" "+this.model.get("textFont"),this.context.textAlign=this.model.get("textAlign"),this.context.textBaseline=this.model.get("textBaseline"),this.context.strokeStyle=this.model.get("strokeStyle"),this.context.lineWidth=this.model.get("lineWidth"),this.context.lineJoin="miter",this.context.miterLimit=2;var t=this.model.get("textArray"),e=this.model.get("lineWidth"),n=parseInt(this.model.get("textSize")+this.model.get("lineWidth")),r=e>0,i=this.model.get("w"),o=Math.floor(2*i/parseInt(this.model.get("textSize")));if(this.model.get("exact"))for(var s,a,l,h,c=0,u=[],d=this.model.get("x");c<t.length;c++){if(u=t[c].split(" "),1!==u.length||""!==u[0])for(var p=0,f=this.model.get("y");p<u.length;p++)0===p&&(s=u[0],a=p!==u.length-1?" "+u[1]:"",l=this.context.measureText(s).width,h=this.context.measureText(a).width),p===u.length-1||h+l>i?(this.context.save(),this.model.get("angle")&&(this.context.translate(d,f),this.context.rotate(this.model.get("angle")),d=0,f=0),r&&this.context.strokeText(s,d,f),this.context.fillText(s,d,f),this.context.restore(),s=p!==u.length-1?u[p+1]:"",a=p+2<=u.length-1?" "+u[p+2]:"",l=this.context.measureText(s).width,h=this.context.measureText(a).width,f+=n+e):(s+=a,a=p+2<=u.length-1?" "+u[p+2]:"",l=this.context.measureText(s).width,h=this.context.measureText(a).width);d+=this.model.get("offset")}else for(var s,a,l,h,c=0,u=[],d=this.model.get("x");c<t.length;c++){if(u=t[c].split(" "),1!==u.length||""!==u[0])for(var p=0,f=this.model.get("y");p<u.length;p++)0===p&&(s=u[0],a=p!==u.length-1?" "+u[1]:"",l=s.length,h=a.length),p===u.length-1||h+l>o?(this.context.save(),this.model.get("angle")&&(this.context.translate(d,f),this.context.rotate(this.model.get("angle")),d=0,f=0),r&&this.context.strokeText(s,d,f),this.context.fillText(s,d,f),this.context.restore(),s=p!==u.length-1?u[p+1]:"",a=p+2<=u.length-1?" "+u[p+2]:"",l=s.length,h=a.length,f+=n+e):(s+=a,a=p+2<=u.length-1?" "+u[p+2]:"",l=s.length,h=a.length);d+=this.model.get("offset")}}}),Controller.CanvasAxisBreakModel=Controller.CanvasComponentModel.extend({defaults:{x:0,y:0,clearColor:Controller.COLORS.lightblue,lineColor:Controller.COLORS.charcoal,axisBreakWidth:1,axis:"x"}}),Controller.CanvasAxisBreakView=Controller.CanvasComponentView.extend({render:function(){this.context.save(),this.model.set({lineWidth:1,strokeStyle:this.model.get("clearColor")}),this.context.beginPath(),"x"===this.model.get("axis")?(this.context.moveTo(this.model.get("x")+3,this.model.get("y")),
this.context.lineTo(this.model.get("x")+15,this.model.get("y")),this.context.closePath(),Controller.CanvasComponentView.prototype.render.apply(this),this.model.set({lineWidth:this.model.get("axisBreakWidth"),strokeStyle:this.model.get("lineColor")}),this.context.beginPath(),this.context.moveTo(this.model.get("x")+3,this.model.get("y")),this.context.lineTo(this.model.get("x")+6,this.model.get("y")-3),this.context.closePath(),Controller.CanvasComponentView.prototype.render.apply(this),this.context.beginPath(),this.context.moveTo(this.model.get("x")+6,this.model.get("y")-3),this.context.lineTo(this.model.get("x")+12,this.model.get("y")+3),this.context.closePath(),Controller.CanvasComponentView.prototype.render.apply(this),this.context.beginPath(),this.context.moveTo(this.model.get("x")+12,this.model.get("y")+3),this.context.lineTo(this.model.get("x")+15,this.model.get("y")),this.context.closePath(),Controller.CanvasComponentView.prototype.render.apply(this)):"y"===this.model.get("axis")&&(this.context.moveTo(this.model.get("x"),this.model.get("y")-3),this.context.lineTo(this.model.get("x"),this.model.get("y")-15),this.context.closePath(),Controller.CanvasComponentView.prototype.render.apply(this),this.model.set({lineWidth:this.model.get("axisBreakWidth"),strokeStyle:this.model.get("lineColor")}),this.context.beginPath(),this.context.moveTo(this.model.get("x"),this.model.get("y")-3),this.context.lineTo(this.model.get("x")+3,this.model.get("y")-6),this.context.closePath(),Controller.CanvasComponentView.prototype.render.apply(this),this.context.beginPath(),this.context.moveTo(this.model.get("x")+3,this.model.get("y")-6),this.context.lineTo(this.model.get("x")-3,this.model.get("y")-12),this.context.closePath(),Controller.CanvasComponentView.prototype.render.apply(this),this.context.beginPath(),this.context.moveTo(this.model.get("x")-3,this.model.get("y")-12),this.context.lineTo(this.model.get("x")+0,this.model.get("y")-15),this.context.closePath(),Controller.CanvasComponentView.prototype.render.apply(this)),this.context.restore()}}),Controller.CanvasCounterModel=Controller.CanvasComponentModel.extend({defaults:{strokeStyle:Controller.COLORS.charcoal,lineWidth:0,x:0,y:0,w:75,h:75}}),Controller.CanvasCounterView=Controller.CanvasComponentView.extend({render:function(){this.context.beginPath();var t=Math.min(this.model.get("w"),this.model.get("h"))/2,e=this.model.get("x")+this.model.get("w")/2,n=this.model.get("y")+this.model.get("h")/2;this.context.arc(e,n,t,0,2*Math.PI),Controller.CanvasComponentView.prototype.render.apply(this)}}),Controller.CanvasIntegerTileModel=Controller.CanvasComponentModel.extend({defaults:{positiveFillStyle:Controller.COLORS.yellow,negativeFillStyle:Controller.COLORS.red,textColor:Controller.COLORS.white,sign:"positive",x:0,y:0,w:46,h:46}}),Controller.CanvasIntegerTileView=Controller.CanvasComponentView.extend({render:function(){this.context.save();var t;switch(this.model.get("sign")){case"positive":this.context.fillStyle=this.model.get("positiveFillStyle"),t="";break;case"negative":this.context.fillStyle=this.model.get("negativeFillStyle"),t=""}this.context.beginPath();var e=Math.min(this.model.get("w"),this.model.get("h"))/2,n=this.model.get("x")+e,r=this.model.get("y")+e;this.context.arc(n,r,e,0,2*Math.PI),this.context.closePath(),this.context.fill(),this.context.fillStyle=this.model.get("textColor"),this.context.font="30px FontAwesome",this.context.textAlign="center",this.context.textBaseline="middle",this.context.fillText(t,n,r+2),this.context.restore()}}),Controller.CanvasOutlineModel=Controller.CanvasComponentModel.extend({defaults:{x:0,y:0,w:0,h:0,strokeStyle:Controller.COLORS.charcoal,lineWidth:2,lineStyle:"",dashAttributes:[10,10],dashOffset:5}}),Controller.CanvasOutlineView=Controller.CanvasComponentView.extend({render:function(){this.context.save();var t=this.model.get("x"),e=this.model.get("y"),n=this.model.get("w"),r=this.model.get("h");this.context.lineWidth=this.model.get("lineWidth"),this.context.strokeStyle=this.model.get("strokeStyle"),this.context.beginPath(),this.context.moveTo(t,e),this.context.lineTo(t+n,e),this.context.lineTo(t+n,e+r),this.context.lineTo(t,e+r),this.context.lineTo(t,e),"dashed"===this.model.get("lineStyle")&&(this.context.setLineDash(this.model.get("dashAttributes")),this.context.lineDashOffset=this.model.get("dashOffset")),this.context.stroke(),this.context.closePath(),this.context.restore()}}),Controller.CANVAS_COMPONENTS={rectangle:{model:Controller.CanvasRectangleModel,view:Controller.CanvasRectangleView},rounded_rectangle:{model:Controller.CanvasRoundedRectangleModel,view:Controller.CanvasRoundedRectangleView},grid:{model:Controller.CanvasGridModel,view:Controller.CanvasGridView},text:{model:Controller.CanvasTextModel,view:Controller.CanvasTextView},image:{model:Controller.CanvasImageModel,view:Controller.CanvasImageView},arrow:{model:Controller.CanvasArrowModel,view:Controller.CanvasArrowView},line:{model:Controller.CanvasLineModel,view:Controller.CanvasLineView},triangle:{model:Controller.CanvasTriangleModel,view:Controller.CanvasTriangleView},circle:{model:Controller.CanvasCircleModel,view:Controller.CanvasCircleView},shape:{model:Controller.CanvasShapeModel,view:Controller.CanvasShapeView},cylinder:{model:Controller.CanvasCylinderModel,view:Controller.CanvasCylinderView},cylindernet:{model:Controller.CanvasCylinderNetModel,view:Controller.CanvasCylinderNetView},fraction:{model:Controller.CanvasFractionModel,view:Controller.CanvasFractionView},fractionContainer:{model:Controller.CanvasFractionContainerModel,view:Controller.CanvasRectangleView},sphere:{model:Controller.CanvasSphereModel,view:Controller.CanvasSphereView},cone:{model:Controller.CanvasConeModel,view:Controller.CanvasConeView},conenet:{model:Controller.CanvasConeNetModel,view:Controller.CanvasConeNetView},squarebasedpyramid:{model:Controller.CanvasSquareBasedPyramidModel,view:Controller.CanvasSquareBasedPyramidView},squarebasedpyramidnet:{model:Controller.CanvasSquareBasedPyramidNetModel,view:Controller.CanvasSquareBasedPyramidNetView},triangularprism:{model:Controller.CanvasTriangularPrismModel,view:Controller.CanvasTriangularPrismView},triangularprismnet:{model:Controller.CanvasTriangularPrismNetModel,view:Controller.CanvasTriangularPrismNetView},rectangularprism:{model:Controller.CanvasRectangularPrismModel,view:Controller.CanvasRectangularPrismView},rectangularprismnet:{model:Controller.CanvasRectangularPrismNetModel,view:Controller.CanvasRectangularPrismNetView},triangularbasedpyramid:{model:Controller.CanvasTriangularBasedPyramidModel,view:Controller.CanvasTriangularBasedPyramidView},triangularbasedpyramidnet:{model:Controller.CanvasTriangularBasedPyramidNetModel,view:Controller.CanvasTriangularBasedPyramidNetView},fraction_circle:{model:Controller.CanvasFractionCircleModel,view:Controller.CanvasFractionCircleView},blend_colors:{model:Controller.CanvasBlendColorsModel,view:Controller.CanvasBlendColorsView},button:{model:Controller.CanvasButtonModel,view:Controller.CanvasButtonView},undo_button:{model:Controller.CanvasUndoButtonModel,view:Controller.CanvasUndoButtonView},arrow_button:{model:Controller.CanvasArrowButtonModel,view:Controller.CanvasArrowButtonView},plus_sign:{model:Controller.CanvasPlusSignModel,view:Controller.CanvasPlusSignView},text_wrap:{model:Controller.CanvasTextWrapModel,view:Controller.CanvasTextWrapView},axis_break:{model:Controller.CanvasAxisBreakModel,view:Controller.CanvasAxisBreakView},counter:{model:Controller.CanvasCounterModel,view:Controller.CanvasCounterView},integer_tile:{model:Controller.CanvasIntegerTileModel,view:Controller.CanvasIntegerTileView},outline:{model:Controller.CanvasOutlineModel,view:Controller.CanvasOutlineView},textBox:{model:Controller.CanvasTextBoxModel,view:Controller.CanvasTextBoxView},component:{model:Controller.CanvasComponentModel,view:Controller.CanvasComponentView}},Controller.CanvasComponentsCollection=Backbone.Collection.extend({initialize:function(t,e){this.controls=e.controls},model:function(t,e){return e.parse=!0,Controller.CANVAS_COMPONENTS[t.type]?new Controller.CANVAS_COMPONENTS[t.type].model(t,e):(console.warn("No model defined for control of type "+t.type),new Controller.CANVAS_COMPONENTS.component.model(t,e))},loadAssets:function(){var t=this,e=this.length,n=function(){0===e&&t.trigger("load-complete")},r=function(){e--,n()};this.forEach(function(t){t.once("loaded-assets",r),t.loadAssets()}),0===this.length&&n()},removeComponents:function(t,e){for(var n=0;n<t.length;n++)this.remove(t[n],{silent:!0});e&&e.silent||this.trigger("remove")},addComponents:function(t,e){for(var n=0;n<t.length;n++)this.add(t[n],{silent:!0});e&&e.silent||this.trigger("add")},getNearestComponent:function(t,e,n,r){r=_.isNumber(r)?r:30;var i=r,o=[];return this.each(function(r){_.isFunction(n)&&!n(r)||(r.distance(t,e)<i?(i=r.distance(t,e),o=[r]):r.distance(t,e)===i&&o.push(r))}),i<r?o.pop():null},sortByZIndex:function(){this.models=_.sortBy(this.models,function(t){return t.get("zIndex")||0})}}),Controller.CanvasComponentsView=Backbone.View.extend({tagName:"canvas",className:"control",initialize:function(t){this.views=[],this.el.width=t.canvasWidth,this.el.height=t.canvasHeight,this.listenTo(this.collection,"reset",this.remove)},render:function(t){var e=this.el.getContext("2d");for(e.clearRect(0,0,this.el.width,this.el.height);this.views.length>0;)this.views.pop().remove();this.collection.sortByZIndex(),this.collection.forEach(this.addComponent.bind(this))},addComponent:function(t,e){var n,r=this.el.getContext("2d");Controller.CANVAS_COMPONENTS[t.get("type")]?n=new(Controller.CANVAS_COMPONENTS[t.get("type")].view)({context:r,model:t}):(console.warn("No view defined for canvas component of type "+t.get("type")),n=new Controller.CANVAS_COMPONENTS.component.view({context:r,model:t})),n.render(),this.views.push(n)},remove:function(arguments){for(;this.views.length>0;)this.views.pop().remove();Backbone.View.prototype.remove.apply(this,arguments)}}),Controller.CanvasControlView=Controller.BaseControlView.extend({initialize:function(){if(this.componentsView=new Controller.CanvasComponentsView({collection:this.model.components,canvasWidth:this.model.get("w"),canvasHeight:this.model.get("h")}),this.model.isInputControl()){for(var t in this.canvasEvents)switch(function(t){this[this.canvasEvents[t]]=function(e,n){var r=this.$el.offset(),i=this.el.getBoundingClientRect().width/this.el.offsetWidth,o=(e.pageX-r.left)/i,s=(e.pageY-r.top)/i;n=$.extend(n,{}),n.normalizeControl=function(t,e){return{x:t-r.left/i,y:e-r.top/i}},n.normalizeManipulative=function(t,e){return{x:t+r.left/i,y:e+r.top/i}},this.model[this.canvasEvents[t]](o,s,n)}}.bind(this)(t),this.events=this.events||{},t){case"click":this.events[t.replace("click","mousedown")]=this.canvasEvents[t],this.events[t.replace("click","touchstart")]=this.canvasEvents[t];break;case"drag":this.events[t.replace("drag","mousemove")]=this.canvasEvents[t],this.events[t.replace("drag","touchmove")]=this.canvasEvents[t];case"drop":this.events[t.replace("drop","mouseup")]=this.canvasEvents[t],this.events[t.replace("drop","mouseleave")]=this.canvasEvents[t],this.events[t.replace("drop","touchend")]=this.canvasEvents[t];break;default:this.events[t]=this.canvasEvents[t]}this.listenTo(this.model.components,"add",this.render),this.listenTo(this.model.components,"remove",this.render),this.listenTo(this.model.components,"render",this.render),this.delegateEvents()}this.listenTo(this.model,"remove",this.remove),Controller.BaseControlView.prototype.initialize.call(this)},normalizeEventCoordinates:function(t){try{return t=QuestionInterface.Manipulatives.getEventCoordinates(t,this.$el.offset()),{x:t.x,y:t.y}}catch(e){t.preventDefault(),t=t.originalEvent||t;var n=this.$el.offset();return t.touches||t.changedTouches?(t=t.touches[0]||t.changedTouches[0],{x:t.pageX-n.left,y:t.pageY-n.top}):void 0!==t.offsetX&&void 0!==t.offsetY?{x:t.offsetX,y:t.offsetY}:{x:t.pageX-n.left,y:t.pageY-n.top}}},render:function(t){this.model.get("value")?this.componentsView.render(t):this.model.components.reset(),this.$el.html(this.componentsView.el),Controller.BaseControlView.prototype.render.apply(this)},remove:function(arguments){this.componentsView.remove(),Controller.BaseControlView.prototype.remove.apply(this,arguments)},_changeMcSelected:function(){this.model.get("_mcSelected")?(this.$el.css({overflow:"visible"}),this.$("canvas").addClass("mc-selected")):(this.$el.css({overflow:"hidden"}),this.$("canvas").removeClass("mc-selected"))},highlightCorrect:function(){this.$el.css({overflow:"visible"}),this.$("canvas").removeClass("highlight-incorrect").addClass("highlight-correct")},highlightIncorrect:function(){this.$el.css({overflow:"visible"}),this.$("canvas").removeClass("highlight-correct").addClass("highlight-incorrect")},removeHighlight:function(){this.$el.css({overflow:"hidden"}),this.$("canvas").removeClass("highlight-correct").removeClass("highlight-incorrect")}}),Controller.CanvasControlModel=Controller.BaseControlModel.extend({initialize:function(){this.components=new Controller.CanvasComponentsCollection([],{controls:this.collection}),this.listenTo(this,"remove",this.close),this.setup&&this.get("value")&&this.setup(),Controller.BaseControlModel.prototype.initialize.call(this)},parse:function(t){if(t.fractionFormat)switch(t.fractionFormat){case"decimal":t.fractionOptions={format:"decimal"};break;case"mixed":t.fractionOptions={format:"mixed"};break;case"mixed reduced":t.fractionOptions={format:"mixed",reduced:!0};break;case"improper":t.fractionOptions={format:"improper"};break;case"improper reduced":t.fractionOptions={format:"improper",reduced:!0}}return Controller.BaseControlModel.prototype.parse.call(this,t)},loadAssets:function(){this.components.once("load-complete",function(){this.trigger("loaded-assets")}.bind(this)),this.components.loadAssets()},close:function(){this.components.reset()},getUsedControlDimensions:function(){var t=_.minBy(this.components.map(function(t){return t.get("x")})),e=_.minBy(this.components.map(function(t){return t.get("y")})),n=_.maxBy(this.components.map(function(t){return t.get("x")+t.get("w")||0})),r=_.maxBy(this.components.map(function(t){return t.get("y")+t.get("h")||0})),i={x:t,y:e},o={x:n,y:r},s=n-t,a=r-e;return{topLeftCoordinates:i,bottomRightCoordinates:o,totalWidth:s,totalHeight:a}},validateCoordinates:function(){var t=this.getUsedControlDimensions();if(t.totalWidth>this.get("w")||t.totalHeight>this.get("h"))throw new Error("The control does not fit inside the specified w and h dimensions.")},centerControl:function(){this.validateCoordinates();var t=this.getUsedControlDimensions(),e=(this.get("w")-t.totalWidth)/2,n=(this.get("h")-t.totalHeight)/2;this.components.each(function(r){r.set({x:r.get("x")+e-t.topLeftCoordinates.x,y:r.get("y")+n-t.topLeftCoordinates.y})})}}),Controller.PlaceValueChartView=Controller.CanvasControlView.extend({initialize:function(t){Controller.CanvasControlView.prototype.initialize.apply(this,t)}}),Controller.PlaceValueChartModel=Controller.CanvasControlModel.extend({parse:function(t){var e=t.value;return e&&(e=e.replace(/\s+/g,"").replace(/'/g,"").replace("'","").split(","),t.format=e[0]||"",t.numbers=e.splice(1)||[]),Controller.CanvasControlModel.prototype.parse.call(this,t)},setup:function(){var t=this.get("format"),e=this.get("numbers"),n=this.get("answerIndex")||1,r=[],i=t.indexOf(".")!==-1,o=i?t.indexOf("."):t.length,s=i?t.length-t.indexOf(".")-1:0;i=i||this.get("value").indexOf(".")!==-1;for(var a,l=0;l<e.length;l++)a=e[l].split("."),a[0]=a[0]?a[0].length:0,a[1]=a[1]?a[1].length:0,r.push({before:a[0],after:a[1]}),o=Math.max(o,a[0]),s=Math.max(s,a[1]);(o>12||s>6)&&(console.warn("Up to 12 digits can be displayed before the decimal, and up to of 6 digits can be displayed after it."),console.warn("The values provided exceed these bounds. Digits before: "+o+",  Digits after: "+s),o=Math.min(o,12),s=Math.min(s,6));for(var h,l=0;l<e.length;l++){h=o-r[l].before;for(var c=0;c<h;c++)e[l]=" "+e[l];i&&e[l].indexOf(".")===-1&&(e[l]+=".")}var u={"-6":{label:"Millionths",color:Controller.COLORS.pastel_blue6,height:234},"-5":{label:"Hundred Thousandths",color:Controller.COLORS.pastel_blue5,height:234},"-4":{label:"Ten Thousandths",color:Controller.COLORS.pastel_blue4,height:187},"-3":{label:"Thousandths",color:Controller.COLORS.pastel_blue3,height:146},"-2":{label:"Hundredths",color:Controller.COLORS.pastel_blue2,height:133},"-1":{label:"Tenths",color:Controller.COLORS.pastel_blue1,height:87},0:{label:".",color:Controller.COLORS.white,height:40},1:{label:"Ones",color:Controller.COLORS.pastel_lightgreen,height:72},2:{label:"Tens",color:Controller.COLORS.pastel_green,height:72},3:{label:"Hundreds",color:Controller.COLORS.pastel_darkgreen,height:114},4:{label:"Thousands",color:Controller.COLORS.pastel_lightyellow,height:127},5:{label:"Ten Thousands",color:Controller.COLORS.pastel_yellow,height:168},6:{label:"Hundred Thousands",color:Controller.COLORS.pastel_darkyellow,height:215},7:{label:"Millions",color:Controller.COLORS.pastel_darkorange,height:215},8:{label:"Ten Millions",color:Controller.COLORS.pastel_orange,height:215},9:{label:"Hundred Millions",color:Controller.COLORS.pastel_lightorange,height:215},10:{label:"Billions",color:Controller.COLORS.pastel_lightpink,height:215},11:{label:"Ten Billions",color:Controller.COLORS.pastel_pink,height:215},12:{label:"Hundred Billions",color:Controller.COLORS.pastel_darkpink,height:215}},d=Math.max(u[o].height,u[-s].height,1),p=this.get("h")/(d+40*e.length),d=p*d,f=40*p,g=i?o+s+1:o,m=(this.get("w")-f*g)/2;this.get("w")<f*g&&console.warn("A width of at least "+Math.ceil(f*g)+"px is needed to properly display this PVC with the given height.");for(var l=o,x=m,y=d-10*p,v=21.33*p+"px";l>=(i?-s:1);l--)this.components.add({type:"rectangle",lineWidth:0,fillStyle:u[l].color,x:x,y:0,w:f,h:this.get("h")}),"."===u[l].label?this.components.add({type:"text",text:u[l].label,textSize:34.67*p+"px",x:x+f/2,y:y-15*p}):this.components.add({type:"text",text:u[l].label,textFont:"Roboto",textSize:v,textAlign:"left",angle:Math.PI/-2,x:x+f/2,y:y}),x+=f;this.components.add({type:"grid",numColumns:g,numRows:1,x:m,y:0,w:f*g,h:d}),this.components.add({type:"grid",numColumns:g,numRows:e.length,x:m,y:d,w:f*g,h:f*e.length});for(var C,w=1,l=0,y=d,v=34.67*p+"px";l<e.length;l++){C=e[l];for(var c=0,x=m;c<C.length;c++)""!==C[c]&&("_"===C[c]?this.components.add({type:"textBox",canvasControl:this,x:x+f/2,y:y+f/2,w:f-3,h:f-3,answerIndex:n,answerSubIndex:w++}):this.components.add({type:"text",text:C[c],textSize:v,x:x+f/2,y:y+f/2})),x+=f;y+=f}}}),Controller.MultiplicationGridView=Controller.CanvasControlView.extend({initialize:function(t){Controller.CanvasControlView.prototype.initialize.apply(this,t)}}),Controller.MultiplicationGridModel=Controller.CanvasControlModel.extend({parse:function(t){var e=t.value;return e&&(e=e.split(","),t.columnNum=e[0]||0,t.rowNum=e[1]||0),Controller.CanvasControlModel.prototype.parse.call(this,t)},defaults:{maxRow:12,maxColumn:12,bgColor:Controller.COLORS.white,axisLineColor:Controller.COLORS.charcoal,gridLineColor:Controller.COLORS.darkgrey,blockColor:Controller.COLORS.teal,selectedColor:Controller.COLORS.green},setup:function(){var t=this.get("h")/(this.get("maxRow")+1),e=this.get("w")/(this.get("maxColumn")+1);this.components.add({type:"grid",x:e,y:t,w:this.get("w")-e,h:this.get("h")-t,strokeStyle:this.get("gridLineColor"),numRows:this.get("maxRow"),numColumns:this.get("maxColumn")});for(var n=0;n<this.get("columnNum");n++)for(var r=0;r<this.get("rowNum");r++)n<this.get("columnNum")&&r<this.get("rowNum")&&this.components.add({type:"rectangle",x:(e-1/13)*(n+1)+3,y:(t-1/13)*(r+1)+3,w:e-5,h:t-5,fillStyle:this.get("blockColor"),lineWidth:0,"class":"block"});this.components.add({type:"grid",x:0,y:0,w:this.get("w"),h:t+1,strokeStyle:this.get("axisLineColor"),fillStyle:this.get("bgColor"),numRows:1,numColumns:this.get("maxColumn")+1}),this.components.add({type:"grid",x:0,y:0,w:e+1,h:this.get("h"),strokeStyle:this.get("axisLineColor"),fillStyle:this.get("bgColor"),numRows:this.get("maxRow")+1,numColumns:1});for(var n=0;n<=this.get("maxColumn");n++)this.components.add({type:"text",text:n,x:e/2+e*n,y:t/2,textSize:Math.min(16,t-6)+"px"});for(var n=1;n<=this.get("maxRow");n++)this.components.add({type:"text",text:n,x:Math.floor(e/2),y:Math.floor(t/2)+t*n,textSize:Math.min(16,t-6)+"px"})},clickBlock:function(t,e){var n=this.components.getNearestComponent(t,e,function(t){return"block"===t.get("class")});n&&(n.get("fillStyle")===this.get("blockColor")?n.set({fillStyle:this.get("selectedColor")}):n.set({fillStyle:this.get("blockColor")}))}}),Controller.NumberLineModel=Controller.CanvasControlModel.extend({parse:function(t){var e=t.value.replace(/\+/g,"").replace(/([^,\]\[]+)/g,function(t){return t=t.trim(),"''"===t?'""':(t=t.substring(t.startsWith("'")?1:0,t.endsWith("'")?t.length-1:t.length),isNaN(t)&&"true"!==t&&"false"!==t?'"'+t+'"':t)});return e=JSON.parse("["+e+"]"),e&&(t.start=new Controller.Math.RationalNumber(e[0]),t.finish=new Controller.Math.RationalNumber(e[1]),t.major=new Controller.Math.RationalNumber(e[3]),t.minor=new Controller.Math.RationalNumber(e[4]),t.questionNotHint=e[5],t.highlight=e[6]||[],t.jumps=e[7]||[],t.showJumpNumber=e[8],t.missingNumbers=e[9]||[],t.missingJumps=e[10]||[],t.fractionFormat||(Controller.Math.RationalNumber.existsFraction([e[0],e[1],e[3],e[4],e[6],e[7]])?t.fractionFormat="mixed":t.fractionFormat="decimal")),Controller.CanvasControlModel.prototype.parse.call(this,t)},defaults:{lineColor:Controller.COLORS.charcoal,addColor:Controller.COLORS.darkgreen,subtractColor:Controller.COLORS.purple,highlightColor:Controller.COLORS.blue,selectedPointColor:Controller.COLORS.darkorange,correctColor:Controller.COLORS.correctColor,incorrectColor:Controller.COLORS.incorrectColor,pointRadius:6,answerIndex:1},setup:function(){var t=this.get("w"),e=this.get("h")/2,n=this.get("major"),r=this.get("minor"),i=35,o=this.get("jumps"),s=this.get("highlight"),a=this.get("start"),l=this.get("finish"),h=this.get("answerIndex")||1,c=this.get("fractionOptions");this.get("questionNotHint")&&(a=a.subtract(n),l=l.add(n));var u=l.subtract(a),d=(t-2*i)/u.toFloat();this.components.add({type:"line",lineWidth:2,strokeStyle:this.get("lineColor"),xStart:0,yStart:e,xEnd:t,yEnd:e}),this.components.add({type:"triangle",fillStyle:this.get("lineColor"),x1:0,y1:e,x2:5,y2:e-5,x3:5,y3:e+5}),this.components.add({type:"triangle",fillStyle:this.get("lineColor"),x1:t,y1:e,x2:t-5,y2:e-5,x3:t-5,y3:e+5});for(var p=Math.floor(u.divide(r).toFloat()),f=0,g=i;f<=p;f++)this.components.add({type:"line","class":"minor",value:a.add(r.multiply(f)),lineWidth:2,xStart:g,yStart:e-4,xEnd:g,yEnd:e+4}),g+=r.multiply(d).toFloat();for(var m,x,y,v=Math.floor(u.divide(n).toFloat()),C=this.get("missingNumbers"),w=[],f=0;f<=v;f++)y=a.add(n.multiply(f)),x=_.find(C,function(t){return y.isEqual(t)}),void 0!==x?(m=C.indexOf(x),C[m]=void 0,w.push({label:"",value:x,index:m})):w.push({label:y,value:y});for(var g,b,f=0;f<C.length;f++)void 0!==C[f]&&(g=i+(t-2*i)*(Controller.Math.RationalNumber.parse(C[f])-a.toFloat())/u.toFloat(),b=this.components.add({type:"textBox",canvasControl:this,text:C[f],answerIndex:h,answerSubIndex:f+1,x:g,y:e+("decimal"===this.get("fractionFormat")?56:76)}),s.push([C[f],0]),this.components.add({type:"line",lineWidth:2,strokeStyle:this.get("highlightColor"),xStart:g,yStart:e,xEnd:g,yEnd:b.get("y")-b.get("h")/2}));for(var y,f=0,g=i;f<w.length;f++)this.components.add({type:"line","class":"major",value:w[f].value,xStart:g,yStart:e-8,xEnd:g,yEnd:e+8,lineWidth:2,fillStyle:this.get("lineColor")}),w[f].label?this.components.add({x:g,y:e+("decimal"===this.get("fractionFormat")?24:34),type:"text",text:w[f].label,textSize:"16px",textStyle:"bold",fractionOptions:c}):(this.components.add({type:"textBox",canvasControl:this,text:w[f].value,x:g,y:e+("decimal"===this.get("fractionFormat")?24:34),answerIndex:h,answerSubIndex:w[f].index+1}),s.push([w[f].value,0])),g+=d*n.toFloat();for(var M,S,f=0;f<s.length;f++)M=Controller.Math.RationalNumber.parse(s[f][0]),S=Controller.Math.RationalNumber.parse(s[f][1]),S<0?this.components.add({type:"arrow",lineWidth:4,strokeStyle:this.get("subtractColor"),xStart:i+d*(M-a.toFloat()),yStart:e,xEnd:i+d*(M-(a.toFloat()-S))+2,yEnd:e}):S>0?this.components.add({type:"arrow",lineWidth:4,strokeStyle:this.get("addColor"),xStart:i+d*(M-a.toFloat()),yStart:e,xEnd:i+d*(M-(a.toFloat()-S))-2,yEnd:e}):this.components.add({x:i+d*(M-a.toFloat()),y:e,r:this.get("pointRadius"),fillStyle:this.get("highlightColor"),type:"circle"});var E=$.extend({},c);E.signed=!0;for(var g,f=0;f<o.length;f++){g=i+d*(Controller.Math.RationalNumber.parse(o[f][0])-a.toFloat());for(var I,N=1;N<o[f].length;N++)I=new Controller.Math.RationalNumber(o[f][N]),I.isEqual(0)||this.components.add({type:"arrow",lineWidth:3,strokeStyle:I.isNegative?this.get("subtractColor"):this.get("addColor"),xStart:g,yStart:e-8,xMid:g+d*I.divide(2).toFloat(),yMid:e-58,xEnd:g+d*I.toFloat()+(I.isNegative?2:-2),yEnd:e-10}),this.get("showJumpNumber")&&this.components.add({x:g+d*(I.toFloat()/2),y:e-44+5,type:"text",text:I,fractionOptions:E,textBaseline:"bottom",textSize:"12px",textStyle:"bold"}),g+=d*I.toFloat()}var O=0;C.length>0&&h++;for(var g,f=0,T=this.get("missingJumps");f<T.length;f++){g=i+d*(Controller.Math.RationalNumber.parse(T[f][0])-a.toFloat());for(var I,b,N=1;N<T[f].length;N++)I=new Controller.Math.RationalNumber(T[f][N]),I.isEqual(0)||this.components.add({type:"arrow",lineWidth:3,strokeStyle:I.isNegative?this.get("subtractColor"):this.get("addColor"),xStart:g,yStart:e-8,xMid:g+d*(I.toFloat()/2),yMid:e-58,xEnd:g+d*I.toFloat()+(I.isNegative?2:-2),yEnd:e-10}),O++,b=this.components.add({type:"textBox",text:T[f][N].toString().replace("-",""),canvasControl:this,answerIndex:h,answerSubIndex:O,leadingText:I.isNegative?"-":"+",textSize:"12px",textColor:this.get("textColor"),textStyle:"bold",strokeStyle:this.get("textStroke"),x:g+d*(I.toFloat()/2),y:e-46-8}),g+=d*I.toFloat()}},drawPoint:function(t,e){var n=this.get("h")/2;if(Math.abs(e-n)<=30){var r=this.components.getNearestComponent(t,n,function(t){return"point"===t.get("class")||"major"===t.get("class")||"minor"===t.get("class")});r&&("point"===r.get("class")?this.components.remove(r):this.components.add({type:"circle","class":"point",value:r.get("value"),x:r.get("xStart"),y:n,r:this.get("pointRadius"),fillStyle:this.get("selectedPointColor")}))}},isValid:function(){return this.components.some(function(t){return"point"===t.get("class")})},isCorrect:function(t){var e=this.getData(t),n=this.getInput().input;return e.length===n.length&&_.every(e,function(t,e){return t=new Controller.Math.RationalNumber(t),t.isEqual(n[e])})},getData:function(t){if(this.isInputControl()){var e=this.get("answerIndex")||1;return this.get("missingNumbers").length&&e++,this.get("missingJumps").length&&e++,_.sortBy(t[e-1],function(t){return Controller.Math.RationalNumber.parse(t)})}return[]},getInput:function(){var t=this.get("answerIndex")||1;this.get("missingNumbers").length&&t++,this.get("missingJumps").length&&t++;var e=this.get("fractionFormat"),n=this.components.reduce(function(t,n){return"point"===n.get("class")&&("decimal"===e?t.push(n.get("value").toFloat()):t.push(n.get("value").toString())),t},[]);return{answerIndex:t,input:_.sortBy(n,function(t){return Controller.Math.RationalNumber.parse(t)})}},setInput:function(t){this.components.removeComponents(this.components.filter(function(t){return"point"===t.get("class")}),{silent:!0});for(var e,n,r=this.getData(t),i=[],o=0;o<r.length;o++)e=new Controller.Math.RationalNumber(r[o]),n=this.components.find(function(t){return("major"===t.get("class")||"minor"===t.get("class"))&&e.isEqual(t.get("value"))}),n&&i.push({type:"circle","class":"point",value:n.get("value"),x:n.get("xStart"),y:this.get("h")/2,r:this.get("pointRadius"),fillStyle:this.get("selectedPointColor"),lineWidth:2});this.components.addComponents(i)},displayAnswer:function(t){this.setInput(t),this.displayResult(t)},displayResult:function(t){for(var e,n,r=this.getData(t),i=this.components.filter(function(t){return"point"===t.get("class")}),o=[],s=0;s<i.length;s++)e=i[s],n=_.some(r,function(t){return t=new Controller.Math.RationalNumber(t),t.isEqual(e.get("value"))}),n?(this.components.remove(e,{silent:!0}),o.push({type:"circle","class":"point",value:e.get("value"),x:e.get("x"),y:e.get("y"),r:e.get("r"),fillStyle:this.get("correctColor"),lineWidth:0})):(this.components.remove(e,{silent:!0}),o.push({type:"circle","class":"point",value:e.get("value"),x:e.get("x"),y:e.get("y"),r:e.get("r"),fillStyle:this.get("incorrectColor"),lineWidth:0}));this.components.addComponents(o)}}),Controller.NumberLineView=Controller.CanvasControlView.extend({initialize:function(t){this.model.isInputControl()&&(this.canvasEvents={click:"drawPoint"}),Controller.CanvasControlView.prototype.initialize.apply(this,t)}}),Controller.GraphModel=Controller.CanvasControlModel.extend({parse:function(t){var e=t.value;return e&&(e=JSON.parse("["+e.replace(/'/g,'"').replace(/\(/g,"[").replace(/\)/g,"]").replace(/,/g,", ")+"]"),t.id=JSON.parse(e[0])||0,t.title=e[1]||"",t.xLabel=e[2]||"",t.xMin=JSON.parse(e[3])||0,t.xMax=JSON.parse(e[4])||100,t.xMajor=JSON.parse(e[5])||20,t.xMinor=JSON.parse(e[6])||10,t.yLabel=e[7]||"",t.yMin=JSON.parse(e[8])||0,t.yMax=JSON.parse(e[9])||100,t.yMajor=JSON.parse(e[10])||20,t.yMinor=JSON.parse(e[11])||10,2===t.id||3===t.id?(t.points=0,t.bars=[e[13]]||0,t.names=!1):4==t.id?(t.points=e[12]||0,t.bars=0,t.names=e[14]||!1):5==t.id||6==t.id?(t.points=0,t.bars=e[13]||0,t.names=e[14]||!1):(t.points=[e[12]]||0,t.bars=0,t.names=0)),Controller.CanvasControlModel.prototype.parse.call(this,t)},defaults:{labelFont:"Roboto",titleSize:19,axisLabelSize:16,barLabelSize:11,boxColor:Controller.COLORS.lightblue,graphColor:Controller.COLORS.white,minorStroke:Controller.COLORS.grey,majorStroke:Controller.COLORS.black},setup:function(){var t=Controller.COLORS,e=([t.purple,t.darkyellow,t.green,t.red,t.darkblue,t.orange,t.brown,t.navy,t.grey,t.lavender1],this.get("boxColor")),n=(this.get("graphColor"),this.get("minorStroke"),this.get("majorStroke"),[t.lightred,t.darkteal,t.darkpurple,t.darkorange,t.darknavy],this.get("labelFont")),r=this.get("id"),i=this.get("title"),o=this.get("xLabel"),s=(this.get("xMax"),this.get("xMin"),this.get("xMajor"),this.get("xMinor"),this.get("yLabel")),a=(this.get("yMax"),this.get("yMin"),this.get("yMajor"),this.get("yMinor"),this.get("points"),this.get("bars"),this.get("titleSize"));this.get("axisLabelSize"),this.get("barLabelSize"),this.get("names"),this.get("w")-60,this.get("h")-135,this.get("w")/2;if(this.components.add({x:0,y:0,w:this.get("w"),h:this.get("h"),type:"rectangle",fillStyle:e,lineWidth:2}),this.components.add({x:this.get("w")/2,y:35,type:"text",text:i,textSize:a+"px",textFont:n}),""==o||" "==o){40-this.get("axisLabelSize")/2}else;if(""==s||" "==s){40-this.get("axisLabelSize")}else;0==r||1==r||4==r?this.drawScatterOrLineGraph():2==r||5==r?this.drawVerticalBarGraph():3!=r&&6!=r||this.drawHorizontalBarGraph()},drawScatterOrLineGraph:function(){var t=Controller.COLORS,e=([t.purple,t.darkyellow,t.green,t.red,t.darkblue,t.orange,t.brown,t.navy,t.grey,t.lavender1],this.get("boxColor"),this.get("graphColor")),n=this.get("minorStroke"),r=this.get("majorStroke"),i=[t.lightred,t.darkteal,t.darkpurple,t.darkorange,t.darknavy],o=this.get("labelFont"),s=this.get("id"),a=this.get("title"),l=this.get("xLabel"),h=this.get("xMax"),c=this.get("xMin"),u=this.get("xMajor"),d=this.get("xMinor"),p=this.get("yLabel"),f=this.get("yMax"),g=this.get("yMin"),m=this.get("yMajor"),x=this.get("yMinor"),y=this.get("points"),v=(this.get("bars"),this.get("titleSize"),this.get("axisLabelSize")),C=this.get("barLabelSize"),w=this.get("names"),b=this.get("w")-60,M=this.get("h")-135;this.get("w")/2;if(""==a||" "==a)var S=25+this.get("titleSize")/2;else var S=0;if(""==l||" "==l)var E=40-this.get("axisLabelSize")/2;else var E=0;
if(""==p||" "==p)var I=40-this.get("axisLabelSize");else var I=0;var N=0,O=0;if(4==s){for(var T=0;T<w.length;T++)N<w[T].length*C*.5&&(N=w[T].length*C*.5);var O=N+C+20,_=w.length*C+10+5*(w.length-1)}b+=I-O-30,M+=E+S;var P=1/0,A=!1,k=1/0,R=!1;if(c>0){for(var z=0;z<y.length;z++)for(var B=0;B<y[z].length;B++)y[z][B][0]<P&&(P=y[z][B][0]);P-u>=c&&(A=!0,c-=u)}if(g>0){for(var L=0;L<y.length;L++)for(var D=0;D<y[L].length;D++)y[L][D][1]<k&&(k=y[L][D][1]);k-m>=g&&(R=!0,g-=m)}var W=h-c,F=f-g,V=M/F,q=b/W;this.components.add({x:60-I,y:70-S,w:b,h:M,type:"rectangle",fillStyle:e,lineWidth:1}),this.components.add({x:20,y:70-S+M/2,type:"text",text:p,textSize:v+"px",angle:-Math.PI/2,textFont:o}),this.components.add({x:60-E+b/2,y:M-S+115,type:"text",text:l,textSize:v+"px",textFont:o});for(var H=0;H<=F/m;H++)0==H&&1==R?(this.components.add({type:"line",xStart:60-I,yStart:70-S+M-3,xEnd:60-I,yEnd:70-S+M-15,strokeStyle:e}),this.components.add({type:"line",xStart:60-I,yStart:70-S+M-3,xEnd:60-I+3,yEnd:70-S+M-6}),this.components.add({type:"line",xStart:60-I+3,yStart:70-S+M-6,xEnd:60-I-3,yEnd:70-S+M-12}),this.components.add({type:"line",xStart:60-I-3,yStart:70-S+M-12,xEnd:60-I,yEnd:70-S+M-15}),this.components.add({x:55-I,y:70-S+M-m*V*H,textAlign:"right",type:"text",text:0,textSize:C+"px"})):this.components.add({x:55-I,y:70-S+M-m*V*H,textAlign:"right",type:"text",text:g+m*H,textSize:C+"px"});for(var U=1;U<Math.floor(F/x);U++)x*U%m==0?this.components.add({xStart:60-I+1,yStart:70-S+M-x*V*U,xEnd:60+b-I-1,yEnd:70-S+M-x*V*U,type:"line",lineWidth:1,strokeStyle:r}):this.components.add({xStart:60-I+1,yStart:70-S+M-x*V*U,xEnd:60+b-I-1,yEnd:70-S+M-x*V*U,type:"line",lineWidth:1,strokeStyle:n});for(var j=1;j<Math.floor(W/d);j++)d*j%u==0?this.components.add({xStart:60-I+d*q*j,yStart:70-S+M-1,xEnd:60-I+d*q*j,yEnd:70-S+1,type:"line",lineWidth:1,strokeStyle:r}):this.components.add({xStart:60-I+d*q*j,yStart:70-S+M-1,xEnd:60-I+d*q*j,yEnd:70-S+1,type:"line",lineWidth:1,strokeStyle:n});for(var $=0;$<=Math.floor(W/u);$++)0==$&&1==A?(this.components.add({type:"line",xStart:60-I+1+3,yStart:70-S+M,xEnd:60-I+1+15,yEnd:70-S+M,strokeStyle:e}),this.components.add({type:"line",xStart:60-I+1+3,yStart:70-S+M,xEnd:60-I+1+6,yEnd:70-S+M-3}),this.components.add({type:"line",xStart:60-I+1+6,yStart:70-S+M-3,xEnd:60-I+1+12,yEnd:70-S+M+3}),this.components.add({type:"line",xStart:60-I+1+12,yStart:70-S+M+3,xEnd:60-I+15,yEnd:70-S+M}),this.components.add({type:"text",x:61-I+u*q*$,y:70-S+7+M,text:0,textSize:C+"px"})):this.components.add({type:"text",x:61-I+u*q*$,y:70-S+7+M,text:c+u*$,textSize:C+"px"});for(var G=0;G<y.length;G++){for(var Y=0;Y<y[G].length-1;Y++)1!=s&&4!=s||this.components.add({type:"line",xStart:60-I+(y[G][Y][0]-c)*q,yStart:70-S+M-(y[G][Y][1]-g)*V,xEnd:60-I+(y[G][Y+1][0]-c)*q,yEnd:70-S+M-(y[G][Y+1][1]-g)*V,lineWidth:2,strokeStyle:i[G]}),this.components.add({x:60-I+(y[G][Y][0]-c)*q,y:70-S+M-(y[G][Y][1]-g)*V,r:4,fillStyle:i[G],type:"circle",lineWidth:0});this.components.add({x:60-I+(y[G][Y][0]-c)*q,y:70-S+M-(y[G][Y][1]-g)*V,r:4,fillStyle:i[G],type:"circle"})}if(4==s){var J=60-I+b+15,X=70-S+M/2-_/2;this.components.add({type:"rectangle",w:O,h:_,fillStyle:Controller.COLORS.white,x:J,y:X,lineWidth:1});for(var Z=0;Z<w.length;Z++)this.components.add({type:"rectangle",x:J+5,y:X+5+C*Z+5*Z,w:C,h:C,fillStyle:i[Z]}),this.components.add({type:"text",x:J+5+C+5,y:X+5+C/2+C*Z+5*Z,text:w[Z],textSize:C,textFont:o,textAlign:"left"})}},drawVerticalBarGraph:function(){var t=Controller.COLORS,e=[t.purple,t.darkyellow,t.green,t.red,t.darkblue,t.orange,t.brown,t.navy,t.grey,t.lavender1],n=(this.get("boxColor"),this.get("graphColor")),r=this.get("minorStroke"),i=this.get("majorStroke"),o=([t.lightred,t.darkteal,t.darkpurple,t.darkorange,t.darknavy],this.get("labelFont")),s=this.get("id"),a=this.get("title"),l=this.get("xLabel"),h=(this.get("xMax"),this.get("xMin"),this.get("xMajor"),this.get("xMinor"),this.get("yLabel")),c=this.get("yMax"),u=this.get("yMin"),d=this.get("yMajor"),p=this.get("yMinor"),f=(this.get("points"),this.get("bars")),g=(this.get("titleSize"),this.get("axisLabelSize")),m=this.get("barLabelSize"),x=this.get("names"),y=this.get("w")-60,v=this.get("h")-135;this.get("w")/2;if(""==a||" "==a)var C=25+this.get("titleSize")/2;else var C=0;if(""==l||" "==l)var w=40-this.get("axisLabelSize")/2;else var w=0;if(""==h||" "==h)var b=40-this.get("axisLabelSize");else var b=0;var M=0,S=0;if(5==s){for(var E=0;E<x.length;E++)M<x[E].length*m*.5&&(M=x[E].length*m*.5);var S=M+m+20,I=x.length*m+10+5*(x.length-1)}y+=b-S-30,v+=w+C;var N=1/0,O=!1;if(u>0){for(var T=0;T<f.length;T++)for(var _=0;_<f[T].length;_++)f[T][_][1]<N&&(N=f[T][_][1]);N-d>=u&&(O=!0,u-=d)}var P=c-u,A=v/(P+1);this.components.add({x:60-b,y:70-C,w:y,h:v,type:"rectangle",fillStyle:n,lineWidth:1}),this.components.add({x:20,y:70-C+v/2,type:"text",text:h,textSize:g+"px",angle:-Math.PI/2,textFont:o}),this.components.add({x:60-b+y/2,y:v-C+115,type:"text",text:l,textSize:g+"px",textFont:o});for(var k=0;k<=P/d;k++)0==k&&1==O?(this.components.add({type:"line",xStart:60-b,yStart:70-C+v-3,xEnd:60-b,yEnd:70-C+v-15,strokeStyle:n}),this.components.add({type:"line",xStart:60-b,yStart:70-C+v-3,xEnd:60-b+3,yEnd:70-C+v-6}),this.components.add({type:"line",xStart:60-b+3,yStart:70-C+v-6,xEnd:60-b-3,yEnd:70-C+v-12}),this.components.add({type:"line",xStart:60-b-3,yStart:70-C+v-12,xEnd:60-b,yEnd:70-C+v-15}),this.components.add({x:55-b,y:70-C+v-d*A*k,textAlign:"right",type:"text",text:0,textSize:m+"px"})):this.components.add({x:55-b,y:70-C+v-d*A*k,textAlign:"right",type:"text",text:u+d*k,textSize:m+"px"});for(var R=1;R<=Math.floor(P/p);R++)p*R%d==0?this.components.add({xStart:60-b+1,yStart:70-C+v-p*A*R,xEnd:60-b+y-1,yEnd:70-C+v-p*A*R,type:"line",lineWidth:1,strokeStyle:i}):this.components.add({xStart:60-b+1,yStart:70-C+v-p*A*R,xEnd:60-b+y-1,yEnd:70-C+v-p*A*R,type:"line",lineWidth:1,strokeStyle:r});for(var z=y/(10*f[0].length+f[0].length+1),B=10*z/f.length,L=0;L<f[0].length;L++){for(var D=0;D<f.length;D++)f[D][L][1]-u>0&&(5==s?this.components.add({type:"rectangle",x:60-b+B*(L*f.length+D)+z*(L+1),y:70-C+v-1,w:B,h:-(A*(f[D][L][1]-u))+1,lineWidth:1,fillStyle:e[D]}):this.components.add({type:"rectangle",x:60-b+B*(L*f.length+D)+z*(L+1),y:70-C+v-1,w:B,h:-(A*(f[D][L][1]-u))+1,lineWidth:1,fillStyle:e[L]}));if(f[0][L][0].indexOf(" ")!=-1)for(var W=f[0][L][0].split(" "),D=0;D<W.length;D++)this.components.add({type:"text",x:60-b+B/2*f.length+B*L*f.length+z*(L+1),y:77-C+v+11*D,text:W[D],textSize:m+"px",textFont:o});else this.components.add({type:"text",x:60-b+B/2*f.length+B*L*f.length+z*(L+1),y:77-C+v,text:f[0][L][0],textSize:m+"px",textFont:o});if(5==s){var F=60-b+y+15,V=70-C+v/2-I/2;this.components.add({type:"rectangle",w:S,h:I,fillStyle:Controller.COLORS.white,x:F,y:V,lineWidth:1});for(var D=0;D<x.length;D++)this.components.add({type:"rectangle",x:F+5,y:V+5+m*D+5*D,w:m,h:m,fillStyle:e[D]}),this.components.add({type:"text",x:F+5+m+5,y:V+5+m/2+m*D+5*D,text:x[D],textSize:m,textFont:o,textAlign:"left"})}}},drawHorizontalBarGraph:function(){var t=Controller.COLORS,e=[t.purple,t.darkyellow,t.green,t.red,t.darkblue,t.orange,t.brown,t.navy,t.grey,t.lavender1],n=(this.get("boxColor"),this.get("graphColor")),r=this.get("minorStroke"),i=this.get("majorStroke"),o=([t.lightred,t.darkteal,t.darkpurple,t.darkorange,t.darknavy],this.get("labelFont")),s=this.get("id"),a=this.get("title"),l=this.get("xLabel"),h=this.get("xMax"),c=this.get("xMin"),u=this.get("xMajor"),d=(this.get("xMinor"),this.get("yLabel")),p=this.get("yMax"),f=this.get("yMin"),g=this.get("yMajor"),m=this.get("yMinor"),x=(this.get("points"),this.get("bars")),y=(this.get("titleSize"),this.get("axisLabelSize")),v=this.get("barLabelSize"),C=this.get("names"),w=this.get("w")-60,b=this.get("h")-135;this.get("w")/2;if(""==a||" "==a)var M=25+this.get("titleSize")/2;else var M=0;if(""==l||" "==l)var S=40-this.get("axisLabelSize")/2;else var S=0;if(""==d||" "==d)var E=40-this.get("axisLabelSize");else var E=0;b+=E+M,w+=S;for(var I=0,N=0;N<x[0].length;N++)I<x[0][N][0].length*v*.5&&(I=x[0][N][0].length*v*.5);var O=0,T=0;if(6==s){for(var _=0;_<C.length;_++)O<C[_].length*v*.5&&(O=C[_].length*v*.5);var T=O+v+20,P=C.length*v+10+5*(C.length-1)}w-=I+T+30;var A=1/0,k=!1;if(f>0){for(var R=0;R<x.length;R++)for(var z=0;z<x[R].length;z++)x[R][z][1]<A&&(A=x[R][z][1]);A-g>=f&&(k=!0,f-=g)}var B=h-c,L=p-f,D=w/(L+1),W=b/(B+1);this.components.add({x:60-S+I,y:70-M,w:w,h:b,type:"rectangle",fillStyle:n,lineWidth:1}),this.components.add({x:20,y:70-M+b/2,type:"text",text:l,textSize:y+"px",angle:-Math.PI/2,textFont:o}),this.components.add({x:this.get("w")/2,y:b-M+115,type:"text",text:d,textSize:y+"px",textFont:o});for(var F=0;F<=Math.floor(L/g);F++)0==F&&1==k?(this.components.add({type:"line",xStart:60-S+I+1+3,yStart:70-M+b,xEnd:60-S+I+1+15,yEnd:70-M+b,strokeStyle:n}),this.components.add({type:"line",xStart:60-S+I+1+3,yStart:70-M+b,xEnd:60-S+I+1+6,yEnd:70-M+b-3}),this.components.add({type:"line",xStart:60-S+I+1+6,yStart:70-M+b-3,xEnd:60-S+I+1+12,yEnd:70-M+b+3}),this.components.add({type:"line",xStart:60-S+I+1+12,yStart:70-M+b+3,xEnd:60-S+I+15,yEnd:70-M+b}),this.components.add({type:"text",x:61-S+u*D*H,y:70-M+7+b,text:0,textSize:v+"px"})):this.components.add({type:"text",x:61-S+I+g*D*F,y:77-M+b,text:f+g*F,textSize:v+"px"});for(var V=1;V<=Math.floor(L/m);V++)m*V%g==0?this.components.add({xStart:60-S+I+m*D*V,yStart:70-M+b-1,xEnd:60-S+I+m*D*V,yEnd:70-M+1,type:"line",lineWidth:1,strokeStyle:i}):this.components.add({xStart:60-S+I+m*D*V,yStart:70-M+b-1,xEnd:60-S+I+m*D*V,yEnd:70-M+1,type:"line",lineWidth:1,strokeStyle:r});for(var q=0;q<x[0].length;q++){for(var H=0;H<x.length;H++)x[H][q][1]-f>0&&(5==s?this.components.add({type:"rectangle",x:60-S+G*(q*x.length+H)+$*(q+1),y:70-M+b-1,w:G,h:-(W*(x[H][q][1]-f))+1,lineWidth:1,fillStyle:e[V]}):this.components.add({type:"rectangle",x:60-S+G*(q*x.length+H)+$*(q+1),y:70-M+b-1,w:G,h:-(W*(x[H][q][1]-f))+1,lineWidth:1,fillStyle:e[F]}));if(x[0][q][0].indexOf(" ")!=-1)for(var U=x[0][q][0].split(" "),j=0;j<U.length;j++)this.components.add({type:"text",x:60-S+G/2*x.length+G*q*x.length+$*(q+1),y:77-M+b+11*j,text:U[j],textSize:v+"px",textFont:o});else this.components.add({type:"text",x:60-S+G/2*x.length+G*q*x.length+$*(q+1),y:77-M+b,text:x[0][q][0],textSize:v+"px",textFont:o})}for(var $=b/(10*x[0].length+x[0].length+1),G=10*$/x.length,Y=0;Y<x[0].length;Y++){for(var J=0;J<x.length;J++)x[J][Y][1]-f>0&&(6==s?this.components.add({type:"rectangle",x:60-S+I,y:70-M+G*(Y*x.length+J)+$*(Y+1),w:D*(x[J][Y][1]-f),h:G,lineWidth:1,fillStyle:e[J]}):this.components.add({type:"rectangle",x:60-S+I,y:70-M+G*(Y*x.length+J)+$*(Y+1),w:D*(x[J][Y][1]-f),h:G,lineWidth:1,fillStyle:e[Y]}));this.components.add({type:"text",x:60-S+I-3,y:70-M+(G/2*x.length+G*Y*x.length)+$*(Y+1),text:x[0][Y][0],textSize:v+"px",textFont:o,textAlign:"right"})}if(6==s){var X=60-S+I+w+15,Z=70-M+b/2-P/2;this.components.add({type:"rectangle",w:T,h:P,fillStyle:Controller.COLORS.white,x:X,y:Z,lineWidth:1});for(var Q=0;Q<C.length;Q++)this.components.add({type:"rectangle",x:X+5,y:Z+5+v*Q+5*Q,w:v,h:v,fillStyle:e[Q]}),this.components.add({type:"text",x:X+5+v+5,y:Z+5+v/2+v*Q+5*Q,text:C[Q],textSize:v,textFont:o,textAlign:"left"})}}}),Controller.GraphView=Controller.CanvasControlView.extend({initialize:function(t){Controller.CanvasControlView.prototype.initialize.apply(this,t)}}),Controller.PolygonModel=Controller.CanvasControlModel.extend({parse:function(t){var e=t.value;return e&&(e=JSON.parse("["+e.replace(/\s*,\s*/g,",").replace(/\(/g,"[").replace(/\)/g,"]").replace(/\[(,+)\]/g,"[]").replace(new RegExp("\\s*([^,\\s\\]\\[][^,\\]\\[]*)\\s*","g"),'"$1"')+"]"),t.id=e[0]||0,t.param1=e[1]||0,t.param2=e[2]||0,t.rotation=e[3]||0,t.color=_.isString(e[4])?Controller.COLORS[e[4].toLowerCase()]:"",t.labels=e[5],t.angleLabels=e[6]),Controller.CanvasControlModel.prototype.parse.call(this,t)},defaults:{labelFont:"Roboto",textSize:14,textColor:Controller.COLORS.white,fillStyle:Controller.COLORS.charcoal},setup:function(){switch(this.get("id")){case"0":this.drawLine();break;case"1":this.drawCircle();break;case"2":this.drawStar();break;case"3":this.drawRightAngleTriangle();break;case"4":this.drawRectangle();break;case"5":this.drawRegularPolygon();break;case"6":this.drawIrregularPolygon()}},drawLine:function(){var t=this.get("param1"),e=this.get("param2"),n=-this.get("rotation"),r=this.get("color"),i=t*Math.cos(n*(Math.PI/180)),o=t*Math.sin(n*(Math.PI/180));this.components.add({type:"line",xStart:(this.get("w")-i)/2,yStart:(this.get("h")-o)/2,xEnd:(this.get("w")+i)/2,yEnd:(this.get("h")+o)/2,lineWidth:e,strokeStyle:r})},drawCircle:function(){var t=this.get("textSize"),e=this.get("textColor"),n=this.get("fillStyle"),r=this.get("labelFont"),i=this.get("color"),o=this.get("param2"),s=Math.min(this.get("w"),this.get("h"))/2-10,a=this.get("labels")||"@";if(o<2)this.components.add({type:"circle",x:this.get("w")/2,y:this.get("h")/2,startAngle:0,endAngle:2*Math.PI,r:s,fillStyle:i});else for(var l=0;l<o;l++)this.components.add({type:"circle",x:this.get("w")/2,y:this.get("h")/2,centreLine:!0,startAngle:2*Math.PI/o*l,endAngle:2*Math.PI/o*(l+1),r:s,fillStyle:i});"@"!==a&&(this.components.add({type:"line",xStart:this.get("w")/2,yStart:this.get("h")/2,xEnd:this.get("w")/2+s,yEnd:this.get("h")/2}),this.components.add({type:"line",xStart:this.get("w")/2,yStart:this.get("h")/2-5,xEnd:this.get("w")/2,yEnd:this.get("h")/2+5}),this.components.add({type:"line",xStart:this.get("w")/2+s,yStart:this.get("h")/2-5,xEnd:this.get("w")/2+s,yEnd:this.get("h")/2+5}),this.components.add({type:"text",textFont:r,textColor:e,x:(this.get("w")+s)/2,y:this.get("h")/2+t,fillStyle:n,text:a,lineWidth:4}))},drawStar:function(){for(var t,e,n=this.get("color"),r=this.get("param2"),i=this.get("rotation")*Math.PI/180,o=this.get("w")/2,s=this.get("h")/2,a=Math.min(this.get("w"),this.get("h"))/2-10,l=a*(3-Math.sqrt(5))/2,h=[],c=0,u=Math.PI/2*3,d=Math.PI/r;c<r;c++)t=o+Math.cos(u+i)*a,e=s+Math.sin(u+i)*a,u+=d,h.push([t,e]),t=o+Math.cos(u+i)*l,e=s+Math.sin(u+i)*l,u+=d,h.push([t,e]);for(var p=_.map(h,0),f=_.map(h,1),g=(2*o-_.maxBy(p)-_.minBy(p))/2,m=(2*s-_.maxBy(f)-_.minBy(f))/2,x=0;x<h.length;x++)h[x][0]+=g,h[x][1]+=m;this.components.add({type:"shape",coordinates:h,fillStyle:n})},drawRightAngleTriangle:function(){var t=this.get("textSize"),e=this.get("textColor"),n=this.get("fillStyle"),r=this.get("labelFont"),i=this.get("color"),o=this.get("param1")||1,s=this.get("param2")||1,a=this.get("w")/2,h=this.get("h")/2,c=this.get("rotation")*Math.PI/180,u=this.get("labels")||[],d=[[0,0]],p=60;if(0==o||0==s)var f=this.get("w"),g=this.get("h");else if(o/s>this.get("w")/this.get("h"))var f=this.get("w"),g=f*s/o;else var g=this.get("h"),f=g*o/s;var m=(Math.atan(f/g)+c)%(2*Math.PI),x=Math.sqrt(Math.pow(f,2)+Math.pow(g,2)),y=x*Math.sin(m),v=x*Math.cos(m);d.push([y,v]),y=d[1][0]-f*Math.cos(c),v=d[1][1]+f*Math.sin(c),d.push([y,v]);for(var C=0,w=0,b=0,M=0,S=0;S<d.length;S++)d[S][0]>C&&(C=d[S][0]),d[S][1]>b&&(b=d[S][1]),d[S][0]<w&&(w=d[S][0]),d[S][1]<M&&(M=d[S][1]);for(var E=C-w,I=b-M,N=0,O=999999999,T=0,P=999999999,A=0;A<d.length;A++)N<d[A][0]&&(N=d[A][0]),O>d[A][0]&&(O=d[A][0]),T<d[A][1]&&(T=d[A][1]),P>d[A][1]&&(P=d[A][1]);for(var k=(2*a-N-O)/2,R=(2*h-T-P)/2,z=0;z<d.length;z++)d[z][0]+=k,d[z][1]+=R;var B=Math.min(this.get("w")/(E+p),this.get("h")/(I+p));for(l=0;l<d.length;l++)d[l][0]=a+(d[l][0]-a)*B,d[l][1]=h+(d[l][1]-h)*B;this.components.add({type:"shape",coordinates:d,fillStyle:i});var L=[Math.atan2(d[1][1]-d[0][1],d[1][0]-d[0][0]),Math.atan2(d[2][1]-d[1][1],d[2][0]-d[1][0]),Math.atan2(d[0][1]-d[2][1],d[0][0]-d[2][0])];if(this.components.add({type:"line",xStart:d[2][0]+15*Math.cos(L[2]),yStart:d[2][1]+15*Math.sin(L[2]),xEnd:d[2][0]+15*Math.cos(L[2])-15*Math.sin(L[2]),yEnd:d[2][1]+15*Math.sin(L[2])+15*Math.cos(L[2])}),this.components.add({type:"line",xStart:d[2][0]-15*Math.sin(L[2]),yStart:d[2][1]+15*Math.cos(L[2]),xEnd:d[2][0]+15*Math.cos(L[2])-15*Math.sin(L[2]),yEnd:d[2][1]+15*Math.sin(L[2])+15*Math.cos(L[2])}),!_.isEmpty(u))for(var D=0;D<u.length;D++)if(u[D]&&"@"!==u[D]){var W=Math.max(Math.sqrt(Math.pow(d[(D+1)%3][0]-d[D][0],2)+Math.pow(d[(D+1)%3][1]-d[D][1],2)),0);this.components.add({type:"line",xStart:d[D][0]+10*Math.sin(L[D]),yStart:d[D][1]-10*Math.cos(L[D]),xEnd:d[D][0]+10*Math.sin(L[D])+(W/2-10)*Math.cos(L[D]),yEnd:d[D][1]-10*Math.cos(L[D])+(W/2-10)*Math.sin(L[D]),lineWidth:1}),this.components.add({type:"line",xStart:d[(D+1)%3][0]+10*Math.sin(L[D]),yStart:d[(D+1)%3][1]-10*Math.cos(L[D]),xEnd:d[(D+1)%3][0]+10*Math.sin(L[D])-(W/2-10)*Math.cos(L[D]),yEnd:d[(D+1)%3][1]-10*Math.cos(L[D])-(W/2-10)*Math.sin(L[D]),lineWidth:1}),this.components.add({type:"line",xStart:d[D][0]+5*Math.sin(L[D]),yStart:d[D][1]-5*Math.cos(L[D]),xEnd:d[D][0]+15*Math.sin(L[D]),yEnd:d[D][1]-15*Math.cos(L[D]),lineWidth:1}),this.components.add({type:"line",xStart:d[(D+1)%3][0]+5*Math.sin(L[D]),yStart:d[(D+1)%3][1]-5*Math.cos(L[D]),xEnd:d[(D+1)%3][0]+15*Math.sin(L[D]),yEnd:d[(D+1)%3][1]-15*Math.cos(L[D]),lineWidth:1}),this.components.add({type:"text",textFont:r,x:d[D][0]+10*Math.sin(L[D])+W/2*Math.cos(L[D]),y:d[D][1]-10*Math.cos(L[D])+W/2*Math.sin(L[D]),text:u[D],textSize:t+"px",textColor:e,fillStyle:n,lineWidth:4})}},drawRectangle:function(){for(var t=this.get("textSize"),e=this.get("textColor"),n=this.get("fillStyle"),r=this.get("labelFont"),i=this.get("color"),o=this.get("param1"),s=this.get("param2"),a=this.get("rotation")*Math.PI/180,l=this.get("labels")||[],h=[a],c=[[0,0]],u=0,d=0,p=0;u<4;u++)u%2===0?(d+=o*Math.cos(a),p+=o*Math.sin(a)):(d+=s*Math.cos(a),p+=s*Math.sin(a)),a+=Math.PI/2,c.push([d,p]),h.push(a);var f=_.map(c,0),g=_.map(c,1),m=_.minBy(f),x=_.minBy(g),y=_.maxBy(f),v=_.maxBy(g),C=10,w=10;if(!_.isEmpty(l)){for(var b,M=0,u=0;u<l.length;u++)b=l[u].toString(),u%2===1&&"@"!==b&&b.length>M&&(M=b.length);C+=10*M,w+=t}for(var S=this.get("w"),E=this.get("h"),I=Math.min((S-2*C)/(y-m),(E-2*w)/(v-x)),N=(S-I*y-I*m)/2,O=(E-I*v-I*x)/2,T=0;T<c.length;T++)c[T][0]=I*c[T][0]+N,c[T][1]=I*c[T][1]+O;if(this.components.add({type:"shape",coordinates:c,fillStyle:i}),!_.isEmpty(l))for(var P=0;P<l.length;P++)if(l[P]&&"@"!==l[P]){var A=P%2?s*I:o*I;this.components.add({type:"line",xStart:c[P][0]+10*Math.sin(h[P]),yStart:c[P][1]-10*Math.cos(h[P]),xEnd:c[P][0]+10*Math.sin(h[P])+(A/2-10)*Math.cos(h[P]),yEnd:c[P][1]-10*Math.cos(h[P])+(A/2-10)*Math.sin(h[P]),lineWidth:1,strokeStyle:Controller.COLORS.charcoal}),this.components.add({type:"line",xStart:c[(P+1)%c.length][0]+10*Math.sin(h[P]),yStart:c[(P+1)%c.length][1]-10*Math.cos(h[P]),xEnd:c[(P+1)%c.length][0]+10*Math.sin(h[P])-(A/2-10)*Math.cos(h[P]),yEnd:c[(P+1)%c.length][1]-10*Math.cos(h[P])-(A/2-10)*Math.sin(h[P]),lineWidth:1,strokeStyle:Controller.COLORS.charcoal}),this.components.add({type:"line",xStart:c[P][0]+5*Math.sin(h[P]),yStart:c[P][1]-5*Math.cos(h[P]),xEnd:c[P][0]+15*Math.sin(h[P]),yEnd:c[P][1]-15*Math.cos(h[P]),lineWidth:1,strokeStyle:Controller.COLORS.charcoal}),this.components.add({type:"line",xStart:c[(P+1)%c.length][0]+5*Math.sin(h[P]),yStart:c[(P+1)%c.length][1]-5*Math.cos(h[P]),xEnd:c[(P+1)%c.length][0]+15*Math.sin(h[P]),yEnd:c[(P+1)%c.length][1]-15*Math.cos(h[P]),lineWidth:1,strokeStyle:Controller.COLORS.charcoal}),this.components.add({type:"text",textFont:r,x:c[P][0]+10*Math.sin(h[P])+A/2*Math.cos(h[P]),y:c[P][1]-10*Math.cos(h[P])+A/2*Math.sin(h[P]),text:l[P],textSize:t+"px",textColor:e,fillStyle:n,lineWidth:4})}},drawRegularPolygon:function(){var t=this.get("textSize"),e=this.get("textColor"),n=this.get("fillStyle"),r=this.get("labelFont"),i=this.get("color"),o=this.get("param2"),s=Math.PI/2*3,a=this.get("labels")||[],l=10,h=Math.min(this.get("w"),this.get("h"))/2,c=this.get("rotation")*Math.PI/180,u=[];if(!_.isEmpty(a)){for(var d,p=0,f=0;f<a.length;f++)d=a[f].toString(),"@"!==d&&d.length>p&&(p=d.length);l+=Math.max(5*p,t)}o%2===0&&(c+=Math.PI/o);for(var g,m,f=0;f<o;f++)g=Math.cos(s+c)*h,m=Math.sin(s+c)*h,s+=2*Math.PI/o,u.push([g,m]);for(var x=_.map(u,0),y=_.map(u,1),v=_.minBy(x),C=_.minBy(y),w=_.maxBy(x),b=_.maxBy(y),M=this.get("w"),S=this.get("h"),E=Math.min((M-2*l)/(w-v),(S-2*l)/(b-C)),I=(M-E*w-E*v)/2,N=(S-E*b-E*C)/2,O=0;O<u.length;O++)u[O][0]=E*u[O][0]+I,u[O][1]=E*u[O][1]+N;if(this.components.add({type:"shape",coordinates:u,fillStyle:i}),!_.isEmpty(a)){for(var T=Math.sqrt(Math.pow(u[0][0]-u[1][0],2)+Math.pow(u[0][1]-u[1][1],2)),P=0;P<o;P++)if(a[P]&&"@"!==a[P]){var A=c+2*Math.PI/o*(P+.5);if(o%2!==0)this.components.add({type:"line",xStart:u[P][0]+10*Math.sin(A),yStart:u[P][1]-10*Math.cos(A),xEnd:u[P][0]+10*Math.sin(A)+(T/2-10)*Math.cos(A),yEnd:u[P][1]-10*Math.cos(A)+(T/2-10)*Math.sin(A),lineWidth:1,strokeStyle:Controller.COLORS.charcoal}),this.components.add({type:"line",xStart:u[(P+1)%u.length][0]+10*Math.sin(A),yStart:u[(P+1)%u.length][1]-10*Math.cos(A),xEnd:u[(P+1)%u.length][0]+10*Math.sin(A)-(T/2-10)*Math.cos(A),yEnd:u[(P+1)%u.length][1]-10*Math.cos(A)-(T/2-10)*Math.sin(A),lineWidth:1,strokeStyle:Controller.COLORS.charcoal}),this.components.add({type:"line",xStart:u[P][0]+5*Math.sin(A),yStart:u[P][1]-5*Math.cos(A),xEnd:u[P][0]+15*Math.sin(A),yEnd:u[P][1]-15*Math.cos(A),lineWidth:1,strokeStyle:Controller.COLORS.charcoal}),this.components.add({type:"line",xStart:u[(P+1)%u.length][0]+5*Math.sin(A),yStart:u[(P+1)%u.length][1]-5*Math.cos(A),xEnd:u[(P+1)%u.length][0]+15*Math.sin(A),yEnd:u[(P+1)%u.length][1]-15*Math.cos(A),lineWidth:1,strokeStyle:Controller.COLORS.charcoal}),this.components.add({type:"text",textFont:r,x:u[P][0]+10*Math.sin(A)+T/2*Math.cos(A),y:u[P][1]-10*Math.cos(A)+T/2*Math.sin(A),text:a[P],textSize:t+"px",textColor:e,fillStyle:n,lineWidth:4});else{var A=c-Math.PI/o+2*Math.PI/o*P;this.components.add({type:"line",xStart:u[(P+u.length-1)%u.length][0]+10*Math.sin(A),yStart:u[(P+u.length-1)%u.length][1]-10*Math.cos(A),xEnd:u[(P+u.length-1)%u.length][0]+10*Math.sin(A)+(T/2-10)*Math.cos(A),yEnd:u[(P+u.length-1)%u.length][1]-10*Math.cos(A)+(T/2-10)*Math.sin(A),lineWidth:1,strokeStyle:Controller.COLORS.charcoal}),this.components.add({type:"line",xStart:u[(P+u.length)%u.length][0]+10*Math.sin(A),yStart:u[(P+u.length)%u.length][1]-10*Math.cos(A),xEnd:u[(P+u.length)%u.length][0]+10*Math.sin(A)-(T/2-10)*Math.cos(A),yEnd:u[(P+u.length)%u.length][1]-10*Math.cos(A)-(T/2-10)*Math.sin(A),lineWidth:1,strokeStyle:Controller.COLORS.charcoal}),this.components.add({type:"line",xStart:u[(P+u.length-1)%u.length][0]+5*Math.sin(A),yStart:u[(P+u.length-1)%u.length][1]-5*Math.cos(A),xEnd:u[(P+u.length-1)%u.length][0]+15*Math.sin(A),yEnd:u[(P+u.length-1)%u.length][1]-15*Math.cos(A),lineWidth:1,strokeStyle:Controller.COLORS.charcoal}),this.components.add({type:"line",xStart:u[(P+u.length)%u.length][0]+5*Math.sin(A),yStart:u[(P+u.length)%u.length][1]-5*Math.cos(A),xEnd:u[(P+u.length)%u.length][0]+15*Math.sin(A),yEnd:u[(P+u.length)%u.length][1]-15*Math.cos(A),lineWidth:1,strokeStyle:Controller.COLORS.charcoal}),this.components.add({type:"text",textFont:r,x:u[(P+u.length-1)%u.length][0]+10*Math.sin(A)+T/2*Math.cos(A),y:u[(P+u.length-1)%u.length][1]-10*Math.cos(A)+T/2*Math.sin(A),text:a[P],textSize:t+"px",textColor:e,fillStyle:n,lineWidth:4})}}if("3"===o&&4===a.length&&"@"!==a[3]){var k=T*Math.sqrt(3)/2,R=(u[1][0]+u[2][0])/2,z=(u[1][1]+u[2][1])/2;this.components.add({type:"line",xStart:u[0][0],yStart:u[0][1],xEnd:R,yEnd:z,lineWidth:1}),this.components.add({type:"line",xStart:R+15*Math.sin(c),yStart:z-15*Math.cos(c),xEnd:R+15*Math.sin(c)+15*Math.cos(c),yEnd:z-15*Math.cos(c)+15*Math.sin(c),lineWidth:1}),this.components.add({type:"line",xStart:R+15*Math.sin(c)+15*Math.cos(c),yStart:z-15*Math.cos(c)+15*Math.sin(c),xEnd:R+15*Math.cos(c),yEnd:z+15*Math.sin(c),lineWidth:1}),this.components.add({type:"text",textFont:r,x:u[0][0]-k/2*Math.sin(c)+16*Math.cos(c),y:u[0][1]+k/2*Math.cos(c)+16*Math.sin(c),text:a[3],textSize:t+"px",textColor:e,fillStyle:n,lineWidth:4})}}},drawIrregularPolygon:function(){var t=this.get("textSize"),e=this.get("textColor"),n=this.get("fillStyle"),r=this.get("labelFont"),i=this.get("color"),o=this.get("param1"),s=this.get("param2"),a=this.get("rotation")*Math.PI/180,l=this.get("labels")||[],h=this.get("angleLabels")||[],c=a,u=[c],d=[[0,0]],p=10;if(!_.isEmpty(l)){for(var f,g=0,m=0;m<l.length;m++)f=l[m].toString(),"@"!==f&&f.length>g&&(g=f.length);p+=Math.max(5*g,t)}for(var m=0,x=0,y=0;m<o.length;m++)x+=o[m]*Math.cos(c),y+=o[m]*Math.sin(c),c+=(180-s[m])*Math.PI/180,d.push([x,y]),u.push(c);for(var v=_.map(d,0),C=_.map(d,1),w=_.minBy(v),b=_.minBy(C),M=_.maxBy(v),S=_.maxBy(C),E=this.get("w"),I=this.get("h"),N=Math.min((E-2*p)/(M-w),(I-2*p)/(S-b)),O=(E-N*M-N*w)/2,T=(I-N*S-N*b)/2,P=0;P<d.length;P++)d[P][0]=N*d[P][0]+O,d[P][1]=N*d[P][1]+T;if(this.components.add({type:"shape",coordinates:d,fillStyle:i}),!_.isEmpty(l))for(var A=0;A<o.length;A++)if(l[A]&&"@"!==l[A]){var k=Math.max(o[A]*N,0);this.components.add({type:"line",xStart:d[A][0]+10*Math.sin(u[A]),yStart:d[A][1]-10*Math.cos(u[A]),xEnd:d[A][0]+10*Math.sin(u[A])+(k/2-10)*Math.cos(u[A]),yEnd:d[A][1]-10*Math.cos(u[A])+(k/2-10)*Math.sin(u[A]),lineWidth:1,strokeStyle:Controller.COLORS.charcoal}),this.components.add({type:"line",xStart:d[(A+1)%d.length][0]+10*Math.sin(u[A]),yStart:d[(A+1)%d.length][1]-10*Math.cos(u[A]),xEnd:d[(A+1)%d.length][0]+10*Math.sin(u[A])-(k/2-10)*Math.cos(u[A]),yEnd:d[(A+1)%d.length][1]-10*Math.cos(u[A])-(k/2-10)*Math.sin(u[A]),lineWidth:1,strokeStyle:Controller.COLORS.charcoal}),this.components.add({type:"line",xStart:d[A][0]+5*Math.sin(u[A]),yStart:d[A][1]-5*Math.cos(u[A]),xEnd:d[A][0]+15*Math.sin(u[A]),yEnd:d[A][1]-15*Math.cos(u[A]),lineWidth:1,strokeStyle:Controller.COLORS.charcoal}),this.components.add({type:"line",xStart:d[(A+1)%d.length][0]+5*Math.sin(u[A]),yStart:d[(A+1)%d.length][1]-5*Math.cos(u[A]),xEnd:d[(A+1)%d.length][0]+15*Math.sin(u[A]),yEnd:d[(A+1)%d.length][1]-15*Math.cos(u[A]),lineWidth:1,strokeStyle:Controller.COLORS.charcoal}),this.components.add({type:"text",textFont:r,x:d[A][0]+10*Math.sin(u[A])+k/2*Math.cos(u[A]),y:d[A][1]-10*Math.cos(u[A])+k/2*Math.sin(u[A]),text:l[A],textSize:t+"px",textColor:e,fillStyle:n,lineWidth:4})}if(l.length>s.length&&d.length>3)if(4===d.length&&l.length>=4&&"@"!==l[3])z=o[1]*N*Math.sin(s[0]*Math.PI/180),this.components.add({type:"line",xStart:d[2][0],yStart:d[2][1],xEnd:d[2][0]-z*Math.sin(a-Math.PI),yEnd:d[2][1]+z*Math.cos(a-Math.PI),lineWidth:1}),this.components.add({type:"line",xStart:d[2][0]-(z-15)*Math.sin(a-Math.PI),yStart:d[2][1]+(z-15)*Math.cos(a-Math.PI),xEnd:d[2][0]-(z-15)*Math.sin(a-Math.PI)-15*Math.cos(a),yEnd:d[2][1]+(z-15)*Math.cos(a-Math.PI)-15*Math.sin(a),lineWidth:1}),this.components.add({type:"line",xStart:d[2][0]-z*Math.sin(a-Math.PI),yStart:d[2][1]+z*Math.cos(a-Math.PI),xEnd:d[2][0]-z*Math.sin(a-Math.PI)-15*Math.cos(a),yEnd:d[2][1]+z*Math.cos(a-Math.PI)-15*Math.sin(a),lineWidth:1}),this.components.add({type:"line",xStart:d[2][0]-(z-15)*Math.sin(a-Math.PI)-15*Math.cos(a),yStart:d[2][1]+(z-15)*Math.cos(a-Math.PI)-15*Math.sin(a),xEnd:d[2][0]-z*Math.sin(a-Math.PI)-15*Math.cos(a),yEnd:d[2][1]+z*Math.cos(a-Math.PI)-15*Math.sin(a),lineWidth:1}),this.components.add({type:"text",textFont:r,x:d[2][0]-z/2*Math.sin(a-Math.PI)+16*Math.cos(a-Math.PI),y:d[2][1]+z/2*Math.cos(a-Math.PI)+16*Math.sin(a-Math.PI),text:l[3],textSize:t+"px",textColor:e,fillStyle:n,lineWidth:4});else if(5===d.length){var R=o[3]*N*Math.abs(Math.cos(u[1]-a)),z=o[1]*N*Math.sin(s[2]*Math.PI/180);if(l.length>=5&&"@"!==l[4]&&(this.components.add({type:"line",xStart:d[0][0],yStart:d[0][1],xEnd:d[0][0]-z*Math.sin(a),yEnd:d[0][1]+z*Math.cos(a),lineWidth:1}),this.components.add({type:"line",xStart:d[0][0]-(z-15)*Math.sin(a),yStart:d[0][1]+(z-15)*Math.cos(a),xEnd:d[0][0]-(z-15)*Math.sin(a)+15*Math.cos(a),yEnd:d[0][1]+(z-15)*Math.cos(a)-15*Math.sin(a),lineWidth:1}),this.components.add({type:"line",xStart:d[0][0]-z*Math.sin(a),yStart:d[0][1]+z*Math.cos(a),xEnd:d[0][0]-z*Math.sin(a)+15*Math.cos(a),yEnd:d[0][1]+z*Math.cos(a)-15*Math.sin(a),lineWidth:1}),this.components.add({type:"line",xStart:d[0][0]-(z-15)*Math.sin(a)+15*Math.cos(a),yStart:d[0][1]+(z-15)*Math.cos(a)-15*Math.sin(a),xEnd:d[0][0]-z*Math.sin(a)+15*Math.cos(a),yEnd:d[0][1]+z*Math.cos(a)-15*Math.sin(a),lineWidth:1}),this.components.add({type:"text",textFont:r,x:d[0][0]-z/2*Math.sin(a)+16*Math.cos(a),y:d[0][1]+z/2*Math.cos(a)-16*Math.sin(a),text:l[4],textSize:t+"px",textColor:e,fillStyle:n,lineWidth:4})),l.length>=6&&"@"!==l[5]){var B=o[2]*N-R;this.components.add({type:"line",xStart:d[2][0]+10*Math.sin(u[2]),yStart:d[2][1]-10*Math.cos(u[2]),xEnd:d[2][0]+10*Math.sin(u[2])+(B/2-10)*Math.cos(u[2]),yEnd:d[2][1]-10*Math.cos(u[2])+(B/2-10)*Math.sin(u[2]),lineWidth:1,strokeStyle:Controller.COLORS.charcoal}),this.components.add({type:"line",xStart:d[3][0]+10*Math.sin(u[2])-R*Math.cos(u[2]),yStart:d[3][1]-10*Math.cos(u[2])-R*Math.sin(u[2]),xEnd:d[3][0]+10*Math.sin(u[2])-(R+B/2-10)*Math.cos(u[2]),yEnd:d[3][1]-10*Math.cos(u[2])-(R+B/2-10)*Math.sin(u[2]),lineWidth:1,strokeStyle:Controller.COLORS.charcoal}),this.components.add({type:"line",xStart:d[2][0]+5*Math.sin(u[2]),yStart:d[2][1]-5*Math.cos(u[2]),xEnd:d[2][0]+15*Math.sin(u[2]),yEnd:d[2][1]-15*Math.cos(u[2]),lineWidth:1,strokeStyle:Controller.COLORS.charcoal}),this.components.add({type:"line",xStart:d[3][0]+5*Math.sin(u[2])-R*Math.cos(u[2]),yStart:d[3][1]-5*Math.cos(u[2])-R*Math.sin(u[2]),xEnd:d[3][0]+15*Math.sin(u[2])-R*Math.cos(u[2]),yEnd:d[3][1]-15*Math.cos(u[2])-R*Math.sin(u[2]),lineWidth:1,strokeStyle:Controller.COLORS.charcoal}),this.components.add({type:"text",textFont:r,x:d[2][0]+10*Math.sin(u[A])+B/2*Math.cos(u[2]),y:d[2][1]-10*Math.cos(u[2])+B/2*Math.sin(u[2]),text:l[5],textSize:t+"px",textColor:e,fillStyle:n,lineWidth:4})}}if(!_.isEmpty(h))for(var L=0;L<u.length;L++)if(1==h[L]){var D=(u[L]+u[L+1])/2;90!=s[L]?(this.components.add({type:"circle",r:15,x:d[(L+1)%d.length][0],y:d[(L+1)%d.length][1],startAngle:u[(L+1)%d.length],endAngle:u[(L+1)%d.length]+s[L]*Math.PI/180,lineWidth:2}),this.components.add({type:"text",textFont:r,x:d[(L+1)%d.length][0]-15*Math.sin(D)-7/12*t*((s[L]+"").length+1)/2*Math.sin(D),y:d[(L+1)%d.length][1]+15*Math.cos(D)+t/2*Math.cos(D),text:s[L]+"°",textSize:"12px",textColor:e,fillStyle:n,lineWidth:4})):(this.components.add({type:"line",xStart:d[(L+1)%d.length][0]+15*Math.cos(u[(L+1)%d.length]),yStart:d[(L+1)%d.length][1]+15*Math.sin(u[(L+1)%d.length]),xEnd:d[(L+1)%d.length][0]+15*Math.cos(u[(L+1)%d.length])-15*Math.sin(u[(L+1)%d.length]),yEnd:d[(L+1)%d.length][1]+15*Math.sin(u[(L+1)%d.length])+15*Math.cos(u[(L+1)%d.length])}),this.components.add({type:"line",xStart:d[(L+1)%d.length][0]-15*Math.sin(u[(L+1)%d.length]),yStart:d[(L+1)%d.length][1]+15*Math.cos(u[(L+1)%d.length]),xEnd:d[(L+1)%d.length][0]+15*Math.cos(u[(L+1)%d.length])-15*Math.sin(u[(L+1)%d.length]),yEnd:d[(L+1)%d.length][1]+15*Math.sin(u[(L+1)%d.length])+15*Math.cos(u[(L+1)%d.length])}))}}}),Controller.PolygonView=Controller.CanvasControlView.extend({initialize:function(t){Controller.CanvasControlView.prototype.initialize.apply(this,t)}}),Controller.SpinnerModel=Controller.CanvasControlModel.extend({parse:function(t){var e=t.value;return e&&(e=e.replace(/\s*,\s*/g,",").split("),(").join(",,").split(",(").join(",,").split("),").join(",,").split(")").join(",,").split(",,"),t.pointPosition=JSON.parse(e[0])||0,t.labels=e[1].split(",")||["this","is","a","label"],t.colors=e[2].split(",")||["green","red","blue","yellow"],t.merge=e[3]||0),Controller.CanvasControlModel.prototype.parse.call(this,t)},defaults:{bgColor:"#927051",textColor:"white",addColor:"green",subtractColor:"red"},setup:function(){var t=this.get("pointPosition"),e=this.get("labels"),n=this.get("colors"),r=this.get("merge"),i=e.length,o=360/i*Math.PI/180,s=999;if(this.get("w")>this.get("h"))var a=this.get("h")/300;else var a=this.get("w")/300;for(var l=16*a,h="Roboto",c=148*a,u=90*a,d=40*a,p=this.get("w")/2,f=this.get("h")/2,g=0;g<e.length;g++){var m=g,x=g+1;if(1==r&&g<s){if(0==g&&e[g]==e[i-1]&&n[g]==n[i-1])for(m--,s=i+m;e[s]==e[s-1]&&n[s]==n[s-1];)m--,s=i+m;for(;e[g]==e[g+1]&&n[g]==n[g+1]&&x!=s;)x++,g++;var y=(m+x)/2*o,v=u*Math.cos(y-Math.PI/2),C=u*Math.sin(y-Math.PI/2);if(i>=t&&t>=i+m+1||t>0&&t<=x||t>m&&t<=x&&0!=t)var w=y;
this.components.add({type:"circle",x:p,y:f,r:c,startAngle:-Math.PI/2+m*o,endAngle:-Math.PI/2+x*o,stroke:!0,centreLine:0!=s,fillStyle:Controller.COLORS[n[g].toLowerCase()]}),"@"!=e[g]&&this.components.add({type:"text",text:e[g],x:p+v,y:f+C,textFont:h,textSize:l+"px"})}else if(1!=r){var y=(m+x)/2*o,v=u*Math.cos(y-Math.PI/2),C=u*Math.sin(y-Math.PI/2);if(t>m&&t<=x&&0!=t)var w=y;this.components.add({type:"circle",x:p,y:f,r:c,startAngle:-Math.PI/2+m*o,endAngle:-Math.PI/2+x*o,stroke:!0,centreLine:i>1,fillStyle:Controller.COLORS[n[g].toLowerCase()]}),"@"!=e[g]&&this.components.add({type:"text",text:e[g],x:p+v,y:f+C,textFont:h,textSize:l+"px",textStyle:"bold",textColor:Controller.COLORS.white})}}if(0==t)this.components.add({type:"line",xStart:p,yStart:f,xEnd:p,yEnd:f-d,lineWidth:4*a}),this.components.add({type:"triangle",x1:p-5*a,x2:p+5*a,x3:p,y1:f-d+10*a,y2:f-d+10*a,y3:f-d,lineWidth:0,fillStyle:Controller.COLORS.charcoal});else{var b=d*Math.cos(w-Math.PI/2),M=d*Math.sin(w-Math.PI/2);this.components.add({type:"line",xStart:p,yStart:f,xEnd:p+b,yEnd:f+M,lineWidth:4*a});var S=p+b-5*Math.cos(w)*a,E=p+b+5*Math.cos(w)*a,I=p+(d+10*a)*Math.cos(w-Math.PI/2),N=f+M-5*Math.sin(w)*a,O=f+M+5*Math.sin(w)*a,T=f+(d+10*a)*Math.sin(w-Math.PI/2);this.components.add({type:"triangle",x1:S,x2:E,x3:I,y1:N,y2:O,y3:T,lineWidth:0,fillStyle:Controller.COLORS.charcoal})}this.components.add({type:"circle",x:p,y:f,r:5*a,lineWidth:5*a,fillStyle:Controller.COLORS.white,stroke:!0,startAngle:2*Math.PI,endAngle:0,strokeStyle:Controller.COLORS.charcoal})}}),Controller.SpinnerView=Controller.CanvasControlView.extend({initialize:function(t){Controller.CanvasControlView.prototype.initialize.apply(this,t)}}),Controller.CoinModel=Controller.CanvasControlModel.extend({parse:function(t){var e=t.value;return e&&(e=e.split(","),t.order="true"===e[6]||!1,t.ID=JSON.parse(e[7])||1,e.pop(),e.pop(),t.coins=e.map(Number)),Controller.CanvasControlModel.prototype.parse.call(this,t)},defaults:{bgColor:"#927051",textColor:"white",addColor:"green",subtractColor:"red"},setup:function(){var t=this.get("coins"),e=this.get("order"),n=this.get("ID"),r=this.get("w")/2,i=this.get("h")/2;if(1==n)var o=[Controller.IMAGE_PATH+"ToonieBack.gif",looniePath=Controller.IMAGE_PATH+"LoonieBack.gif",quarterPath=Controller.IMAGE_PATH+"QuarterBack.gif",dimePath=Controller.IMAGE_PATH+"DimeBack.gif",nickelPath=Controller.IMAGE_PATH+"NickelBack.gif",penniePath=Controller.IMAGE_PATH+"PennyBack.gif"],s=58;else var o=["","",Controller.IMAGE_PATH+"usquarterFront.gif",Controller.IMAGE_PATH+"usdimeFront.gif",Controller.IMAGE_PATH+"usnickelFront.gif",Controller.IMAGE_PATH+"uspennyFront.gif"],s=64;for(var a=0,l=0;l<t.length;l++)a+=t[l];var h=Math.floor(this.get("w")/s),c=Math.ceil(a/h);if(1==c)var u=a*s;else var u=h*s;var d=r-u/2,p=i-c*s/2,f=0;if(1==e)for(var g=0;g<t.length;g++)for(var m=0;m<t[g];m++)this.components.add({type:"image",source:o[g],xTranslate:d+s*(f%h),yTranslate:p+s*Math.floor(f/h),w:s,h:s}),f++;else if(0==e){for(var x=[],y=0,v=0;v<t.length;v++)t[v]>0&&x.push(v);for(var C=0;C<a;C++){var w=x[Math.floor(Math.random()*(x.length-y))];if(""==o[w]&&(a--,C--),this.components.add({type:"image",source:o[w],xTranslate:d+s*(C%h),yTranslate:p+s*Math.floor(C/h),w:s,h:s}),1==t[w]){t[w]--;for(var b=x.indexOf(w);b<x.length-1;b++)x[b]=x[b+1];y++}else t[w]--}}}}),Controller.CoinView=Controller.CanvasControlView.extend({initialize:function(t){Controller.CanvasControlView.prototype.initialize.apply(this,t)}}),Controller.AngleModel=Controller.CanvasControlModel.extend({parse:function(t){var e=t.value;return e&&(e=e.split(","),t.angle=JSON.parse(e[0])||0,t.label="true"===e[1]||!1,t.rotation=JSON.parse(e[2])||0),Controller.CanvasControlModel.prototype.parse.call(this,t)},defaults:{labelSize:12,lineWidth:2},setup:function(){var t=this.get("angle")*Math.PI/180,e=this.get("label"),n=this.get("rotation")*Math.PI/180,r=this.get("w")/2,i=this.get("h")/2;if(this.get("w")>this.get("h"))var o=this.get("h")/2;else var o=this.get("w")/2;var s=o/75,a=this.get("labelSize")*s,l=this.get("lineWidth")*s;r-=Math.cos(-n-t)>=0&&Math.cos(-n)>=0?Math.max(Math.cos(-n-t),Math.cos(-n))*o/2:Math.cos(-n-t)<=0&&Math.cos(-n)<=0?Math.max(Math.cos(-n-t),Math.cos(-n))*o/2:(Math.cos(-n-t)+Math.cos(-n))*o/2,90==this.get("angle")?(this.components.add({type:"line",lineWidth:l,strokeStyle:Controller.COLORS.darkorange,xStart:r+.25*o*Math.cos(-n),yStart:i+.25*o*Math.sin(-n),xEnd:r+(.25*o*Math.sqrt(2)*Math.cos(-n-t/2)+l/2*Math.cos(-n-t)),yEnd:i+(.25*o*Math.sqrt(2)*Math.sin(-n-t/2)+l/2*Math.sin(-n-t))}),this.components.add({type:"line",lineWidth:l,strokeStyle:Controller.COLORS.darkorange,xStart:r+(.25*o*Math.sqrt(2)*Math.cos(-n-t/2)+l/2*Math.cos(-n)),yStart:i+(.25*o*Math.sqrt(2)*Math.sin(-n-t/2)+l/2*Math.sin(-n)),xEnd:r+.25*o*Math.cos(-n-t),yEnd:i+.25*o*Math.sin(-n-t)})):this.components.add({type:"circle",x:r,y:i,r:o/4,endAngle:-n,startAngle:-n-t,strokeStyle:Controller.COLORS.darkorange,stroke:!0,lineWidth:l});var h=r+(o-8*s)*Math.cos(-n),c=i+(o-8*s)*Math.sin(-n),u=r+(o-8*s)*Math.cos(-n-t),d=i+(o-8*s)*Math.sin(-n-t);this.components.add({type:"line",xStart:r-l/2*Math.cos(-n),yStart:i-l/2*Math.sin(-n),lineWidth:l,strokeStyle:Controller.COLORS.lightnavy,xEnd:h,yEnd:c}),this.components.add({type:"line",xStart:r-l/2*Math.cos(-n-t),yStart:i-l/2*Math.sin(-n-t),lineWidth:l,strokeStyle:Controller.COLORS.lightnavy,xEnd:u,yEnd:d});var p=h-4*Math.sin(-n)*s,f=h+8*Math.cos(-n)*s,g=h+4*Math.sin(-n)*s,m=c+4*Math.cos(-n)*s,x=c+8*Math.sin(-n)*s,y=c-4*Math.cos(-n)*s,v=u-4*Math.sin(-n-t)*s,C=u+8*Math.cos(-n-t)*s,w=u+4*Math.sin(-n-t)*s,b=d+4*Math.cos(-n-t)*s,M=d+8*Math.sin(-n-t)*s,S=d-4*Math.cos(-n-t)*s;this.components.add({type:"triangle",x1:p,x2:f,x3:g,y1:m,y2:x,y3:y,lineWidth:0,fillStyle:Controller.COLORS.lightnavy}),this.components.add({type:"triangle",x1:v,x2:C,x3:w,y1:b,y2:M,y3:S,lineWidth:0,fillStyle:Controller.COLORS.lightnavy}),e&&this.components.add({type:"text",x:r+o/1.8*Math.cos(-n-t/2),y:i+o/1.8*Math.sin(-n-t/2),text:this.get("angle")+"°",textSize:a+"px"})}}),Controller.AngleView=Controller.CanvasControlView.extend({initialize:function(t){Controller.CanvasControlView.prototype.initialize.apply(this,t)}}),Controller.AddingSequenceModel=Controller.CanvasControlModel.extend({parse:function(t){var e=t.value;return e&&(e=e.split(","),t.num_1=JSON.parse(e[0])||0,t.num_2=JSON.parse(e[1])||0),Controller.CanvasControlModel.prototype.parse.call(this,t)},setup:function(){for(var t=this.get("num_1")+"",e=this.get("num_2")+"",n=(this.get("w")/2,this.get("h")/2),r=[],i=0,o=0,s=Math.max((t+"").length,(e+"").length),a=this.get("h")/100,l=24*a,h=3*a,c=140*a,u=8*a,d=Controller.COLORS,p=[d.darkred,d.darknavy,d.darkteal,d.darkbrown],f=(t+" + "+e+" =").length*l*7/12,g=(this.get("w")-(f+c/2+(s-1)*c+3*l*7/12))/2,m=0;m<s;m++)this.components.add({type:"text",x:g+f+7*l/12/2-l*(m+5+e.length)*7/12,y:n,text:t[t.length-m-1],textSize:l+"px",textColor:p[m],textAlign:"right"}),this.components.add({type:"text",x:g+f+7*l/12/2-l*(m+2)*7/12,y:n,text:e[e.length-m-1],textSize:l+"px",textColor:p[m],textAlign:"right"}),r.push([t%Math.pow(10,m+1)-i,e%Math.pow(10,m+1)-o]),i=t%Math.pow(10,m+1),o=e%Math.pow(10,m+1);this.components.add({type:"text",x:g+f+7*l/12/2,y:n,text:"=",textSize:l+"px",textAlign:"right"}),this.components.add({type:"text",x:g+f+7*l/12/2-l*(e.length+2)*7/12,y:n,text:" + ",textSize:l+"px",textAlign:"right"});for(var x=g+f+c/2+c*(s-1),y=n-2.3*l/2,v=0;v<s;v++){var C=Math.max((r[v][0]+"").length,(r[v][1]+"").length),w=x+(C+2)*l*7/12;this.components.add({type:"text",x:w,y:y,textAlign:"right",text:r[v][0],textSize:l+"px",textColor:p[v]}),this.components.add({type:"text",x:w,y:y+l,textAlign:"right",text:r[v][1],textSize:l+"px",textColor:p[v]}),this.components.add({type:"text",x:w-C*l*7/12,y:y+l,textAlign:"right",text:"+ ",textSize:l+"px",textColor:p[v]}),this.components.add({type:"line",lineWidth:h,xStart:w,yStart:y+2*l-u,xEnd:w-(C+2)*l*7/12,yEnd:y+2*l-u}),this.components.add({type:"text",x:w,y:y+2.3*l,textAlign:"right",text:r[v][0]+r[v][1],textSize:l+"px",textColor:p[v]}),x-=c}}}),Controller.AddingSequenceView=Controller.CanvasControlView.extend({initialize:function(t){Controller.CanvasControlView.prototype.initialize.apply(this,t)}}),Controller.ThermometerModel=Controller.CanvasControlModel.extend({parse:function(t){var e=t.value;return e&&(e=e.split(","),t.degree=JSON.parse(e[0])||0,t.start=JSON.parse(e[1])||0,t.finish=JSON.parse(e[2])||0,t.major=JSON.parse(e[3])||10,t.minor=JSON.parse(e[4])||2,t.target=JSON.parse(e[5])||0),Controller.CanvasControlModel.prototype.parse.call(this,t)},setup:function(){var t=this.get("degree"),e=this.get("start"),n=this.get("finish"),r=this.get("major"),i=this.get("minor"),o=this.get("target"),s=this.get("w"),a=this.get("h");if(a/s>2.625)var l=0,h=400*s/150,c=h/5,u=(20*a/420+a-h)/2;else if(a/s<2.625)var u=20*a/420,c=80*(a-u)/400,h=5*c,l=(s-(c+80))/2;else var l=0,u=20*a/420,h=a-u,c=h/5;var d=317*h/400,p=l+54*h/400,f=u+330*h/400,g=l+(c+1*h/400)/2,m=l+(c+3*h/400)/2,x=u+363*h/400,y=29*h/400,v=18*h/400,C=5*h/400,w=26*h/400,b=2*h/400,M=l+112*h/400,S=l+120*h/400,E=14*h/400,I=24*h/400,N=n-e,O=d/(N+1);this.components.add({type:"rectangle",fillStyle:"red",x:m-v/2,y:x,w:v,h:f-x-O*(o-e)}),this.components.add({type:"circle",fillStyle:"red",r:y,x:g,y:x,startAngle:0,endAngle:2*Math.PI}),this.components.add({type:"image",source:Controller.IMAGE_PATH+"Thermometer-2.png",w:c,h:h,xTranslate:l,yTranslate:u});for(var T=0;T<=N/r;T++)this.components.add({type:"line",xStart:p-w/2,yStart:f-O*T*r,xEnd:p+w,yEnd:f-O*T*r,lineWidth:b}),this.components.add({type:"text",x:M,y:f-O*T*r+3*a/420,text:e+r*T,textAlign:"right",textSize:E+"pt"});for(var _=1;_<Math.floor(N/i);_++)this.components.add({type:"line",xStart:p-C,yStart:f-O*_*i,xEnd:p+C,yEnd:f-O*_*i,lineWidth:b});0==t?this.components.add({type:"text",x:S,y:u,textSize:I+"pt",text:"°C"}):this.components.add({type:"text",x:S,y:u,textSize:I+"pt",text:"°F"})}}),Controller.ThermometerView=Controller.CanvasControlView.extend({initialize:function(t){Controller.CanvasControlView.prototype.initialize.apply(this,t)}}),Controller.LinePlotModel=Controller.CanvasControlModel.extend({defaults:{font:"Roboto",titleSize:18,labelSize:16,numberSize:10,boxColor:Controller.COLORS.white,lineColor:Controller.COLORS.charcoal,plotColor:Controller.COLORS.darkblue,selectedColor:Controller.COLORS.orange,unusedColor:Controller.COLORS.grey,correctColor:Controller.COLORS.correctColor,incorrectColor:Controller.COLORS.incorrectColor,inputControl:0,answerIndex:1},parse:function(t){var e=t.value;return e&&(e=e.replace(/([^,\]\[]+)/g,function(t){return t=t.trim(),"''"===t?'""':(t=t.substring(t.startsWith("'")?1:0,t.endsWith("'")?t.length-1:t.length),isNaN(t)&&"true"!==t&&"false"!==t?'"'+t+'"':t)}),e=JSON.parse("["+e+"]"),t.title=e[0]||"",t.xLabel=e[1]||"",t.yLabel=e[2]||"",t.start=new Controller.Math.RationalNumber(e[3]),t.finish=new Controller.Math.RationalNumber(e[4]),t.major=new Controller.Math.RationalNumber(e[5]),t.minor=new Controller.Math.RationalNumber(e[6]),t.coordinates=e[7],t.fractionFormat||(Controller.Math.RationalNumber.existsFraction([e[3],e[4],e[5],e[6],_.map(e[7],0)])?t.fractionFormat="mixed":t.fractionFormat="decimal")),Controller.CanvasControlModel.prototype.parse.call(this,t)},setup:function(){var t,e,n,r,i,o=this.get("start"),s=this.get("finish"),a=this.get("major"),l=this.get("minor"),h=this.get("coordinates"),c=s.subtract(o);""===this.get("title")?(t=this.get("h")-20-2-26-20-this.get("labelSize"),n=20):(t=this.get("h")-this.get("titleSize")-20-2-26-20-this.get("labelSize"),n=20+this.get("titleSize")),""===this.get("xLabel")&&(t+=this.get("labelSize")+10),""===this.get("yLabel")?(e=this.get("w")-40,r=20):(e=this.get("w")-40-this.get("labelSize"),r=20+this.get("labelSize"));for(var u=0,d=0;u<h.length;u++)_.isNumber(h[u][1])&&h[u][1]>d&&(d=h[u][1]);1===this.get("inputControl")&&(d=Math.max(d,_.maxBy(this.get("answers")[this.get("answerIndex")-1])));var p=e-20,f=r+10,g=n+t+8,m=p/c.toFloat(),x=1===this.get("inputControl")?45:25;x*d>t-10&&(x=(t-10)/d),x<=25?(plusSize=5,plusWidth=4):x>=40?(plusSize=7,plusWidth=6):(plusSize=6,plusWidth=5),this.components.add({x:0,y:0,w:this.get("w"),h:this.get("h"),type:"rectangle",fillStyle:this.get("boxColor")}),this.components.add({x:this.get("w")/2,y:10+this.get("titleSize")/2,type:"text",text:this.get("title"),textSize:this.get("titleSize")+"px",textFont:this.get("font")}),this.components.add({x:20,y:n+t/2,type:"text",text:this.get("yLabel"),textFont:this.get("font"),textSize:this.get("labelSize")+"px",angle:-Math.PI/2}),this.components.add({x:r+e/2,y:n+t+38+this.get("labelSize")/2,type:"text",text:this.get("xLabel"),textFont:this.get("font"),textSize:this.get("labelSize")+"px"}),this.components.add({xStart:f,yStart:g-5,xEnd:f+p+11,yEnd:g-5,type:"line",lineWidth:2,strokeStyle:this.get("lineColor")}),o.isEqual(0)||(this.components.add({xStart:f,yStart:g-5,xEnd:f-6,yEnd:g-5,type:"line",lineWidth:2,strokeStyle:this.get("lineColor")}),this.components.add({xStart:f,yStart:g-10,xEnd:f,yEnd:g,type:"line",lineWidth:2,strokeStyle:this.get("lineColor")}),this.components.add({x1:f-10,y1:g-5,x2:f-5,y2:g-10,x3:f-5,y3:g,type:"triangle",fillStyle:this.get("lineColor"),lineWidth:1,strokeStyle:this.get("lineColor")})),this.components.add({xStart:f+p,yStart:g-5,xEnd:f+p+6,yEnd:g-5,type:"line",lineWidth:2,strokeStyle:this.get("lineColor")}),this.components.add({xStart:f+p,yStart:g-10,xEnd:f+p,yEnd:g,type:"line",lineWidth:2,strokeStyle:this.get("lineColor")}),this.components.add({x1:f+p+10,y1:g-5,x2:f+p+5,y2:g-10,x3:f+p+5,y3:g,type:"triangle",fillStyle:this.get("lineColor"),lineWidth:1,strokeStyle:this.get("lineColor")});for(var y=a.toFloat(),v=Math.floor(c.divide(a).toFloat()),u=0,i=f;u<=v;u++)this.components.add({type:"line",lineWidth:2,strokeStyle:this.get("lineColor"),xStart:i,yStart:g-13,xEnd:i,yEnd:g+3}),this.components.add({type:"text",text:a.multiply(u).add(o),fractionOptions:this.get("fractionOptions"),textFont:this.get("font"),textStyle:"bold",textSize:this.get("numberSize")+"px",x:i,y:g+1.5*this.get("numberSize")}),i+=m*y;for(var C=Math.floor(c.divide(l).toFloat()),w=0;w<=C;w++)this.components.add({xStart:f+m*l.toFloat()*w,yStart:g-4-5,xEnd:f+m*l.toFloat()*w,yEnd:g+4-5,type:"line",lineWidth:2,strokeStyle:this.get("lineColor")});if(1===this.get("inputControl"))var b=[];for(var i,u=0;u<h.length;u++)if(i=f+m*(Controller.Math.RationalNumber.parse(h[u][0])-o.toFloat()),_.isNumber(h[u][1]))for(var w=0;w<h[u][1];w++)this.components.add({x:i,y:n+t-x*(w+1),type:"plus_sign",rotation:45,strokeStyle:this.get("plotColor"),w:0,h:0,size:plusSize,lineWidth:plusWidth});else if(1===this.get("inputControl")&&"_"===h[u][1]){this.components.add({type:"component",x:i,y:n+t,pointNumber:0,pointIndex:b.length,selected:!0});for(var w=0;w<d;w++)this.components.add({type:"circle",x:i,y:n+t-x*(w+1),w:0,h:0,r:2,fillStyle:this.get("unusedColor"),pointNumber:w+1,pointIndex:b.length,selected:!1});b.push(0)}1===this.get("inputControl")&&this.set({currentAnswer:b,max:d,plotSpacing:x,plusSize:plusSize,plusWidth:plusWidth})},selectPoint:function(t,e){var n=this.components.getNearestComponent(t,e,function(t){return _.isNumber(t.get("pointIndex"))});if(n&&n.get("selected")===!1){var r=this.get("currentAnswer").slice(),i=this.get("answers").slice();r[n.get("pointIndex")]=n.get("pointNumber"),i[this.get("answerIndex")-1]=r,this.setInput(i)}},isValid:function(){return!0},isCorrect:function(t){return _.isEqual(this.get("currentAnswer"),t[this.get("answerIndex")-1])},getInput:function(){return this.get("currentAnswer")},setInput:function(t){for(var e=this.get("currentAnswer"),n=[],r=t[this.get("answerIndex")-1],i=0;i<e.length;i++)if(e[i]!==r[i]&&r[i]>=0&&r[i]<=this.get("max")){var o=this.components.find(function(t){return"component"===t.get("type")&&t.get("pointIndex")===i});this.components.removeComponents(this.components.filter(function(t){return t.get("pointIndex")===i&&"circle"!==t.get("type")}),{silent:!0}),n.push({type:"component",x:o.get("x"),y:o.get("y"),pointNumber:0,pointIndex:i,selected:0===r[i]});for(var s=0;s<r[i];s++)s+1<=r[i]?n.push({type:"plus_sign",x:o.get("x"),y:o.get("y")-this.get("plotSpacing")*(s+1),w:0,h:0,rotation:45,size:this.get("plusSize"),lineWidth:this.get("plusWidth"),strokeStyle:this.get("selectedColor"),pointNumber:s+1,pointIndex:i,selected:!1}):n.push({type:"plus_sign",x:o.get("x"),y:o.get("y")-this.get("plotSpacing")*(s+1),w:0,h:0,rotation:45,size:this.get("plusSize"),lineWidth:this.get("plusWidth"),strokeStyle:this.get("selectedColor"),pointNumber:s+1,pointIndex:i,selected:!0});e[i]=r[i]}this.components.addComponents(n)},displayAnswer:function(t){this.setInput(t),this.displayResult(t)},displayResult:function(t){for(var e=t[this.get("answerIndex")-1],n=this.get("currentAnswer"),r=[],i=0;i<n.length;i++){var o=this.components.find(function(t){return"component"===t.get("type")&&t.get("pointIndex")===i});this.components.removeComponents(this.components.filter(function(t){return t.get("pointIndex")===i&&"circle"!==t.get("type")}),{silent:!0}),r.push({type:"component",x:o.get("x"),y:o.get("y"),pointNumber:0,pointIndex:i,selected:!1});for(var s=0;s<this.get("max");s++)n[i]===e[i]&&n[i]>=s+1?r.push({type:"plus_sign",x:o.get("x"),y:o.get("y")-this.get("plotSpacing")*(s+1),w:0,h:0,rotation:45,size:this.get("plusSize"),lineWidth:this.get("plusWidth"),strokeStyle:this.get("correctColor"),pointNumber:s+1,pointIndex:i,selected:!1}):n[i]!==e[i]&&n[i]>=s+1?r.push({type:"plus_sign",x:o.get("x"),y:o.get("y")-this.get("plotSpacing")*(s+1),w:0,h:0,rotation:45,size:this.get("plusSize"),lineWidth:this.get("plusWidth"),strokeStyle:this.get("incorrectColor"),pointNumber:s+1,pointIndex:i,selected:!1}):r.push({type:"component",x:o.get("x"),y:o.get("y")-this.get("plotSpacing")*(s+1),pointNumber:s+1,pointIndex:i,selected:!1})}this.components.addComponents(r)},disableInput:function(){var t=this.components.filter(function(t){return"circle"===t.get("type")});t.forEach(function(t){t.set("opacity",0)}),this.components.trigger("render")},enableInput:function(){var t=this.components.filter(function(t){return"circle"===t.get("type")});t.forEach(function(t){t.set("opacity",100)}),this.components.trigger("render")}}),Controller.LinePlotView=Controller.CanvasControlView.extend({initialize:function(t){this.model.isInputControl()&&(this.canvasEvents={mouseup:"selectPoint"}),Controller.CanvasControlView.prototype.initialize.apply(this,t)}}),Controller.ClockView=Controller.CanvasControlView.extend({initialize:function(t){Controller.CanvasControlView.prototype.initialize.apply(this,t)}}),Controller.ClockModel=Controller.CanvasControlModel.extend({parse:function(t){var e=t.value;return e&&(e=e.replace(/\s+/g,"").split(","),t.kind="true"===e[0]||!1,t.hours=e[1]||12,t.minutes=e[2]||30,t.seconds=e[3]||45),Controller.CanvasControlModel.prototype.parse.call(this,t)},defaults:{textColor:"#01fd32",bgColor:"whitesmoke"},setup:function(){var t=this.get("hours"),e=("0"+this.get("minutes")%60).slice(-2),n=this.get("seconds")%60,r=this.get("w"),i=this.get("h");if(this.get("kind")){if(r>i){r=i;var o=r/125}else if(this.get("w")<this.get("h")){i=r;var o=r/125}else var o=r/125;this.components.add({w:r,h:i,scale:o,type:"image",source:Controller.IMAGE_PATH+"AnalogClock.gif"});var s=(6*e+n/60*6)*Math.PI/180,a=(30*t+e/60*30+n/60*.5)*Math.PI/180;this.components.add({w:r,h:i,type:"image",angle:a,source:Controller.IMAGE_PATH+"HourHand.gif"}),this.components.add({w:r,h:i,type:"image",angle:s,source:Controller.IMAGE_PATH+"MinuteHand.gif"})}else{if(r/i>125/61){r=125*i/61;var o=i/61}else if(r/i<125/61){i=61*r/125;var o=r/125}else var o=r/125;this.components.add({w:r,h:i,type:"image",source:Controller.IMAGE_PATH+"DigitalClock.gif"}),this.components.add({x:42*o,y:31*o,type:"text",textSize:21.33*o+"px",text:t,textColor:this.get("textColor")}),this.components.add({x:79*o,y:31*o,type:"text",textSize:21.33*o+"px",text:e,textColor:this.get("textColor")})}}}),Controller.BaseBlocksView=Controller.CanvasControlView.extend({initialize:function(t){Controller.CanvasControlView.prototype.initialize.apply(this,t)}}),Controller.BaseBlocksModel=Controller.CanvasControlModel.extend({parse:function(t){var e=t.value;return e&&(e=e.split(","),t.numHundreds=JSON.parse(e[0])||0,t.numTens=JSON.parse(e[1])||0,t.numOnes=JSON.parse(e[2])||0,t.isOrdered=JSON.parse(e[3])||0,t.displayPVC=JSON.parse(e[4])),Controller.CanvasControlModel.prototype.parse.call(this,t)},defaults:{blockColor:Controller.COLORS.lightorange,gridLineColor:Controller.COLORS.charcoal,PVCGridLineColor:Controller.COLORS.charcoal,PVCHundredsTitleBlockColor:Controller.COLORS.darkyellow,PVCTensTitleBlockColor:Controller.COLORS.yellow,PVCOnesTitleBlockColor:Controller.COLORS.lightyellow,PVCBgBlockColor:Controller.COLORS.white,PVCTitleBlockHeight:30,paddingBetweenTableAndBlocks:4,blockWidth:8,blockHeight:8,paddingSameElement:6,paddingDiffElement:16,disorderedBlockWidth:7.8,disorderedBlockHeight:7.8},setup:function(){var t=this.get("isOrdered"),e=this.get("displayPVC");try{if(!t){var n=0,r=0,i="",o=this.get("numOnes"),s=this.get("numTens"),a=this.get("numHundreds"),l=0,h=0;h=Math.floor(this.get("w")/(10*this.get("disorderedBlockWidth")+this.get("paddingSameElement"))),l=Math.floor(this.get("h")/(10*this.get("disorderedBlockHeight")+this.get("paddingSameElement")));for(var c=[],u=[],d=0;d<l;d++){if(n>this.get("w")||r>this.get("h"))throw console.error("ERROR: SOMETHING WILL BE CUT OFF!"),"error";for(var p=0;p<h;p++)this.storePositions(n,r,i,c),n+=10*this.get("disorderedBlockHeight")+this.get("paddingSameElement");r+=10*this.get("disorderedBlockHeight")+this.get("paddingSameElement"),n=0}n=0,r=0;var f=0;n=c[c.length-1].x+10*this.get("disorderedBlockWidth")+this.get("paddingSameElement");for(var d=0;d<l;d++){for(;n+this.get("blockWidth")<=this.get("w");)this.storePositions(n,r,i,u),n+=this.get("blockWidth")+this.get("paddingSameElement"),f++;r+=10*this.get("disorderedBlockHeight")+this.get("paddingSameElement"),n=c[c.length-1].x+10*this.get("disorderedBlockWidth")+this.get("paddingSameElement")}f/=l;for(var g,m=new Array,d=0;d<h*l;d++)m[d]=d;if(0!==a){if(a>c.length)throw console.error("ERROR: YOU HAVE TOO MANY HUNDREDS BLOCKS"),"error";for(var d=0;d<a;d++)g=this.generateRandomNumber(0,m.length-1),c[m[g]]={x:c[m[g]].x,y:c[m[g]].y,type:"H"},m.splice(g,1)}m.splice(0,m.length);var x,y,v=this.get("blockWidth")+this.get("paddingSameElement"),C=6*l*h-6*a;for(p=0;p+6<=C+a;p+=6){for(;c[p+1]&&"H"===c[p].type;)p++;if(c[p]&&"H"!==c[p].type)for(x=c[p].x,y=c[p].y,d=p;d<p+5;d++)x+=v,c.splice(d+1,0,{x:x,y:y,type:""})}for(var d=0;d<c.length;d++)if(d+1<c.length&&c[d+1].y!==c[d].y){for(var p=0;p<f;p++)c.splice(d+p+1,0,{x:u[p].x,y:c[d].y,type:""});d+f<c.length&&(d+=f)}d--;for(var p=0;p<f;p++)c.push({x:u[p].x,y:c[d].y,type:""});for(var d=0;d<c.length;d++)"H"!==c[d].type&&m.push(d);if(0!==s){if(s>c.length-a)throw console.error("ERROR: CAN'T DISPLAY THESE MANY TENS"),"error";for(var d=0;d<s;d++)g=this.generateRandomNumber(0,m.length-1),c[m[g]]={x:c[m[g]].x,y:c[m[g]].y,type:"T"},m.splice(g,1)}if(0!==o){if(o>5*m.length)throw console.error("ERROR: CAN'T FIT THESE MANY ONES"),"error";var w,b,M,S=[];o<=m.length?(w=this.generateRandomNumber(Math.ceil(o/5),o),0===w&&(w=1),b=new Array(w),M=o-w):(w=this.generateRandomNumber(Math.ceil(o/5),m.length),M=o-w,b=new Array(w));for(var E=0,d=0;d<w;d++)b[d]=0;for(var d=0;d<b.length;d++)S[d]=d;for(;E!==M;)g=this.generateRandomNumber(0,S.length-1),b[S[g]]++,E++,4===b[S[g]]&&S.splice(g,1);if(M>4*w)throw console.error("ERROR: NOT ENOUGH ROOM FOR THESE MANY ONES"),"error";for(var d=0;d<w;d++)g=this.generateRandomNumber(0,m.length-1),c[m[g]]={x:c[m[g]].x,y:c[m[g]].y,type:"O",clustered:b[d]},m.splice(g,1)}var I=c.length;if(0!==m.length)for(var d=0,d=0;d<c.length;d++)""===c[d].type&&(c.splice(d,1),d--);c[0].x=0,c[0].y=0;for(var d=0;d<c.length;d++)d+1<c.length&&"H"!==c[d].type&&(c[d+1].y!==c[d].y?c[d+1].x=0:c[d+1].x=c[d].x+v),d+1<c.length&&"H"===c[d].type&&(c[d+1].y!==c[d].y?c[d+1].x=0:c[d+1].x=c[d].x+10*this.get("disorderedBlockWidth")+this.get("paddingSameElement"));for(var N=[],O=0,T=0,d=0;d<c.length;d++)T++,d<c.length-1&&c[d+1].y!==c[d].y&&(N[O]=T,O++,T=0);N[O]=T,O=0;for(var d=0;d<c.length;d++){if(0!==c[0].y){for(var p=d;p<N[O];p++)c[p].y=0,d++;O++}if(0!==d){var p=d,_=d-1;if(c[_].y!==c[d].y&&(O++,c[p].y-84!==c[_].y))for(var p=d;p<d+N[O];p++)c[p].y=c[_].y+84}}O=0;for(var P=[],d=0;d<c.length;d++){if(d+1<c.length&&c[d].y!==c[d+1].y&&("H"===c[d].type?P.push(c[d].x+10*this.get("disorderedBlockWidth")):P.push(c[d].x+this.get("blockWidth"))),d+1===c.length&&("H"===c[d].type?P.push(c[d].x+10*this.get("disorderedBlockWidth")):P.push(c[d].x+this.get("blockWidth"))),c[d].x<0||c[d].x>this.get("w")||c[d].y<0||c[d].y>this.get("h"))throw console.error("ERROR: SOMETHING WILL BE CUT OFF"),"error";if("H"===c[d].type&&(c[d].x+10*this.get("disorderedBlockWidth")>this.get("w")||c[d].y+10*this.get("disorderedBlockHeight")>this.get("h")))throw console.error("ERROR: SOMETHING WILL BE CUT OFF"),"error";if("T"===c[d].type&&(c[d].x+this.get("blockWidth")>this.get("w")||c[d].y+10*this.get("disorderedBlockHeight")>this.get("h")))throw console.error("ERROR: SOMETHING WILL BE CUT OFF"),"error";if("O"===c[d].type&&(c[d].x+this.get("blockWidth")>this.get("w")||c[d].y+this.get("disorderedBlockHeight")>this.get("h")))throw console.error("ERROR: SOMETHING WILL BE CUT OFF"),"error"}for(var O=0,d=0;d<c.length;d++)c[d].x+=(this.get("w")-P[O])/2,d+1<c.length&&c[d].y!==c[d+1].y&&O++;O=0;for(var A=0,k=0,R=0,z=0,d=0;d<c.length;d++){for(var B=d;B<d+N[O];B++)c[B]&&("H"===c[B].type&&k++,"T"===c[B].type&&R++,"O"===c[B].type&&(A<c[B].clustered&&(A=c[B].clustered),z++));if(d=B-1,0===k&&0===R)for(var p=d+1;p<c.length;p++)c[p].y=c[p].y-84+(A+1)*(1.5*this.get("paddingSameElement")+this.get("disorderedBlockWidth"));O++,k=0,R=0,A=0}for(var L=0,D=0,W=0,d=0;d<c.length;d++){if("H"===c[d].type&&(L++,c[d].x>this.get("w")||c[d].x<0||c[d].y>this.get("h")||c[d].y<0||c[d].x+10*this.get("disorderedBlockWidth")>this.get("w")||c[d].y+10*this.get("disorderedBlockHeight")>this.get("h")))throw console.error("ERROR: SOMETHING IS CUT OFF"),"error";if("T"===c[d].type&&(D++,c[d].x>this.get("w")||c[d].x<0||c[d].y>this.get("h")||c[d].y<0||c[d].x+this.get("blockWidth")>this.get("w")||c[d].y+10*this.get("disorderedBlockHeight")>this.get("h")))throw console.error("ERROR: SOMETHING IS CUT OFF"),"error";if("O"===c[d].type&&(W++,c[d].x>this.get("w")||c[d].x<0||c[d].y>this.get("h")||c[d].y<0||c[d].x+this.get("blockWidth")>this.get("w")||c[d].y+this.get("disorderedBlockHeight")>this.get("h")))throw console.error("ERROR: SOMETHING IS CUT OFF"),"error";0!==c[d].clustered&&(W+=c[d].clustered)}if(L>a)throw console.error("ERROR: DREW TOO MANY HUNDREDS"),"error";if(D>s)throw console.error("ERROR: DREW TOO MANY TENS"),"error";if(W>o)throw console.error("ERROR: DREW TOO MANY ONES"),"error";if(L<a)throw console.error("ERROR: DIDN'T DRAW ALL HUNDREDS"),"error";if(D<s)throw console.error("ERROR: DIDN'T DRAW ALL TENS"),"error";if(W<o)throw console.error("ERROR: DIDN'T DRAW ALL ONES"),"error";for(var F=0,I=c.length,d=0;d<I;d++)if("H"===c[d].type&&this.drawDisorderedHundreds(c[d].x,c[d].y),"T"===c[d].type&&this.drawDisorderedTens(c[d].x,c[d].y),"O"===c[d].type){if(this.drawDisorderedOnes(c[d].x,c[d].y),0!==c[d].clustered)for(var p=0;p<c[d].clustered;p++)this.drawDisorderedOnes(c[d].x,c[d].y+(p+1)*(this.get("disorderedBlockHeight")+1.5*this.get("paddingSameElement")));F++}}}catch(V){t=!0,e=!1,console.error("This combination of disordered blocks will not fit in the container provided OR an incorrect number of blocks were about to be drawn. Switching to non-PVC ordered")}var q=this.getNumBlockTypes();try{if(t){var H;H=0===this.get("numHundreds")?0:Math.ceil(this.get("numHundreds")/3)*this.get("blockWidth")*10+(Math.ceil(this.get("numHundreds")/3)-1)*this.get("paddingSameElement");var U;if(0===this.get("numTens"))U=0;else{var j=Math.floor(this.get("numTens")/15)*this.get("blockWidth")*5,$=4*Math.floor(this.get("numTens")/15)*this.get("paddingSameElement"),G=Math.min(5,this.get("numTens")%15)*this.get("blockWidth"),Y=(Math.min(5,this.get("numTens")%15)-1)*this.get("paddingSameElement");Y<0&&(Y=0);var J;J=0===Math.floor(this.get("numTens")/15)?0:.75*this.get("paddingDiffElement")*(Math.ceil(this.get("numTens")/15)-1),U=j+G+$+Y+J}var X;if(0===this.get("numOnes"))X=0;else{var Z=Math.floor(this.get("numOnes")/90)*this.get("blockWidth")*5,Q=Math.min(5,this.get("numOnes")%90)*this.get("blockWidth"),K=4*Math.floor(this.get("numOnes")/90)*this.get("paddingSameElement");K<0&&(K=0);var tt=(Math.min(5,this.get("numOnes")%90)-1)*this.get("paddingSameElement");tt<0&&(tt=0);var et;et=0===Math.floor(this.get("numOnes")/90)?0:.75*this.get("paddingDiffElement")*(Math.ceil(this.get("numOnes")/90)-1),X=Z+Q+K+tt+et}var nt;nt=3===q?2*this.get("paddingDiffElement"):2===q?this.get("paddingDiffElement"):0;var rt=H+U+X+nt,it=(this.get("w")-rt)/2,ot=0;if(it<0||it>this.get("w")||ot<0||ot>this.get("h"))throw console.error("ERROR: SOMETHING MAY BE CUT OFF!!"),"error";var st=10*this.get("blockWidth"),at=10*this.get("blockHeight"),lt=this.get("blockWidth"),ht=10*this.get("blockHeight"),ct=this.get("blockWidth"),ut=this.get("blockHeight");if(e){if(e){var L=0,D=0,W=0,dt=10*this.get("blockWidth")+2*this.get("paddingBetweenTableAndBlocks"),pt=5*this.get("blockWidth")+4*this.get("paddingSameElement")+2*this.get("paddingBetweenTableAndBlocks"),ft=5*this.get("blockWidth")+4*this.get("paddingSameElement")+2*this.get("paddingBetweenTableAndBlocks");this.get("numHundreds")>3&&(dt=H+2*this.get("paddingBetweenTableAndBlocks")),this.get("numTens")>15&&(pt=U+2*this.get("paddingBetweenTableAndBlocks")),this.get("numOnes")>90&&(ft=X+2*this.get("paddingBetweenTableAndBlocks"));var gt=(this.get("w")-dt-pt-ft)/2;this.components.add({type:"grid",x:gt,y:0,w:dt,h:this.get("PVCTitleBlockHeight"),strokeStyle:this.get("PVCGridLineColor"),fillStyle:this.get("PVCHundredsTitleBlockColor"),numRows:1,numColumns:1}),this.components.add({type:"grid",x:gt,y:30,w:dt,h:2*this.get("paddingBetweenTableAndBlocks")+30*this.get("blockWidth")+2*this.get("paddingSameElement"),strokeStyle:this.get("PVCGridLineColor"),fillStyle:this.get("PVCBgBlockColor"),numRows:1,numColumns:1});var mt=gt+dt;this.components.add({type:"grid",x:mt,y:0,w:pt,h:this.get("PVCTitleBlockHeight"),strokeStyle:this.get("PVCGridLineColor"),fillStyle:this.get("PVCTensTitleBlockColor"),numRows:1,numColumns:1}),this.components.add({type:"grid",x:mt,y:30,w:pt,h:2*this.get("paddingBetweenTableAndBlocks")+30*this.get("blockWidth")+2*this.get("paddingSameElement"),strokeStyle:this.get("PVCGridLineColor"),fillStyle:this.get("PVCBgBlockColor"),numRows:1,numColumns:1});var xt=mt+pt;this.components.add({type:"grid",x:xt,y:0,w:ft,h:this.get("PVCTitleBlockHeight"),strokeStyle:this.get("PVCGridLineColor"),fillStyle:this.get("PVCOnesTitleBlockColor"),numRows:1,numColumns:1}),this.components.add({type:"grid",x:xt,y:30,w:ft,h:2*this.get("paddingBetweenTableAndBlocks")+30*this.get("blockWidth")+2*this.get("paddingSameElement"),strokeStyle:this.get("PVCGridLineColor"),fillStyle:this.get("PVCBgBlockColor"),numRows:1,numColumns:1}),this.components.add({x:gt+dt/2,y:this.get("PVCTitleBlockHeight")/2,type:"text",textSize:"15px",text:"Hundreds",textColor:this.get("textColor"),textFont:"Roboto"}),this.components.add({x:mt+pt/2,y:this.get("PVCTitleBlockHeight")/2,type:"text",textSize:"15px",text:"Tens",textColor:this.get("textColor"),textFont:"Roboto"}),this.components.add({x:xt+ft/2,y:this.get("PVCTitleBlockHeight")/2,type:"text",textSize:"15px",text:"Ones",textColor:this.get("textColor"),textFont:"Roboto"}),gt+=this.get("paddingBetweenTableAndBlocks"),ot=this.get("PVCTitleBlockHeight")+this.get("paddingBetweenTableAndBlocks");for(var p=0,d=0;d<this.get("numHundreds");d++)this.drawHundreds(gt,ot+(at+this.get("paddingSameElement"))*p),L++,p++,3===p&&(d!==this.get("numHundreds")-1&&(gt=gt+st+this.get("paddingSameElement")),p=0);mt+=this.get("paddingBetweenTableAndBlocks");var yt=mt;
ot=this.get("PVCTitleBlockHeight")+this.get("paddingBetweenTableAndBlocks");var d=0,p=0,B=0;for(d=0;d<this.get("numTens");d++)this.drawTens(mt+(lt+this.get("paddingSameElement"))*p,ot),D++,p++,5===p&&(p=0,mt=yt,ot+=ht+this.get("paddingSameElement"),B++),3===B&&(mt+=5*lt+4*this.get("paddingSameElement")+.75*this.get("paddingDiffElement"),yt=mt,ot=this.get("PVCTitleBlockHeight")+this.get("paddingBetweenTableAndBlocks"),B=0);xt+=this.get("paddingBetweenTableAndBlocks"),ot=this.get("PVCTitleBlockHeight")+this.get("paddingBetweenTableAndBlocks");var vt=xt,d=0,p=0,B=0;for(d=0;d<this.get("numOnes");d++)this.drawOnes(xt+(ct+this.get("paddingSameElement"))*p,ot),W++,p++,5===p&&(p=0,xt=vt,ot=ot+ut+this.get("paddingSameElement"),B++),18===B&&(xt=xt+5*ct+4*this.get("paddingSameElement")+.75*this.get("paddingDiffElement"),vt=xt,ot=this.get("PVCTitleBlockHeight")+this.get("paddingBetweenTableAndBlocks"),B=0);if(L>this.get("numHundreds"))throw console.error("TOO MANY HUNDREDS WERE DRAWN"),"error";if(L<this.get("numHundreds"))throw console.error("ALL HUNDREDS WERE NOT DRAWN!!"),"error";if(D>this.get("numTens"))throw console.error("TOO MANY TENS WERE DRAWN"),"error";if(D<this.get("numTens"))throw console.error("ALL TENS WERE NOT DRAWN!!"),"error";if(W>this.get("numOnes"))throw console.error("TOO MANY ONES WERE DRAWN"),"error";if(W<this.get("numOnes"))throw console.error("ALL ONES WERE NOT DRAWN!!"),"error"}}else{for(var L=0,D=0,W=0,p=0,d=0;d<this.get("numHundreds");d++)this.drawHundreds(it,ot+(at+this.get("paddingSameElement"))*p),L++,p++,3===p&&(d<this.get("numHundreds")-1&&(it+=st+this.get("paddingSameElement")),ot=0,p=0);it=0===this.get("numHundreds")&&0===this.get("numOnes")?(this.get("w")-rt)/2+(rt-U):0===this.get("numOnes")?(this.get("w")-rt)/2+(rt-U):(this.get("w")-rt)/2+(rt-U-X)-this.get("paddingDiffElement");var yt=it,d=0,p=0,B=0;for(d=0;d<this.get("numTens");d++)this.drawTens(it+(lt+this.get("paddingSameElement"))*p,ot),D++,p++,5===p&&(p=0,it=yt,ot+=ht+this.get("paddingSameElement"),B++),3===B&&(it+=5*lt+4*this.get("paddingSameElement")+.75*this.get("paddingDiffElement"),yt=it,ot=0,B=0);it=(this.get("w")-rt)/2+(rt-X),ot=0;var vt=it,d=0,p=0,B=0;for(d=0;d<this.get("numOnes");d++)this.drawOnes(it+(ct+this.get("paddingSameElement"))*p,ot),W++,p++,5===p&&(p=0,it=vt,ot+=ut+this.get("paddingSameElement"),B++),18===B&&(it+=5*ct+4*this.get("paddingSameElement")+.75*this.get("paddingDiffElement"),vt=it,ot=0,B=0);if(L>this.get("numHundreds"))throw console.error("ERROR: TOO MANY HUNDREDS WERE DRAWN"),"error";if(L<this.get("numHundreds"))throw console.error("ERROR: ALL HUNDREDS WERE NOT DRAWN!!"),"error";if(D>this.get("numTens"))throw console.error("ERROR: TOO MANY TENS WERE DRAWN"),"error";if(D<this.get("numTens"))throw console.error("ERROR: ALL TENS WERE NOT DRAWN!!"),"error";if(W>this.get("numOnes"))throw console.error("ERROR: TOO MANY ONES WERE DRAWN"),"error";if(W<this.get("numOnes"))throw console.error("ERROR: ALL ONES WERE NOT DRAWN!!"),"error"}}}catch(V){console.error("This combination of ordered blocks will not fit in the container provided")}},storePositions:function(t,e,n,r){r.push({x:t,y:e,type:n})},getNumBlockTypes:function(){var t=0;return 0!==this.get("numHundreds")&&t++,0!==this.get("numTens")&&t++,0!==this.get("numOnes")&&t++,t},generateRandomNumber:function(t,e){return Math.floor(Math.random()*(e-t+1))+t},drawHundreds:function(t,e){this.components.add({type:"grid",x:t,y:e,w:10*this.get("blockWidth"),h:10*this.get("blockHeight"),strokeStyle:this.get("gridLineColor"),fillStyle:this.get("blockColor"),numRows:10,numColumns:10})},drawDisorderedHundreds:function(t,e){this.components.add({type:"grid",x:t,y:e,w:10*this.get("disorderedBlockWidth"),h:10*this.get("disorderedBlockHeight"),strokeStyle:this.get("gridLineColor"),fillStyle:this.get("blockColor"),numRows:10,numColumns:10})},drawTens:function(t,e){this.components.add({type:"grid",x:t,y:e,w:this.get("blockWidth"),h:10*this.get("blockHeight"),strokeStyle:this.get("gridLineColor"),fillStyle:this.get("blockColor"),numRows:10,numColumns:1})},drawDisorderedTens:function(t,e){this.components.add({type:"grid",x:t,y:e,w:this.get("blockWidth"),h:10*this.get("disorderedBlockHeight"),strokeStyle:this.get("gridLineColor"),fillStyle:this.get("blockColor"),numRows:10,numColumns:1})},drawOnes:function(t,e){this.components.add({type:"grid",x:t,y:e,w:this.get("blockWidth"),h:this.get("blockHeight"),strokeStyle:this.get("gridLineColor"),fillStyle:this.get("blockColor"),numRows:1,numColumns:1})},drawDisorderedOnes:function(t,e){this.components.add({type:"grid",x:t,y:e,w:this.get("blockWidth"),h:this.get("disorderedBlockHeight"),strokeStyle:this.get("gridLineColor"),fillStyle:this.get("blockColor"),numRows:1,numColumns:1})}}),Controller.NumberSequenceModel=Controller.CanvasControlModel.extend({parse:function(t){var e=t.value;if(e){switch(e=JSON.parse("["+e+"]"),e[0]){case 1:t.operation="-";break;case 2:t.operation="×";break;case 3:t.operation="÷";break;default:t.operation="+"}t.factor=e[1]||0,t.showJumps=e[2]||0,t.start=e[3]||0,t.sequenceLength=e[4]||0,t.missingNumbers=e[5]||[]}return Controller.CanvasControlModel.prototype.parse.call(this,t)},defaults:{positiveColor:Controller.COLORS.darkgreen,negativeColor:Controller.COLORS.purple,textColor:Controller.COLORS.white,textStroke:Controller.COLORS.charcoal,answerIndex:1},setup:function(){for(var t=this.get("missingNumbers"),e=[],n=0,r=this.get("start"),i=this.get("operation"),o=this.get("factor"),s=this.get("sequenceLength"),a=0;a<s;a++)switch(t.indexOf(r)>-1?e.push(r.toString().replace(/./g,"_")):e.push(r),n=Math.max(n,(r+"").length),i){case"+":r+=o;break;case"-":r-=o;break;case"×":r*=o;break;case"÷":r/=o}for(var l=r>this.get("start"),h=this.get("answerIndex"),c=1,a=0,u=Math.max(40,15*n+10),d=this.get("showJumps"),p=(this.get("w")-u*(this.get("sequenceLength")-1))/2,f=d?(this.get("h")+60)/2:this.get("h")/2;a<e.length;a++){if(/^_+$/.test(e[a])?this.components.add({type:"textBox",canvasControl:this,answerIndex:h,answerSubIndex:c++,text:e[a],textBaseline:d?"bottom":"middle",x:p,y:f}):this.components.add({type:"text",text:e[a],textBaseline:d?"bottom":"middle",x:p,y:f,textSize:"19px"}),a<e.length-1&&(this.components.add({type:"text",text:",",textBaseline:d?"bottom":"middle",x:p+u/2,y:f,textSize:"19px"}),d)){var g=l?this.get("positiveColor"):this.get("negativeColor");this.components.add({type:"arrow",lineWidth:3,strokeStyle:g,xStart:p+2,yStart:f-19-5-10,xMid:p+u/2,yMid:f-60-5,xEnd:p+u-2,yEnd:f-19-5-10}),this.components.add({type:"text",x:p+u/2,y:f-58-10,text:this.get("operation")+this.get("factor"),textSize:"12px",textBaseline:"top",textStyle:"bold"})}p+=u}}}),Controller.NumberSequenceView=Controller.CanvasControlView.extend({initialize:function(t){Controller.CanvasControlView.prototype.initialize.apply(this,t)}}),Controller.ThreeDeeShapeModel=Controller.CanvasControlModel.extend({parse:function(t){var e=t.value;if(e){var e=t.value.replace(/\(([^\)]*)\)/g,"[$1]");e=e.replace(/([^,\]\[]+)/g,function(t){return t=t.trim(),"''"===t?'""':(t=t.substring(t.startsWith("'")?1:0,t.endsWith("'")?t.length-1:t.length),isNaN(t)&&"true"!==t&&"false"!==t?'"'+t+'"':t)}),e=JSON.parse("["+e+"]"),t.shapeID=JSON.parse(e[0]),t.rotation=JSON.parse(e[1]),t.color=e[2].toLowerCase(),t.dimensions=e[3],t.labels=e[4]}switch(t.color){case"red":t.color=Controller.COLORS.red;break;case"green":t.color=Controller.COLORS.green;break;case"blue":t.color=Controller.COLORS.blue;break;case"orange":t.color=Controller.COLORS.orange;break;default:t.color=""}return Controller.CanvasControlModel.prototype.parse.call(this,t)},defaults:{labelFont:"Roboto",textSize:"14px",textColor:Controller.COLORS.white,fillStyle:Controller.COLORS.charcoal},setup:function(){var t,e=42.5,n=37.5,r=37.5,i=15,o=17,s=10;if(4===this.get("shapeID")){var a,l,h,c,u,d;switch(0===this.get("dimensions")[2]&&(this.get("dimensions")[0]/this.get("dimensions")[1]===1?this.set({sizeID:2}):this.get("dimensions")[0]/this.get("dimensions")[1]>1?this.set({sizeID:3}):this.set({sizeID:1})),0!==this.get("dimensions")[2]&&(this.get("dimensions")[0]/(2*this.get("dimensions")[2])===1?this.set({sizeID:2}):this.get("dimensions")[0]/(2*this.get("dimensions")[2])>1?this.set({sizeID:3}):this.set({sizeID:1})),this.get("rotation")){case 0:case 2:d=this.get("labels")[0]?80:20,u=this.get("labels")[1]||this.get("labels")[2]?150:20;var p=this.get("w")-u;1===this.get("sizeID")&&(a=5*p/9,l=2*a,l>=this.get("h")-d&&(l=this.get("h")-d,a=.5*l)),2===this.get("sizeID")&&(a=5*p/7,l=a,l>=this.get("h")-d&&(l=this.get("h")-d,a=l)),3===this.get("sizeID")&&(a=5*p/6,l=.5*a,l>=this.get("h")-d&&(l=this.get("h")-d,a=2*l)),h=this.get("w")/2-a/2,c=this.get("h")/2-l/2,this.drawCylinder(h,c,l,a),t=l/5,this.get("labels")[0]&&(this.drawExtensionLines(h,c-i,10,a,"vertical"),this.drawText(h+a/2,c-o-parseInt(this.get("textSize"))/2,this.get("labels")[0]),this.connectExtensionLines(h,c-s,a,"horizontal")),0===this.get("rotation")&&(this.get("labels")[1]&&(this.drawExtensionLines(h-t-e,c,10,l,"horizontal"),this.drawText(h-t-n,c+l/2,this.get("labels")[1]),this.connectExtensionLines(h-t-r,c,l,"vertical")),this.get("labels")[2]&&(this.drawExtensionLines(h-t-e,c,10,l/2,"horizontal"),this.drawText(h-t-n,c+l/4,this.get("labels")[2]),this.connectExtensionLines(h-t-r,c,l/2,"vertical"))),2===this.get("rotation")&&(this.get("labels")[1]&&(this.drawExtensionLines(h+a+t+e-10,c,10,l,"horizontal"),this.drawText(h+a+t+n,c+l/2,this.get("labels")[1]),this.connectExtensionLines(h+a+t+r,c,l,"vertical")),this.get("labels")[2]&&(this.drawExtensionLines(h+a+t+e-10,c,10,l/2,"horizontal"),this.drawText(h+a+t+n,c+l/4,this.get("labels")[2]),this.connectExtensionLines(h+a+t+r,c,l/2,"vertical")));break;case 1:case 3:d=this.get("labels")[0]?150:20,u=this.get("labels")[1]||this.get("labels")[2]?80:20;var f=this.get("h")-u;1===this.get("sizeID")&&(a=5*f/9,l=2*a,l>=this.get("w")-d&&(l=this.get("w")-d,a=.5*l)),2===this.get("sizeID")&&(a=5*f/7,l=a,l>=this.get("w")-d&&(l=this.get("w")-d,a=l)),3===this.get("sizeID")&&(a=5*f/6,l=.5*a,l>=this.get("w")-u&&(l=this.get("w")-d,a=2*l)),h=this.get("w")/2-l/2,c=this.get("h")/2-a/2,this.drawCylinder(c,h,l,a),t=l/5,this.get("labels")[0]&&(this.drawExtensionLines(h-e,c,10,a,"horizontal"),this.drawText(h-n,c+a/2,this.get("labels")[0]),this.connectExtensionLines(h-r,c,a,"vertical")),1===this.get("rotation")&&(this.get("labels")[1]&&(this.drawExtensionLines(h,c-t-i,10,l,"vertical"),this.drawText(h+l/2,c-t-o-parseInt(this.get("textSize"))/2,this.get("labels")[1]),this.connectExtensionLines(h,c-t-s,l,"horizontal")),this.get("labels")[2]&&(this.drawExtensionLines(h,c-t-i,10,l/2,"vertical"),this.drawText(h+l/4,c-t-o-parseInt(this.get("textSize"))/2,this.get("labels")[2]),this.connectExtensionLines(h,c-t-s,l/2,"horizontal"))),3===this.get("rotation")&&(this.get("labels")[1]&&(this.drawExtensionLines(h,c+a+t+5,10,l,"vertical"),this.drawText(h+l/2,c+a+t+o+parseInt(this.get("textSize"))/2,this.get("labels")[1]),this.connectExtensionLines(h,c+a+t+s,l,"horizontal")),this.get("labels")[2]&&(this.drawExtensionLines(h,c+a+t+5,10,l/2,"vertical"),this.drawText(h+l/4,c+a+t+o+parseInt(this.get("textSize"))/2,this.get("labels")[2]),this.connectExtensionLines(h,c+a+t+s,l/2,"horizontal")))}}if(1===this.get("shapeID")){var g,m,x,y,v,C,w,b;v=this.get("labels")[0]||this.get("labels")[1]?150:20,C=20,w=this.get("w")-v,b=this.get("h")-C,g=this.get("w")/2,m=this.get("h")/2,w<b?(x=w,y=w/2):(x=b,y=b/2),this.drawSphere(g,m,x),0!==this.get("labels")[0]?(this.drawExtensionLines(g-x/2-e,m-x/2,10,x,"horizontal"),this.drawText(g-x/2-n,m,this.get("labels")[0]),this.connectExtensionLines(g-x/2-r,m-x/2,x,"vertical")):0!==this.get("labels")[1]&&(this.drawExtensionLines(g-y-e,m-y,10,y,"horizontal"),this.drawText(g-y-n,m-y/2,this.get("labels")[1]),this.connectExtensionLines(g-y-r,m-y,y,"vertical"))}if(3===this.get("shapeID")){0===this.get("dimensions")[2]&&(this.get("dimensions")[0]/this.get("dimensions")[1]===1?this.set({sizeID:2}):this.get("dimensions")[0]/this.get("dimensions")[1]>1?this.set({sizeID:3}):this.set({sizeID:1})),0!==this.get("dimensions")[2]&&(this.get("dimensions")[0]/(2*this.get("dimensions")[2])===1?this.set({sizeID:2}):this.get("dimensions")[0]/(2*this.get("dimensions")[2])>1?this.set({sizeID:3}):this.set({sizeID:1}));var a,l,h,c,u,d;if(0===this.get("rotation")||2===this.get("rotation")){d=this.get("labels")[0]?125:20,u=this.get("labels")[1]||this.get("labels")[2]?80:20;var M=this.get("h")-u;e=20,n=15,r=15}else{d=this.get("labels")[0]?90:20,u=this.get("labels")[1]||this.get("labels")[2]?150:20;var M=this.get("w")-u;e=42.5,n=37.5,r=37.5,i=20,o=22,s=15}switch(this.get("rotation")){case 0:i=5,o=20,s=10,1===this.get("sizeID")&&(a=15*M/17,l=2*a,l>=this.get("w")-d&&(l=this.get("w")-d,a=.5*l)),2===this.get("sizeID")&&(a=15*M/16,l=a,l>=this.get("w")-d&&(l=this.get("w")-d,a=l)),3===this.get("sizeID")&&(a=30*M/31,l=.5*a,l>=this.get("w")-d&&(l=this.get("w")-d,a=2*l)),t=l/15,M=a+t,h=this.get("w")/2,c=this.get("h")/2-M/2,this.drawCone(h,c,l,a),this.get("labels")[0]&&(this.drawExtensionLines(h-l/2-e,c,10,a,"horizontal"),this.drawText(h-l/2-n,c+a/2,this.get("labels")[0]),this.connectExtensionLines(h-l/2-r,c,a,"vertical")),this.get("labels")[1]&&(this.drawExtensionLines(h-l/2,c+a+t+i,10,l,"vertical"),this.drawText(h,c+a+t+o+parseInt(this.get("textSize"))/2,this.get("labels")[1]),this.connectExtensionLines(h-l/2,c+a+t+s,l,"horizontal")),this.get("labels")[2]&&(this.drawExtensionLines(h-l/2,c+a+t+i,10,l/2,"vertical"),this.drawText(h-l/4,c+a+t+o+parseInt(this.get("textSize"))/2,this.get("labels")[2]),this.connectExtensionLines(h-l/2,c+a+t+s,l/2,"horizontal"));break;case 2:i=15,o=17,s=10,1===this.get("sizeID")&&(a=15*M/17,l=2*a,l>=this.get("w")-d&&(l=this.get("w")-d,a=.5*l)),2===this.get("sizeID")&&(a=15*M/16,l=a,l>=this.get("w")-d&&(l=this.get("w")-d,a=l)),3===this.get("sizeID")&&(a=30*M/31,l=.5*a,l>=this.get("w")-d&&(l=this.get("w")-d,a=2*l)),t=l/15,M=a+t,h=this.get("w")/2,c=this.get("h")/2-M/2,this.drawCone(h,c,l,a),this.get("labels")[0]&&(this.drawExtensionLines(h-l/2-e,c+t,10,a,"horizontal"),this.drawText(h-l/2-n,c+t+a/2,this.get("labels")[0]),this.connectExtensionLines(h-l/2-r,c+t,a,"vertical")),this.get("labels")[1]&&(this.drawExtensionLines(h-l/2,c-i,10,l,"vertical"),this.drawText(h,c-o-parseInt(this.get("textSize"))/2,this.get("labels")[1]),this.connectExtensionLines(h-l/2,c-s,l,"horizontal")),this.get("labels")[2]&&(this.drawExtensionLines(h-l/2,c-i,10,l/2,"vertical"),this.drawText(h-l/4,c-o-parseInt(this.get("textSize"))/2,this.get("labels")[2]),this.connectExtensionLines(h-l/2,c-s,l/2,"horizontal"));break;case 1:1===this.get("sizeID")&&(a=15*M/17,l=2*a,l>=this.get("h")-d&&(l=this.get("h")-d,a=.5*l)),2===this.get("sizeID")&&(a=15*M/16,l=a,l>=this.get("h")-d&&(l=this.get("h")-d,a=l)),3===this.get("sizeID")&&(a=30*M/31,l=.5*a,l>=this.get("h")-d&&(l=this.get("h")-d,a=2*l)),t=l/15,M=a+t,h=this.get("w")/2-M/2,c=this.get("h")/2,this.drawCone(c,h,l,a),this.get("labels")[0]&&(this.drawExtensionLines(h+t,c-l/2-i,10,a,"vertical"),this.drawText(h+t+a/2,c-l/2-o-parseInt(this.get("textSize"))/2,this.get("labels")[0]),this.connectExtensionLines(h+t,c-l/2-s,a,"horizontal")),this.get("labels")[1]&&(this.drawExtensionLines(h-e,c-l/2,10,l,"horizontal"),this.drawText(h-n,c,this.get("labels")[1]),this.connectExtensionLines(h-r,c-l/2,l,"vertical")),this.get("labels")[2]&&(this.drawExtensionLines(h-e,c-l/2,10,l/2,"horizontal"),this.drawText(h-n,c-l/4,this.get("labels")[2]),this.connectExtensionLines(h-r,c-l/2,l/2,"vertical"));break;case 3:1===this.get("sizeID")&&(a=15*M/17,l=2*a,l>=this.get("h")-d&&(l=this.get("h")-d,a=.5*l)),2===this.get("sizeID")&&(a=15*M/16,l=a,l>=this.get("h")-d&&(l=this.get("h")-d,a=l)),3===this.get("sizeID")&&(a=30*M/31,l=.5*a,l>=this.get("h")-d&&(l=this.get("h")-d,a=2*l)),t=l/15,M=a+t,h=this.get("w")/2-M/2,c=this.get("h")/2,this.drawCone(c,h,l,a),this.get("labels")[0]&&(this.drawExtensionLines(h,c-l/2-i,10,a,"vertical"),this.drawText(h+a/2,c-l/2-o-parseInt(this.get("textSize"))/2,this.get("labels")[0]),this.connectExtensionLines(h,c-l/2-s,a,"horizontal")),this.get("labels")[1]&&(this.drawExtensionLines(h+a+t+e-10,c-l/2,10,l,"horizontal"),this.drawText(h+a+t+n,c,this.get("labels")[1]),this.connectExtensionLines(h+a+t+r,c-l/2,l,"vertical")),this.get("labels")[2]&&(this.drawExtensionLines(h+a+t+e-10,c-l/2,10,l/2,"horizontal"),this.drawText(h+a+t+n,c-l/4,this.get("labels")[2]),this.connectExtensionLines(h+a+t+r,c-l/2,l/2,"vertical"))}}if(5===this.get("shapeID")){var S,a,h,c,E,I,N,O=.75;N=30,this.get("dimensions")[0]/this.get("dimensions")[1]===1?this.set({sizeID:2}):this.get("dimensions")[0]/this.get("dimensions")[1]<1?this.set({sizeID:1}):this.set({sizeID:3});var T,_;this.get("labels")[0]&&(E=100),this.get("labels")[2]&&(E=135),this.get("labels")[2]||this.get("labels")[0]||(E=20),I=this.get("labels")[1]?120:20,T=this.get("w")-E,_=this.get("h")-I,S=T/(1+O*Math.cos(N*Math.PI/180)),a=1===this.get("sizeID")?.5*S:2===this.get("sizeID")?S:2*S,a+O*S*Math.sin(N*Math.PI/180)+I>this.get("h")&&(1===this.get("sizeID")&&(a=_/(1+2*O*Math.sin(N*Math.PI/180)),S=2*a),2===this.get("sizeID")&&(a=_/(1+O*Math.sin(N*Math.PI/180)),S=a),3===this.get("sizeID")&&(a=_/(1+.5*O*Math.sin(N*Math.PI/180)),S=.5*a)),h=this.get("w")/2,c=(this.get("h")-a-O*S/2*Math.sin(N*Math.PI/180))/2,this.drawSquareBasedPyramid(h,c,S,a,N);var P={x:h,y:c},A={x:h,y:c+a},k={x:A.x-S/2-S*O/2*Math.cos(N*Math.PI/180),y:A.y+S*O/2*Math.sin(N*Math.PI/180)};if(this.get("labels")[0]){this.components.add({type:"line",xStart:P.x,yStart:P.y,xEnd:A.x,yEnd:A.y}),this.components.add({type:"line",xStart:P.x,yStart:P.y+a/3,xEnd:P.x-S/2,yEnd:P.y+a/3}),this.components.add({x:P.x-S/2-5,y:P.y+a/3,type:"text",textSize:this.get("textSize"),text:this.get("labels")[0],textColor:this.get("textColor"),textFont:this.get("labelFont"),fillStyle:this.get("fillStyle"),lineWidth:4,textAlign:"right"});var R=S/15;this.components.add({type:"line",xStart:A.x,yStart:A.y-R,xEnd:A.x+R,yEnd:A.y-R}),this.components.add({type:"line",xStart:A.x+R,yStart:A.y-R,xEnd:A.x+R,yEnd:A.y}),this.components.add({type:"line",xStart:A.x,yStart:A.y,xEnd:A.x+R,yEnd:A.y})}if(this.get("labels")[1]&&(this.drawExtensionLines(k.x,k.y+10,10,S,"vertical"),this.drawText(k.x+S/2,k.y+parseInt(this.get("textSize"))/2+24,this.get("labels")[1]),this.connectExtensionLines(k.x,k.y+15,S,"horizontal")),this.get("labels")[2]){var z=180-(180*Math.atan(a/(S/2))/Math.PI+N);this.components.add({type:"line",xStart:P.x,yStart:P.y,xEnd:P.x+S/2,yEnd:P.y+a}),this.components.add({type:"line",xStart:P.x+S/6,yStart:P.y+a/3,xEnd:P.x+S/6+S/2,yEnd:P.y+a/3}),this.components.add({x:P.x+S/6+S/2+5,y:P.y+a/3,type:"text",textSize:this.get("textSize"),text:this.get("labels")[2],textColor:this.get("textColor"),textFont:this.get("labelFont"),fillStyle:this.get("fillStyle"),lineWidth:4,textAlign:"left"});var R=S/15;this.components.add({type:"line",xStart:P.x+S/2+R*Math.cos(N*Math.PI/180),yStart:A.y-R*Math.sin(N*Math.PI/180),xEnd:P.x+S/2+R*Math.cos(N*Math.PI/180)-R*Math.cos(((360-2*z)/2-N)*Math.PI/180),yEnd:A.y-R*Math.sin(N*Math.PI/180)-R*Math.sin(((360-2*z)/2-N)*Math.PI/180)}),this.components.add({type:"line",xStart:P.x+S/2-R*Math.cos(((360-2*z)/2-N)*Math.PI/180),yStart:A.y-R*Math.sin(((360-2*z)/2-N)*Math.PI/180),xEnd:P.x+S/2+R*Math.cos(N*Math.PI/180)-R*Math.cos(((360-2*z)/2-N)*Math.PI/180),yEnd:A.y-R*Math.sin(N*Math.PI/180)-R*Math.sin(((360-2*z)/2-N)*Math.PI/180)})}}if(8===this.get("shapeID")){var h,c,a,S,B,L,D,W,N,F=.2;S=this.get("dimensions")[1],B=this.get("dimensions")[2],L=this.get("dimensions")[3],D=this.get("rotation"),W=this.get("color"),N=30;var V,v;if(S===L?B<S?this.set({sizeID:1}):B===S?this.set({sizeID:2}):this.set({sizeID:3}):S>L?B<S?this.set({sizeID:4}):B===S?this.set({sizeID:5}):this.set({sizeID:6}):B<S?this.set({sizeID:7}):B===S?this.set({sizeID:8}):this.set({sizeID:9}),!D){v=this.get("labels")[0]||this.get("labels")[2]||this.get("labels")[3]?170:20,V=this.get("labels")[1]?120:20;var q=this.get("w")-v,H=this.get("h")-V;1!==this.get("sizeID")&&4!==this.get("sizeID")&&7!==this.get("sizeID")||(S=q/(1+.5*Math.cos(N*Math.PI/180)),B=.5*S),2!==this.get("sizeID")&&5!==this.get("sizeID")&&8!==this.get("sizeID")||(S=q/(1+Math.cos(N*Math.PI/180)),B=S),3!==this.get("sizeID")&&6!==this.get("sizeID")&&9!==this.get("sizeID")||(S=q/(1+2*Math.cos(N*Math.PI/180)),B=2*S),1!==this.get("sizeID")&&2!==this.get("sizeID")&&3!==this.get("sizeID")||(a=S/2*Math.tan(60*Math.PI/180)),4!==this.get("sizeID")&&5!==this.get("sizeID")&&6!==this.get("sizeID")||(a=.4*S),7!==this.get("sizeID")&&8!==this.get("sizeID")&&9!==this.get("sizeID")||(a=2*S),a+B*Math.sin(N*Math.PI/180)>H&&(1===this.get("sizeID")&&(a=H/(1+Math.sin(N*Math.PI/180)/Math.tan(60*Math.PI/180))),2===this.get("sizeID")&&(a=H/(1+2*(Math.sin(N*Math.PI/180)/Math.tan(60*Math.PI/180)))),3===this.get("sizeID")&&(a=H/(1+4*(Math.sin(N*Math.PI/180)/Math.tan(60*Math.PI/180)))),4===this.get("sizeID")&&(a=H/(1+5/4*Math.sin(N*Math.PI/180))),5===this.get("sizeID")&&(a=H/(1+2.5*Math.sin(N*Math.PI/180))),6===this.get("sizeID")&&(a=H/(1+5*Math.sin(N*Math.PI/180))),7===this.get("sizeID")&&(a=H/(1+.25*Math.sin(N*Math.PI/180))),8===this.get("sizeID")&&(a=H/(1+.5*Math.sin(N*Math.PI/180))),9===this.get("sizeID")&&(a=H/(1+Math.sin(N*Math.PI/180))),1!==this.get("sizeID")&&2!==this.get("sizeID")&&3!==this.get("sizeID")||(S=2*a/Math.tan(60*Math.PI/180)),4!==this.get("sizeID")&&5!==this.get("sizeID")&&6!==this.get("sizeID")||(S=2.5*a),7!==this.get("sizeID")&&8!==this.get("sizeID")&&9!==this.get("sizeID")||(S=.5*a),1!==this.get("sizeID")&&4!==this.get("sizeID")&&7!==this.get("sizeID")||(B=.5*S),2!==this.get("sizeID")&&5!==this.get("sizeID")&&8!==this.get("sizeID")||(B=S),3!==this.get("sizeID")&&6!==this.get("sizeID")&&9!==this.get("sizeID")||(B=2*S)),L=Math.sqrt(.5*S*(.5*S)+a*a),h=(this.get("w")-S-B*Math.cos(N*Math.PI/180))/2+S/2,c=(this.get("h")-a-B*Math.sin(N*Math.PI/180))/2+B*Math.sin(N*Math.PI/180),this.drawTriangularPrism(h,c,a,S,B,L,N);var U={x:h,y:c},j={x:h-S/2,y:c+a},$={x:h+S/2,y:c+a},G={x:h+B*Math.cos(N*Math.PI/180),y:c-B*Math.sin(N*Math.PI/180)},Y={x:G.x-S/2,y:G.y+a},J={x:G.x+S/2,y:G.y+a};if(this.get("labels")[0]&&(this.components.add({type:"line",xStart:U.x,yStart:U.y,xEnd:(j.x+$.x)/2,yEnd:j.y}),this.components.add({type:"line",xStart:(j.x+$.x)/2,yStart:j.y-S/15,xEnd:(j.x+$.x)/2+S/15,yEnd:j.y-S/15}),this.components.add({type:"line",xStart:(j.x+$.x)/2+S/15,yStart:j.y-S/15,xEnd:(j.x+$.x)/2+S/15,yEnd:j.y}),this.components.add({type:"line",xStart:(j.x+$.x)/2,yStart:U.y+a/2,xEnd:(j.x+$.x)/2-S/2,yEnd:U.y+a/2}),this.components.add({x:(j.x+$.x)/2-S/2-5,y:U.y+a/2,type:"text",textSize:this.get("textSize"),text:this.get("labels")[0],textColor:this.get("textColor"),textFont:this.get("labelFont"),fillStyle:this.get("fillStyle"),textAlign:"right",lineWidth:4,textBaseline:"middle"})),this.get("labels")[1]&&(this.drawExtensionLines(j.x,j.y+10,10,S,"vertical"),this.drawText(j.x+S/2,j.y+parseInt(this.get("textSize"))/2+24,this.get("labels")[1]),this.connectExtensionLines(j.x,j.y+15,S,"horizontal")),this.get("labels")[2]){var X=180*Math.atan(a/(S/2))/Math.PI;this.components.add({type:"line",xStart:$.x+10*Math.cos(X*Math.PI/180),yStart:$.y+10*Math.sin(X*Math.PI/180),xEnd:$.x+20*Math.cos(X*Math.PI/180),yEnd:$.y+20*Math.sin(X*Math.PI/180)}),this.components.add({type:"line",xStart:J.x+10*Math.cos(X*Math.PI/180),yStart:J.y+10*Math.sin(X*Math.PI/180),xEnd:J.x+20*Math.cos(X*Math.PI/180),yEnd:J.y+20*Math.sin(X*Math.PI/180)}),this.components.add({type:"line",xStart:$.x+15*Math.cos(X*Math.PI/180),yStart:$.y+15*Math.sin(X*Math.PI/180),xEnd:J.x+15*Math.cos(X*Math.PI/180),yEnd:J.y+15*Math.sin(X*Math.PI/180)}),this.components.add({x:($.x+J.x)/2+22*Math.sin(N*Math.PI/180),y:($.y+J.y)/2+22*Math.cos(N*Math.PI/180),type:"text",textSize:this.get("textSize"),text:this.get("labels")[2],textColor:this.get("textColor"),textFont:this.get("labelFont"),fillStyle:this.get("fillStyle"),textAlign:"left",lineWidth:4,textBaseline:"top"})}this.get("labels")[3]&&(this.components.add({type:"line",xStart:G.x+10*Math.cos(N*Math.PI/180),yStart:G.y-10*Math.sin(N*Math.PI/180),xEnd:G.x+20*Math.cos(N*Math.PI/180),yEnd:G.y-20*Math.sin(N*Math.PI/180)}),this.components.add({type:"line",xStart:J.x+10*Math.cos(N*Math.PI/180),yStart:J.y-10*Math.sin(N*Math.PI/180),xEnd:J.x+20*Math.cos(N*Math.PI/180),yEnd:J.y-20*Math.sin(N*Math.PI/180)}),this.components.add({type:"line",xStart:G.x+15*Math.cos(N*Math.PI/180),yStart:G.y-15*Math.sin(N*Math.PI/180),xEnd:J.x+15*Math.cos(N*Math.PI/180),yEnd:J.y-15*Math.sin(N*Math.PI/180)}),this.components.add({x:(G.x+J.x)/2+22*Math.sin((90-N)*Math.PI/180),y:(G.y+J.y)/2-22*Math.cos((90-N)*Math.PI/180),type:"text",textSize:this.get("textSize"),text:this.get("labels")[3],textColor:this.get("textColor"),textFont:this.get("labelFont"),fillStyle:this.get("fillStyle"),lineWidth:4,textAlign:"left",textBaseline:"bottom"}))}if(D){v=this.get("labels")[1]||this.get("labels")[2]||this.get("labels")[3]?180:40,V=60;var q=this.get("w")-v,H=this.get("h")-V;N=60,1!==this.get("sizeID")&&2!==this.get("sizeID")&&3!==this.get("sizeID")||(S=q/Math.cos((60-N)*Math.PI/180),a=S/2*Math.tan(60*Math.PI/180)),4!==this.get("sizeID")&&5!==this.get("sizeID")&&6!==this.get("sizeID")||(S=1/Math.sqrt(41)*10*q/Math.cos((N-180*Math.atan(.8)/Math.PI)*Math.PI/180),a=.4*S),7!==this.get("sizeID")&&8!==this.get("sizeID")&&9!==this.get("sizeID")||(S=1/Math.sqrt(17)*2*q/Math.cos((180*Math.atan(4)/Math.PI-N)*Math.PI/180),a=2*S),1!==this.get("sizeID")&&4!==this.get("sizeID")&&7!==this.get("sizeID")||(B=.5*S),2!==this.get("sizeID")&&5!==this.get("sizeID")&&8!==this.get("sizeID")||(B=S),3!==this.get("sizeID")&&6!==this.get("sizeID")&&9!==this.get("sizeID")||(B=2*S),7===this.get("sizeID")||8===this.get("sizeID")||9===this.get("sizeID")?B+S*Math.sin(N*Math.PI/180)+L*Math.sin((180*Math.atan(4)/Math.PI-N)*Math.PI/180)>H&&(7===this.get("sizeID")&&(a=H/(.25+.5*Math.sin(N*Math.PI/180)+Math.sqrt(17/16)*Math.sin((180*Math.atan(4)/Math.PI-N)*Math.PI/180)),S=a/2,B=.5*S),8===this.get("sizeID")&&(a=H/(.5+.5*Math.sin(N*Math.PI/180)+Math.sqrt(17/16)*Math.sin((180*Math.atan(4)/Math.PI-N)*Math.PI/180)),S=a/2,B=S),9===this.get("sizeID")&&(a=H/(1+.5*Math.sin(N*Math.PI/180)+Math.sqrt(17/16)*Math.sin((180*Math.atan(4)/Math.PI-N)*Math.PI/180)),S=a/2,B=2*S)):B+S*Math.sin(N*Math.PI/180)>H&&(1===this.get("sizeID")&&(a=H/((1+2*Math.sin(N*Math.PI/180))/Math.tan(60*Math.PI/180)),S=2*a/Math.tan(60*Math.PI/180),B=.5*S),2===this.get("sizeID")&&(a=H/((2+2*Math.sin(N*Math.PI/180))/Math.tan(60*Math.PI/180)),S=2*a/Math.tan(60*Math.PI/180),B=S),3===this.get("sizeID")&&(a=H/((4+2*Math.sin(N*Math.PI/180))/Math.tan(60*Math.PI/180)),S=2*a/Math.tan(60*Math.PI/180),B=2*S),4===this.get("sizeID")&&(a=H/(5/4+2.5*Math.sin(N*Math.PI/180)),S=5*a/2,B=.5*S),5===this.get("sizeID")&&(a=H/(2.5+2.5*Math.sin(N*Math.PI/180)),S=5*a/2,B=S),6===this.get("sizeID")&&(a=H/(5+2.5*Math.sin(N*Math.PI/180)),S=5*a/2,B=2*S));var X=180*Math.atan(a/(S/2))/Math.PI;if(L=Math.sqrt(.5*S*(.5*S)+a*a),h=(this.get("w")-L*Math.cos((X-N)*Math.PI/180))/2,1!==this.get("sizeID")&&2!==this.get("sizeID")&&3!==this.get("sizeID")||(c=(this.get("h")-B-S*Math.sin(N*Math.PI/180))/2+F*B/2),4!==this.get("sizeID")&&5!==this.get("sizeID")&&6!==this.get("sizeID")||(c=(this.get("h")-B-S*Math.sin(N*Math.PI/180))/2),7!==this.get("sizeID")&&8!==this.get("sizeID")&&9!==this.get("sizeID")||(c=(this.get("h")-B-S*Math.sin(N*Math.PI/180)-L*Math.sin((X-N)*Math.PI/180))/2+L*Math.sin((X-N)*Math.PI/180)),this.drawTriangularPrism(h,c,a,S,B,L,N),1===this.get("sizeID")||2===this.get("sizeID")||3===this.get("sizeID"))var U={x:h,y:c},j={x:h,y:c+B},$={x:j.x+S*Math.cos(N*Math.PI/180),y:j.y+S*Math.sin(N*Math.PI/180)-F*B},G={x:j.x+S*Math.cos(N*Math.PI/180),y:$.y-B},Y={x:U.x+L*Math.cos((X-N)*Math.PI/180),y:U.y-L*Math.sin((X-N)*Math.PI/180)},J={x:Y.x,y:Y.y+B};else var U={x:h,y:c},j={x:h,y:c+B},$={x:j.x+S*Math.cos(N*Math.PI/180),y:j.y+S*Math.sin(N*Math.PI/180)},G={x:j.x+S*Math.cos(N*Math.PI/180),y:$.y-B},Y={x:U.x+L*Math.cos((X-N)*Math.PI/180),y:U.y-L*Math.sin((X-N)*Math.PI/180)},J={x:Y.x,y:Y.y+B};if(this.get("labels")[2]&&(this.drawExtensionLines(U.x-47.5,U.y,10,B,"horizontal"),this.drawText(U.x-42.5,U.y+B/2,this.get("labels")[2]),this.connectExtensionLines(U.x-42.5,U.y,B,"vertical")),this.get("labels")[3]&&(this.components.add({type:"line",xStart:$.x+10*Math.cos((90-N)*Math.PI/180),yStart:$.y+10*Math.sin((90-N)*Math.PI/180),xEnd:$.x+20*Math.cos((90-N)*Math.PI/180),yEnd:$.y+20*Math.sin((90-N)*Math.PI/180)}),this.components.add({type:"line",xStart:J.x+10*Math.cos((90-N)*Math.PI/180),yStart:J.y+10*Math.sin((90-N)*Math.PI/180),xEnd:J.x+20*Math.cos((90-N)*Math.PI/180),yEnd:J.y+20*Math.sin((90-N)*Math.PI/180)}),this.components.add({type:"line",xStart:$.x+15*Math.cos((90-N)*Math.PI/180),yStart:$.y+15*Math.sin((90-N)*Math.PI/180),xEnd:J.x+15*Math.cos((90-N)*Math.PI/180),yEnd:J.y+15*Math.sin((90-N)*Math.PI/180)}),this.components.add({x:($.x+J.x)/2+(23+parseInt(this.get("textSize"))/2)*Math.cos((90-N)*Math.PI/180),y:($.y+J.y)/2+(23+parseInt(this.get("textSize"))/2)*Math.sin((90-N)*Math.PI/180),type:"text",textSize:this.get("textSize"),text:this.get("labels")[3],textColor:this.get("textColor"),textFont:this.get("labelFont"),fillStyle:this.get("fillStyle"),lineWidth:4,textAlign:"left",textBaseline:"middle"})),this.get("labels")[1]&&(this.components.add({type:"line",xStart:j.x-10*Math.cos((90-X)*Math.PI/180),yStart:j.y+10*Math.sin((90-X)*Math.PI/180),xEnd:j.x-20*Math.cos((90-X)*Math.PI/180),yEnd:j.y+20*Math.sin((90-X)*Math.PI/180)}),this.components.add({type:"line",xStart:$.x-10*Math.cos((90-X)*Math.PI/180),yStart:$.y+10*Math.sin((90-X)*Math.PI/180),xEnd:$.x-20*Math.cos((90-X)*Math.PI/180),yEnd:$.y+20*Math.sin((90-X)*Math.PI/180)}),this.components.add({type:"line",xStart:j.x-15*Math.cos((90-X)*Math.PI/180),yStart:j.y+15*Math.sin((90-X)*Math.PI/180),xEnd:$.x-15*Math.cos((90-X)*Math.PI/180),yEnd:$.y+15*Math.sin((90-X)*Math.PI/180)}),this.components.add({x:(j.x+$.x)/2-(23+parseInt(this.get("textSize"))/2)*Math.cos((90-X)*Math.PI/180),y:(j.y+$.y)/2+(23+parseInt(this.get("textSize"))/2)*Math.sin((90-X)*Math.PI/180),type:"text",textSize:this.get("textSize"),text:this.get("labels")[1],textColor:this.get("textColor"),textFont:this.get("labelFont"),fillStyle:this.get("fillStyle"),lineWidth:4,textAlign:"right",textBaseline:"middle"})),this.get("labels")[0]){this.components.add({type:"line",xStart:Y.x,yStart:Y.y,xEnd:(U.x+G.x)/2,yEnd:(U.y+G.y)/2});var Z=0;if(1===this.get("sizeID")||2===this.get("sizeID")||3===this.get("sizeID")){var R=(S-a)/2;Z=F*B/2,X=180*Math.atan((G.y-U.y)/(G.x-U.x))/Math.PI;var Q=Math.sqrt((G.x-U.x)*(G.x-U.x)+(G.y-U.y)*(G.y-U.y)),K=Math.sqrt((Y.x-G.x)*(Y.x-G.x)+(Y.y-G.y)*(Y.y-G.y)),tt=Math.sqrt((Y.x-U.x)*(Y.x-U.x)+(Y.y-U.y)*(Y.y-U.y)),et=Math.sqrt((Y.x-(U.x+G.x)/2)*(Y.x-(U.x+G.x)/2)+(Y.y-(U.y+G.y)/2)*(Y.y-(U.y+G.y)/2)),nt=180*Math.acos((K*K-tt*tt-Q*Q)/(-2*tt*Q))/Math.PI,rt=180*Math.acos((tt*tt-Q/2*(Q/2)-et*et)/(-2*et*Q/2))/Math.PI,N=180*Math.asin((Y.x-U.x)/2/Q)/Math.PI;this.components.add({type:"line",xStart:(U.x+G.x)/2-R*Math.cos(nt*Math.PI/180),yStart:(U.y+G.y)/2-R*Math.sin(nt*Math.PI/180),xEnd:(U.x+G.x)/2-R*Math.cos(nt*Math.PI/180)+R*Math.cos((90-rt+N)*Math.PI/180),yEnd:(U.y+G.y)/2-R*Math.sin(nt*Math.PI/180)-R*Math.sin((90-rt+N)*Math.PI/180)}),this.components.add({type:"line",xStart:(U.x+G.x)/2-R*Math.cos(nt*Math.PI/180)+R*Math.cos((90-rt+N)*Math.PI/180),yStart:(U.y+G.y)/2-R*Math.sin(nt*Math.PI/180)-R*Math.sin((90-rt+N)*Math.PI/180),xEnd:(U.x+G.x)/2+R*Math.cos((90-rt+N)*Math.PI/180),yEnd:(U.y+G.y)/2-R*Math.sin((90-rt+N)*Math.PI/180)}),this.components.add({type:"line",xStart:Y.x-et/3*Math.cos((180-nt-rt)*Math.PI/180),yStart:Y.y+et/3*Math.sin((180-nt-rt)*Math.PI/180),xEnd:Y.x-et/3*Math.cos((180-nt-rt)*Math.PI/180)-S/4*Math.cos((-90+nt+rt)*Math.PI/180),yEnd:Y.y+et/3*Math.sin((180-nt-rt)*Math.PI/180)-S/4*Math.sin((-90+nt+rt)*Math.PI/180)}),this.components.add({x:Y.x-et/3*Math.cos((180-nt-rt)*Math.PI/180)-S/4*Math.cos((-90+nt+rt)*Math.PI/180),y:Y.y+et/3*Math.sin((180-nt-rt)*Math.PI/180)-S/4*Math.sin((-90+nt+rt)*Math.PI/180)-2,
type:"text",textSize:this.get("textSize"),text:this.get("labels")[0],textColor:this.get("textColor"),textFont:this.get("labelFont"),fillStyle:this.get("fillStyle"),lineWidth:4,textAlign:"right",textBaseline:"bottom"})}else{if(4===this.get("sizeID")||5===this.get("sizeID")||6===this.get("sizeID"))var R=(S-a)/10;else var R=S/10;this.components.add({type:"line",xStart:Y.x-(a-R)*Math.cos((90-N)*Math.PI/180),yStart:Y.y+(a-R)*Math.sin((90-N)*Math.PI/180)-Z,xEnd:Y.x-(a-R)*Math.cos((90-N)*Math.PI/180)+R*Math.cos((180-N)*Math.PI/180),yEnd:Y.y+(a-R)*Math.sin((90-N)*Math.PI/180)-R*Math.sin((180-N)*Math.PI/180)-Z}),this.components.add({type:"line",xStart:Y.x-(a-R)*Math.cos((90-N)*Math.PI/180)+R*Math.cos((180-N)*Math.PI/180),yStart:Y.y+(a-R)*Math.sin((90-N)*Math.PI/180)-R*Math.sin((180-N)*Math.PI/180)-Z,xEnd:Y.x-a*Math.cos((90-N)*Math.PI/180)+R*Math.cos((180-N)*Math.PI/180),yEnd:Y.y+a*Math.sin((90-N)*Math.PI/180)-R*Math.sin((180-N)*Math.PI/180)-Z}),this.components.add({type:"line",xStart:Y.x-a/3*Math.cos((90-N)*Math.PI/180),yStart:Y.y+a/3*Math.sin((90-N)*Math.PI/180),xEnd:Y.x-a/3*Math.cos((90-N)*Math.PI/180)+S/4*Math.cos((180-N)*Math.PI/180),yEnd:Y.y+a/3*Math.sin((90-N)*Math.PI/180)-S/4*Math.sin((180-N)*Math.PI/180)}),4!==this.get("sizeID")&&5!==this.get("sizeID")&&6!==this.get("sizeID")||this.components.add({x:Y.x-a/3*Math.cos((90-N)*Math.PI/180)+S/4*Math.cos((180-N)*Math.PI/180)-5,y:Y.y+a/3*Math.sin((90-N)*Math.PI/180)-S/4*Math.sin((180-N)*Math.PI/180)-2,type:"text",textSize:this.get("textSize"),text:this.get("labels")[0],textColor:this.get("textColor"),textFont:this.get("labelFont"),fillStyle:this.get("fillStyle"),lineWidth:4,textAlign:"left",textBaseline:"bottom"}),7!==this.get("sizeID")&&8!==this.get("sizeID")&&9!==this.get("sizeID")||this.components.add({x:Y.x-a/3*Math.cos((90-N)*Math.PI/180)+S/4*Math.cos((180-N)*Math.PI/180),y:Y.y+a/3*Math.sin((90-N)*Math.PI/180)-S/4*Math.sin((180-N)*Math.PI/180)-2,type:"text",textSize:this.get("textSize"),text:this.get("labels")[0],textColor:this.get("textColor"),textFont:this.get("labelFont"),fillStyle:this.get("fillStyle"),lineWidth:4,textAlign:"right",textBaseline:"bottom"})}}}}if(7===this.get("shapeID")){var h,c,a=this.get("dimensions")[0],S=this.get("dimensions")[1],B=this.get("dimensions")[2],D=this.get("rotation"),W=this.get("color"),N=30,it=.6;if(S===B)a<S?this.set({sizeID:1}):a===S?this.set({sizeID:2}):this.set({sizeID:3});else{if(!(S>B))throw new Error("base < width is not applicable for a rectangular prism.");a<S?this.set({sizeID:4}):a===S?this.set({sizeID:5}):this.set({sizeID:6})}var v,V;D||(v=this.get("labels")[0]||this.get("labels")[2]?160:20,V=this.get("labels")[1]||this.get("labels")[2]?85:20),D&&(v=this.get("labels")[1]||this.get("labels")[2]?160:20,V=this.get("labels")[0]||this.get("labels")[2]?85:20);var q=this.get("w")-v,H=this.get("h")-V;if(1!==this.get("sizeID")&&2!==this.get("sizeID")&&3!==this.get("sizeID")||(S=D?H/(1+it*Math.sin(N*Math.PI/180)):q/(1+it*Math.cos(N*Math.PI/180)),B=S,1===this.get("sizeID")&&(a=S/2,!D&&a+B*it*Math.sin(N*Math.PI/180)>H&&(a=H/(1+2*it*Math.sin(N*Math.PI/180)),B=2*a,S=B),D&&a+B*it*Math.cos(N*Math.PI/180)>q&&(a=q/(1+2*it*Math.cos(N*Math.PI/180)),B=2*a,S=B)),2===this.get("sizeID")&&(a=S,!D&&a+B*it*Math.sin(N*Math.PI/180)>H&&(a=H/(1+it*Math.sin(N*Math.PI/180)),B=a,S=B),D&&a+B*it*Math.cos(N*Math.PI/180)>q&&(a=q/(1+it*Math.cos(N*Math.PI/180)),B=a,S=B)),3===this.get("sizeID")&&(a=2*S,!D&&a+B*it*Math.sin(N*Math.PI/180)>H&&(a=H/(1+.5*it*Math.sin(N*Math.PI/180)),B=.5*a,S=B),D&&a+B*it*Math.cos(N*Math.PI/180)>q&&(a=q/(1+.5*it*Math.cos(N*Math.PI/180)),B=.5*a,S=B))),4!==this.get("sizeID")&&5!==this.get("sizeID")&&6!==this.get("sizeID")||(D||(S=q/(1+.5*it*Math.cos(N*Math.PI/180))),D&&(S=H/(1+.5*it*Math.sin(N*Math.PI/180))),B=.5*S,4===this.get("sizeID")&&(a=S/2,!D&&a+B*it*Math.sin(N*Math.PI/180)>H&&(a=H/(1+it*Math.sin(N*Math.PI/180)),B=a,S=2*B),D&&a+B*it*Math.cos(N*Math.PI/180)>q&&(a=q/(1+it*Math.cos(N*Math.PI/180)),B=a,S=2*B)),5===this.get("sizeID")&&(a=S,!D&&a+B*it*Math.sin(N*Math.PI/180)>H&&(a=H/(1+.5*it*Math.sin(N*Math.PI/180)),B=.5*a,S=a),D&&a+B*it*Math.cos(N*Math.PI/180)>q&&(a=q/(1+.5*it*Math.cos(N*Math.PI/180)),B=.5*a,S=a)),6===this.get("sizeID")&&(a=2*S,!D&&a+B*Math.sin(N*Math.PI/180)>H&&(a=H/(1+.25*it*Math.sin(N*Math.PI/180)),B=.25*a,S=.5*a),D&&a+B*Math.cos(N*Math.PI/180)>q&&(a=q/(1+.25*it*Math.cos(N*Math.PI/180)),B=.25*a,S=.5*a))),D||(h=(this.get("w")-S-B*it*Math.cos(N*Math.PI/180))/2,c=(this.get("h")-a-B*it*Math.sin(N*Math.PI/180))/2+B*it*Math.sin(N*Math.PI/180)),D&&(h=(this.get("w")-a-B*it*Math.cos(N*Math.PI/180))/2,c=(this.get("h")-S-B*it*Math.sin(N*Math.PI/180))/2+B*it*Math.sin(N*Math.PI/180)),this.drawRectangularPrism(h,c,a,S,B,N),!D){var U={x:h,y:c},j={x:U.x+S,y:U.y},$={x:j.x,y:j.y+a},G={x:U.x,y:U.y+a},Y={x:U.x+B*it*Math.cos(N*Math.PI/180),y:U.y-B*it*Math.sin(N*Math.PI/180)},J={x:Y.x+S,y:Y.y},ot={x:J.x,y:J.y+a};({x:Y.x,y:Y.y+a})}if(D){var U={x:h,y:c},j={x:U.x+a,y:U.y},$={x:j.x,y:j.y+S},G={x:U.x,y:U.y+S},Y={x:U.x+B*it*Math.cos(N*Math.PI/180),y:U.y-B*it*Math.sin(N*Math.PI/180)},J={x:Y.x+a,y:Y.y},ot={x:J.x,y:J.y+S};({x:Y.x,y:Y.y+S})}D||(this.get("labels")[0]&&(this.drawExtensionLines(U.x-45,U.y,10,a,"horizontal"),this.drawText(U.x-40,U.y+a/2,this.get("labels")[0]),this.connectExtensionLines(U.x-40,U.y,a,"vertical")),this.get("labels")[1]&&(this.drawExtensionLines(G.x,G.y+10,10,S,"vertical"),this.drawText(G.x+S/2,G.y+23+parseInt(this.get("textSize"))/2,this.get("labels")[1]),this.connectExtensionLines(G.x,G.y+15,S,"horizontal"))),D&&(this.get("labels")[1]&&(this.drawExtensionLines(U.x-45,U.y,10,S,"horizontal"),this.drawText(U.x-40,U.y+S/2,this.get("labels")[1]),this.connectExtensionLines(U.x-40,U.y,S,"vertical")),this.get("labels")[0]&&(this.drawExtensionLines(G.x,G.y+10,10,a,"vertical"),this.drawText(G.x+a/2,G.y+23+parseInt(this.get("textSize"))/2,this.get("labels")[0]),this.connectExtensionLines(G.x,G.y+15,a,"horizontal"))),this.get("labels")[2]&&(this.components.add({type:"line",xStart:$.x+10*Math.cos((90-N)*Math.PI/180),yStart:$.y+10*Math.sin((90-N)*Math.PI/180),xEnd:$.x+20*Math.cos((90-N)*Math.PI/180),yEnd:$.y+20*Math.sin((90-N)*Math.PI/180)}),this.components.add({type:"line",xStart:ot.x+10*Math.cos((90-N)*Math.PI/180),yStart:ot.y+10*Math.sin((90-N)*Math.PI/180),xEnd:ot.x+20*Math.cos((90-N)*Math.PI/180),yEnd:ot.y+20*Math.sin((90-N)*Math.PI/180)}),this.components.add({type:"line",xStart:$.x+15*Math.cos((90-N)*Math.PI/180),yStart:$.y+15*Math.sin((90-N)*Math.PI/180),xEnd:ot.x+15*Math.cos((90-N)*Math.PI/180),yEnd:ot.y+15*Math.sin((90-N)*Math.PI/180)}),this.components.add({x:($.x+ot.x)/2+23*Math.cos((90-N)*Math.PI/180),y:($.y+ot.y)/2+23*Math.sin((90-N)*Math.PI/180),type:"text",textSize:this.get("textSize"),text:this.get("labels")[2],textColor:this.get("textColor"),textFont:this.get("labelFont"),fillStyle:this.get("fillStyle"),lineWidth:4,textBaseline:"top",textAlign:"left"}))}if(6===this.get("shapeID")){var h,c,v,V,a=this.get("dimensions")[0],S=this.get("dimensions")[1],N=30,st=20,at=85,lt=.7;v=this.get("labels")[1]&&this.get("labels"[0])?180:this.get("labels")[1]?180:this.get("labels")[0]?100:50,V=60;var q=this.get("w")-v,H=this.get("h")-V;S>a?this.set({sizeID:1}):S===a?this.set({sizeID:2}):this.set({sizeID:3}),S=q/(Math.cos(st*Math.PI/180)+lt*Math.cos(at*Math.PI/180)),a=1===this.get("sizeID")?.5*S:2===this.get("sizeID")?S:2*S;var U={x:0,y:0},j={x:U.x+S*Math.cos(st*Math.PI/180),y:U.x+S*Math.sin(st*Math.PI/180)},$={x:j.x+lt*S*Math.cos(at*Math.PI/180),y:j.y-lt*S*Math.sin(at*Math.PI/180)},P=this.tipOfTriangularBasedPyramid(U,j,$,a);j.y-P.y>H&&(1===this.get("sizeID")&&(a=H/(1+2*Math.sin(st*Math.PI/180)),S=2*a),2===this.get("sizeID")?(a=H/(1+Math.sin(st*Math.PI/180)),S=a):3===this.get("sizeID")&&(a=H/(1+.5*Math.sin(st*Math.PI/180)),S=.5*a)),h=(this.get("w")-S*Math.cos(st*Math.PI/180)-lt*S*Math.cos(at*Math.PI/180))/2,c=(this.get("h")-a-S*Math.sin(st*Math.PI/180))/2+a,U={x:h,y:c},j={x:h+S*Math.cos(st*Math.PI/180),y:c+S*Math.sin(st*Math.PI/180)},$={x:j.x+lt*S*Math.cos(at*Math.PI/180),y:j.y-lt*S*Math.sin(at*Math.PI/180)},P=this.tipOfTriangularBasedPyramid(U,j,$,a);var ht={x:P.x,y:P.y+a};if(this.drawTriangularBasedPyramid(h,c,a,S),this.get("labels")[0]){this.components.add({type:"line",xStart:P.x,yStart:P.y,xEnd:ht.x,yEnd:ht.y});var ct={x:(U.x+j.x)/2,y:(U.y+j.y)/2},ut=Math.sqrt((ht.x-ct.x)*(ht.x-ct.x)+(ht.y-ct.y)*(ht.y-ct.y)),dt=Math.sqrt((P.x-ct.x)*(P.x-ct.x)+(P.y-ct.y)*(P.y-ct.y)),pt=180*Math.acos((a*a-dt*dt-ut*ut)/(-2*(ut*dt)))/Math.PI,ft=180*Math.acos((ut*ut-dt*dt-a*a)/(-2*(a*dt)))/Math.PI,gt=180-pt-ft;this.components.add({type:"line",xStart:ht.x,yStart:ht.y-S/20,xEnd:ht.x-S/20*Math.cos(180*(360-gt)/Math.PI),yEnd:ht.y+S/20*Math.sin(180*(360-gt)/Math.PI)}),this.components.add({type:"line",xStart:ht.x-S/20*Math.cos(180*(360-gt)/Math.PI),yStart:ht.y+S/20*Math.sin(180*(360-gt)/Math.PI),xEnd:ht.x-S/20*Math.cos(180*(360-gt)/Math.PI),yEnd:ht.y+S/20*Math.sin(180*(360-gt)/Math.PI)+S/20}),this.components.add({type:"line",xStart:ht.x-S/20*Math.cos(180*(360-gt)/Math.PI),yStart:ht.y+S/20*Math.sin(180*(360-gt)/Math.PI)+S/20,xEnd:ht.x,yEnd:ht.y}),this.components.add({type:"line",xStart:P.x,yStart:P.y+a/3,xEnd:P.x+S/4*Math.cos(-45*Math.PI/180),yEnd:P.y+a/3+S/4*Math.sin(-45*Math.PI/180)}),this.components.add({x:P.x+S/4*Math.cos(-45*Math.PI/180),y:P.y+a/3+S/4*Math.sin(-45*Math.PI/180)-2,type:"text",textSize:this.get("textSize"),text:this.get("labels")[0],textColor:this.get("textColor"),textFont:this.get("labelFont"),fillStyle:this.get("fillStyle"),lineWidth:4,textBaseline:"bottom",textAlign:"left"})}this.get("labels")[3]&&(this.components.add({type:"line",xStart:ht.x,yStart:ht.y,xEnd:(U.x+j.x)/2,yEnd:(U.y+j.y)/2}),this.components.add({type:"line",xStart:((U.x+j.x)/2+ht.x)/2,yStart:((U.y+j.y)/2+ht.y)/2,xEnd:((U.x+j.x)/2+ht.x)/2,yEnd:((U.y+j.y)/2+ht.y)/2+S/5}),this.components.add({x:((U.x+j.x)/2+ht.x)/2+2,y:((U.y+j.y)/2+ht.y)/2+S/5+2,type:"text",textSize:this.get("textSize"),text:this.get("labels")[3],textColor:this.get("textColor"),textFont:this.get("labelFont"),fillStyle:this.get("fillStyle"),lineWidth:4,textBaseline:"top",textAlign:"right"})),this.get("labels")[2]&&(this.components.add({type:"line",xStart:(U.x+j.x)/2,yStart:(U.y+j.y)/2,xEnd:P.x,yEnd:P.y}),this.components.add({type:"line",xStart:(((U.x+j.x)/2+P.x)/2+P.x)/2,yStart:(((U.y+j.y)/2+P.y)/2+P.y)/2,xEnd:(((U.x+j.x)/2+P.x)/2+P.x)/2-S/4*Math.cos(N*Math.PI/180),yEnd:(((U.y+j.y)/2+P.y)/2+P.y)/2-S/4*Math.sin(N*Math.PI/180)}),this.components.add({x:(((U.x+j.x)/2+P.x)/2+P.x)/2-S/4*Math.cos(N*Math.PI/180),y:(((U.y+j.y)/2+P.y)/2+P.y)/2-S/4*Math.sin(N*Math.PI/180)-2,type:"text",textSize:this.get("textSize"),text:this.get("labels")[2],textColor:this.get("textColor"),textFont:this.get("labelFont"),fillStyle:this.get("fillStyle"),lineWidth:4,textBaseline:"bottom",textAlign:"right"})),this.get("labels")[1]&&(this.components.add({type:"line",xStart:j.x+10*Math.cos((90-at)*Math.PI/180),yStart:j.y+10*Math.sin((90-at)*Math.PI/180),xEnd:j.x+20*Math.cos((90-at)*Math.PI/180),yEnd:j.y+20*Math.sin((90-at)*Math.PI/180)}),this.components.add({type:"line",xStart:$.x+10*Math.cos((90-at)*Math.PI/180),yStart:$.y+10*Math.sin((90-at)*Math.PI/180),xEnd:$.x+20*Math.cos((90-at)*Math.PI/180),yEnd:$.y+20*Math.sin((90-at)*Math.PI/180)}),this.components.add({type:"line",xStart:j.x+15*Math.cos((90-at)*Math.PI/180),yStart:j.y+15*Math.sin((90-at)*Math.PI/180),xEnd:$.x+15*Math.cos((90-at)*Math.PI/180),yEnd:$.y+15*Math.sin((90-at)*Math.PI/180)}),this.components.add({x:(j.x+$.x)/2+23*Math.cos((90-at)*Math.PI/180),y:(j.y+$.y)/2+23*Math.sin((90-at)*Math.PI/180),type:"text",textSize:this.get("textSize"),text:this.get("labels")[1],textColor:this.get("textColor"),textFont:this.get("labelFont"),fillStyle:this.get("fillStyle"),lineWidth:4,textBaseline:"middle",textAlign:"left"}))}},drawCylinder:function(t,e,n,r){this.components.add({type:"cylinder",color:this.get("color"),x:t,y:e,d:n,h:r,rotation:this.get("rotation"),sizeID:this.get("sizeID"),containerH:this.get("h"),containerW:this.get("w")})},drawSphere:function(t,e,n){this.components.add({type:"sphere",xCenter:t,yCenter:e,diameter:n,color:this.get("color")})},drawCone:function(t,e,n,r){this.components.add({type:"cone",color:this.get("color"),x:t,y:e,d:n,h:r,rotation:this.get("rotation"),sizeID:this.get("sizeID"),containerH:this.get("h"),containerW:this.get("w")})},drawSquareBasedPyramid:function(t,e,n,r,i){this.components.add({type:"squarebasedpyramid",color:this.get("color"),xStart:t,yStart:e,base:n,height:r,rotation:this.get("rotation"),baseRotation:i,sizeID:this.get("sizeID"),containerH:this.get("h"),containerW:this.get("w")})},drawTriangularPrism:function(t,e,n,r,i,o,s){this.components.add({type:"triangularprism",color:this.get("color"),xStart:t,yStart:e,h:n,b:r,w:i,l:o,sizeID:this.get("sizeID"),containerH:this.get("h"),containerW:this.get("w"),rotation:this.get("rotation"),baseRotation:s})},drawRectangularPrism:function(t,e,n,r,i,o){this.components.add({type:"rectangularprism",color:this.get("color"),xStart:t,yStart:e,h:n,b:r,w:i,sizeID:this.get("sizeID"),containerH:this.get("h"),containerW:this.get("w"),rotation:this.get("rotation"),baseRotation:o})},drawTriangularBasedPyramid:function(t,e,n,r){this.components.add({type:"triangularbasedpyramid",color:this.get("color"),xStart:t,yStart:e,b:r,h:n,sizeID:this.get("sizeID"),containerH:this.get("h"),containerW:this.get("w")})},drawBorder:function(){this.components.add({type:"rectangle",x:0,y:0,w:this.get("w"),h:this.get("h")})},drawExtensionLines:function(t,e,n,r,i){"horizontal"===i&&(this.components.add({type:"line",xStart:t,yStart:e,xEnd:t+n,yEnd:e}),this.components.add({type:"line",xStart:t,yStart:e+r,xEnd:t+n,yEnd:e+r})),"vertical"===i&&(this.components.add({type:"line",xStart:t,yStart:e,xEnd:t,yEnd:e+n}),this.components.add({type:"line",xStart:t+r,yStart:e,xEnd:t+r,yEnd:e+n}))},drawText:function(t,e,n){this.components.add({x:t,y:e,type:"text",textSize:this.get("textSize"),text:n,textColor:this.get("textColor"),textFont:this.get("labelFont"),fillStyle:this.get("fillStyle"),lineWidth:4})},connectExtensionLines:function(t,e,n,r){"horizontal"===r&&this.components.add({type:"line",xStart:t,yStart:e,xEnd:t+n,yEnd:e}),"vertical"===r&&(this.components.add({type:"line",xStart:t,yStart:e,xEnd:t,yEnd:e+n/2-parseInt(this.get("textSize"))}),this.components.add({type:"line",xStart:t,yStart:e+n/2+parseInt(this.get("textSize")),xEnd:t,yEnd:e+n}))},tipOfTriangularBasedPyramid:function(t,e,n,r){var i={xStart:t.x,yStart:t.y,xEnd:(e.x+n.x)/2,yEnd:(e.y+n.y)/2},o=(i.yEnd-i.yStart)/(i.xEnd-i.xStart),s=t.y-o*t.x,a={xStart:e.x,yStart:e.y,xEnd:(t.x+n.x)/2,yEnd:(t.y+n.y)/2},l=(a.yEnd-a.yStart)/(a.xEnd-a.xStart),h=e.y-l*e.x,c=(h-s)/(o-l),u=o*c+s,d={x:c,y:u-r};return d}}),Controller.ThreeDeeShapeView=Controller.CanvasControlView.extend({initialize:function(t){Controller.CanvasControlView.prototype.initialize.apply(this,t)}}),Controller.FractionsModel=Controller.CanvasControlModel.extend({parse:function(t){var e=t.value;return e&&(e=JSON.parse("["+e+"]"),t.fractions=e[0]||[],t.container=e[1]||!1,t.padded=e[2]||!1),Controller.CanvasControlModel.prototype.parse.call(this,t)},defaults:{padding:5.5},setup:function(){function t(t){return{w:r/Math.max(t,1),h:i}}var e=Controller.CanvasFractionContainerModel.prototype.defaults,n=e.lineWidth,r=e.w-2*n,i=e.h-1,n=e.lineWidth,o=this.get("fractions"),s=this.get("padding");if(this.get("container")){s=this.get("padded")?Math.floor(s):0;for(var a,l=0,h=0,c=0,u=0,d=n,p=0;u<o.length;u++)a=t(o[u]),l+r+n<d+a.w&&(h++,this.components.add({type:"fractionContainer",x:l,y:p-1}),l+=2*n+r+(this.get("padded")?s:-4),d=l+n,this.get("w")<l+2*n+r+(this.get("padded")?0:-4)&&(c=c||h,l=0,d=n,p+=a.h+(this.get("padded")?s:-4))),this.components.add({type:"fraction",x:d,y:p,denominator:o[u]}),d+=a.w;h++,c=c||h,this.components.add({type:"fractionContainer",x:l,y:p-1});var f=Math.ceil(h/c),g=(this.get("w")-c*(r+2*n+(this.get("padded")?s:-4))+(this.get("padded")?s:-4))/2,m=(this.get("h")-i-(f-1)*(i+(this.get("padded")?s:-4)))/2;this.components.each(function(t){t.set({x:t.get("x")+g}),t.set({y:t.get("y")+m})})}else for(var a,u=0,d=s,p=s;u<o.length;u++)a=t(o[u]),this.get("w")<d+a.w&&!(a.w+s>=this.get("w")&&d===s)&&(d=s,p+=a.h+s),this.components.add({type:"fraction",x:d,y:p,denominator:o[u]}),d+=a.w+(this.get("padded")?s:0)}}),Controller.FractionsView=Controller.CanvasControlView.extend({initialize:function(t){Controller.CanvasControlView.prototype.initialize.apply(this,t)}}),Controller.NetModel=Controller.CanvasControlModel.extend({parse:function(t){var e=t.value;return e&&(e=e.replace(/([^,\]\[]+)/g,function(t){return t=t.trim(),"''"===t?'""':(t=t.substring(t.startsWith("'")?1:0,t.endsWith("'")?t.length-1:t.length),isNaN(t)&&"true"!==t&&"false"!==t?'"'+t+'"':t)}),e=JSON.parse("["+e+"]"),t.shapeID=e[0],t.rotation=e[1],t.orientation=e[3],t.dimensions=e[4],t.labels=e[5]),t.color=Controller.COLORS[e[2].toLowerCase()],Controller.CanvasControlModel.prototype.parse.call(this,t)},defaults:{labelFont:"Roboto",textSize:"14px",textColor:Controller.COLORS.white,fillStyle:Controller.COLORS.charcoal},setup:function(){if(4===this.get("shapeID")){var t,e,n,r,i,o,s,a,l=37.5,h=17;this.get("dimensions")[1]&&!this.get("dimensions")[2]&&(this.get("dimensions")[0]/this.get("dimensions")[1]===1?this.set({sizeID:2}):this.get("dimensions")[0]/this.get("dimensions")[1]>1?this.set({sizeID:3}):this.set({sizeID:1})),this.get("dimensions")[2]&&!this.get("dimensions")[1]&&(this.get("dimensions")[0]/(2*this.get("dimensions")[2])===1?this.set({sizeID:2}):this.get("dimensions")[0]/(2*this.get("dimensions")[2])>1?this.set({sizeID:3}):this.set({sizeID:1})),this.get("rotation")?(i=20,o=20):(i=150,o=80),0!==this.get("rotation")&&2!==this.get("rotation")||(s=this.get("w")-i,1===this.get("sizeID")&&(e=2*s/5,t=e/2),2===this.get("sizeID")&&(e=s/3,t=e),3===this.get("sizeID")&&(e=s/4,t=2*e),a=Math.PI*e,a+o>this.get("h")&&(a=this.get("h")-o,e=a/Math.PI,1===this.get("sizeID")&&(t=e/2),2===this.get("sizeID")&&(t=e),3===this.get("sizeID")&&(t=2*e),s=2*e+t),n=(this.get("w")-s)/2+e,r=(this.get("h")-a)/2,this.drawCylinderNet(n,r,e,t)),1!==this.get("rotation")&&3!==this.get("rotation")||(a=this.get("h")-o,1===this.get("sizeID")&&(e=2*a/5,t=e/2),2===this.get("sizeID")&&(e=a/3,t=e),3===this.get("sizeID")&&(e=a/4,t=2*e),s=Math.PI*e,s+i>this.get("w")&&(s=this.get("w")-i,e=s/Math.PI,1===this.get("sizeID")&&(t=e/2),2===this.get("sizeID")&&(t=e),3===this.get("sizeID")&&(t=2*e),a=2*e+t),n=(this.get("w")-s)/2,r=(this.get("h")-a)/2+e,this.drawCylinderNet(r,n,e,t));var c={},u={};this.get("orientation")?(c={x:n+t+e/2,y:r+Math.PI*e/2},u={x:n-e/2,y:r+Math.PI*e/2}):(c={x:n+t+e/2,y:r+e/2},u={x:n-e/2,y:r+Math.PI*e-e/2}),this.get("labels")[0]&&!this.get("rotation")&&(this.extensionLines(n,r,n+t,r,10,"slopeDownTop"),this.drawText(n+t/2,r-h-parseInt(this.get("textSize"))/2,this.get("labels")[0],"middle","center")),!this.get("labels")[1]||this.get("labels")[2]||this.get("rotation")||(this.verticalExtensionLines(c.x+e/2+l,c.y-e/2,c.x+e/2+l,c.y+e/2,10),this.drawText(c.x+e/2+l,c.y,this.get("labels")[1])),!this.get("labels")[2]||this.get("labels")[1]||this.get("rotation")||(2*parseInt(this.get("textSize"))+2<e/2?(this.verticalExtensionLines(c.x+e/2+l,c.y-e/2,c.x+e/2+l,c.y,10),this.drawText(c.x+e/2+l,c.y-e/4,this.get("labels")[2])):this.get("orientation")?(this.extensionLines(c.x,c.y-e/2,c.x+e/2,c.y-e/2,10,"slopeDownTop"),this.drawText(c.x,c.y-e/2-h-parseInt(this.get("textSize"))/2,this.get("labels")[2],"middle","left")):(this.extensionLines(c.x,c.y+e/2,c.x+e/2,c.y+e/2,10,"slopeDownBottom"),this.drawText(c.x,c.y+e/2+h+parseInt(this.get("textSize"))/2+2,this.get("labels")[2],"middle","left")))}if(3===this.get("shapeID")){var d=this.get("rotation");if(!this.get("dimensions")[2]&&this.get("dimensions")[1]&&(this.get("dimensions")[0]/this.get("dimensions")[1]===1?this.set({sizeID:2}):this.get("dimensions")[0]/this.get("dimensions")[1]>1?this.set({sizeID:3}):this.set({sizeID:1})),this.get("dimensions")[2]&&!this.get("dimensions")[1]&&(this.get("dimensions")[0]/(2*this.get("dimensions")[2])===1?this.set({sizeID:2}):this.get("dimensions")[0]/(2*this.get("dimensions")[2])>1?this.set({sizeID:3}):this.set({sizeID:1})),void 0===this.get("sizeID"))return;var t,e,n,r,p,f,a,s;p=20,f=-10,0===d||2===d?(this.get("orientation")&&1===this.get("sizeID")?(p=20,f=30):(p=20,f=-10),a=this.get("h")-p,s=this.get("w")-f):(this.get("orientation")&&1===this.get("sizeID")?(p=20,f=30):(p=20,f=-10),s=this.get("w")-p,a=this.get("h")-f),1===this.get("sizeID")&&(0===d||2===d?(e=s/4,2*e>=a&&(e=a/2),this.get("orientation")?(n=this.get("w")/2-e/4,r=(this.get("h")-2*e)/2+e/4):(n=this.get("w")/2,r=(this.get("h")-2*e)/2)):(e=a/4,2*e>=s&&(e=s/2),this.get("orientation")?(n=(this.get("w")-2*e)/2+e/4,r=this.get("h")/2-e/4):(n=(this.get("w")-2*e)/2,r=this.get("h")/2))),2===this.get("sizeID")&&(0===d||2===d?(e=s/6,3*e>=a&&(e=a/3),n=this.get("w")/2,r=(this.get("h")-3*e)/2):(e=a/6,3*e>=s&&(e=s/3),n=(this.get("w")-3*e)/2,r=this.get("h")/2)),3===this.get("sizeID")&&(0===d||2===d?(e=s/8,5*e>=a&&(e=a/5),n=this.get("w")/2,r=(this.get("h")-5*e)/2):(e=a/8,5*e>=s&&(e=s/5),n=(this.get("w")-5*e)/2,r=this.get("h")/2)),0===d||2===d?this.drawConeNet(n,r,e):this.drawConeNet(r,n,e)}if(5===this.get("shapeID")){var i,o,g,t,n,r,m=this.get("orientation");if(this.get("dimensions")[0]/this.get("dimensions")[1]===1?this.set({sizeID:2}):this.get("dimensions")[0]/this.get("dimensions")[1]<1?this.set({sizeID:1}):this.set({sizeID:3}),!m){var x,i=45,o=20,a=this.get("h")-o,s=this.get("w")-i;x=this.get("w")>this.get("h")?a:s,1===this.get("sizeID")&&(g=x/(1+Math.sqrt(2)),t=.5*g),2===this.get("sizeID")&&(g=x/(1+2*Math.sqrt(5/4)),t=g),3===this.get("sizeID")&&(g=x/(1+2*Math.sqrt(4.25)),t=2*g);var y=Math.sqrt(t*t+.5*g*(.5*g));n=this.get("w")/2,r=this.get("h")/2-g/2-y,this.drawSquareBasedPyramidNet(n,r,g,t),this.get("labels")[2]&&(this.components.add({type:"line",xStart:n,yStart:r,xEnd:n,yEnd:r+y}),this.components.add({type:"line",xStart:n,yStart:r+y/3,xEnd:n+g/3,yEnd:r+y/3}),this.drawText(n+g/3+5,r+y/3,this.get("labels")[2],"middle","left")),this.get("labels")[1]&&(this.extensionLines(n-g/2,r+y+g/2+10,n+g/2,r+y+g/2+10,10,"slopeDownTop"),this.components.add({type:"line",xStart:n,yStart:r+y+g/2,xEnd:n+g*Math.cos(45*Math.PI/180),yEnd:r+y+g/2-g*Math.sin(45*Math.PI/180)}),this.drawText(n+g*Math.cos(45*Math.PI/180)+5,r+y+g/2-g*Math.sin(45*Math.PI/180),this.get("labels")[1],"middle","left"))}if(m){var s,a,v,C;if(i=20,o=20,s=this.get("w")-i,a=this.get("h")-o,0===this.get("rotation")||2===this.get("rotation")?(v=s,C=a):(v=a,C=s),1===this.get("sizeID")&&(g=v/(3*Math.sqrt(.5)+1),t=.5*g,2.5*g>C&&(g=C/2.5,t=.5*g)),2===this.get("sizeID")&&(g=v/(1+2*Math.sqrt(5/4)),t=g,2.5*g>C&&(g=C/2.5,t=g)),3===this.get("sizeID")&&(g=v/(1+2*Math.sqrt(4.25)),t=2*g,3*g>C&&(g=C/3,t=2*g)),y=Math.sqrt(.5*g*.5*g+t*t),0===this.get("rotation")||2===this.get("rotation")){if(1===this.get("sizeID")){var w=180*Math.atan(g/2/y)/Math.PI,b=180*Math.atan(y/(g/2))/Math.PI;n=this.get("w")/2-g/2-g*Math.cos((b-w)*Math.PI/180)+(g*Math.cos((b-w)*Math.PI/180)-y),r=this.get("h")/2}else n=this.get("w")/2-g/2-y,r=this.get("h")/2;this.drawSquareBasedPyramidNet(n,r,g,t),this.get("labels")[2]&&(this.components.add({type:"line",xStart:n+y+g,yStart:r,xEnd:n+2*y+g,yEnd:r}),this.components.add({type:"line",xStart:n+y+g+3*y/5,yStart:r,xEnd:n+y+g+3*y/5,yEnd:r-g/2-17}),this.drawText(n+y+g+3*y/5,r-g/2-17,this.get("labels")[2],"bottom","center")),this.get("labels")[1]&&(this.extensionLines(n+y,r-g/2,n+y+g,r-g/2,10,"slopeDownTop"),this.drawText(n+y+g/2,r-g/2-17,this.get("labels")[1],"bottom","center"))}else{if(1===this.get("sizeID")){var w=180*Math.atan(g/2/y)/Math.PI,b=180*Math.atan(y/(g/2))/Math.PI;n=this.get("w")/2,r=this.get("h")/2-g/2-g*Math.cos((b-w)*Math.PI/180)+(g*Math.cos((b-w)*Math.PI/180)-y)}else n=this.get("w")/2,r=this.get("h")/2-g/2-y;this.drawSquareBasedPyramidNet(r,n,g,t)}}}if(8===this.get("shapeID")){var n,r,t,g,M,e,d;g=this.get("dimensions")[1],M=this.get("dimensions")[2],e=this.get("dimensions")[3],d=this.get("rotation"),g===e?M<g?this.set({sizeID:1}):M===g?this.set({sizeID:2}):this.set({sizeID:3}):g>e?M<g?this.set({sizeID:4}):M===g?this.set({sizeID:5}):this.set({sizeID:6}):M<g?this.set({sizeID:7}):M===g?this.set({sizeID:8}):this.set({sizeID:9});var S=this.get("sizeID");if(this.get("orientation")){if(!d){var f,s,a,p=30;f=this.get("labels")[0]||this.get("labels")[2]?180:this.get("labels")[3]?60:20,s=this.get("w")-f,a=this.get("h")-p;var E={1:2*Math.sin(60*Math.PI/180)+.5,2:2*Math.sin(60*Math.PI/180)+1,3:2*Math.sin(60*Math.PI/180)+2,4:2*Math.sin(30*Math.PI/180)+.5,5:2*Math.sin(30*Math.PI/180)+1,6:2*Math.sin(30*Math.PI/180)+2,7:2*Math.sin(Math.acos(.25))+.5,8:2*Math.sin(Math.acos(.25))+1,9:2*Math.sin(Math.acos(.25))+2};S<=3&&(g=a/E[S],e=g,2*e+g>s&&(g=s/(2*Math.sqrt(5/4)+1),e=g)),S>3&&S<=6&&(g=a/E[S],e=g/2/Math.cos(30*Math.PI/180),2*e+g>s&&(g=s/(1+2*Math.cos(30*Math.PI/180)),e=g/2/Math.cos(30*Math.PI/180))),S>6&&(g=a/E[S],e=2*g,2*e+g>s&&(g=s/(2*Math.sqrt(4.25)+1),e=2*g)),S%3===1&&(M=.5*g),S%3===2&&(M=g),S%3===0&&(M=2*g),t=Math.sqrt(e*e-g/2*(g/2)),n=this.get("w")/2-g/2-e,r=this.get("h")/2-M/2,this.drawTriangularPrismNet(n,r,t,g,M,e),this.get("labels")[0]&&(this.components.add({type:"line",xStart:n+e+g+e,yStart:r+M,xEnd:n+e+g+g/2*Math.cos(Math.acos(g/2/e)),yEnd:r+M+g/2*Math.sin(Math.acos(g/2/e))}),this.components.add({type:"line",xStart:n+e+g+e-t/2*Math.cos(Math.acos(t/e)),yStart:r+M+t/2*Math.sin(Math.acos(t/e)),xEnd:n+e+g+e-t/2*Math.cos(Math.acos(t/e))+3*g/5*Math.cos(.5*Math.PI-Math.acos(t/e)),yEnd:r+M+t/2*Math.sin(Math.acos(t/e))+3*g/5*Math.sin(.5*Math.PI-Math.acos(t/e))}),this.drawText(n+e+g+e-t/2*Math.cos(Math.acos(t/e))+3*g/5*Math.cos(.5*Math.PI-Math.acos(t/e)),r+M+t/2*Math.sin(Math.acos(t/e))+3*g/5*Math.sin(.5*Math.PI-Math.acos(t/e))+2,this.get("labels")[0],"top","left")),this.get("labels")[1]&&(this.extensionLines(n+e,r,n+e+g,r,10,"slopeDownTop"),g>70?this.drawText(n+e+g/2,r-17,this.get("labels")[1],"bottom","center"):this.drawText(n+e,r-17,this.get("labels")[1],"bottom","left")),this.get("labels")[2]&&(2*parseInt(this.get("textSize"))+2<M?(this.verticalExtensionLines(n+e+g+e+37.5,r,n+e+g+e+37.5,r+M,10),this.drawText(n+e+g+e+42.5,r+M/2,this.get("labels")[2],"middle","center")):(this.extensionLines(n+e+g+e,r,n+e+g+e,r+M,10,"slopeDownTop"),this.drawText(n+e+g+e+20,r+M/2,this.get("labels")[2],"middle","left"))),this.get("labels")[3]&&(this.extensionLines(n,r+M,n+e,r+M,10,"slopeDownBottom"),this.drawText(n+e/2,r+M+17,this.get("labels")[3],"top","center"))}if(1===d){var s,a,p=20,f=20;s=this.get("w")-f,a=this.get("h")-p;var I={1:2*Math.sin(60*Math.PI/180)+.5,2:2*Math.sin(60*Math.PI/180)+1,3:2*Math.sin(60*Math.PI/180)+2,4:2*Math.sin(30*Math.PI/180)+.5,5:2*Math.sin(30*Math.PI/180)+1,6:2*Math.sin(30*Math.PI/180)+2,7:2*Math.sin(Math.acos(.25))+.5,8:2*Math.sin(Math.acos(.25))+1,9:2*Math.sin(Math.acos(.25))+2};S<=3&&(g=s/I[S],e=g,2*e+g>a&&(g=a/(2*Math.sqrt(5/4)+1),e=g)),S>3&&S<=6&&(g=s/I[S],e=g/2/Math.cos(30*Math.PI/180),g+2*g*Math.cos(30*Math.PI/180)>a&&(g=a/(1+2*Math.cos(30*Math.PI/180)),e=g/2/Math.cos(30*Math.PI/180))),S>6&&(g=s/I[S],e=2*g,2*e+g>a&&(g=a/(2*Math.sqrt(4.25)+1),e=2*g)),S%3===1&&(M=.5*g),S%3===2&&(M=g),S%3===0&&(M=2*g),t=Math.sqrt(e*e-g/2*(g/2)),n=this.get("w")/2-M/2,r=this.get("h")/2-g/2-e,this.drawTriangularPrismNet(r,n,t,g,M,e)}}else{if(!d){var p,f,s,a;this.get("labels")[0]||this.get("labels")[1]||this.get("labels")[2]||this.get("labels")[3]?(p=20,f=180):(p=20,f=20),s=this.get("w")-f,a=this.get("h")-p;var E={1:2.5,2:3,3:4,4:1.5,5:2,6:3,7:4.5,8:5,9:6};S<=3&&(g=a/E[S],e=g,2*e+g>s&&(g=s/(2*Math.sqrt(5/4)+1),e=g)),S>3&&S<=6&&(g=a/E[S],e=g/2/Math.cos(30*Math.PI/180),2*e+g>s&&(g=s/(2*Math.sqrt(.5)+1),e=g/2/Math.cos(30*Math.PI/180))),S>6&&(g=a/E[S],e=2*g,2*e+g>s&&(g=s/(2*Math.sqrt(4.25)+1),e=2*g)),S%3===1&&(M=.5*g),S%3===2&&(M=g),S%3===0&&(M=2*g),t=Math.sqrt(e*e-g/2*(g/2)),n=this.get("w")/2,r=this.get("h")/2-M/2-t,this.drawTriangularPrismNet(n,r,t,g,M,e),this.get("labels")[0]&&(this.components.add({type:"line",xStart:n,yStart:r,xEnd:n,yEnd:r+t}),this.components.add({type:"line",xStart:n,yStart:r+t/3,xEnd:n-g/2,yEnd:r+t/3}),this.drawText(n-g/2-5,r+t/3,this.get("labels")[0],"middle","right")),this.get("labels")[1]&&(this.extensionLines(n-g/2,r+t+M/2+8.5,n+g/2,r+t+M/2+8.5,7,"slopeDownTop"),this.components.add({type:"line",xStart:n,yStart:r+t+M/2,xEnd:n+g/2+10,yEnd:r+t+M+10}),this.drawText(n+g/2+10,r+t+M+10,this.get("labels")[1],"top","left")),this.get("labels")[2]&&(2*parseInt(this.get("textSize"))+2<M?(this.verticalExtensionLines(n+g/2+e+37.5,r+t,n+g/2+e+37.5,r+t+M,10),this.drawText(n+g/2+e+42.5,r+t+M/2,this.get("labels")[2],"middle","center")):(this.extensionLines(n+g/2+e+0,r+t,n+g/2+e+0,r+t+M,10,"slopeDownTop"),this.drawText(n+g/2+e+20,r+t+M/2,this.get("labels")[2],"middle","left"))),this.get("labels")[3]&&(this.extensionLines(n+g/2,r+t,n+g/2+e,r+t,10,"slopeDownTop"),this.drawText(n+g/2,r+t-17,this.get("labels")[3],"bottom","left"))}if(1===d){var s,a,p=20,f=20;s=this.get("w")-f,a=this.get("h")-p;var I={1:2.5,2:3,3:4,4:1.5,5:2,6:3,7:4.5,8:5,9:6};S<=3&&(g=s/I[S],e=g,2*e+g>a&&(g=a/(2*Math.sqrt(5/4)+1),e=g)),S>3&&S<=6&&(g=s/I[S],e=g/2/Math.cos(30*Math.PI/180),2*e+g>a&&(g=a/(2*Math.sqrt(.5)+1),e=g/2/Math.cos(30*Math.PI/180))),S>6&&(g=s/I[S],e=2*g,2*e+g>a&&(g=a/(2*Math.sqrt(4.25)+1),e=2*g)),S%3===1&&(M=.5*g),S%3===2&&(M=g),S%3===0&&(M=2*g),t=Math.sqrt(e*e-g/2*(g/2)),n=this.get("w")/2-M/2-t,r=this.get("h")/2,this.drawTriangularPrismNet(r,n,t,g,M,e)}}}if(6===this.get("shapeID")){var n,r,f,p,t=this.get("dimensions")[0],g=this.get("dimensions")[1],d=this.get("rotation"),m=this.get("orientation");if(g>t?(this.set({sizeID:1}),f=d?20:140):g===t?(this.set({sizeID:2}),f=d?20:70):(this.set({sizeID:3}),f=m?140:20),p=d?20:30,m){if(0===d||2===d){var s=this.get("w")-f,a=this.get("h")-p,S=this.get("sizeID");1===S&&(g=a/(Math.sqrt(.75)+.5+Math.sin(2*Math.atan(1)-Math.PI/3)),g/2+g*Math.cos(2*Math.atan(1)-Math.PI/3)>s&&(g=s/(.5+Math.cos(2*Math.atan(1)-Math.PI/3))),y=g/2,e=Math.sqrt(y*y+g/2*(g/2)),a=g*Math.sqrt(.75)+g/2+g*Math.sin(2*Math.atan(1)-Math.PI/3),s=g/2+g*Math.cos(2*Math.atan(1)-Math.PI/3),0===d?(r=(this.get("h")-a)/2+g*Math.sin(2*Math.atan(1)-Math.PI/3),n=(this.get("w")-s)/2+g/2):(r=(this.get("w")-a)/2+g*Math.sin(2*Math.atan(1)-Math.PI/3),n=(this.get("h")-s)/2+g/2)),2===S&&(g=a/(1+Math.sqrt(.75)+Math.sin(2*Math.atan(2)-Math.PI/3)),g/2+g*Math.sqrt(5/4)*Math.cos(Math.atan(2)-Math.PI/3)>s&&(g=s/(.5+Math.sqrt(5/4)*Math.cos(Math.atan(2)-Math.PI/3))),y=g,e=Math.sqrt(y*y+g/2*(g/2)),a=g+g*Math.sqrt(.75)+g*Math.sin(2*Math.atan(2)-Math.PI/3),s=g/2+g*Math.sqrt(5/4)*Math.cos(Math.atan(2)-Math.PI/3),0===d?(r=(this.get("h")-a)/2+g*Math.sin(2*Math.atan(2)-Math.PI/3),n=(this.get("w")-s)/2+g/2):(r=(this.get("w")-a)/2+g*Math.sin(2*Math.atan(2)-Math.PI/3),n=(this.get("h")-s)/2+g/2)),3===S&&(g=a/(2+Math.sqrt(.75)+Math.sin(2*Math.atan(4)-Math.PI/3)),g/2+g*Math.sqrt(4.25)*Math.cos(Math.atan(4)-Math.PI/3)>s&&(g=s/(.5+Math.sqrt(4.25)*Math.cos(Math.atan(4)-Math.PI/3))),y=2*g,e=Math.sqrt(y*y+g/2*(g/2)),a=2*g+g*Math.sqrt(.75)+g*Math.sin(2*Math.atan(4)-Math.PI/3),s=g/2+g*Math.sqrt(4.25)*Math.cos(Math.atan(4)-Math.PI/3),0===d?(r=(this.get("h")-a)/2+g*Math.sin(2*Math.atan(4)-Math.PI/3),n=(this.get("w")-s)/2+g/2):(r=(this.get("w")-a)/2+g*Math.sin(2*Math.atan(4)-Math.PI/3),n=(this.get("h")-s)/2+g/2)),this.drawTriangularBasedPyramidNet(n,r,g,y)}if(1===d||3===d){var s=this.get("w")-p,a=this.get("h")-f,S=this.get("sizeID");1===S&&(g=s/(Math.sqrt(.75)+.5+Math.sin(2*Math.atan(1)-Math.PI/3)),g/2+g*Math.cos(2*Math.atan(1)-Math.PI/3)>a&&(g=a/(.5+Math.cos(2*Math.atan(1)-Math.PI/3))),y=g/2,e=Math.sqrt(y*y+g/2*(g/2)),s=g*Math.sqrt(.75)+g/2+g*Math.sin(2*Math.atan(1)-Math.PI/3),a=g/2+g*Math.cos(2*Math.atan(1)-Math.PI/3),1===d?(r=(this.get("h")-a)/2+g/2,n=(this.get("w")-s)/2+g*Math.sin(2*Math.atan(1)-Math.PI/3)):(r=(this.get("h")-a)/2+g/2,n=(this.get("w")-s)/2+g*Math.sin(2*Math.atan(1)-Math.PI/3))),2===S&&(g=s/(1+Math.sqrt(.75)+Math.sin(2*Math.atan(2)-Math.PI/3)),g/2+g*Math.sqrt(5/4)*Math.cos(Math.atan(2)-Math.PI/3)>a&&(g=a/(.5+Math.sqrt(5/4)*Math.cos(Math.atan(2)-Math.PI/3))),
y=g,e=Math.sqrt(y*y+g/2*(g/2)),s=g+g*Math.sqrt(.75)+g*Math.sin(2*Math.atan(2)-Math.PI/3),a=g/2+g*Math.sqrt(5/4)*Math.cos(Math.atan(2)-Math.PI/3),1===d?(r=(this.get("h")-a)/2+g/2,n=(this.get("w")-s)/2+g*Math.sin(2*Math.atan(2)-Math.PI/3)):(r=(this.get("h")-a)/2+g/2,n=(this.get("w")-s)/2+g*Math.sin(2*Math.atan(2)-Math.PI/3))),3===S&&(g=s/(2+Math.sqrt(.75)+Math.sin(2*Math.atan(4)-Math.PI/3)),g/2+g*Math.sqrt(4.25)*Math.cos(Math.atan(4)-Math.PI/3)>a&&(g=a/(.5+Math.sqrt(4.25)*Math.cos(Math.atan(4)-Math.PI/3))),y=2*g,e=Math.sqrt(y*y+g/2*(g/2)),s=2*g+g*Math.sqrt(.75)+g*Math.sin(2*Math.atan(4)-Math.PI/3),a=g/2+g*Math.sqrt(4.25)*Math.cos(Math.atan(4)-Math.PI/3),1===d?(r=(this.get("h")-a)/2+g/2,n=(this.get("w")-s)/2+g*Math.sin(2*Math.atan(4)-Math.PI/3)):(r=(this.get("h")-a)/2+g/2,n=(this.get("w")-s)/2+g*Math.sin(2*Math.atan(4)-Math.PI/3))),this.drawTriangularBasedPyramidNet(r,n,g,y)}}else{if(0===d||2===d){var s=this.get("w")-f,a=this.get("h")-p,S=this.get("sizeID");1===S&&(g=a/(Math.sqrt(.75)+.5),2*g*Math.sqrt(.5)*Math.cos(15*Math.PI/180)>s&&(g=s/(2*Math.sqrt(.5)*Math.cos(15*Math.PI/180))),y=g/2,e=Math.sqrt(y*y+g/2*(g/2)),a=Math.sqrt(g*g-g/2*(g/2))+y,0===d?(r=(this.get("h")-a)/2,n=this.get("w")/2):(r=(this.get("w")-a)/2,n=this.get("h")/2)),2===S&&(g=a/(Math.sqrt(5/4)*Math.sin(Math.atan(2)-Math.PI/3)+Math.sqrt(.75)+1),2*g*Math.sqrt(5/4)*Math.cos(Math.atan(2)-Math.PI/3)>s&&(g=s/(2*Math.sqrt(5/4)*Math.cos(Math.atan(2)-Math.PI/3))),y=g,e=Math.sqrt(y*y+g/2*(g/2)),a=Math.sqrt(g*g-g/2*(g/2))+y+e*Math.sin(Math.atan(2)-Math.PI/3),0===d?(r=(this.get("h")-a)/2+e*Math.sin(Math.atan(2)-Math.PI/3),n=this.get("w")/2):(r=(this.get("w")-a)/2+e*Math.sin(Math.atan(2)-Math.PI/3),n=this.get("h")/2)),3===S&&(g=a/(Math.sqrt(4.25)*Math.sin(Math.atan(4)-Math.PI/3)+Math.sqrt(.75)+2),2*g*Math.sqrt(4.25)*Math.cos(Math.atan(4)-Math.PI/3)>s&&(g=s/(2*Math.sqrt(4.25)*Math.cos(Math.atan(4)-Math.PI/3))),y=2*g,e=Math.sqrt(y*y+g/2*(g/2)),a=Math.sqrt(g*g-g/2*(g/2))+y+e*Math.sin(Math.atan(4)-Math.PI/3),0===d?(r=(this.get("h")-a)/2+e*Math.sin(Math.atan(4)-Math.PI/3),n=this.get("w")/2):(r=(this.get("w")-a)/2+e*Math.sin(Math.atan(4)-Math.PI/3),n=this.get("h")/2)),this.drawTriangularBasedPyramidNet(n,r,g,y)}if(1===d||3===d){var s=this.get("w")-p,a=this.get("h")-f,S=this.get("sizeID");1===S&&(g=s/(Math.sqrt(.75)+.5),2*g*Math.sqrt(.5)*Math.cos(15*Math.PI/180)>a&&(g=a/(2*Math.sqrt(.5)*Math.cos(15*Math.PI/180))),y=g/2,e=Math.sqrt(y*y+g/2*(g/2)),s=Math.sqrt(g*g-g/2*(g/2))+y,1===d?(r=this.get("h")/2,n=(this.get("w")-s)/2):(r=this.get("h")/2,n=(this.get("w")-s)/2)),2===S&&(g=s/(Math.sqrt(5/4)*Math.sin(Math.atan(2)-Math.PI/3)+Math.sqrt(.75)+1),2*g*Math.sqrt(5/4)*Math.cos(Math.atan(2)-Math.PI/3)>a&&(g=a/(2*Math.sqrt(5/4)*Math.cos(Math.atan(2)-Math.PI/3))),y=g,e=Math.sqrt(y*y+g/2*(g/2)),s=Math.sqrt(g*g-g/2*(g/2))+y+e*Math.sin(Math.atan(2)-Math.PI/3),1===d?(r=this.get("h")/2,n=(this.get("w")-s)/2+e*Math.sin(Math.atan(2)-Math.PI/3)):(r=this.get("h")/2,n=(this.get("w")-s)/2+e*Math.sin(Math.atan(2)-Math.PI/3))),3===S&&(g=s/(Math.sqrt(4.25)*Math.sin(Math.atan(4)-Math.PI/3)+Math.sqrt(.75)+2),2*g*Math.sqrt(4.25)*Math.cos(Math.atan(4)-Math.PI/3)>a&&(g=a/(2*Math.sqrt(4.25)*Math.cos(Math.atan(4)-Math.PI/3))),y=2*g,e=Math.sqrt(y*y+g/2*(g/2)),s=Math.sqrt(g*g-g/2*(g/2))+y+e*Math.sin(Math.atan(4)-Math.PI/3),1===d?(r=this.get("h")/2,n=(this.get("w")-s)/2+e*Math.sin(Math.atan(4)-Math.PI/3)):(r=this.get("h")/2,n=(this.get("w")-s)/2+e*Math.sin(Math.atan(4)-Math.PI/3))),this.drawTriangularBasedPyramidNet(r,n,g,y)}}var N=Math.atan(y/(g/2));if(this.get("labels")[1]&&!d&&(this.components.add({type:"line",xStart:n-g*Math.cos(Math.PI/3),yStart:r+g*Math.sin(Math.PI/3),xEnd:n+g*Math.cos(Math.PI/3),yEnd:r+g*Math.sin(Math.PI/3)}),this.components.add({type:"line",xStart:n+g/4,yStart:r+Math.sqrt(g*g-g/2*(g/2)),xEnd:n+g/4+g/4,yEnd:r+Math.sqrt(g*g-g/2*(g/2))+y/3}),this.drawText(n+g/4+g/4,r+Math.sqrt(g*g-g/2*(g/2))+y/3,this.get("labels")[1],"top","left")),this.get("labels")[2]&&!d&&(this.components.add({type:"line",xStart:n+g/2*Math.cos(Math.PI/3),yStart:r+g/2*Math.sin(Math.PI/3),xEnd:n+e*Math.cos(Math.PI/3-N),yEnd:r+e*Math.sin(Math.PI/3-N)}),this.components.add({type:"line",xStart:n+g/2*Math.cos(Math.PI/3)+y/3*Math.cos(Math.PI/2-Math.PI/3),yStart:r+g/2*Math.sin(Math.PI/3)-y/3*Math.sin(Math.PI/2-Math.PI/3),xEnd:n+g/2*Math.cos(Math.PI/3)+y/3*Math.cos(Math.PI/2-Math.PI/3)+2*g/5*Math.cos(Math.PI/3),yEnd:r+g/2*Math.sin(Math.PI/3)-y/3*Math.sin(Math.PI/2-Math.PI/3)+2*g/5*Math.sin(Math.PI/3)}),this.drawText(n+g/2*Math.cos(Math.PI/3)+y/3*Math.cos(Math.PI/2-Math.PI/3)+2*g/5*Math.cos(Math.PI/3),r+g/2*Math.sin(Math.PI/3)-y/3*Math.sin(Math.PI/2-Math.PI/3)+2*g/5*Math.sin(Math.PI/3),this.get("labels")[2],"top","left")),this.get("labels")[3]&&!d){if(this.components.add({type:"line",xStart:n,yStart:r,xEnd:n,yEnd:r+Math.sqrt(g*g-g/2*(g/2))}),!m){if(1===S)var O=3*g/5;if(2===S)var O=3.5*g/5;if(3===S)var O=4*g/5;this.components.add({type:"line",xStart:n,yStart:r+3*Math.sqrt(g*g-g/2*(g/2))/4,xEnd:n-O,yEnd:r+3*Math.sqrt(g*g-g/2*(g/2))/4}),this.drawText(n-O-5,r+3*Math.sqrt(g*g-g/2*(g/2))/4,this.get("labels")[3],"middle","right")}if(m){var O=g/5;this.components.add({type:"line",xStart:n,yStart:r+1*Math.sqrt(g*g-g/2*(g/2))/4,xEnd:n-O,yEnd:r+1*Math.sqrt(g*g-g/2*(g/2))/4}),this.drawText(n-O-5,r+1*Math.sqrt(g*g-g/2*(g/2))/4,this.get("labels")[3],"middle","right")}}}if(7===this.get("shapeID")){var n,r,t=this.get("dimensions")[0],g=this.get("dimensions")[1],M=this.get("dimensions")[2],m=this.get("orientation"),d=this.get("rotation"),l=37.5,h=17;g===M&&(t<g?this.set({sizeID:1}):t===g?this.set({sizeID:2}):this.set({sizeID:3})),g>M&&(t<g?this.set({sizeID:4}):t===g?this.set({sizeID:5}):this.set({sizeID:6}));var f,p,a,s,v,C,S=this.get("sizeID");d?(f=20,p=20):(f=this.get("labels")[0]||this.get("labels")[2]?180:20,p=this.get("labels")[1]?80:20),a=this.get("h")-p,s=this.get("w")-f,0===d||2===d?(v=s,C=a):(v=a,C=s);var T={1:2,2:3,3:5,4:2,5:3,6:5};S<=3&&(g=v/T[S],(T[S]+1)*g>C&&(g=C/(T[S]+1))),S>=4&&(g=v/T[S],T[S]*g>C&&(g=C/T[S])),M=S<=3?g:g/2,S%3===1&&(t=g/2),S%3===2&&(t=g),S%3===0&&(t=2*g),0===d&&(a=2*t+2*M,s=2*t+g,n=this.get("w")/2-g/2,r=(this.get("h")-a)/2,this.drawRectangularPrismNet(n,r,t,g,M)),2===d&&(a=2*t+2*M,s=2*t+g,n=this.get("h")/2-g/2,r=(this.get("w")-a)/2,this.drawRectangularPrismNet(n,r,t,g,M)),1!==d&&3!==d||(s=2*t+2*M,a=2*t+g,n=(this.get("w")-s)/2,r=this.get("h")/2-g/2,this.drawRectangularPrismNet(r,n,t,g,M)),this.get("labels")[0]&&!d&&(m?2*parseInt(this.get("textSize"))+2<t?(this.verticalExtensionLines(n-l,r,n-l,r+t,10),this.drawText(n-l,r+t/2,this.get("labels")[0],"middle","center")):(this.extensionLines(n,r,n,r+t,10,"slopeDownBottom"),this.drawText(n-17,r+t/2,this.get("labels")[0],"middle","right")):2*parseInt(this.get("textSize"))+2<t?(this.verticalExtensionLines(n-t-10,r,n-t-10,r+t,10),this.drawText(n-t-10,r+t/2,this.get("labels")[0],"middle","center")):(this.extensionLines(n-t,r,n-t,r+t,10,"slopeDownBottom"),this.drawText(n-t-17,r+t/2,this.get("labels")[0],"middle","right"))),this.get("labels")[1]&&!d&&(this.extensionLines(n,r,n+g,r,10,"slopeDownTop"),this.drawText(n+g/2,r-h,this.get("labels")[1],"bottom","center")),this.get("labels")[2]&&!d&&(2*parseInt(this.get("textSize"))+2<M?(this.verticalExtensionLines(n+g+t+l,r+t,n+g+t+l,r+t+M,10),this.drawText(n+g+t+l,r+t+M/2,this.get("labels")[2],"middle","center")):(this.extensionLines(n+g+t,r+t,n+g+t,r+t+M,10,"slopeDownTop"),this.drawText(n+g+t+17,r+t+M/2,this.get("labels")[2],"middle","left")))}},drawCylinderNet:function(t,e,n,r){this.components.add({type:"cylindernet",color:this.get("color"),xStart:t,yStart:e,d:n,h:r,sizeID:this.get("sizeID"),rotation:this.get("rotation"),containerW:this.get("w"),containerH:this.get("h"),orientation:this.get("orientation")})},drawConeNet:function(t,e,n){this.components.add({type:"conenet",color:this.get("color"),xStart:t,yStart:e,d:n,rotation:this.get("rotation"),sizeID:this.get("sizeID"),containerH:this.get("h"),containerW:this.get("w"),orientation:this.get("orientation")})},drawSquareBasedPyramidNet:function(t,e,n,r){this.components.add({type:"squarebasedpyramidnet",color:this.get("color"),xStart:t,yStart:e,b:n,h:r,rotation:this.get("rotation"),sizeID:this.get("sizeID"),orientation:this.get("orientation"),containerH:this.get("h"),containerW:this.get("w")})},drawTriangularPrismNet:function(t,e,n,r,i,o){this.components.add({type:"triangularprismnet",color:this.get("color"),xStart:t,yStart:e,h:n,b:r,w:i,d:o,sizeID:this.get("sizeID"),containerH:this.get("h"),containerW:this.get("w"),rotation:this.get("rotation"),orientation:this.get("orientation")})},drawRectangularPrismNet:function(t,e,n,r,i){this.components.add({type:"rectangularprismnet",color:this.get("color"),xStart:t,yStart:e,h:n,b:r,w:i,sizeID:this.get("sizeID"),containerH:this.get("h"),containerW:this.get("w"),rotation:this.get("rotation"),orientation:this.get("orientation")})},drawTriangularBasedPyramidNet:function(t,e,n,r){this.components.add({type:"triangularbasedpyramidnet",color:this.get("color"),xStart:t,yStart:e,b:n,l:r,orientation:this.get("orientation"),rotation:this.get("rotation"),sizeID:this.get("sizeID"),containerH:this.get("h"),containerW:this.get("w")})},extensionLines:function(t,e,n,r,i,o){var s=Math.abs(180*Math.atan((r-e)/(n-t))/Math.PI+90),a=Math.abs(Math.cos(s*Math.PI/180)),l=Math.abs(Math.sin(s*Math.PI/180));"slopeDownBottom"===o&&(this.components.add({type:"line",xStart:t-5*a,yStart:e+5*l,xEnd:t-(5+i)*a,yEnd:e+(5+i)*l}),this.components.add({type:"line",xStart:n-5*a,yStart:r+5*l,xEnd:n-(5+i)*a,yEnd:r+(5+i)*l}),this.components.add({type:"line",xStart:t-(5+i/2)*a,yStart:e+(5+i/2)*l,xEnd:n-(5+i/2)*a,yEnd:r+(5+i/2)*l})),"slopeUpBottom"===o&&(this.components.add({type:"line",xStart:t+5*a,yStart:e+5*l,xEnd:t+(5+i)*a,yEnd:e+(5+i)*l}),this.components.add({type:"line",xStart:n+5*a,yStart:r+5*l,xEnd:n+(5+i)*a,yEnd:r+(5+i)*l}),this.components.add({type:"line",xStart:t+(5+i/2)*a,yStart:e+(5+i/2)*l,xEnd:n+(5+i/2)*a,yEnd:r+(5+i/2)*l})),"slopeDownTop"===o&&(this.components.add({type:"line",xStart:t+5*a,yStart:e-5*l,xEnd:t+(5+i)*a,yEnd:e-(5+i)*l}),this.components.add({type:"line",xStart:n+5*a,yStart:r-5*l,xEnd:n+(5+i)*a,yEnd:r-(5+i)*l}),this.components.add({type:"line",xStart:t+(5+i/2)*a,yStart:e-(5+i/2)*l,xEnd:n+(5+i/2)*a,yEnd:r-(5+i/2)*l})),"slopeUpTop"===o&&(this.components.add({type:"line",xStart:t-5*a,yStart:e-5*l,xEnd:t-(5+i)*a,yEnd:e-(5+i)*l}),this.components.add({type:"line",xStart:n-5*a,yStart:r-5*l,xEnd:n-(5+i)*a,yEnd:r-(5+i)*l}),this.components.add({type:"line",xStart:t-(5+i/2)*a,yStart:e-(5+i/2)*l,xEnd:n-(5+i/2)*a,yEnd:r-(5+i/2)*l}))},verticalExtensionLines:function(t,e,n,r,i){t-=i/2,n-=i/2,this.components.add({type:"line",xStart:t,yStart:e,xEnd:t+i,yEnd:e}),this.components.add({type:"line",xStart:n,yStart:r,xEnd:n+i,yEnd:r}),this.components.add({type:"line",xStart:t+i/2,yStart:e,xEnd:t+i/2,yEnd:(e+r)/2-parseInt(this.get("textSize"))}),this.components.add({type:"line",xStart:t+i/2,yStart:(e+r)/2+parseInt(this.get("textSize")),xEnd:t+i/2,yEnd:r})},drawText:function(t,e,n,r,i){this.components.add({x:t,y:e,type:"text",textSize:this.get("textSize"),text:n,textColor:this.get("textColor"),textFont:this.get("labelFont"),fillStyle:this.get("fillStyle"),lineWidth:4,textBaseline:r,textAlign:i})}}),Controller.NetView=Controller.CanvasControlView.extend({initialize:function(t){Controller.CanvasControlView.prototype.initialize.apply(this,t)}}),Controller.DecimalChartModel=Controller.CanvasControlModel.extend({parse:function(t){var e=t.value;return e&&(e=e.replace(/([^,\]\[]+)/g,function(t){return t=t.trim(),"''"===t?'""':(t=t.substring(t.startsWith("'")?1:0,t.endsWith("'")?t.length-1:t.length),isNaN(t)&&"true"!==t&&"false"!==t?'"'+t+'"':t)}),e=JSON.parse("["+e+"]"),t.style=e[0],t.orientation=e[1],t.decimals=e[2]),Controller.CanvasControlModel.prototype.parse.call(this,t)},defaults:{bgColor:Controller.COLORS.white,gridLineColor:Controller.COLORS.charcoal},setup:function(){var t=this.get("style"),e=this.get("orientation"),n=this.get("decimals"),r=Math.min(this.get("w"),this.get("h")),i=Math.min(this.get("w"),this.get("h")),o=this.get("w")/2-r/2,s=this.get("h")/2-i/2;this.components.add({type:"rectangle",x:o,y:s,w:r,h:i,fillStyle:this.get("bgColor"),lineWidth:0});for(var a=0,l=0;l<n.length;l++)if(n[l][1]=Controller.COLORS[n[l][1].toLowerCase()],a+=n[l][0],a>1)return;switch(t){case 0:if(0===e)for(var h=o,c=s,u=0;u<n.length;u++){for(var l=0;l<100*n[u][0];l++)0!==l&&l%10===0?(c=s,h+=r/10):0!==l&&(c+=i/10),this.drawColoredSections(h,c,r/10,i/10,n[u][1],1,1);c=s,h+=r/10}else if(1===e)for(var h=o+(r-r/10),c=s,u=0;u<n.length;u++){for(var l=0;l<100*n[u][0];l++)0!==l&&l%10===0?(c=s,h-=r/10):0!==l&&(c+=i/10),this.drawColoredSections(h,c,r/10,i/10,n[u][1],1,1);c=s,h-=r/10}this.drawGridLines(o,s,r,i,1,10);break;case 1:if(0===e)for(var h=o,c=s,u=0;u<n.length;u++){for(var l=0;l<100*n[u][0];l++)0!==l&&l%10===0?(h=o,c+=i/10):0!==l&&(h+=r/10),this.drawColoredSections(h,c,r/10,i/10,n[u][1],1,1);c+=i/10,h=o}else if(1===e)for(var h=o,c=s+(i-i/10),u=0;u<n.length;u++){for(var l=0;l<100*n[u][0];l++)0!==l&&l%10===0?(h=o,c-=i/10):0!==l&&(h+=r/10),this.drawColoredSections(h,c,r/10,i/10,n[u][1],1,1);c-=i/10,h=o}this.drawGridLines(o,s,r,i,10,1);break;case 2:if(0===e)for(var h=o,c=s,l=0,d=0,u=0;u<n.length;u++)for(d+=100*n[u][0],l;l<d;l++)0!==l&&l%10===0?(c=s,h+=r/10):0!==l&&(c+=i/10),this.drawColoredSections(h,c,r/10,i/10,n[u][1],1,1);else if(1===e)for(var h=o,c=s,l=0,d=0,u=0;u<n.length;u++)for(d+=100*n[u][0],l;l<d;l++)0!==l&&l%10===0?(h=o,c+=i/10):0!==l&&(h+=r/10),this.drawColoredSections(h,c,r/10,i/10,n[u][1],1,1);else if(2===e)for(var h=o+(r-r/10),c=s,l=0,d=0,u=0;u<n.length;u++)for(d+=100*n[u][0],l;l<d;l++)0!==l&&l%10===0?(c=s,h-=r/10):0!==l&&(c+=i/10),this.drawColoredSections(h,c,r/10,i/10,n[u][1],1,1);else if(3===e)for(var h=o,c=s+(i-i/10),l=0,d=0,u=0;u<n.length;u++)for(d+=100*n[u][0],l;l<d;l++)0!==l&&l%10===0?(h=o,c-=i/10):0!==l&&(h+=r/10),this.drawColoredSections(h,c,r/10,i/10,n[u][1],1,1);this.drawGridLines(o,s,r,i,10,10)}},drawColoredSections:function(t,e,n,r,i,o,s){this.components.add({type:"grid",x:t,y:e,w:n,h:r,fillStyle:i,numRows:o,numColumns:s,lineWidth:0})},drawGridLines:function(t,e,n,r,i,o){this.components.add({type:"grid",x:t,y:e,w:n,h:r,strokeStyle:this.get("gridLineColor"),numRows:i,numColumns:o,lineWidth:1})}}),Controller.DecimalChartView=Controller.CanvasControlView.extend({initialize:function(t){Controller.CanvasControlView.prototype.initialize.apply(this,t)}}),Controller.FractionCircleModel=Controller.CanvasControlModel.extend({parse:function(t){var e=t.value;if(e){var e=t.value.replace(/\(([^\)]*)\)/g,"[$1]");e=e.replace(/([^,\]\[]+)/g,function(t){return t=t.trim(),"''"===t?'""':(t=t.substring(t.startsWith("'")?1:0,t.endsWith("'")?t.length-1:t.length),isNaN(t)&&"true"!==t&&"false"!==t?'"'+t+'"':t)}),e=JSON.parse("["+e+"]"),t.style=e[0],t.rotation=e[1],t.labelIndicator=e[2],t.denominator=e[3]}return Controller.CanvasControlModel.prototype.parse.call(this,t)},defaults:{},setup:function(){var t=this.get("style"),e=this.get("rotation"),n=this.get("denominator"),r=this.get("labelIndicator");this.components.add({type:"fraction_circle",style:t,rotation:e,labelIndicator:r,denominator:n,xCenter:this.get("w")/2,yCenter:this.get("h")/2,r:120})}}),Controller.FractionCircleView=Controller.CanvasControlView.extend({initialize:function(t){Controller.CanvasControlView.prototype.initialize.apply(this,t)}}),Controller.HundredsChartModel=function(){"use strict";return Controller.CanvasControlModel.extend({parse:function(t){var e=t.value;return e&&(e=e.replace(/([^,\]\[]+)/g,function(t){return t=t.trim(),"''"===t?'""':(t=t.substring(t.startsWith("'")?1:0,t.endsWith("'")?t.length-1:t.length),isNaN(t)&&"true"!==t&&"false"!==t?'"'+t+'"':t)}),e=JSON.parse("["+e+"]"),t.operations=e[0]||[],t.arrows=e[1]||[],t.numHide=e[2]||[],t.textboxNumbers=e[3]||[]),Controller.CanvasControlModel.prototype.parse.call(this,t)},defaults:{gridLineColor:Controller.COLORS.charcoal,labelFont:"Roboto",textSize:12,textColor:Controller.COLORS.white,textFillStyle:Controller.COLORS.charcoal,textStrokeStyle:Controller.COLORS.charcoal,selectedNumbers:[],numWidthHeight:30,selectLineWidth:6,selectedColor:Controller.COLORS.darkorange,correctColor:Controller.COLORS.darkgreen,incorrectColor:Controller.COLORS.darkred,inputControl:0,answerIndex:1},setup:function(){var t=1===this.get("inputControl")?Math.min(this.get("w"),this.get("h"))/310:Math.min(this.get("w"),this.get("h"))/300,e=10*this.get("numWidthHeight")*t,n=10*this.get("numWidthHeight")*t,r=this.get("numWidthHeight")*t,i=this.get("numWidthHeight")*t,o=this.get("textSize")*t,s=this.get("operations"),a=this.get("arrows"),l=this.get("numHide"),h=this.get("textboxNumbers"),c=this.get("w")/2-5*this.get("numWidthHeight")*t,u=this.get("h")/2-5*this.get("numWidthHeight")*t,d=[],p=[];if(!(t<1)){for(var f=0;f<s.length;f++)s[f][5]=Controller.COLORS[s[f][5].toLowerCase()],d[f]={op:s[f][0],factor:s[f][1],start:s[f][2],sequenceLength:s[f][3],showNum:s[f][4],color:s[f][5]};for(var f=1,g=0;f<=10;f++)for(var m=1;m<=10;m++)g++,p[g]={num:g,x:c+this.get("numWidthHeight")*(m-1)*t,y:u+this.get("numWidthHeight")*(f-1)*t,bg:[Controller.COLORS.white],showNum:1,textStrokeStyle:this.get("textStrokeStyle")};for(var f=0;f<l.length;f++)p[l[f]].showNum=0;for(var f=0;f<h.length;f++)p[h[f]].showNum=0;for(m=0;m<d.length;m++){var x=d[m].op,y=d[m].start,v=d[m].factor,C=d[m].sequenceLength,w=d[m].showNum,b=d[m].color;if(v>0)switch(x){case 0:for(var f=y;f<=y+v*(C-1);f+=v)this.alterColorOrShowNum(f,p,b,w);break;case 1:for(var f=y;f>=y-v*(C-1);f-=v)this.alterColorOrShowNum(f,p,b,w);break;case 2:if(1===v)this.alterColorOrShowNum(y,p,b,w);else for(var f=y;f<=y*Math.pow(v,C-1);f*=v)this.alterColorOrShowNum(f,p,b,w);break;case 3:if(1===v)this.alterColorOrShowNum(y,p,b,w);else for(var f=y;f>=y/Math.pow(v,C-1);f/=v)this.alterColorOrShowNum(f,p,b,w)}}for(var f=1;f<=100;f++)1===p[f].bg.length?this.components.add({type:"rectangle",x:p[f].x,y:p[f].y,w:e/10,h:n/10,fillStyle:_.first(p[f].bg),numSection:p[f].num,"class":"section",selected:!1,showNum:p[f].showNum,zIndex:1}):this.components.add({type:"blend_colors",colors:p[f].bg,x:p[f].x,y:p[f].y,w:30*t,h:30*t,scale:t,numSection:p[f].num,"class":"section",selected:!1,showNum:p[f].showNum,zIndex:1});for(var M=this.components.add({type:"grid",x:c,y:u,w:e,h:n,numRows:10,numColumns:10,strokeStyle:this.get("gridLineColor"),lineWidth:1,zIndex:2}),f=0;f<a.length;f++)a[f][a[f].length-1]=Controller.COLORS[a[f][a[f].length-1].toLowerCase()];for(var m=0;m<a.length;m++)for(var f=0;f<Object.keys(a[m]).length-1;f++)p[a[m][f]].arrow=1;for(var f=1;f<=100;f++)p[f].showNum&&!p[f].arrow&&this.components.add({x:p[f].x+15*t,y:p[f].y+15*t,type:"text",textSize:o+"px",text:p[f].num,textColor:this.get("textColor"),textFont:this.get("labelFont"),textFillStyle:this.get("fillStyle"),strokeStyle:p[f].textStrokeStyle,lineWidth:4,selected:!1,zIndex:4});for(var m=0;m<a.length;m++){for(var f=0;f<Object.keys(a[m]).length-1;f++)p[a[m][f]].textStrokeStyle=a[m][a[m].length-1];for(var S=a[m][0],E=[],f=1;f<Object.keys(a[m]).length-1;f++)E.push(a[m][f]);for(var f=0;f<E.length;f++)E[f]>S&&Math.floor((E[f]-1)/10)===Math.floor((S-1)/10)?this.drawArrowRight(f,m,p,a,S,E,r,i,o,3*t,8*t):E[f]<S&&Math.floor((E[f]-1)/10)===Math.floor((S-1)/10)?this.drawArrowLeft(f,m,p,a,S,E,r,i,o,3*t,8*t):E[f]<S&&(E[f]-1)%10>(S-1)%10?this.drawArrowTopRight(f,m,p,a,S,E,r,i,o,3*t,8*t):E[f]>S&&(E[f]-1)%10>(S-1)%10?this.drawArrowBotRight(f,m,p,a,S,E,r,i,o,3*t,8*t):E[f]<S&&(E[f]-1)%10<(S-1)%10?this.drawArrowTopLeft(f,m,p,a,S,E,r,i,o,3*t,8*t):E[f]>S&&(E[f]-1)%10<(S-1)%10?this.drawArrowBotLeft(f,m,p,a,S,E,r,i,o,3*t,8*t):E[f]<S&&(E[f]-1)%10===(S-1)%10?this.drawArrowUp(f,m,p,a,S,E,r,i,o,3*t,8*t):E[f]>S&&(E[f]-1)%10===(S-1)%10&&this.drawArrowDown(f,m,p,a,S,E,r,i,o,3*t,8*t)}for(var f=1;f<=100;f++)p[f].showNum&&p[f].textStrokeStyle!==Controller.COLORS.charcoal&&this.components.add({x:p[f].x+15*t,y:p[f].y+15*t,type:"text","class":"arrowText",textSize:o+"px",text:p[f].num,textColor:this.get("textColor"),textFont:this.get("labelFont"),textFillStyle:this.get("fillStyle"),strokeStyle:p[f].textStrokeStyle,lineWidth:4,selected:!1,zIndex:7});for(var f=0;f<h.length;f++)this.components.add({type:"textBox",canvasControl:this,text:h[f],answerIndex:this.get("answerIndex"),answerSubIndex:f+1,x:p[h[f]].x+15*t,y:p[h[f]].y+15*t,w:23*t,h:23*t,zIndex:9});1===this.get("inputControl")&&this.set({scale:t,grid:M})}},alterColorOrShowNum:function(t,e,n,r){if(e[t].bg[0]===Controller.COLORS.white)e[t].bg[0]=n;else{for(var i=1,o=0;o<e[t].bg.length;o++)n===e[t].bg[o]&&(i=0);i&&e[t].bg.push(n)}r||(e[t].showNum=r)},drawArrow:function(t,e,n,r,i,o,s){this.components.add({type:"arrow",xStart:t,yStart:e,xEnd:n,yEnd:r,strokeStyle:i,lineWidth:o,arrowWidth:s,zIndex:6})},drawArrowRight:function(t,e,n,r,i,o,s,a,l,h,c){this.drawArrow(n[i].x+s/2+l/2,n[i].y+a/2,n[o[t]].x+s/2-l/2,n[o[t]].y+a/2,r[e][r[e].length-1],h,c)},drawArrowLeft:function(t,e,n,r,i,o,s,a,l,h,c){this.drawArrow(n[i].x+s/2-l/2,n[i].y+a/2,n[o[t]].x+s/2+l/2,n[o[t]].y+a/2,r[e][r[e].length-1],h,c)},drawArrowTopRight:function(t,e,n,r,i,o,s,a,l,h,c){this.drawArrow(n[i].x+s/2+l/2,n[i].y+a/2-l/2,n[o[t]].x+s/2-l/2,n[o[t]].y+a/2+l/2,r[e][r[e].length-1],h,c)},drawArrowBotRight:function(t,e,n,r,i,o,s,a,l,h,c){this.drawArrow(n[i].x+s/2+l/2,n[i].y+a/2+l/2,n[o[t]].x+s/2-l/2,n[o[t]].y+a/2-l/2,r[e][r[e].length-1],h,c)},drawArrowTopLeft:function(t,e,n,r,i,o,s,a,l,h,c){this.drawArrow(n[i].x+s/2-l/2,n[i].y+a/2-l/2,n[o[t]].x+s/2+l/2,n[o[t]].y+a/2+l/2,r[e][r[e].length-1],h,c)},drawArrowBotLeft:function(t,e,n,r,i,o,s,a,l,h,c){this.drawArrow(n[i].x+s/2-l/2,n[i].y+a/2+l/2,n[o[t]].x+s/2+l/2,n[o[t]].y+a/2-l/2,r[e][r[e].length-1],h,c)},drawArrowUp:function(t,e,n,r,i,o,s,a,l,h,c){this.drawArrow(n[i].x+s/2,n[i].y+a/2-l/2,n[o[t]].x+s/2,n[o[t]].y+a/2+l/2,r[e][r[e].length-1],h,c)},drawArrowDown:function(t,e,n,r,i,o,s,a,l,h,c){this.drawArrow(n[i].x+s/2,n[i].y+a/2+l/2,n[o[t]].x+s/2,n[o[t]].y+a/2-l/2,r[e][r[e].length-1],h,c)},clickNumber:function(t,e){var n=this.components.getNearestComponent(t,e,function(t){return"section"===t.get("class")});if(n&&n.get("selected")===!1&&n.get("showNum")){var r=this.components.find(function(t){return t.get("text")===n.get("numSection")});n.set({x:n.get("x")-this.get("selectLineWidth")/3*this.get("scale"),y:n.get("y")-this.get("selectLineWidth")/3*this.get("scale"),w:n.get("w")+this.get("selectLineWidth")/3*2*this.get("scale"),h:n.get("h")+this.get("selectLineWidth")/3*2*this.get("scale"),lineWidth:this.get("selectLineWidth")*this.get("scale"),strokeStyle:this.get("selectedColor"),selected:!0,zIndex:3}),r.set({selected:!0,zIndex:"arrowText"===r.get("class")?8:5}),this.components.trigger("render")}else if(n&&n.get("selected")===!0&&n.get("showNum")){var i=this.components.find(function(t){return t.get("text")===n.get("numSection")});n.set({x:n.get("x")+this.get("selectLineWidth")/3*this.get("scale"),y:n.get("y")+this.get("selectLineWidth")/3*this.get("scale"),w:n.get("w")-this.get("selectLineWidth")/3*2*this.get("scale"),h:n.get("h")-this.get("selectLineWidth")/3*2*this.get("scale"),lineWidth:1,strokeStyle:this.get("gridLineColor"),selected:!1,zIndex:1}),i.set({selected:!1,zIndex:"arrowText"===i.get("class")?7:4}),this.components.trigger("render")}},isValid:function(){return this.components.some(function(t){return"text"===t.get("type")&&t.get("selected")===!0})},getData:function(t){var e=this.get("answerIndex");return this.get("textboxNumbers").length>0&&e++,t[e-1]},isCorrect:function(t){var e=this.components.filter(function(t){return"text"===t.get("type")&&t.get("selected")===!0}).map(function(t){return t.get("text")}),n=this.getData(t);return e.length===n.length&&_.every(e,function(t){return _.some(n,function(e){return t===e})})},getInput:function(){var t=this.get("answerIndex"),e=this.components.filter(function(t){return"text"===t.get("type")&&t.get("selected")===!0}).map(function(t){return t.get("text")});return this.get("textboxNumbers").length>0&&t++,{answerIndex:t,input:e}},hasInputChanged:function(t){var e=this.getInput(),n=e.answerIndex,r=e.input,i=t[n-1];return!_.isEqual(_.sortBy(i),_.sortBy(r))},setInput:function(t){var e=this.getData(t),n=this.components.filter(function(t){return"section"===t.get("class")&&t.get("selected")===!0&&!_.some(e,function(e){return e===t.get("numSection")})}),r=this.components.filter(function(t){return"text"===t.get("type")&&t.get("selected")===!0&&!_.some(e,function(e){return e===t.get("text")})}),i=this.components.filter(function(t){return"section"===t.get("class")&&t.get("selected")===!1&&_.some(e,function(e){return e===t.get("numSection")})}),o=this.components.filter(function(t){return"text"===t.get("type")&&t.get("selected")===!1&&_.some(e,function(e){return e===t.get("text")})}),s=this.get("grid");n.forEach(function(t){var e=s.getInputCellCanvasCoord(t.get("numSection"));t.set({x:e.x,y:e.y,w:this.get("numWidthHeight")*this.get("scale"),h:this.get("numWidthHeight")*this.get("scale"),lineWidth:1,strokeStyle:this.get("gridLineColor"),selected:!1,zIndex:1})}.bind(this)),r.forEach(function(t){t.set({selected:!1,zIndex:"arrowText"===t.get("class")?7:4})}),i.forEach(function(t){var e=s.getInputCellCanvasCoord(t.get("numSection"));t.set({x:e.x-this.get("selectLineWidth")/3*this.get("scale"),y:e.y-this.get("selectLineWidth")/3*this.get("scale"),w:(this.get("numWidthHeight")+this.get("selectLineWidth")/3*2)*this.get("scale"),h:(this.get("numWidthHeight")+this.get("selectLineWidth")/3*2)*this.get("scale"),lineWidth:this.get("selectLineWidth")*this.get("scale"),strokeStyle:this.get("selectedColor"),selected:!0,zIndex:3})}.bind(this)),o.forEach(function(t){t.set({selected:!0,zIndex:"arrowText"===t.get("class")?8:5})}),this.components.trigger("render")},displayAnswer:function(t){this.setInput(t),this.displayResult(t)},displayResult:function(t){var e,n=this.getData(t),r=this.components.filter(function(t){return"section"===t.get("class")&&t.get("selected")===!0});_.each(r,function(t){e=_.some(n,function(e){return t.get("numSection")===e}),t.set({strokeStyle:e?this.get("correctColor"):this.get("incorrectColor"),zIndex:2.9})}.bind(this)),this.components.trigger("render")}})}(),Controller.HundredsChartView=Controller.CanvasControlView.extend({initialize:function(t){this.model.isInputControl()&&(this.canvasEvents={mouseup:"clickNumber"}),Controller.CanvasControlView.prototype.initialize.apply(this,t)}}),Controller.ManipulativeFractionStripsModel=Controller.CanvasControlModel.extend({defaults:{inputControl:1,answerIndex:1,padding:30},setup:function(){var t=Controller.CanvasFractionContainerModel.prototype.defaults,e=this.get("answers")[this.get("answerIndex")-1];this.set({numContainers:e.length,containerHeight:t.h-1,containerWidth:t.w-2*t.lineWidth,containerThickness:t.lineWidth,containerStrokeStyle:t.strokeStyle});for(var n=0,r=0,i=0,o=1,s=1,a=[],l=[];n<this.get("numContainers")-1;n++)r+this.get("containerWidth")+2*this.get("containerThickness")<=this.get("w")&&(this.components.add({type:"fractionContainer",x:r,y:i,containerIndex:n}),a[n]=[],l[n]=0,r+=this.get("containerWidth")+2*this.get("containerThickness")+this.get("padding"),0===i&&s++,r+this.get("containerWidth")+2*this.get("containerThickness")>this.get("w")&&(o++,xContainer=0,r=0,0===i&&s--,i+=this.get("containerHeight")+this.get("padding")));this.components.add({type:"fractionContainer",x:r,y:i,containerIndex:n}),a[n]=[],l[n]=0;var h=(this.get("w")-s*(this.get("containerWidth")+2*this.get("containerThickness"))-(s-1)*this.get("padding"))/2,c=(this.get("h")-o*this.get("containerHeight")-(o-1)*this.get("padding"))/2;this.components.each(function(t){t.set({x:t.get("x")+h}),t.set({y:t.get("y")+c})}),this.set({containerFractions:a,containerFilled:l})},selectFraction:function(t,e,n){var r=this.components.getNearestComponent(t,e,function(t){return"fraction"===t.get("type")});this.set({selectedFraction:r})},removeFractionUpdate:function(t){var e=t.get("containerIndex"),n=this.get("containerFractions"),r=this.get("containerFilled"),i=this.components.find(function(e){return"fractionContainer"===e.get("type")&&e.get("containerIndex")===t.get("containerIndex")}),o=t.get("x")-i.get("x")-this.get("containerThickness");r[e]-=t.get("w");for(var s=0,a=0;s<n[e].length&&a!==o;s++)a+=this.get("containerWidth")/n[e][s];n[e].splice(s,1),this.components.each(function(n){"fraction"===n.get("type")&&n.get("containerIndex")===e&&n.get("x")>t.get("x")&&n.translate(-t.get("w"),0)}),i.set("strokeStyle",this.get("containerStrokeStyle")),this.components.trigger("render"),this.unset("selectedFraction")},dragToRemoveFraction:function(t,e,n){var r=this.get("selectedFraction");if(r){var i=n.normalizeManipulative(r.get("x"),r.get("y"));r.destroy(),this.collection.manipulatives.addManipulative("fractions",r.get("denominator"),i.x,i.y,!0),this.removeFractionUpdate(r)}},dropToAddFractionOrClickToRemoveFraction:function(t,e,n){if(n&&n.manipulative){var r=n.manipulative;if("fraction"===r.get("type")){var i=n.normalizeControl(r.get("x"),r.get("y")),o=this.components.find(function(t){return"fractionContainer"===t.get("type")&&Controller.Math.intersect({type:"rectangle",x:i.x,y:i.y,w:r.get("w"),h:r.get("h")},{type:"rectangle",x:t.get("x"),y:t.get("y"),w:t.get("w"),h:t.get("h")})});if(o){var s=o.get("containerIndex"),a=this.get("containerFractions"),l=this.get("containerFilled"),h=this.get("containerWidth")/r.get("denominator");l[s]+h<=this.get("containerWidth")&&(this.components.add({type:"fraction",denominator:r.get("denominator"),x:o.get("x")+o.get("lineWidth")+l[s],y:o.get("y")+1,containerIndex:s},{silent:!0}),a[s].push(r.get("denominator")),l[s]+=h,this.components.remove(o,{silent:!0}),this.components.add(o),o.set("strokeStyle",this.get("containerStrokeStyle")),r.destroy())}}}else{var c=this.get("selectedFraction");if(c){c.destroy(),c.get("y")+50+c.get("h")<this.get("h")?c.translate(0,50):c.translate(0,-50);var u=n.normalizeManipulative(c.get("x"),c.get("y"));this.collection.manipulatives.addManipulative("fractions",c.get("denominator"),u.x,u.y,!1),this.removeFractionUpdate(c)}}this.components.trigger("render")},isValid:function(){return _.some(this.get("containerFilled"),function(t){return t>0})},totalContainersFilled:function(t){for(var e=0,n=0;e<t.length;e++)for(var r=0;r<t[e].length;r++)n+=this.get("containerWidth")/t[e][r];return n},isCorrect:function(t){var e=t[this.get("answerIndex")-1];if(e.length!==this.get("numContainers"))return!1;var n=this.get("containerFractions"),r=[],i=[];if(1===this.get("inputControl")){for(var o=0;o<this.get("numContainers");o++)r.push(_.sortBy(n[o],function(t){return t})),i.push(_.sortBy(e[o],function(t){return t}));return _.isEqual(r,i)}if(2===this.get("inputControl")){for(var s=this.totalContainersFilled(n),a=this.totalContainersFilled(e),l=0,o=0;o<n.length;o++)containerSum=this.get("containerFilled")[o],containerSum===this.get("containerWidth")&&l++;if(l>=e.length-1&&s===a)return!0}return!1},getInput:function(){return this.get("containerFractions")},setInput:function(t){for(var e,n,r=[],i=this.get("containerFilled"),o=this.get("containerFractions"),s=this.get("numContainers"),a=t[this.get("answerIndex")-1],l=0;l<s;l++){r.push(this.components.filter(function(t){return t.get("containerIndex")===l&&"fraction"===t.get("type")}));var e=this.components.find(function(t){return"fractionContainer"===t.get("type")&&t.get("containerIndex")===l});i[l]=0,o[l]=[];for(var h=0;h<a[l].length;h++)n=this.get("containerWidth")/a[l][h],i[l]+n<=240&&(this.components.add({type:"fraction",denominator:a[l][h],x:e.get("x")+e.get("lineWidth")+i[l],y:e.get("y")+1,containerIndex:l},{silent:!0}),i[l]+=n,o[l].push(a[l][h]));this.components.remove(e,{silent:!0}),this.components.add(e)}this.components.removeComponents(r,{silent:!0})},displayAnswer:function(t){this.setInput(t),this.displayResult(t)},displayResult:function(t){var e=t[this.get("answerIndex")-1],n=this.get("containerFractions");if(1===this.get("inputControl"))for(var r=0;r<this.get("numContainers");r++)_.isEqual(_.sortBy(n[r],function(t){
return t}),_.sortBy(e[r],function(t){return t}))?this.components.find(function(t){return"fractionContainer"===t.get("type")&&t.get("containerIndex")===r}).set({strokeStyle:Controller.COLORS.darkgreen}):this.components.find(function(t){return"fractionContainer"===t.get("type")&&t.get("containerIndex")===r}).set({strokeStyle:Controller.COLORS.darkred});else if(2===this.get("inputControl"))for(var i=this.totalContainersFilled(e),o=i%this.get("containerWidth"),s=!1,a=0,r=0;r<n.length;r++)containerSum=this.get("containerFilled")[r],containerSum===this.get("containerWidth")&&a++,a<=e.length&&(containerSum===this.get("containerWidth")||containerSum===o&&s===!1)||0===o&&containerSum===this.get("containerWidth")?this.components.find(function(t){return"fractionContainer"===t.get("type")&&t.get("containerIndex")===r}).set({strokeStyle:Controller.COLORS.darkgreen}):this.components.find(function(t){return"fractionContainer"===t.get("type")&&t.get("containerIndex")===r}).set({strokeStyle:Controller.COLORS.darkred}),containerSum===o&&s===!1&&(s=!0);this.components.trigger("render")}}),Controller.ManipulativeFractionStripsView=Controller.CanvasControlView.extend({initialize:function(t){this.model.isInputControl()&&(this.canvasEvents={mousedown:"selectFraction",mousemove:"dragToRemoveFraction",mouseup:"dropToAddFractionOrClickToRemoveFraction"}),Controller.CanvasControlView.prototype.initialize.apply(this,t)}}),Controller.InteractiveFractionStripsModel=Controller.CanvasControlModel.extend({defaults:{inputControl:1,answerIndex:1,denominator:1,showDenominatorFlag:!0,showFractionFlag:!0,fractionOptions:[1,2,3,4,5,6,8,10,12],correctColor:Controller.COLORS.correctColor,incorrectColor:Controller.COLORS.incorrectColor},parse:function(t){return t.fractionOptions=_.sortBy(t.fractionOptions||this.defaults.fractionOptions),t.denominator=_.includes(t.fractionOptions,t.initialDenominator)?t.initialDenominator:this.defaults.denominator,Controller.CanvasControlModel.prototype.parse.call(this,t)},initialize:function(){this.listenTo(this,"change:denominator",this.handleDenominatorChange),Controller.CanvasControlModel.prototype.initialize.apply(this)},setup:function(){var t=Controller.CanvasFractionContainerModel.prototype.defaults,e=Controller.CanvasFractionModel.prototype.defaults,n={containerLineWidth:t.lineWidth,containerWidth:360+2*t.lineWidth,containerInnerWidth:360,containerHeight:e.h+2*t.lineWidth,containerInnerHeight:t.h-t.lineWidth,fractionLineWidth:e.lineWidth,buttonRadius:30,padding:20,buttonContainerRadius:140,buttonContainerHeight:210,buttonContainerWidth:80,textSize:20};this._drawFractionContainer(n),this._drawInitialFractions(n),this._drawArrowButtonModule(n),this.centerControl()},_drawFractionContainer:function(t){this.components.add({type:"fractionContainer",y:-t.containerHeight/2,w:t.containerWidth,h:t.containerHeight-1,lineWidth:t.containerLineWidth,zIndex:2})},_drawInitialFractions:function(t){for(var e=this.get("denominator"),n=t.containerInnerWidth/e,r=0;r<e;r++)this.components.add({type:"fraction",x:t.containerLineWidth+n*r,y:-t.containerHeight/2+t.containerLineWidth,containerWidth:t.containerInnerWidth,denominator:e,fractionIndex:r,lineWidth:t.fractionLineWidth,showText:this.get("showFractionFlag")})},_drawArrowButtonModule:function(t){this._drawArrowButtonContainer(t),this._drawArrowButton(t,"up"),this._drawArrowButton(t,"down"),this._drawInitialDenominatorText(t)},_drawArrowButtonContainer:function(t){this.components.add({type:"rounded_rectangle",x:t.containerWidth+t.padding,y:-t.buttonContainerHeight/2,w:t.buttonContainerWidth,h:t.buttonContainerHeight,cornerRadius:20})},_drawArrowButton:function(t,e){var n="up"===e?-60:60,r=t.containerWidth+t.padding+t.buttonContainerWidth/2,i=this.get("fractionOptions"),o=this.get("denominator"),s="up"===e?o!==_.last(i):o!==_.head(i);this.components.add({type:"arrow_button",x:r,y:n,r:t.buttonRadius,"class":e,isEnabled:s})},_drawInitialDenominatorText:function(t){if(this.get("showDenominatorFlag")){var e=t.containerWidth+t.padding+t.buttonContainerWidth/2;this.components.add({type:"text",x:e,y:0,text:this.get("denominator"),textSize:t.textSize+"px"})}},handleButtonClick:function(t,e){var n=this.components.getNearestComponent(t,e,function(t){return"arrow_button"===t.get("type")&&t.get("isEnabled")},1);n&&this._setNewDenominator(n)},_setNewDenominator:function(t){var e=this.get("denominator"),n=this.get("fractionOptions"),r=t.get("class"),i=n.indexOf(e),o="up"===r?i+1:i-1,s=n[o];this.set("denominator",s)},handleDenominatorChange:function(){this._drawFractions(),this._setButtonEnabledStates(),this._drawDenominatorText(),this._removeCorrectnessHighlighting(),this.components.trigger("render")},_drawFractions:function(){var t=this.components.find(function(t){return 0===t.get("fractionIndex")}),e=t.get("x"),n=t.get("y"),r=t.get("containerWidth"),i=t.get("lineWidth");this.components.removeComponents(this.components.filter(function(t){return"fraction"===t.get("type")}));for(var o=this.get("denominator"),s=r/o,a=0;a<o;a++)this.components.add({type:"fraction",x:e+s*a,y:n,containerWidth:r,denominator:o,fractionIndex:a,lineWidth:i,showText:this.get("showFractionFlag")})},_setButtonEnabledStates:function(){var t=this.components.find(function(t){return"arrow_button"===t.get("type")&&"up"===t.get("class")}),e=this.components.find(function(t){return"arrow_button"===t.get("type")&&"down"===t.get("class")}),n=this.get("denominator"),r=this.get("fractionOptions");t.set("isEnabled",n!==_.last(r)),e.set("isEnabled",n!==_.head(r))},_drawDenominatorText:function(){if(this.get("showDenominatorFlag")){var t=this.components.find(function(t){return"text"===t.get("type")});t.set("text",this.get("denominator"))}},_removeCorrectnessHighlighting:function(){var t=Controller.CanvasFractionContainerModel.prototype.defaults.strokeStyle,e=this.components.find(function(t){return"fractionContainer"===t.get("type")});if(e.set("strokeStyle",t),this.get("showDenominatorFlag")){var n=Controller.CanvasTextModel.prototype.defaults.textColor,r=this.components.find(function(t){return"text"===t.get("type")});r.set("textColor",n)}},isCorrect:function(t){var e=t[this.get("answerIndex")-1];return this.get("denominator")===e},setInput:function(t){this.set("denominator",t[this.get("answerIndex")-1])},getInput:function(){return this.get("denominator")},displayResult:function(){var t=this.isCorrect(this.get("answers")),e=this.components.find(function(t){return"fractionContainer"===t.get("type")});if(e.set("strokeStyle",t?this.get("correctColor"):this.get("incorrectColor")),this.get("showDenominatorFlag")){var n=this.components.find(function(t){return"text"===t.get("type")});n.set("textColor",t?this.get("correctColor"):this.get("incorrectColor"))}this.components.trigger("render")},displayAnswer:function(t){this.setInput(t),this.displayResult()},disableInput:function(){var t=this.components.find(function(t){return"arrow_button"===t.get("type")&&"up"===t.get("class")}),e=this.components.find(function(t){return"arrow_button"===t.get("type")&&"down"===t.get("class")});t.set("isEnabled",!1),e.set("isEnabled",!1),this.components.trigger("render")},enableInput:function(){this._setButtonEnabledStates(),this.components.trigger("render")}}),Controller.InteractiveFractionStripsView=Controller.CanvasControlView.extend({initialize:function(t){this.model.isInputControl()&&(this.canvasEvents={click:"handleButtonClick"}),Controller.CanvasControlView.prototype.initialize.apply(this,t)}}),Controller.ClickableFractionCircleModel=Controller.CanvasControlModel.extend({defaults:{fraction:1,inputControl:1,textSize:20,defaultColor:Controller.COLORS.charcoal,correctColor:Controller.COLORS.correctColor,incorrectColor:Controller.COLORS.incorrectColor,fractionOptions:[1,2,3,4,5,6,8,10,12]},setup:function(){var t=40;this.set({wButtons:t,hButtons:t,yCenter:this.get("h")/2,yButtons:this.get("h")/2-1.5*t,buttonOffset:1.5*t}),this.get("w")>this.get("h")?(this.set({radius:this.get("h")/2-5}),this.set({xCenter:this.get("w")/2-this.get("wButtons")}),this.set({xButtons:this.get("xCenter")+this.get("radius")+25})):(this.set({xButtons:this.get("w")-20-this.get("wButtons")-5}),this.set({radius:(this.get("xButtons")-40)/2-5}),this.set({xCenter:20+this.get("radius")}));var e=this.get("h"),n=this.get("buttonOffset"),r=[this.drawFractionCircle(this.get("fraction")),this.drawButtonFractionContainer(),this.drawButton({classID:"up",y:e/2-n}),this.drawButton({classID:"down",y:e/2+n}),this.drawText(this.get("fraction"))];this.components.addComponents(r)},buttonClick:function(t,e){var n=this.components.getNearestComponent(t,e,function(t){return"up"===t.get("class")||"down"===t.get("class")},1),r=this.components.find(function(t){return"text"===t.get("type")}),i=this.components.find(function(t){return"fraction_circle"===t.get("type")}),o=this.components.find(function(t){return"up"===t.get("class")}),s=this.components.find(function(t){return"down"===t.get("class")}),a=r.get("text");if(n){var l=this.get("fractionOptions"),h="up"===n.get("class")&&o.get("isEnabled"),c="down"===n.get("class")&&s.get("isEnabled");if(h){if(a+1<=12)do a++;while(!_.includes(l,a))}else if(c&&a-1>=1)do a--;while(!_.includes(l,a));(h||c)&&(r.set({text:a,textColor:this.get("defaultColor")}),i.set({style:a,strokeStyle:this.get("defaultColor")}))}o.set("isEnabled",12!==a),s.set("isEnabled",1!==a),this.components.trigger("render")},isValid:function(){return!0},isCorrect:function(t){var e=this.getData(t),n=this.components.find(function(t){return"text"===t.get("type")}),r=n.get("text");return e===r},getData:function(t){return parseInt(_.first(t[(this.get("answerIndex")||1)-1]))},getInput:function(){var t=this.components.find(function(t){return"fraction_circle"===t.get("type")});return[t.get("style")]},setInput:function(t){var e=this.getData(t),n=this.components.find(function(t){return"fraction_circle"===t.get("type")}),r=this.components.find(function(t){return"text"===t.get("type")}),i=this.components.find(function(t){return"up"===t.get("class")}),o=this.components.find(function(t){return"down"===t.get("class")});i.set("isEnabled",12!==e),o.set("isEnabled",1!==e),r.set({text:e,textColor:this.get("defaultColor")}),n.set({style:e,strokeStyle:this.get("defaultColor")}),this.components.trigger("render")},displayAnswer:function(t){this.setInput(t),this.displayResult(t)},displayResult:function(t){var e=this.getData(t),n=this.components.find(function(t){return"fraction_circle"===t.get("type")}),r=this.components.find(function(t){return"text"===t.get("type")});e===r.get("text")?(n.set("strokeStyle",this.get("correctColor")),r.set("textColor",this.get("correctColor"))):(n.set("strokeStyle",this.get("incorrectColor")),r.set("textColor",this.get("incorrectColor"))),this.components.trigger("render")},drawButton:function(t){var e;return e=!("up"===t.classID&&12===this.get("fraction")||"down"===t.classID&&1===this.get("fraction")),{type:"arrow_button","class":t.classID,x:this.get("xButtons")+20,y:t.y||this.get("yButtons"),r:.75*this.get("wButtons"),isEnabled:e}},drawText:function(t){return{type:"text",x:this.get("xButtons")+20,y:this.get("h")/2,w:50,h:25,text:t,textSize:this.get("textSize")+"px"}},drawFractionCircle:function(t){return{type:"fraction_circle",style:t,denominator:[],xCenter:this.get("xCenter"),yCenter:this.get("yCenter"),r:this.get("radius"),bgColor:Controller.COLORS.darkblue}},drawButtonFractionContainer:function(){return{type:"rounded_rectangle",x:this.get("xButtons")-this.get("wButtons")/2,y:this.get("h")/2-this.get("radius")/(1+1/3),w:2*this.get("wButtons"),h:1.5*this.get("radius"),cornerRadius:20}}}),Controller.ClickableFractionCircleView=Controller.CanvasControlView.extend({initialize:function(t){this.model.isInputControl()&&(this.canvasEvents={click:"buttonClick"}),Controller.CanvasControlView.prototype.initialize.apply(this,t)}}),Controller.CoordinatePlaneModel=Controller.CanvasControlModel.extend({parse:function(t){var e=t.value;return e&&(e=e.replace(/([^,\]\[]+)/g,function(t){return t=t.trim(),"''"===t?'""':(t=t.substring(t.startsWith("'")?1:0,t.endsWith("'")?t.length-1:t.length),isNaN(t)&&"true"!==t&&"false"!==t?'"'+t+'"':t)}),e=JSON.parse("["+e+"]"),t.quadrants=e[0],t.pointData=e[1]||[],t.arrowData=e[2]||[]),Controller.CanvasControlModel.prototype.parse.call(this,t)},defaults:{quadrants:1,axisStrokeStyle:Controller.COLORS.charcoal,gridStrokeStyle:Controller.COLORS.blue,axisLabelsFillStyle:Controller.COLORS.charcoal,textColor:Controller.COLORS.white,textBoxCount:1,inputControl:0,pointColor:Controller.COLORS.orange,textBoxesExist:!1,gridIncrement:1,labelIncrement:1,maxCoords:10,answerIndex:1,shapeColors:[Controller.COLORS.orange,Controller.COLORS.blue,Controller.COLORS.lightpink,Controller.COLORS.teal,Controller.COLORS.brown,Controller.COLORS.purple]},setup:function(){function t(){for(H=0,q=!0;q&&H<36;){H++,D+=10,D>360&&(D-=360),F=this.textRectangle({labelAngle:D,pointData:y,grid:f,shape:k,center:z,labelDistance:L,fontSize:d}),V=""!==y[k][y[k].length-2]&&Controller.Math.intersect({type:"rectangle",x:M[k].x,y:M[k].y,w:M[k].w,h:M[k].h},{type:"rectangle",x:F.xText,y:F.yText,w:F.wText,h:F.hText});var t=0;for(lt=!1;lt===!1&&t<y[k].length-2;)0===t?(et=0,nt=1):(et++,nt++),et===y[k].length-3&&(nt=0),lt=this.checkIntersection({lineEquations:it[k][et],xRect:F.xText,yRect:F.yText,wRect:F.wText,hRect:F.hText,xMaxOne:Math.max(this.getCanvasCoord(f,y[k][nt][0]).x,this.getCanvasCoord(f,y[k][et][0]).x),xMinOne:Math.min(this.getCanvasCoord(f,y[k][nt][0]).x,this.getCanvasCoord(f,y[k][et][0]).x),yMaxOne:Math.max(this.getCanvasCoord(f,y[k][nt][1]).y,this.getCanvasCoord(f,y[k][et][1]).y),yMinOne:Math.min(this.getCanvasCoord(f,y[k][nt][1]).y,this.getCanvasCoord(f,y[k][et][1]).y)}),t++;q=lt||V}}function e(t){switch(H=0,lt=!0,t){case"right":1===this.get("quadrants")?q=U||lt:4===this.get("quadrants")&&(q=j||lt);break;case"left":q=X||lt;break;case"top":4===this.get("quadrants")?q=Z||lt:1===this.get("quadrants")&&(q=Q||lt);break;case"bottom":q=K||lt}for(;q&&H<36;){H++,D+=10,D>360&&(D-=360),F=this.textRectangle({labelAngle:D,pointData:y,grid:f,shape:k,center:z,labelDistance:L,fontSize:d});var e=0;for(lt=!1;lt===!1&&e<y[k].length-2;)0===e?(et=0,nt=1):(et++,nt++),et===y[k].length-3&&(nt=0),lt=this.checkIntersection({lineEquations:it[k][et],xRect:F.xText,yRect:F.yText,wRect:F.wText,hRect:F.hText,xMaxOne:Math.max(this.getCanvasCoord(f,y[k][nt][0]).x,this.getCanvasCoord(f,y[k][et][0]).x),xMinOne:Math.min(this.getCanvasCoord(f,y[k][nt][0]).x,this.getCanvasCoord(f,y[k][et][0]).x),yMaxOne:Math.max(this.getCanvasCoord(f,y[k][nt][1]).y,this.getCanvasCoord(f,y[k][et][1]).y),yMinOne:Math.min(this.getCanvasCoord(f,y[k][nt][1]).y,this.getCanvasCoord(f,y[k][et][1]).y)}),e++;switch(V=""!==y[k][y[k].length-2]&&Controller.Math.intersect({type:"rectangle",x:M[k].x,y:M[k].y,w:M[k].w,h:M[k].h},{type:"rectangle",x:F.xText,y:F.yText,w:F.wText,h:F.hText}),t){case"right":1===this.get("quadrants")?(U=r(1,"right"),Y=r(1,"x"),q=U||Y||lt||V):4===this.get("quadrants")&&(j=r(4,"right"),J=r(4,"x"),q=j||J||lt||V);break;case"left":X=r(4,"left"),J=r(4,"x"),q=J||X||lt||V;break;case"top":4===this.get("quadrants")?(Z=r(4,"top"),X=r(4,"left"),j=r(4,"right"),G=r(4,"y"),q=Z||X||j||G||lt||V):1===this.get("quadrants")&&(Q=r(1,"top"),U=r(1,"right"),$=r(1,"y"),q=Q||U||$||lt||V);break;case"bottom":K=r(4,"bottom"),X=r(4,"left"),j=r(4,"right"),G=r(4,"y"),q=K||X||j||G||lt||V}}}function n(t){switch(H=0,lt=!0,t){case"y":1===this.get("quadrants")?q=$||lt:4===this.get("quadrants")&&(q=G||lt);break;case"x":1===this.get("quadrants")?q=Y||lt:4===this.get("quadrants")&&(q=J||lt)}for(;q&&H<36;){H++,D+=10,D>360&&(D-=360),F=this.textRectangle({labelAngle:D,pointData:y,grid:f,shape:k,center:z,labelDistance:L,fontSize:d});var e=0;for(lt=!1;lt===!1&&e<y[k].length-2;)0===e?(et=0,nt=1):(et++,nt++),et===y[k].length-3&&(nt=0),lt=this.checkIntersection({lineEquations:it[k][et],xRect:F.xText,yRect:F.yText,wRect:F.wText,hRect:F.hText,xMaxOne:Math.max(this.getCanvasCoord(f,y[k][nt][0]).x,this.getCanvasCoord(f,y[k][et][0]).x),xMinOne:Math.min(this.getCanvasCoord(f,y[k][nt][0]).x,this.getCanvasCoord(f,y[k][et][0]).x),yMaxOne:Math.max(this.getCanvasCoord(f,y[k][nt][1]).y,this.getCanvasCoord(f,y[k][et][1]).y),yMinOne:Math.min(this.getCanvasCoord(f,y[k][nt][1]).y,this.getCanvasCoord(f,y[k][et][1]).y)}),e++;switch(V=""!==y[k][y[k].length-2]&&Controller.Math.intersect({type:"rectangle",x:M[k].x,y:M[k].y,w:M[k].w,h:M[k].h},{type:"rectangle",x:F.xText,y:F.yText,w:F.wText,h:F.hText}),t){case"y":1===this.get("quadrants")?($=r(1,"y"),Y=r(1,"x"),q=$||Y||lt||V):4===this.get("quadrants")&&(G=r(4,"y"),J=r(4,"x"),q=G||J||lt||V);break;case"x":1===this.get("quadrants")?(Y=r(1,"x"),U=r(1,"right"),$=r(1,"y"),q=Y||$||U||lt||V):4===this.get("quadrants")&&(J=r(4,"x"),j=r(4,"right"),G=r(4,"y"),X=r(4,"left"),q=J||G||j||X||lt||V)}}}function r(t,e){switch(e){case"right":if(1===t)return F.xText+F.wText>=l-u+i;if(4===t)return j=F.xText+F.wText>=l+i/2;break;case"left":if(4===t)return F.xText<=l-i/2;break;case"top":if(1===t)return F.yText<=h+u-i;if(4===t)return F.yText<=h-i/2;break;case"bottom":if(4===t)return F.yText+F.hText>=h+i/2;break;case"x":if(1===t)return F.yText+F.hText>=h;if(4===t)return F.yText+F.hText<=h+.75*u&&F.yText+F.hText>=h||F.yText<=h&&F.yText+F.hText>=h+.75*u||F.yText>=h&&F.yText<=h+.75*u;break;case"y":if(1===t)return F.xText<=l;if(4===t)return F.xText+F.wText>=l-.75*u&&F.xText+F.wText<l||F.xText<=l-.75*u&&F.xText+F.wText>l||F.xText<=l&&F.xText>l-.75*u}}this.get("inputControl")&&4===this.get("quadrants")&&this.set({maxCoords:5});var i=Math.min(this.get("w"),this.get("h")),o=1;if(4===this.get("quadrants")){var s=i/(10*this.get("maxCoords")),a=i-2*o,l=this.get("inputControl")?i/2:this.get("w")/2,h=this.get("h")/2,c=a-6*s,u=c/(2*this.get("maxCoords")+2),d=u/2,p=u/5;this.components.add({type:"rectangle",x:l-i/2,y:h-i/2,w:i,h:i,fillStyle:Controller.COLORS.white,lineWidth:0});var f=this.components.add({type:"grid",x:l-c/2,y:h-c/2,w:c,h:c,strokeStyle:this.get("gridStrokeStyle"),numRows:2*this.get("maxCoords")+2,numColumns:2*this.get("maxCoords")+2,lineWidth:1});this.axisArrows(l+c/2,h,l+a/2,h,s),this.axisArrows(l-c/2,h,l-a/2,h,s),this.axisArrows(l,h+c/2,l,h+a/2,s),this.axisArrows(l,h-c/2,l,h-a/2,s),this.components.add({type:"line","class":"yAxis",xStart:l,yStart:h-a/2,xEnd:l,yEnd:h+a/2,strokeStyle:this.get("axisStrokeStyle"),lineWidth:2}),this.components.add({type:"line","class":"xAxis",xStart:l-a/2,yStart:h,xEnd:l+a/2,yEnd:h,strokeStyle:this.get("axisStrokeStyle"),lineWidth:2}),this.axisLabels(l-u/3.5,h+u/2.5,d,"0"),this.axisLabels(l+c/2+u/3,h+u/2,d,"x"),this.axisLabels(l-u/2,h-c/2-u/2,d,"y");for(var g=1;g<this.get("maxCoords")+1;g++)this.axisLabels(l+g*this.get("gridIncrement")*u,h+u/2,d,g*this.get("labelIncrement")),this.axisLabels(l-g*this.get("gridIncrement")*u,h+u/2,d,-g*this.get("labelIncrement")),this.axisLabels(l-u/2,h-g*this.get("gridIncrement")*u,d,g*this.get("labelIncrement")),this.axisLabels(l-u/2,h+g*this.get("gridIncrement")*u,d,-g*this.get("labelIncrement"))}else if(1===this.get("quadrants")){var s=i/(10*this.get("maxCoords")/2),u=(i-o)/(this.get("maxCoords")+2.5),c=(this.get("maxCoords")+1)*u,a=i-o-u,l=this.get("inputControl")?u:(this.get("w")-i)/2+u,h=this.get("inputControl")?this.get("h")/2+i/2-u:(this.get("h")-i)/2+i-u,d=u/2,p=u/5;this.components.add({type:"rectangle",x:l-u,y:h-a,w:i,h:i,fillStyle:Controller.COLORS.white,lineWidth:0});var f=this.components.add({type:"grid",x:l,y:h-c,w:c,h:c,strokeStyle:this.get("gridStrokeStyle"),numRows:this.get("maxCoords")+1,numColumns:this.get("maxCoords")+1,lineWidth:1});this.axisArrows(l+c,h,l+a,h,s),this.axisArrows(l,h-c,l,h-a,s),this.components.add({type:"line","class":"yAxis",xStart:l,yStart:h,xEnd:l,yEnd:h-a,strokeStyle:this.get("axisStrokeStyle"),lineWidth:2}),this.components.add({type:"line","class":"xAxis",xStart:l,yStart:h,xEnd:l+a,yEnd:h,strokeStyle:this.get("axisStrokeStyle"),lineWidth:2}),this.axisLabels(l-u/3,h+u/3,d,"0"),this.axisLabels(l+c+u/3,h+u/2,d,"x"),this.axisLabels(l-u/2,h-c-u/3,d,"y");for(var g=1;g<this.get("maxCoords")+1;g++)this.axisLabels(l+g*this.get("gridIncrement")*u,h+u/2,d,g*this.get("labelIncrement")),this.axisLabels(l-u/2,h-g*this.get("gridIncrement")*u,d,g*this.get("labelIncrement"))}this.set({boxWidthHeight:u});for(var m,x,y=this.get("pointData"),v=this.get("arrowData"),C=y.length,w=v.length,b=[],M=[],S=[],E=[],I=[],g=0;g<C;g++){S=[],m=0,x=0,E.push(Controller.COLORS[y[g][y[g].length-1].toLowerCase()]),I.push(y[g].length-2);for(var N=0;N<I[g];N++)S.push([this.getCanvasCoord(f,y[g][N][0]).x,this.getCanvasCoord(f,y[g][N][1]).y]),m+=S[N][0],x+=S[N][1];b[g]={x:m/I[g],y:x/I[g]},this.components.add({type:"shape",coordinates:S,fillStyle:E[g],lineWidth:0,strokeStyle:"",bgTransparency:.2})}for(var g=0;g<C;g++){for(var N=0;N<I[g]-1;N++)this.connectPoints(this.getCanvasCoord(f,y[g][N][0]).x,this.getCanvasCoord(f,y[g][N][1]).y,this.getCanvasCoord(f,y[g][N+1][0]).x,this.getCanvasCoord(f,y[g][N+1][1]).y,E[g],y[g][N]);this.connectPoints(this.getCanvasCoord(f,y[g][N][0]).x,this.getCanvasCoord(f,y[g][N][1]).y,this.getCanvasCoord(f,y[g][0][0]).x,this.getCanvasCoord(f,y[g][0][1]).y,E[g],y[g][N])}for(var g=0;g<C;g++)for(var N=0;N<I[g];N++)this.drawPoint(this.getCanvasCoord(f,y[g][N][0]).x,this.getCanvasCoord(f,y[g][N][1]).y,p,E[g]);for(var g=0;g<C;g++)if(""!==y[g][I[g]]){var O=this.labelWidth({label:y[g][I[g]],fontSize:4*d/3,showCoords:0}),T=4===this.get("quadrants")?d+5:d,_=b[g].x-O/2,P=b[g].y-T/2;M[g]={x:_,y:P,w:O,h:T};var A=d;4===this.get("quadrants")&&(A+=5),this.components.add({type:"text",text:y[g][I[g]],x:b[g].x,y:b[g].y,textFont:"Roboto",textSize:A+"px",lineWidth:1})}for(var g=0;g<w;g++)5===v[g].length&&(v[g][4]=Controller.COLORS[v[g][4].toLowerCase()]),this.drawArrow(this.getCanvasCoord(f,v[g][0]).x,this.getCanvasCoord(f,v[g][1]).y,this.getCanvasCoord(f,v[g][2]).x,this.getCanvasCoord(f,v[g][3]).y,v[g],2*s);for(var k,R,z,B,L,D,W,F,V,q,H,U,j,$,G,Y,J,X,Z,Q,K,tt,et,nt,rt,it=[],ot=[],st=1,k=0;k<C;k++){ot=[];for(var N=0;N<I[k];N++)ot.push(this.lineEquations({xStart:this.getCanvasCoord(f,y[k][N][0]).x,yStart:this.getCanvasCoord(f,y[k][N][1]).y,xEnd:this.getCanvasCoord(f,N<I[k]-1?y[k][N+1][0]:y[k][0][0]).x,yEnd:this.getCanvasCoord(f,N<I[k]-1?y[k][N+1][1]:y[k][0][1]).y}));it[k]=ot}for(var k=0;k<C;k++){R=0,z=0,B=0;for(var N=0;N<y[k].length-2;N++){if(z=N,B=N+1,0===N&&(R=y[k].length-3),R>y[k].length-3&&(R=0),B>y[k].length-3&&(B=0),L=p+5,y[k][z][3]>=2&&(L*=5/4),I[k]>1?(W=this.angleBetweenLines({pointOneX:y[k][R][0],pointOneY:y[k][R][1],connectingPointX:y[k][z][0],connectingPointY:y[k][z][1],pointTwoX:y[k][B][0],pointTwoY:y[k][B][1],grid:f}),Math.abs(W.angleOne-W.angleTwo)<180&&(W.avgNormalAngle-=180),D=W.avgNormalAngle):D=90,F=this.textRectangle({labelAngle:D,pointData:y,grid:f,shape:k,center:z,labelDistance:L,fontSize:d}),""!==y[k][z][2]||y[k][z][3]>0){for(var at=0,lt=!1,V=!1;lt===!1&&at<y[k].length-2;)0===at?(et=0,nt=1):(et++,nt++),et===y[k].length-3&&(nt=0),lt=this.checkIntersection({lineEquations:it[k][et],xRect:F.xText,yRect:F.yText,wRect:F.wText,hRect:F.hText,xMaxOne:Math.max(this.getCanvasCoord(f,y[k][nt][0]).x,this.getCanvasCoord(f,y[k][et][0]).x),xMinOne:Math.min(this.getCanvasCoord(f,y[k][nt][0]).x,this.getCanvasCoord(f,y[k][et][0]).x),yMaxOne:Math.max(this.getCanvasCoord(f,y[k][nt][1]).y,this.getCanvasCoord(f,y[k][et][1]).y),yMinOne:Math.min(this.getCanvasCoord(f,y[k][nt][1]).y,this.getCanvasCoord(f,y[k][et][1]).y)}),at++;lt&&t.bind(this)(),U=r.bind(this)(1,"right"),j=r.bind(this)(4,"right"),(1===this.get("quadrants")&&U||4===this.get("quadrants")&&j)&&e.bind(this)("right"),$=r.bind(this)(1,"y"),G=r.bind(this)(4,"y"),(1===this.get("quadrants")&&$||4===this.get("quadrants")&&G)&&n.bind(this)("y"),Y=r.bind(this)(1,"x"),J=r.bind(this)(4,"x"),(1===this.get("quadrants")&&Y||4===this.get("quadrants")&&J)&&n.bind(this)("x"),X=r.bind(this)(4,"left"),4===this.get("quadrants")&&X&&e.bind(this)("left"),Z=r.bind(this)(4,"top"),Q=r.bind(this)(1,"top"),(4===this.get("quadrants")&&Z||1===this.get("quadrants")&&Q)&&e.bind(this)("top"),K=r.bind(this)(4,"bottom"),4===this.get("quadrants")&&K&&e.bind(this)("bottom"),tt=1===y[k][z][3]?y[k][z][2]+" ("+y[k][z][0]+" , "+y[k][z][1]+")":y[k][z][2],this.pointLabel({x:this.getCanvasCoord(f,y[k][z][0]).x+L*Math.cos(D*Math.PI/180),y:this.getCanvasCoord(f,y[k][z][1]).y-L*Math.sin(D*Math.PI/180),fontSize:d,text:tt,color:y[k][y[k].length-1],align:F.textAlign,baseline:F.textBaseline,coordType:y[k][z][3]}),y[k][z][3]>=2&&(rt=this.drawTextBox({pointData:y,shape:k,center:z,textRectAttribs:F,fontSize:d,pointOne:R,textBoxCount:st}),st=rt)}R++}}if(this.set({xOrigin:l}),this.set({yOrigin:h}),this.set({pointRadius:p}),this.set({grid:f}),this.set({totalLength:i}),this.get("inputControl")){this.set({pointsArray:[]}),this.set({shapeNum:0}),this.set({pointNum:0});var ht=this.components.add({type:"undo_button","class":"undo",x:4===this.get("quadrants")?l+i/2+(this.get("w")-i)/2:l+i-u+(this.get("w")-i)/2,y:4===this.get("quadrants")?h:h-i/2+u,outlineWidth:3,r:(this.get("w")-i)/3,arrowColor:Controller.COLORS.lightgrey,buttonColor:Controller.COLORS.darkgrey});this.set({undoButton:ht})}},axisLabels:function(t,e,n,r){this.components.add({type:"text",text:r,x:t,y:e,textFont:"Roboto",textSize:n+"px",strokeStyle:Controller.COLORS.charcoal,lineWidth:1})},axisArrows:function(t,e,n,r,i){this.components.add({type:"arrow",xStart:t,yStart:e,xEnd:n,yEnd:r,strokeStyle:this.get("axisStrokeStyle"),lineWidth:2,arrowWidth:i})},drawPoint:function(t,e,n,r){this.components.add({type:"circle",x:t,y:e,r:n,fillStyle:r})},connectPoints:function(t,e,n,r,i,o){var s=[],a="";5===o.length&&(a="dashed",s=[this.get("boxWidthHeight")/2,this.get("boxWidthHeight")/6]),this.components.add({type:"line",xStart:t,yStart:e,xEnd:n,yEnd:r,strokeStyle:Controller.COLORS.charcoal,lineWidth:5,lineStyle:a,lineStyleAttributes:s}),this.components.add({type:"line",xStart:t,yStart:e,xEnd:n,yEnd:r,strokeStyle:i,lineWidth:2,lineStyle:a,lineStyleAttributes:s})},drawArrow:function(t,e,n,r,i,o){var s=Controller.COLORS.charcoal;5===i.length&&(s=i[4]),t===n?e>r?r+=3:e<r&&(r-=3):e===r?t>n?n+=3:t<n&&(n-=3):r<e?n>t?(n-=3,r+=3):n<t&&(n+=3,r+=3):r>e&&(n>t?(n-=3,r-=3):n<t&&(n+=3,r-=3)),(r-e)/(n-t)>=-.3&&(r-e)/(n-t)<0&&(n>t&&r<e?(n-=1,r-=1):n<t&&r>e&&(n+=1,r+=1)),(r-e)/(n-t)<=.3&&(r-e)/(n-t)>0&&(n>t&&r>e?(n-=1,r+=1):n<t&&r<e&&(n+=1,r-=1)),(r-e)/(n-t)<=-3.33&&(n>t&&r<e?(n+=1,r+=1):n<t&&r>e&&(n-=1,r-=1)),(r-e)/(n-t)>=3.33&&(n<t&&r<e?(n-=1,r+=1):n>t&&r>e&&(n+=1,r-=1)),this.components.add({type:"arrow",xStart:t,yStart:e,xEnd:n,yEnd:r,strokeStyle:Controller.COLORS.charcoal,lineWidth:5,arrowWidth:o}),this.components.add({type:"arrow",xStart:t,yStart:e,xEnd:n,yEnd:r,strokeStyle:s,lineWidth:2,arrowWidth:o})},getCanvasCoord:function(t,e){return t.getCanvasCoords({gridIncrement:this.get("gridIncrement"),labelIncrement:this.get("labelIncrement"),gridCoord:e,quadrants:this.get("quadrants"),xStart:0,yStart:0})},getGridCoord:function(t){var e=t.grid,n=t.point,r=t.xOrigin,i=t.yOrigin,o=t.boxWidthHeight;return e.getGridCoords({gridIncrement:this.get("gridIncrement"),labelIncrement:this.get("labelIncrement"),canvasCoord:n,quadrants:this.get("quadrants"),xOrigin:r,yOrigin:i,boxWidthHeight:o})},shapeLabel:function(t,e,n,r,i){4===this.get("quadrants")&&(n+=5),this.components.add({type:"text",text:r,x:t,y:e,textFont:"Roboto",textSize:n+"px",lineWidth:1})},pointLabel:function(t){t.fontSize*=2/3,4===this.get("quadrants")&&(t.fontSize+=5),1!==t.coordType&&0!==t.coordType||this.components.add({type:"text",text:t.text,x:t.x,y:t.y,textFont:"Roboto",textSize:t.fontSize+"px",lineWidth:1,textBaseline:t.baseline,textAlign:t.align})},angleBetweenLines:function(t){var e=180*Math.atan((t.pointOneY-t.connectingPointY)/(t.pointOneX-t.connectingPointX))/Math.PI,n=180*Math.atan((t.pointTwoY-t.connectingPointY)/(t.pointTwoX-t.connectingPointX))/Math.PI;t.pointOneX===t.connectingPointX&&t.pointOneY>t.connectingPointY&&(e=90),t.pointTwoX===t.connectingPointX&&t.pointTwoY>t.connectingPointY&&(n=90),t.pointOneX<t.connectingPointX&&(e+=180),t.pointTwoX<t.connectingPointX&&(n+=180),t.pointOneX===t.connectingPointX&&t.pointOneY<t.connectingPointY&&(e=270),t.pointTwoX===t.connectingPointX&&t.pointTwoY<t.connectingPointY&&(n=270),t.pointOneY<t.connectingPointY&&t.pointOneX>t.connectingPointX&&(e+=360),t.pointTwoY<t.connectingPointY&&t.pointTwoX>t.connectingPointX&&(n+=360);var r=Math.min(e,n)+Math.abs(n-e)/2;return{avgNormalAngle:r,angleOne:e,angleTwo:n}},labelWidth:function(t){var e=t.label.toString(),n=t.xCoord,r=t.yCoord,i=t.fontSize,o=t.showCoords,s=0;return 4===this.get("quadrants")&&(i+=5),n=parseFloat(n),r=parseFloat(r),s+=e.length*this.charWidth("character",i),e.length>0&&o>0&&(s+=this.charWidth(" ",i)),o&&(s+=2*this.charWidth(")",i)+this.charWidth(",",i),1===o?s+=2*this.charWidth(" ",i):2===o?s+=94+4*this.charWidth(" ",i):3!==o&&4!==o||(s+=48+3*this.charWidth(" ",i)),1!==o&&3!==o||(n%1===0?(s+=this.charWidth("digit",i),10!==n&&n!==-10||(s+=this.charWidth("digit",i))):s+=2*this.charWidth("digit",i)+this.charWidth(".",i),n<0&&(s+=this.charWidth("-",i))),1!==o&&4!==o||(r%1===0?(s+=this.charWidth("digit",i),10!==r&&r!==-10||(s+=this.charWidth("digit",i))):s+=2*this.charWidth("digit",i)+this.charWidth(".",i),r<0&&(s+=this.charWidth("-",i))),4===this.get("quadrants")&&1===o&&(s-=.5*i),4===this.get("quadrants")&&2===o&&(s-=.3*i),4!==this.get("quadrants")||3!==o&&4!==o||(s-=.15*i)),s+=2},lineEquations:function(t){var e=(t.yEnd-t.yStart)/(t.xEnd-t.xStart),n=t.yStart-e*t.xStart;return{lineInfo:t,lineSlope:e,lineYInt:n}},textRectangle:function(t){var e,n,r,i,o,s,a=t.grid,l=t.labelAngle,h=t.labelDistance,c=t.shape,u=t.center,d=t.fontSize,p=t.pointData;return 4===this.get("quadrants")&&(d+=5),Math.abs(l)<=60&&Math.abs(l)>=0||Math.abs(l)>=300?(e="left",n="middle"):l>60&&l<120||l>-300&&l<-240?(e="center",n="bottom"):l>240&&l<300||l<-60&&l>-120?(e="center",n="top"):Math.abs(l)>=120&&Math.abs(l)<=240&&(e="right",n="middle"),"middle"===n?i=this.getCanvasCoord(a,p[c][u][1]).y-h*Math.sin(l*Math.PI/180)-(p[c][u][3]>=2?21:d/2):"top"===n?i=this.getCanvasCoord(a,p[c][u][1]).y-h*Math.sin(l*Math.PI/180)-(p[c][u][3]>=2?12-d/2:0):"bottom"===n&&(i=this.getCanvasCoord(a,p[c][u][1]).y-h*Math.sin(l*Math.PI/180)-(p[c][u][3]>=2?d/2+28:d)),s=p[c][u][3]>=2?40:d,o=this.labelWidth({label:p[c][u][2],xCoord:p[c][u][0],yCoord:p[c][u][1],fontSize:d,showCoords:p[c][u][3]}),"left"===e?r=this.getCanvasCoord(a,p[c][u][0]).x+h*Math.cos(l*Math.PI/180):"right"===e?r=this.getCanvasCoord(a,p[c][u][0]).x+h*Math.cos(l*Math.PI/180)-o:"center"===e&&(r=this.getCanvasCoord(a,p[c][u][0]).x+h*Math.cos(l*Math.PI/180)-o/2),{xText:r,yText:i,wText:o,hText:s,textAlign:e,textBaseline:n}},checkIntersection:function(t){var e={x:t.xRect,y:t.yRect},n={x:t.xRect+t.wRect,y:t.yRect},r={x:t.xRect+t.wRect,y:t.yRect+t.hRect},i={x:t.xRect,y:t.yRect+t.hRect},o=[],s=t.lineEquations;if(isFinite(s.lineSlope)){(t.xMaxOne>e.x&&t.xMinOne<e.x||t.yMaxOne>e.y&&t.yMinOne<e.y)&&o.push(s.lineSlope*e.x+s.lineYInt-e.y),(t.xMaxOne>n.x&&t.xMinOne<n.x||t.yMaxOne>n.y&&t.yMinOne<n.y)&&o.push(s.lineSlope*n.x+s.lineYInt-n.y),(t.xMaxOne>r.x&&t.xMinOne<r.x||t.yMaxOne>r.y&&t.yMinOne<r.y)&&o.push(s.lineSlope*r.x+s.lineYInt-r.y),(t.xMaxOne>i.x&&t.xMinOne<i.x||t.yMaxOne>i.y&&t.yMinOne<i.y)&&o.push(s.lineSlope*i.x+s.lineYInt-i.y);for(var a=[],l=[],h=0;h<o.length;h++)o[h]<0?l.push(o[h]):a.push(o[h]);if(l.length&&a.length)return!0}else if(t.xRect<=s.lineInfo.xStart&&t.xRect+t.wRect>s.lineInfo.xStart)if(s.lineInfo.yStart<s.lineInfo.yEnd){if(t.yRect>=s.lineInfo.yStart&&t.yRect<s.lineInfo.yEnd||t.yRect+t.hRect>=s.lineInfo.yStart&&t.yRect+t.hRect<s.lineInfo.yEnd)return!0}else if(t.yRect<=s.lineInfo.yStart&&t.yRect>s.lineInfo.yEnd||t.yRect+t.hRect<=s.lineInfo.yStart&&t.yRect+t.hRect>s.lineInfo.yEnd)return!0;return!1},labelInsidePolygon:function(t){for(var e=t.xLabel,n=t.yLabel,r=t.lineEquations,i=(t.xOrigin,t.totalLength,t.pointData,t.shape),o=0,s=0,a=0;a<r[i].length;a++)r[i][a].lineInfo.xStart>=e&&r[i][a].lineInfo.xEnd>=e&&(n<=r[i][a].lineInfo.yStart&&n>=r[i][a].lineInfo.yEnd||n<=r[i][a].lineInfo.yEnd&&n>=r[i][a].lineInfo.yStart)&&(o++,
n!==r[i][a].lineInfo.yStart&&n!==r[i][a].lineInfo.yEnd||s++);return s>0&&o--,o%2!==0},drawTextBox:function(t){this.set({textBoxesExist:!0});var e,n,r=t.pointData,i=t.shape,o=t.center,s=t.textRectAttribs,a=t.fontSize,l=r[i][o][2],h=r[i][o][0],c=r[i][o][1],u=0,d=t.textBoxCount,p=this.get("answerIndex");return this.get("inputControl")&&p++,4===this.get("quadrants")&&(a+=5,u+=2),l=l.toString(),u+=l.length*this.charWidth("character",a),l.length>0&&(u+=this.charWidth(" ",a)),u+=this.charWidth("(",a),2===r[i][o][3]?(u+=23.5+this.charWidth(" ",a),e=s.xText+u,n=s.yText+20,this.components.add({type:"textBox",canvasControl:this,text:-5.5,answerIndex:p,answerSubIndex:d,x:e+1,y:n,w:30,h:30,leadingText:l+(l.length>0?" ( ":"( "),textSize:1===this.get("quadrants")?2*a/3+"px":2*(a-5)/3+5+"px",trailingText:" ,",leadingTrailingFont:"Roboto",lineWidth:1,strokeStyle:Controller.COLORS.charcoal,textColor:Controller.COLORS.charcoal}),d++,this.components.add({type:"textBox",canvasControl:this,text:-5.5,answerIndex:p,answerSubIndex:d,x:e+52+2*this.charWidth(" ",a),y:n,w:30,h:30,trailingText:" )",textSize:1===this.get("quadrants")?2*a/3+"px":2*(a-5)/3+5+"px",leadingTrailingFont:"Roboto",lineWidth:1,strokeStyle:Controller.COLORS.charcoal,textColor:Controller.COLORS.charcoal}),d++):3===r[i][o][3]?(h%1===0?(u+=this.charWidth("digit",a),10!==h&&h!==-10||(u+=this.charWidth("digit",a))):u+=2*this.charWidth("digit",a)+this.charWidth(".",a),h<0&&(u+=this.charWidth("-",a)),u+=this.charWidth(",",a)+this.charWidth(" ",a),u+=1===this.get("quadrants")?27.5:30.5,e=s.xText+u,n=s.yText+20,this.components.add({type:"textBox",canvasControl:this,text:-5.5,answerIndex:p,answerSubIndex:d,x:e+1,y:n,w:30,h:30,leadingText:l+(l.length>0?" (":"(")+h+"  , ",textSize:1===this.get("quadrants")?2*a/3+"px":2*(a-5)/3+5+"px",trailingText:" )",leadingTrailingFont:"Roboto",lineWidth:1,strokeStyle:Controller.COLORS.charcoal,textColor:Controller.COLORS.charcoal}),d++):4===r[i][o][3]&&(u+=23.5+this.charWidth(" ",a),e=s.xText+u,n=s.yText+20,this.components.add({type:"textBox",canvasControl:this,text:-5.5,answerIndex:p,answerSubIndex:d,x:e+1,y:n,w:30,h:30,leadingText:l+(l.length>0?" ( ":"( "),textSize:1===this.get("quadrants")?2*a/3+"px":2*(a-5)/3+5+"px",trailingText:" ,  "+c+")",leadingTrailingFont:"Roboto",lineWidth:1,strokeStyle:Controller.COLORS.charcoal,textColor:Controller.COLORS.charcoal}),d++),d},charWidth:function(t,e){switch(t){case" ":return.16*e;case"(":case")":return.37*e;case"digit":return.37*e;case"character":return.4*e;case",":return.13*e;case"-":case".":return.18*e}},buttonClick:function(t,e){var n=this.getGridCoord({grid:this.get("grid"),point:{x:t,y:e},xOrigin:this.get("xOrigin"),yOrigin:this.get("yOrigin"),boxWidthHeight:this.get("boxWidthHeight")});n.x=Math.round(n.x),n.y=Math.round(n.y);var r=this.components.getNearestComponent(this.getCanvasCoord(this.get("grid"),n.x).x,this.getCanvasCoord(this.get("grid"),n.y).y,function(t){return"point"===t.get("class")},1),i=this.components.getNearestComponent(t,e,function(t){return"undo"===t.get("class")},10);if(1===this.get("inputControl")){var o=this.get("pointsArray"),s=this.get("pointNum");if(r){this.components.remove(r);for(var a=r.attributes.xGrid,l=r.attributes.yGrid,h=0;h<o.length&&(o[h].xGrid!==a||o[h].yGrid!==l);h++);o.splice(h,1),s--}else if(i&&o.length>0){var c=this.components.find(function(t){return"point"===t.get("class")&&t.get("xGrid")===o[o.length-1].xGrid&&t.get("yGrid")===o[o.length-1].yGrid});this.components.remove(c),o.pop(),s--}else s<this.getData(this.get("answers")).length&&Math.abs(n.x)<=this.get("maxCoords")+1&&Math.abs(n.y)<=this.get("maxCoords")+1&&(1===this.get("quadrants")&&n.x>=0&&n.y>=0||4===this.get("quadrants"))&&(o[s]={type:"circle","class":"point",xGrid:n.x,yGrid:n.y,pointNum:s,x:this.getCanvasCoord(this.get("grid"),n.x).x,y:this.getCanvasCoord(this.get("grid"),n.y).y,r:this.get("pointRadius"),fillStyle:this.get("pointColor")},this.components.add(o[s]),s++);this.redrawUndoButton(),this.set({pointNum:s}),this.set({pointsArray:o})}else if(this.get("inputControl")>=2){var o=this.get("pointsArray"),u=this.get("shapeNum"),s=this.get("pointNum"),d=function(){this.redrawUndoButton(),this.set({pointNum:s}),this.set({shapeNum:u}),this.set({pointsArray:o})};if(0===s&&u<this.getData(this.get("answers")).length&&(o[u]=[]),i&&(u>0||s>0)){if(2===this.get("inputControl")){var p,f=[];0===s?(u-=1,s=o[u].length-1,f.push(this.components.filter(function(t){return"connectingLine"===t.get("class")&&t.get("pointNum")===s&&t.get("shapeNum")===u})),s++,p=this.components.find(function(t){return"point"===t.get("class")&&0===t.get("pointNum")&&t.get("shapeNum")===u}),p.set({shapeClosed:!1}),o[u][0].shapeClosed=!1,o.splice(u+1,1)):(f.push(this.components.find(function(t){return"point"===t.get("class")&&t.get("pointNum")===s-1&&t.get("shapeNum")===u})),f.push(this.components.filter(function(t){return"connectingLine"===t.get("class")&&t.get("pointNum")===s-2&&t.get("shapeNum")===u})),s--,o[u].splice(s,1)),this.components.removeComponents(f),0===o[u].length&&o.splice(u,1)}else if(3===this.get("inputControl")){var f=[];0===s?(u-=1,s=2,f.push(this.components.find(function(t){return"point"===t.get("class")&&t.get("pointNum")===s-1&&t.get("shapeNum")===u})),f.push(this.components.filter(function(t){return"connectingLine"===t.get("class")&&0===t.get("pointNum")&&t.get("shapeNum")===u})),o[u].splice(1,1),o[u+1]&&0===o[u+1].length&&o.splice(u+1,1),s--):1===s&&(f.push(this.components.find(function(t){return"point"===t.get("class")&&t.get("pointNum")===s-1&&t.get("shapeNum")===u})),o.splice(u,1),s=0),this.components.removeComponents(f)}return void d.bind(this)()}if(u>=this.getData(this.get("answers")).length)return;if(0===o[u].length&&Math.abs(n.x)<=this.get("maxCoords")+1&&Math.abs(n.y)<=this.get("maxCoords")+1&&(1===this.get("quadrants")&&n.x>=0&&n.y>=0||4===this.get("quadrants")))return o[u][s]={type:"circle","class":"point",shapeNum:u,pointNum:s,xGrid:n.x,yGrid:n.y,x:this.getCanvasCoord(this.get("grid"),n.x).x,y:this.getCanvasCoord(this.get("grid"),n.y).y,r:this.get("pointRadius"),fillStyle:this.get("shapeColors")[u%this.get("shapeColors").length]},this.components.add(o[u][s]),s++,void d.bind(this)();if((!r||r.get("shapeNum")!==u)&&Math.abs(n.x)<=this.get("maxCoords")+1&&Math.abs(n.y)<=this.get("maxCoords")+1&&(1===this.get("quadrants")&&n.x>=0&&n.y>=0||4===this.get("quadrants"))){if(2===this.get("inputControl")||3===this.get("inputControl")&&s<2){var g=this.components.find(function(t){return"point"===t.get("class")&&t.get("pointNum")===s-1&&t.get("shapeNum")===u});this.components.remove(g,{silent:!0});var m=[];m.push({type:"line","class":"connectingLine",shapeNum:u,pointNum:s-1,xStart:this.getCanvasCoord(this.get("grid"),o[u][s-1].xGrid).x,yStart:this.getCanvasCoord(this.get("grid"),o[u][s-1].yGrid).y,xEnd:this.getCanvasCoord(this.get("grid"),n.x).x,yEnd:this.getCanvasCoord(this.get("grid"),n.y).y,strokeStyle:Controller.COLORS.charcoal,lineWidth:5},{type:"line","class":"connectingLine",shapeNum:u,pointNum:s-1,xStart:this.getCanvasCoord(this.get("grid"),o[u][s-1].xGrid).x,yStart:this.getCanvasCoord(this.get("grid"),o[u][s-1].yGrid).y,xEnd:this.getCanvasCoord(this.get("grid"),n.x).x,yEnd:this.getCanvasCoord(this.get("grid"),n.y).y,strokeStyle:this.get("shapeColors")[u%this.get("shapeColors").length],lineWidth:2}),o[u][s]={type:"circle","class":"point",shapeNum:u,pointNum:s,xGrid:n.x,yGrid:n.y,x:this.getCanvasCoord(this.get("grid"),n.x).x,y:this.getCanvasCoord(this.get("grid"),n.y).y,r:this.get("pointRadius"),fillStyle:this.get("shapeColors")[u%this.get("shapeColors").length]},this.components.addComponents([m,g,o[u][s]]),s++}if(3===this.get("inputControl")&&2===s){var p=this.components.find(function(t){return"point"===t.get("class")&&0===t.get("pointNum")&&t.get("shapeNum")===u});this.components.remove(p,{silent:!0}),o[u][0]={type:"circle","class":"point",shapeNum:u,pointNum:0,xGrid:p.get("xGrid"),yGrid:p.get("yGrid"),x:p.get("x"),y:p.get("y"),r:this.get("pointRadius"),fillStyle:this.get("shapeColors")[u%this.get("shapeColors").length],lineWidth:2},this.components.add(o[u][0]),u++,s=0}return void d.bind(this)()}if(r&&0===r.get("pointNum")&&r.get("shapeNum")===u&&o[u].length>2){var p=this.components.find(function(t){return"point"===t.get("class")&&0===t.get("pointNum")&&t.get("shapeNum")===u}),x=this.components.find(function(t){return"point"===t.get("class")&&t.get("pointNum")===o[u].length-1&&t.get("shapeNum")===u});this.components.removeComponents([p,x],{silent:!0});var m=[];return m.push({type:"line","class":"connectingLine",shapeNum:u,pointNum:o[u].length-1,xStart:this.getCanvasCoord(this.get("grid"),n.x).x,yStart:this.getCanvasCoord(this.get("grid"),n.y).y,xEnd:this.getCanvasCoord(this.get("grid"),o[u][o[u].length-1].xGrid).x,yEnd:this.getCanvasCoord(this.get("grid"),o[u][o[u].length-1].yGrid).y,strokeStyle:Controller.COLORS.charcoal,lineWidth:5},{type:"line","class":"connectingLine",shapeNum:u,pointNum:o[u].length-1,xStart:this.getCanvasCoord(this.get("grid"),n.x).x,yStart:this.getCanvasCoord(this.get("grid"),n.y).y,xEnd:this.getCanvasCoord(this.get("grid"),o[u][o[u].length-1].xGrid).x,yEnd:this.getCanvasCoord(this.get("grid"),o[u][o[u].length-1].yGrid).y,strokeStyle:this.get("shapeColors")[u%this.get("shapeColors").length],lineWidth:2}),o[u][0]={type:"circle","class":"point",shapeNum:u,pointNum:0,shapeClosed:!0,xGrid:p.get("xGrid"),yGrid:p.get("yGrid"),x:p.get("x"),y:p.get("y"),r:this.get("pointRadius"),fillStyle:this.get("shapeColors")[u%this.get("shapeColors").length]},this.components.addComponents([m,o[u][0],x]),u++,s=0,void d.bind(this)()}0===o[u].length&&o.splice(u,1)}},disableInput:function(){this.components.remove(this.components.find(function(t){return"undo"===t.get("class")}));var t=this.components.add({type:"undo_button","class":"undo",x:4===this.get("quadrants")?this.get("xOrigin")+this.get("totalLength")/2+(this.get("w")-this.get("totalLength"))/2:this.get("xOrigin")+this.get("totalLength")-this.get("boxWidthHeight")+(this.get("w")-this.get("totalLength"))/2,y:4===this.get("quadrants")?this.get("yOrigin"):this.get("yOrigin")-this.get("totalLength")/2+this.get("boxWidthHeight"),outlineWidth:3,r:(this.get("w")-this.get("totalLength"))/3,arrowColor:Controller.COLORS.lightgrey,buttonColor:Controller.COLORS.darkgrey});this.set({undoButton:t}),Controller.CanvasControlModel.prototype.disableInput.call(this)},enableInput:function(){this.undoActivated()&&this.redrawUndoButton(),Controller.CanvasControlModel.prototype.enableInput.call(this)},isValid:function(){var t=this.get("shapeNum"),e=this.get("pointNum"),n=this.get("pointsArray");return 1===this.get("inputControl")?this.components.some(function(t){return"point"===t.get("class")}):!!this.components.some(function(t){return"point"===t.get("class")})&&(2===this.get("inputControl")?(0===e&&t--,n[t][0].shapeClosed):3===this.get("inputControl")?(0===e&&t--,!(n[t].length<2)):void 0)},isCorrect:function(t){if(1===this.get("inputControl")){for(var e=this.components.filter(function(t){return"point"===t.get("class")}),n=this.getData(t),r=0,i=0;r<n.length;r++)this.components.find(function(t){return t.get("xGrid")===n[r][0]&&t.get("yGrid")===n[r][1]})&&i++;return e.length===n.length&&i===n.length}if(this.get("inputControl")>=2){var n=this.getData(t),o=this.get("pointsArray"),s=[];if(n.length!==o.length)return!1;for(var a=0;a<o.length;a++){if(s[a]=[],o[a].length>2&&!o[a][0].shapeClosed)return!1;for(var l=0;l<o[a].length;l++)s[a][l]=[o[a][l].xGrid,o[a][l].yGrid]}for(var h,c,u,d,p,f,g,m=0,x=n.length;m<x;){c=[],u=[],d=!1,h=m;for(var r=0;r<s.length;r++)for(var y=0;y<s[r].length;y++)n[m][0][0]===s[r][y][0]&&n[m][0][1]===s[r][y][1]&&(c.push(r),u.push(y));if(0===c.length)return!1;for(var v=0;v<c.length;v++){if(p=!1,f=!1,d=!1,n[m].length!==s[c[v]].length&&(d=!0),d||0!==u[v]?d||u[v]!==s[c[v]].length-1?!d&&u[v]>0&&u[v]<s[c[v]].length-1&&(n[m][1][0]===s[c[v]][u[v]+1][0]&&n[m][1][1]===s[c[v]][u[v]+1][1]?p=!0:n[m][1][0]===s[c[v]][u[v]-1][0]&&n[m][1][1]===s[c[v]][u[v]-1][1]&&(f=!0)):n[m][1][0]===s[c[v]][u[v]-1][0]&&n[m][1][1]===s[c[v]][u[v]-1][1]?f=!0:n[m][1][0]===s[c[v]][0][0]&&n[m][1][1]===s[c[v]][0][1]&&(p=!0):n[m][1][0]===s[c[v]][u[v]+1][0]&&n[m][1][1]===s[c[v]][u[v]+1][1]?p=!0:n[m][1][0]===s[c[v]][s[c[v]].length-1][0]&&n[m][1][1]===s[c[v]][s[c[v]].length-1][1]&&(f=!0),p||f||(d=!0),p&&!d){g=u[v];for(var y=0;y<s[c[v]].length;y++)if(y>0&&(g+1<=s[c[v]].length-1?g+=1:g=0),n[m][y][0]!==s[c[v]][g][0]||n[m][y][1]!==s[c[v]][g][1]){d=!0;break}}else if(f&&!d){g=u[v];for(var y=0;y<s[c[v]].length;y++)if(y>0&&(g-1>=0?g-=1:g=s[c[v]].length-1),n[m][y][0]!==s[c[v]][g][0]||n[m][y][1]!==s[c[v]][g][1]){d=!0;break}}if(!d)break}if(d)return!1;s.splice(c[v],1,[]),m++}return!0}},getData:function(t){var e=this.get("answerIndex")||1;return t[e-1]},getInput:function(){var t=this.get("pointsArray"),e=[];if(1===this.get("inputControl")){for(var n=0;n<t.length;n++)e[n]=[t[n].xGrid,t[n].yGrid];return e}if(this.get("inputControl")>=2){for(var r=0;r<t.length;r++){e[r]=[];for(var n=0;n<t[r].length;n++)e[r][n]=[t[r][n].xGrid,t[r][n].yGrid],2===this.get("inputControl")&&n===t[r].length-1&&(t[r][0].shapeClosed||e[r].push("no"))}return e}},setInput:function(t){if(1===this.get("inputControl")){var e=[],t=this.getData(t);this.components.removeComponents(this.components.filter(function(t){return"point"===t.get("class")}),{silent:!0});for(var n=0;n<t.length;n++)e.push({type:"circle","class":"point",xGrid:t[n][0],yGrid:t[n][1],pointNum:n,x:this.getCanvasCoord(this.get("grid"),t[n][0]).x,y:this.getCanvasCoord(this.get("grid"),t[n][1]).y,r:this.get("pointRadius"),fillStyle:this.get("pointColor")});this.components.addComponents(e),this.set({pointsArray:e}),this.set({pointNum:n})}else if(this.get("inputControl")>=2){var r,t=this.getData(t),i=[],e=[],o=[],s=t.length,a=[];if(2===this.get("inputControl"))for(var l=0;l<t.length;l++)"no"===t[l][t[l].length-1]?(r=!1,t[l].splice(t[l].length-1,1)):r=!0;for(var n=0;n<s;n++)a[n]=t[n].length;this.components.removeComponents(this.components.filter(function(t){return"point"===t.get("class")||"connectingLine"===t.get("class")}),{silent:!0});for(var l=0;l<s;l++){e[l]=[];for(var h=0;h<a[l];h++)(2===this.get("inputControl")||3===this.get("inputControl")&&h<1)&&o.push({type:"line","class":"connectingLine",shapeNum:l,pointNum:h,xStart:this.getCanvasCoord(this.get("grid"),t[l][h][0]).x,yStart:this.getCanvasCoord(this.get("grid"),t[l][h][1]).y,xEnd:this.getCanvasCoord(this.get("grid"),t[l][h<a[l]-1?h+1:0][0]).x,yEnd:this.getCanvasCoord(this.get("grid"),t[l][h<a[l]-1?h+1:0][1]).y,strokeStyle:Controller.COLORS.charcoal,lineWidth:5},{type:"line","class":"connectingLine",shapeNum:l,pointNum:h,xStart:this.getCanvasCoord(this.get("grid"),t[l][h][0]).x,yStart:this.getCanvasCoord(this.get("grid"),t[l][h][1]).y,xEnd:this.getCanvasCoord(this.get("grid"),t[l][h<a[l]-1?h+1:0][0]).x,yEnd:this.getCanvasCoord(this.get("grid"),t[l][h<a[l]-1?h+1:0][1]).y,strokeStyle:this.get("shapeColors")[l%this.get("shapeColors").length],lineWidth:2}),i.push({type:"circle","class":"point",shapeNum:l,pointNum:h,xGrid:t[l][h][0],yGrid:t[l][h][1],x:this.getCanvasCoord(this.get("grid"),t[l][h][0]).x,y:this.getCanvasCoord(this.get("grid"),t[l][h][1]).y,r:this.get("pointRadius"),fillStyle:this.get("shapeColors")[l%this.get("shapeColors").length]}),2===this.get("inputControl")&&h===a[l]-1&&(i[i.length-1-h].shapeClosed=!0),e[l][h]=i[i.length-1]}2===this.get("inputControl")&&r===!1?(o.splice(o.length-2,2),i[i.length-t[s-1].length].shapeClosed=!1,e[s-1][0].shapeClosed=!1,l--):3===this.get("inputControl")&&e[s-1]&&1===e[s-1].length?l--:h=0,this.components.addComponents([o,i]),this.set({pointsArray:e}),this.set({shapeNum:l}),this.set({pointNum:h})}this.redrawUndoButton()},displayAnswer:function(t){this.setInput(t),this.displayResult(t)},displayResult:function(t){if(this.isValid())if(1===this.get("inputControl")){var e=this.getData(t),n=this.components.filter(function(t){return"point"===t.get("class")});n.forEach(function(t){var n=_.some(e,function(e){return t.get("xGrid")===e[0]&&t.get("yGrid")===e[1]});t.set({fillStyle:n?Controller.COLORS.correctColor:Controller.COLORS.incorrectColor})}),this.components.trigger("render")}else if(this.get("inputControl")>=2){for(var r=this.getData(t),i=this.get("pointsArray"),o=[],s=[],a=0;a<i.length;a++){s[a]=[],o[a]=[];for(var l=0;l<i[a].length;l++)s[a][l]={},o[a][l]=[i[a][l].xGrid,i[a][l].yGrid]}if(r.length>1){for(var h,c,u,d,p,f,g=0,m=[];g<o.length;)if(h=[],c=[],d=!1,p=!1,2!==this.get("inputControl")||i[g][0].shapeClosed){for(var x=0;x<r.length;x++)for(var y=0;y<r[x].length;y++)o[g][0][0]===r[x][y][0]&&o[g][0][1]===r[x][y][1]&&(h.push(x),c.push(y));if(0!==h.length){for(var v=0,C=!0;v<h.length&&C===!0;v++)if(d=!1,p=!1,r[h[v]].length===o[g].length)if(0===c[v]?o[g][1][0]===r[h[v]][c[v]+1][0]&&o[g][1][1]===r[h[v]][c[v]+1][1]?d=!0:o[g][1][0]===r[h[v]][r[h[v]].length-1][0]&&o[g][1][1]===r[h[v]][r[h[v]].length-1][1]&&(p=!0):c[v]===r[h[v]].length-1?o[g][1][0]===r[h[v]][c[v]-1][0]&&o[g][1][1]===r[h[v]][c[v]-1][1]?p=!0:o[g][1][0]===r[h[v]][0][0]&&o[g][1][1]===r[h[v]][0][1]&&(d=!0):c[v]>0&&c[v]<r[h[v]].length-1&&(o[g][1][0]===r[h[v]][c[v]+1][0]&&o[g][1][1]===r[h[v]][c[v]+1][1]?d=!0:o[g][1][0]===r[h[v]][c[v]-1][0]&&o[g][1][1]===r[h[v]][c[v]-1][1]&&(p=!0)),d||p){if(f=c[v],d)for(var y=0,u=!1;y<r[h[v]].length&&!u;y++)y>0&&(f+1<=r[h[v]].length-1?f+=1:f=0),o[g][y][0]===r[h[v]][f][0]&&o[g][y][1]===r[h[v]][f][1]||(m[g]=Controller.COLORS.darkred,u=!0);else if(p)for(var y=0,u=!1;y<r[h[v]].length&&!u;y++)y>0&&(f-1>=0?f-=1:f=r[h[v]].length-1),o[g][y][0]===r[h[v]][f][0]&&o[g][y][1]===r[h[v]][f][1]||(m[g]=Controller.COLORS.darkred,u=!0);if(u!==!0){m[g]=Controller.COLORS.darkgreen;break}}else m[g]=Controller.COLORS.darkred;else v===h.length-1&&(C=!1);C!==!1?g++:(m[g]=Controller.COLORS.darkred,g++)}else m[g]=Controller.COLORS.darkred,g++}else m[g]=Controller.COLORS.darkred,g++;for(var w=[],b=[],M=[],S=[],x=0;x<o.length;x++){w=[],b=[],M=[],S=[],w=this.components.filter(function(t){return"point"===t.get("class")&&t.get("shapeNum")===x}),b=this.components.filter(function(t){return"connectingLine"===t.get("class")&&t.get("shapeNum")===x});for(var E,y=0;y<b.length;y++)E=b[y],S.push({type:"line","class":"connectingLine",shapeNum:E.attributes.shapeNum,pointNum:E.attributes.pointNum,xStart:E.attributes.xStart,yStart:E.attributes.yStart,xEnd:E.attributes.xEnd,yEnd:E.attributes.yEnd,strokeStyle:Controller.COLORS.charcoal,lineWidth:5},{type:"line","class":"connectingLine",shapeNum:E.attributes.shapeNum,pointNum:E.attributes.pointNum,xStart:E.attributes.xStart,yStart:E.attributes.yStart,xEnd:E.attributes.xEnd,yEnd:E.attributes.yEnd,strokeStyle:m[x],lineWidth:2});for(var I,y=0;y<w.length;y++)I=w[y],M.push({type:"circle","class":"point",shapeNum:I.attributes.shapeNum,pointNum:I.attributes.pointNum,xGrid:I.attributes.xGrid,yGrid:I.attributes.yGrid,x:I.attributes.x,y:I.attributes.y,r:I.attributes.r,fillStyle:m[x]});this.components.removeComponents([w,b]),this.components.addComponents([S,M])}}else if(1===r.length){for(var N,O,T,P,A,k=[],R=[],z=[],B=[],L=0;L<o[0].length;L++){N=o[0][L][0],O=o[0][L][1],T=L<o[0].length-1?o[0][L+1][0]:o[0][0][0],P=L<o[0].length-1?o[0][L+1][1]:o[0][0][1],A=(P-O)/(T-N),B[L]={xStart:N,yStart:O,xEnd:T,yEnd:P,slope:Math.abs(A)};for(var D=0;D<r[0].length;D++)0===L&&(N=r[0][D][0],O=r[0][D][1],T=D<r[0].length-1?r[0][D+1][0]:r[0][0][0],P=D<r[0].length-1?r[0][D+1][1]:r[0][0][1],A=(P-O)/(T-N),z[D]={xStart:N,yStart:O,xEnd:T,yEnd:P,slope:Math.abs(A)}),B[L].xStart===z[D].xStart&&B[L].yStart===z[D].yStart&&(k[L]=Controller.COLORS.darkgreen),(B[L].xStart===z[D].xStart&&B[L].yStart===z[D].yStart&&B[L].xEnd===z[D].xEnd&&B[L].yEnd===z[D].yEnd&&B[L].slope===z[D].slope||B[L].xStart===z[D].xEnd&&B[L].yStart===z[D].yEnd&&B[L].xEnd===z[D].xStart&&B[L].yEnd===z[D].yStart&&B[L].slope===z[D].slope)&&(R[L]=Controller.COLORS.darkgreen);"undefined"==typeof k[L]&&(k[L]=Controller.COLORS.darkred),"undefined"==typeof R[L]&&(R[L]=Controller.COLORS.darkred)}for(var w=[],b=[],M=[],S=[],W=0;W<o[0].length;W++)w[W]=this.components.find(function(t){return"point"===t.get("class")&&t.get("pointNum")===W}),b[W]=this.components.filter(function(t){return"connectingLine"===t.get("class")&&t.get("pointNum")===W});for(var x=0;x<b.length;x++)b[x][0]&&S.push({type:"line","class":"connectingLine",shapeNum:b[x][0].attributes.shapeNum,pointNum:b[x][0].attributes.pointNum,xStart:b[x][0].attributes.xStart,yStart:b[x][0].attributes.yStart,xEnd:b[x][0].attributes.xEnd,yEnd:b[x][0].attributes.yEnd,strokeStyle:Controller.COLORS.charcoal,lineWidth:5},{type:"line","class":"connectingLine",shapeNum:b[x][0].attributes.shapeNum,pointNum:b[x][0].attributes.pointNum,xStart:b[x][0].attributes.xStart,yStart:b[x][0].attributes.yStart,xEnd:b[x][0].attributes.xEnd,yEnd:b[x][0].attributes.yEnd,strokeStyle:R[x],lineWidth:2});for(var y=0;y<w.length;y++)M.push({type:"circle","class":"point",shapeNum:w[y].attributes.shapeNum,pointNum:w[y].attributes.pointNum,xGrid:w[y].attributes.xGrid,yGrid:w[y].attributes.yGrid,x:w[y].attributes.x,y:w[y].attributes.y,r:w[y].attributes.r,fillStyle:k[y]});this.components.removeComponents([w,b]),this.components.addComponents([S,M])}}},undoActivated:function(){return this.components.find(function(t){return"point"===t.get("class")})},redrawUndoButton:function(){this.components.remove(this.components.find(function(t){return"undo"===t.get("class")}));var t=this.components.add({type:"undo_button","class":"undo",x:4===this.get("quadrants")?this.get("xOrigin")+this.get("totalLength")/2+(this.get("w")-this.get("totalLength"))/2:this.get("xOrigin")+this.get("totalLength")-this.get("boxWidthHeight")+(this.get("w")-this.get("totalLength"))/2,y:4===this.get("quadrants")?this.get("yOrigin"):this.get("yOrigin")-this.get("totalLength")/2+this.get("boxWidthHeight"),outlineWidth:3,r:(this.get("w")-this.get("totalLength"))/3,arrowColor:this.undoActivated()?Controller.COLORS.white:Controller.COLORS.lightgrey,buttonColor:this.undoActivated()?Controller.COLORS.teal:Controller.COLORS.darkgrey});this.set({undoButton:t})}}),Controller.CoordinatePlaneView=Controller.CanvasControlView.extend({initialize:function(t){this.model.isInputControl()&&(this.canvasEvents={click:"buttonClick"}),Controller.CanvasControlView.prototype.initialize.apply(this,t)}}),Controller.BarGraphModel=function(){"use strict";return Controller.CanvasControlModel.extend({parse:function(t){var e=t.value;if(e){if(e=e.replace(/([^,\]\[]+)/g,function(t){return t=t.trim(),"''"===t.replace(/ /g,"")?'""':(t=t.substring(t.startsWith("'")?1:0,t.endsWith("'")?t.length-1:t.length),isNaN(t)&&"true"!==t&&"false"!==t?'"'+t+'"':t)}),e=JSON.parse("["+e+"]"),t.title=e[0]||"",t.xLabel=e[1]||"",t.yLabel=e[2]||"",t.min=new Controller.Math.RationalNumber(e[3]||0),t.max=new Controller.Math.RationalNumber(e[4]||10),t.major=new Controller.Math.RationalNumber(e[5]||1),t.minor=new Controller.Math.RationalNumber(e[6]||t.major),t.max.isLEQ(t.min))throw"min cannot be greater than or equal to max.";if(t.major.divide(t.minor).toFloat()%1!==0)throw"major must be divisible by minor.";t.bars=e[7]||[],t.showBarValue=e[8]||!1,t.bars.forEach(function(e){if(t.min.isGreaterThan(e[1])||t.max.isLessThan(e[1]))throw"The bar "+e[0]+" is not within the minimum and maximum bounds."})}return Controller.CanvasControlModel.prototype.parse.call(this,t)},defaults:{labelFont:"Roboto",titleSize:20,axisLabelSize:16,majorTextSize:10,barLabelSize:11,textColor:Controller.COLORS.white,textStroke:Controller.COLORS.charcoal,boxColor:Controller.COLORS.lightblue,graphColor:Controller.COLORS.white,minorStroke:Controller.COLORS.lightgrey,majorStroke:Controller.COLORS.darkgrey,barColors:[Controller.COLORS.purple,Controller.COLORS.darkyellow,Controller.COLORS.green,Controller.COLORS.red,Controller.COLORS.darkblue,Controller.COLORS.orange,Controller.COLORS.brown,Controller.COLORS.navy,Controller.COLORS.grey],staticBarColor:Controller.COLORS.navy,selectedColor:Controller.COLORS.orange,correctColor:Controller.COLORS.correctColor,incorrectColor:Controller.COLORS.incorrectColor,fillerColor:Controller.COLORS.grey,inputControl:0,answerIndex:1},setup:function(){var t=this.get("min"),e=this.get("max"),n=this.get("major"),r=this.get("minor"),i=t.toFloat()>0,t=i?t.subtract(n):t,o=Math.ceil(e.subtract(t).divide(n).toFloat()),s=n.multiply(o);e=t.add(s);for(var a=[],l=0;l<=o;l++)a.push(t.add(n.multiply(l)));var h=7*_.maxBy(a.map(function(t){return t.toFloat().toString().length}))/12*this.get("majorTextSize"),c=15,u=20,d=c+h;_.isEmpty(this.get("yLabel"))||(d+=c+this.get("axisLabelSize")/2);var p=c;_.isEmpty(this.get("title"))||(p+=this.get("axisLabelSize")+this.get("titleSize")),this.components.add({type:"rectangle",x:0,y:0,w:this.get("w"),h:this.get("h"),fillStyle:this.get("boxColor"),lineWidth:2});var f=this.get("w")-d-u,g=this.get("bars"),m=f/(10*g.length+g.length+1),x=10*m,y=this.components.add({type:"text_wrap",x:d+m+x/2,textSize:this.get("barLabelSize")+"px",textFont:this.get("labelFont"),textBaseline:"top",textArray:_.map(g,0),w:x,offset:m+x,exact:!1}),v=y.getHeight(),C=this.get("h")-p-c-v;_.isEmpty(this.get("xLabel"))||(C-=+this.get("majorTextSize")),y.set({y:p+C}),this.components.add({type:"text",x:this.get("w")/2,y:p/2,text:this.get("title"),textSize:this.get("titleSize")+"px",textFont:this.get("labelFont")}),this.components.add({type:"text",x:d-u-h,y:p+C/2,text:this.get("yLabel"),textSize:this.get("axisLabelSize")+"px",angle:-Math.PI/2,textFont:this.get("labelFont")}),this.components.add({type:"text",x:d+f/2,y:p+C+c+v,text:this.get("xLabel"),textSize:this.get("axisLabelSize")+"px",textFont:this.get("labelFont")}),this.components.add({type:"rectangle",x:d,y:p,w:f,h:C,fillStyle:this.get("graphColor"),lineWidth:0});var w=this.components.add({type:"grid",x:d,y:p,w:f,h:C,numRows:s.divide(r).toFloat(),numColumns:1,strokeStyle:this.get("minorStroke"),lineWidth:1,displayBorder:!1,xMin:t,yMin:t,xIncrement:r,yIncrement:r});this.components.add({type:"grid",x:d,y:p,w:f,h:C,numRows:o,numColumns:1,strokeStyle:this.get("majorStroke"),lineWidth:1,displayBorder:!1}),this.components.add({x:d,y:p,w:f,h:C,type:"rectangle",fillStyle:"",lineWidth:1});var b=C/s.toFloat();a.forEach(function(t,e){0===e&&i===!0?(this.components.add({type:"axis_break",x:d,y:p+C,axis:"y"}),this.components.add({type:"text",x:d-5,y:p+C,text:0,textSize:this.get("majorTextSize")+"px",textAlign:"right"})):this.components.add({type:"text",x:d-5,y:p+C-n.multiply(e*b).toFloat(),text:t.toFloat(),textSize:this.get("majorTextSize")+"px",textAlign:"right",decimalPlaces:3})}.bind(this));var M=0;g.forEach(function(e,n){if("_"!==e[1]){var r=w.getInputCanvasCoord(0,e[1]).y;if(this.components.add({type:"rectangle",x:d+n*x+(n+1)*m,y:p+C-1,w:x,h:Math.min(r-p-C+2,1),lineWidth:1,fillStyle:1===this.get("inputControl")?this.get("staticBarColor"):this.get("barColors")[n%this.get("barColors").length]}),this.get("showBarValue")){var o=new Controller.Math.RationalNumber(e[1]);this.components.add({type:"text",x:d+n*x+(n+1)*m+x/2,y:r,text:o.toFloat(),textBaseline:"bottom",textSize:this.get("barLabelSize")+"px",textColor:this.get("textColor"),strokeStyle:this.get("textStroke"),lineWidth:2,decimalPlaces:3})}}else if(1===this.get("inputControl")){this.components.add({type:"rectangle",x:d+n*x+(n+1)*m,y:p,w:x,h:C,lineWidth:1,fillStyle:this.get("fillerColor"),opacity:.4,barIndex:M,"class":"fillerBar"});var o=i?new Controller.Math.RationalNumber(0):new Controller.Math.RationalNumber(t);this.components.add({type:"rectangle",x:d+n*x+(n+1)*m,y:p+C-1,w:x,h:1,barValue:o,lineWidth:1,fillStyle:this.get("selectedColor"),"class":"manipulativeBar",barIndex:M}),this.get("showBarValue")&&this.components.add({type:"text",x:d+n*x+(n+1)*m+x/2,y:p+C,text:o.toFloat(),textBaseline:"bottom",textSize:this.get("barLabelSize")+"px",textColor:this.get("textColor"),strokeStyle:this.get("textStroke"),lineWidth:2,barIndex:M,decimalPlaces:3}),M++}}.bind(this)),1===this.get("inputControl")&&this.set({minorGrid:w,min:t,max:e,axisBreak:i})},selectBarValue:function(t,e){var n=this.components.getNearestComponent(t,e,function(t){return"fillerBar"===t.get("class")}),r=this.get("minorGrid"),i=r.getIntersectingGraphCoord(t,e).y,o=r.getIntersectingCanvasCoord(t,e).y,s=i.isGEQ(this.get("min"))&&i.isLEQ(this.get("max")),a=!this.get("axisBreak")||i.isEqual(this.get("min"))||i.isGEQ(this.get("min").add(this.get("major"))),l=Math.abs(o-e)<=30;if(n&&s&&a&&l){var h=this.components.find(function(t){return"manipulativeBar"===t.get("class")&&t.get("barIndex")===n.get("barIndex")});if(this.get("axisBreak")&&i.isEqual(this.get("min"))&&(i=new Controller.Math.RationalNumber(0)),!h.get("barValue").isEqual(i)){if(h.set({h:Math.min(o-h.get("y")+1,1),fillStyle:this.get("selectedColor"),barValue:i}),this.get("showBarValue")){var c=this.components.find(function(t){return"text"===t.get("type")&&t.get("barIndex")===h.get("barIndex")});c.set({y:o,text:i.toFloat(),strokeStyle:this.get("textStroke")})}this.components.trigger("render")}}},isValid:function(){return this.components.some(function(t){return"manipulativeBar"===t.get("class")&&!t.get("barValue").isEqual(0)})},isCorrect:function(t){var e=t[this.get("answerIndex")-1],n=this.components.filter(function(t){return"manipulativeBar"===t.get("class")});return e.length===n.length&&_.every(n,function(t){return t.get("barValue").isEqual(e[t.get("barIndex")])})},getInput:function(){var t=this.components.filter(function(t){return"manipulativeBar"===t.get("class")}),e=[];return t.forEach(function(t){e[t.get("barIndex")]=t.get("barValue").toString()}),e},setInput:function(t){var e=t[this.get("answerIndex")-1],n=this.components.filter(function(t){return"manipulativeBar"===t.get("class")}),r=this.get("minorGrid");n.forEach(function(t){var n=new Controller.Math.RationalNumber(e[t.get("barIndex")]);if(t.set({fillStyle:this.get("selectedColor")}),!t.get("barValue").isEqual(n)){var i=r.getInputCanvasCoord(n,n).y;if(t.set({h:Math.min(i-t.get("y")+1,1),barValue:n}),this.get("showBarValue")===!0){var o=this.components.find(function(e){return"text"===e.get("type")&&e.get("barIndex")===t.get("barIndex")});o.set({y:Math.min(i,t.get("y")+1),text:n.toFloat(),strokeStyle:this.get("textStroke")})}}}.bind(this)),this.components.trigger("render")},displayAnswer:function(t){this.setInput(t),this.displayResult(t)},displayResult:function(t){var e=t[this.get("answerIndex")-1],n=this.components.filter(function(t){return"manipulativeBar"===t.get("class")});n.forEach(function(t){var n=t.get("barValue").isEqual(e[t.get("barIndex")]);if(t.set({fillStyle:n?this.get("correctColor"):this.get("incorrectColor")}),this.get("showBarValue")){var r=this.components.find(function(e){return"text"===e.get("type")&&e.get("barIndex")===t.get("barIndex")});r.set({strokeStyle:n?this.get("correctColor"):this.get("incorrectColor")})}}.bind(this)),this.components.trigger("render")},disableInput:function(){this.components.filter(function(t){return"fillerBar"===t.get("class")}).forEach(function(t){t.set({opacity:0})}),this.components.trigger("render"),Controller.CanvasControlModel.prototype.disableInput.call(this)},enableInput:function(){this.components.filter(function(t){return"fillerBar"===t.get("class")}).forEach(function(t){t.set({opacity:.4})}),this.components.trigger("render"),Controller.CanvasControlModel.prototype.enableInput.call(this)}})}(),Controller.BarGraphView=Controller.CanvasControlView.extend({initialize:function(t){this.model.isInputControl()&&(this.canvasEvents={mouseup:"selectBarValue"}),Controller.CanvasControlView.prototype.initialize.apply(this,t)}}),Controller.ScatterPlotModel=function(){"use strict";return Controller.CanvasControlModel.extend({parse:function(t){var e=t.value;if(e){if(e=e.replace(/([^,\]\[]+)/g,function(t){return t=t.trim(),"''"===t.replace(/ /g,"")?'""':(t=t.substring(t.startsWith("'")?1:0,t.endsWith("'")?t.length-1:t.length),isNaN(t)&&"true"!==t&&"false"!==t?'"'+t+'"':t)}),e=JSON.parse("["+e+"]"),t.title=e[0]||"",t.xLabel=e[1]||"",t.xMin=new Controller.Math.RationalNumber(e[2]||0),
t.xMax=new Controller.Math.RationalNumber(e[3]||10),t.xMajor=new Controller.Math.RationalNumber(e[4]||1),t.xMinor=new Controller.Math.RationalNumber(e[5]||t.xMajor),t.yLabel=e[6]||"",t.yMin=new Controller.Math.RationalNumber(e[7]||0),t.yMax=new Controller.Math.RationalNumber(e[8]||10),t.yMajor=new Controller.Math.RationalNumber(e[9]||1),t.yMinor=new Controller.Math.RationalNumber(e[10]||t.yMajor),t.xMax.toFloat()<=t.xMin.toFloat()||t.yMax.toFloat()<=t.yMin.toFloat())throw"xMin cannot be greater than or equal to xMax, and yMin cannot be greater than or equal to yMax.";if(t.xMajor.divide(t.xMinor).toFloat()%1!==0||t.yMajor.divide(t.yMinor).toFloat()%1!==0)throw"xMajor must be divisible by xMinor, and yMajor must be divisible by yMinor.";t.points=e[11]||[],t.trendlines=e[12]||[],t.points.forEach(function(e){if(t.xMin.isGreaterThan(e[0])||t.xMax.isLessThan(e[0])||t.yMin.isGreaterThan(e[1])||t.yMax.isLessThan(e[1]))throw"The point ("+e[0]+","+e[1]+") is not within the minimum and maximum bounds."}),t.trendlines.forEach(function(e){if(t.xMin.isGreaterThan(e[0][0])||t.xMax.isLessThan(e[0][0])||t.yMin.isGreaterThan(e[0][1])||t.yMax.isLessThan(e[0][1])||t.xMin.isGreaterThan(e[1][0])||t.xMax.isLessThan(e[1][0])||t.yMin.isGreaterThan(e[1][1])||t.yMax.isLessThan(e[1][1]))throw"The trendline ("+e[0][0]+","+e[0][1]+") to ("+e[1][0]+","+e[1][1]+") is not within the minimum and maximum bounds."})}return Controller.CanvasControlModel.prototype.parse.call(this,t)},defaults:{labelFont:"Roboto",titleSize:20,axisLabelSize:16,majorTextSize:10,boxColor:Controller.COLORS.lightblue,graphColor:Controller.COLORS.white,minorStroke:Controller.COLORS.lightgrey,majorStroke:Controller.COLORS.darkgrey,pointColor:Controller.COLORS.navy,trendlineColors:[Controller.COLORS.black,Controller.COLORS.lightbrown,Controller.COLORS.darkpurple,Controller.COLORS.darkteal],selectedColor:Controller.COLORS.darkorange,correctColor:Controller.COLORS.darkgreen,incorrectColor:Controller.COLORS.darkred,inputControl:0,answerIndex:1},setup:function(){var t=this.get("xMin"),e=this.get("xMax"),n=this.get("xMajor"),r=this.get("xMinor"),i=this.get("yMin"),o=this.get("yMax"),s=this.get("yMajor"),a=this.get("yMinor"),l=t.toFloat()>0,h=i.toFloat()>0,t=l?t.subtract(n):t,i=h?i.subtract(s):i,c=Math.ceil(e.subtract(t).divide(n).toFloat()),u=Math.ceil(o.subtract(i).divide(s).toFloat()),d=n.multiply(c),p=s.multiply(u);e=t.add(d),o=t.add(p);for(var f=[],g=[],m=0;m<=c;m++)f.push(t.add(n.multiply(m)));for(var m=0;m<=u;m++)g.push(i.add(s.multiply(m)));var x=7*_.maxBy(g.map(function(t){return t.toFloat().toString().length}))/12*this.get("majorTextSize"),y=15,v=20,C=y+x;_.isEmpty(this.get("yLabel"))||(C+=y+this.get("axisLabelSize")/2);var w=y;_.isEmpty(this.get("title"))||(w+=this.get("axisLabelSize")+this.get("titleSize"));var b=this.get("w")-C-v,M=this.get("h")-w-y;_.isEmpty(this.get("xLabel"))||(M-=this.get("axisLabelSize")+this.get("majorTextSize")),this.components.add({type:"rectangle",x:0,y:0,w:this.get("w"),h:this.get("h"),fillStyle:this.get("boxColor"),lineWidth:2}),this.components.add({type:"rectangle",x:C,y:w,w:b,h:M,fillStyle:this.get("graphColor"),lineWidth:0}),this.components.add({type:"text",x:this.get("w")/2,y:w/2,text:this.get("title"),textSize:this.get("titleSize")+"px",textFont:this.get("labelFont")}),this.components.add({type:"text",x:C-v-x,y:w+M/2,text:this.get("yLabel"),textSize:this.get("axisLabelSize")+"px",angle:-Math.PI/2,textFont:this.get("labelFont")}),this.components.add({type:"text",x:C+b/2,y:w+M+this.get("axisLabelSize")+this.get("majorTextSize"),text:this.get("xLabel"),textSize:this.get("axisLabelSize")+"px",textFont:this.get("labelFont")});var S=this.components.add({type:"grid",x:C,y:w,w:b,h:M,numRows:p.divide(a).toFloat(),numColumns:d.divide(r).toFloat(),strokeStyle:this.get("minorStroke"),lineWidth:1,displayBorder:!1,xMin:t,yMin:i,xIncrement:r,yIncrement:a});this.components.add({type:"grid",x:C,y:w,w:b,h:M,numRows:u,numColumns:c,strokeStyle:this.get("majorStroke"),lineWidth:1,displayBorder:!1}),this.components.add({x:C,y:w,w:b,h:M,type:"rectangle",fillStyle:"",lineWidth:1});var E=b/d.toFloat(),I=M/p.toFloat();f.forEach(function(t,e){0===e&&l===!0?(this.components.add({type:"axis_break",x:C,y:w+M,axis:"x"}),this.components.add({type:"text",x:C+n.multiply(e*E).toFloat(),y:w+7+M,text:0,textSize:this.get("majorTextSize")+"px"})):this.components.add({type:"text",x:C+n.multiply(e*E).toFloat(),y:w+7+M,text:t.toFloat(),textSize:this.get("majorTextSize")+"px"})}.bind(this)),g.forEach(function(t,e){0===e&&h===!0?(this.components.add({type:"axis_break",x:C,y:w+M,axis:"y"}),this.components.add({type:"text",x:C-5,y:w+M-s.multiply(e*I).toFloat()*I,text:0,textSize:this.get("majorTextSize")+"px",textAlign:"right"})):this.components.add({type:"text",x:C-5,y:w+M-s.multiply(e*I).toFloat(),text:t.toFloat(),textSize:this.get("majorTextSize")+"px",textAlign:"right"})}.bind(this));var N=this.get("trendlines"),O=this.get("points");N.forEach(function(t,e){var n=S.getInputCanvasCoord(t[0][0],t[0][1]),r=S.getInputCanvasCoord(t[1][0],t[1][1]);this.components.add({type:"line",xStart:n.x,yStart:n.y,xEnd:r.x,yEnd:r.y,lineWidth:2,strokeStyle:this.get("trendlineColors")[e%this.get("trendlineColors").length]})}.bind(this)),O.forEach(function(t){var e=S.getInputCanvasCoord(t[0],t[1]);this.components.add({type:"circle",x:e.x,y:e.y,r:4,fillStyle:this.get("pointColor"),lineWidth:1})}.bind(this)),1===this.get("inputControl")&&this.set({minorGrid:S})},addOrRemovePoint:function(t,e){var n=this.get("minorGrid"),r=n.getIntersectingCanvasCoord(t,e),i=n.getIntersectingGraphCoord(t,e),o=i.x.isGEQ(this.get("xMin"))&&i.y.isGEQ(this.get("yMin")),s=Controller.Math.euclideanDistance(t,e,r.x,r.y),a=this.components.getNearestComponent(t,e,function(t){return"manipulativePoint"===t.get("class")&&t.get("xCoordinate").isEqual(i.x)&&t.get("yCoordinate").isEqual(i.y)});a?this.components.remove(a):s<=30&&o&&this.components.add({type:"circle",x:r.x,y:r.y,r:4,fillStyle:this.get("selectedColor"),"class":"manipulativePoint",xCoordinate:i.x,yCoordinate:i.y,lineWidth:1})},isValid:function(){return this.components.some(function(t){return"manipulativePoint"===t.get("class")})},isCorrect:function(t){var e=t[this.get("answerIndex")-1],n=this.components.filter(function(t){return"manipulativePoint"===t.get("class")});return e.length===n.length&&_.every(n,function(t){return _.some(e,function(e){return t.get("xCoordinate").isEqual(e[0])&&t.get("yCoordinate").isEqual(e[1])})})},getInput:function(){var t=this.components.filter(function(t){return"manipulativePoint"===t.get("class")});return t.map(function(t){return[t.get("xCoordinate").toString(),t.get("yCoordinate").toString()]})},setInput:function(t){for(var e=t[this.get("answerIndex")-1],n=this.get("minorGrid"),r=[],i=0;i<e.length;i++){var o=new Controller.Math.RationalNumber(e[i][0]),s=new Controller.Math.RationalNumber(e[i][1]),a=n.getInputCanvasCoord(e[i][0],e[i][1]);r.push({type:"circle",x:a.x,y:a.y,xCoordinate:o,yCoordinate:s,r:4,fillStyle:this.get("selectedColor"),"class":"manipulativePoint",lineWidth:1})}this.components.removeComponents(this.components.filter(function(t){return"manipulativePoint"===t.get("class")}),{silent:!0}),this.components.addComponents(r)},displayAnswer:function(t){this.setInput(t),this.displayResult(t)},displayResult:function(t){var e,n=t[this.get("answerIndex")-1],r=this.components.filter(function(t){return"manipulativePoint"===t.get("class")});_.each(r,function(t){e=_.some(n,function(e){return t.get("xCoordinate").isEqual(e[0])&&t.get("yCoordinate").isEqual(e[1])}),t.set({fillStyle:e?this.get("correctColor"):this.get("incorrectColor")})}.bind(this)),this.components.trigger("render")}})}(),Controller.ScatterPlotView=Controller.CanvasControlView.extend({initialize:function(t){this.model.isInputControl()&&(this.canvasEvents={mouseup:"addOrRemovePoint"}),Controller.CanvasControlView.prototype.initialize.apply(this,t)}}),Controller.OrderedCountersModel=function(){"use strict";return Controller.CanvasControlModel.extend({parse:function(t){var e=t.value.replace(/\+/g,"").replace(/([^,\]\[]+)/g,function(t){return t=t.trim(),"''"===t?'""':(t=t.substring(t.startsWith("'")?1:0,t.endsWith("'")?t.length-1:t.length),isNaN(t)&&"true"!==t&&"false"!==t?'"'+t+'"':t)});return t.countersSets=JSON.parse("["+e+"]"),Controller.CanvasControlModel.prototype.parse.call(this,t)},defaults:{counterDiameter:Controller.CanvasCounterModel.prototype.defaults.w,counterPadding:5,setPadding:25,assignedColors:{green:"lightgreen",orange:"lightorange",red:"lightred",pink:"lightpink"}},setup:function(){var t=this.get("countersSets"),e=this.get("counterDiameter"),n=this.get("counterPadding"),r=this.get("setPadding"),i=Controller.CanvasCounterModel.prototype.defaults.lineWidth,o=0;t.forEach(function(t){for(var i=[],s=t[t.length-1],a=0;a<t.length-1;a++){var l=t[a].split(" ")[1];this.get("assignedColors")[l]&&(l=this.get("assignedColors")[l]);for(var h=0;h<parseInt(t[a]);h++)i.push(l)}for(var a=0;a<i.length;a++)"blank"!==i[a]&&this.components.add({type:"counter",x:(n+e)*Math.floor(a/s),y:o+(n+e)*(a%s),fillStyle:Controller.COLORS[i[a]]});o+=r+s*e+(s-1)*n}.bind(this));var s=_.maxBy(this.components.models,function(t){return t.get("x")||0}).get("x"),a=_.maxBy(this.components.models,function(t){return t.get("y")||0}).get("y"),l=(this.get("w")-s-e)/2,h=(this.get("h")-a-e)/2;if(l-i<0||h-i<0)throw"The counters are cut off by the window. Increase the window size or readjust the string.";this.components.each(function(t){t.set({x:t.get("x")+l,y:t.get("y")+h})})}})}(),Controller.OrderedCountersView=Controller.CanvasControlView.extend({initialize:function(t){Controller.CanvasControlView.prototype.initialize.apply(this,t)}}),Controller.UnorderedCountersModel=function(){"use strict";return Controller.CanvasControlModel.extend({parse:function(t){var e=t.value.replace(/\+/g,"").replace(/([^,\]\[]+)/g,function(t){return t=t.trim(),"''"===t?'""':(t=t.substring(t.startsWith("'")?1:0,t.endsWith("'")?t.length-1:t.length),isNaN(t)&&"true"!==t&&"false"!==t?'"'+t+'"':t)});return t.countersSet=JSON.parse("["+e+"]"),Controller.CanvasControlModel.prototype.parse.call(this,t)},defaults:{counterDiameter:Controller.CanvasCounterModel.prototype.defaults.w,xCounterPadding:25,yCounterPadding:25,assignedColors:{green:"lightgreen",orange:"lightorange",red:"lightred",pink:"lightpink"}},setup:function(){var t=this.get("countersSet"),e=this.get("counterDiameter"),n=this.get("xCounterPadding"),r=this.get("yCounterPadding"),i=Math.floor(this.get("h")/(e+r)),o=Math.floor(this.get("w")/(e+n)),s=this.components.add({type:"grid",x:0,y:0,w:this.get("w"),h:this.get("h"),numRows:i,numColumns:o,lineWidth:0,displayBorder:!1});this.get("w")%(e+n)!==0&&(n=this.get("w")/o-e),this.get("h")%(e+r)!==0&&(r=this.get("h")/i-e);for(var a=[],l=0;l<t.length;l++){var h=t[l].split(" ")[1];this.get("assignedColors")[h]&&(h=this.get("assignedColors")[h]);for(var c=0;c<parseInt(t[l]);c++)a.push(h)}var u=_.shuffle(_.range(1,i*o+1));if(a.length>i*o)throw"Insufficient space to display "+a.length+" counters.";for(var l=0;l<a.length;l++){var d=u[l],p=s.getInputCellCanvasCoord(d);"blank"!==a[l]&&this.components.add({type:"counter",x:p.x+Math.random()*(n-2)+1,y:p.y+Math.random()*(r-2)+1,rowIndex:Math.floor((d-1)/o),fillStyle:Controller.COLORS[a[l]]})}for(var l=0;l<i;l++){var f=this.components.filter(function(t){return t.get("rowIndex")===l});if(f.length>0){var g=_.minBy(f,function(t){return t.get("x")||0}).get("x"),m=this.get("w")-_.maxBy(f,function(t){return t.get("x")||0}).get("x")-e,x=Math.random()*(g-1),y=Math.random()*(m-1);0===Math.round(Math.random())?f.forEach(function(t){t.set({x:t.get("x")-x})}):f.forEach(function(t){t.set({x:t.get("x")+y})})}}}})}(),Controller.UnorderedCountersView=Controller.CanvasControlView.extend({initialize:function(t){Controller.CanvasControlView.prototype.initialize.apply(this,t)}}),Controller.ManipulativeBaseBlocksContainerModel=function(){"use strict";return Controller.CanvasControlModel.extend({parse:function(t){var e=t.value;return e&&(e=e.replace(/([^,\]\[]+)/g,function(t){return t=t.trim(),"''"===t.replace(/ /g,"")?'""':(t=t.substring(t.startsWith("'")?1:0,t.endsWith("'")?t.length-1:t.length),isNaN(t)&&"true"!==t&&"false"!==t?'"'+t+'"':t)}),e=JSON.parse("["+e+"]"),t.numHundreds=e[0]||0,t.numTens=e[1]||0,t.numOnes=e[2]||0,t.counter=e[3]||!1),Controller.CanvasControlModel.prototype.parse.call(this,t)},defaults:{staticColor:Controller.COLORS.lightorange,manipulativeColor:Controller.COLORS.blue,bgColor:Controller.COLORS.white,containerBorderColor:Controller.COLORS.charcoal,paddingSameElement:8,paddingDiffElement:16,xPadding:10,yPadding:10,containerBorderWidth:5,staticToManipulativePadding:50,correctColor:Controller.COLORS.correctColor,incorrectColor:Controller.COLORS.incorrectColor,inputControl:0,answerIndex:1},setup:function(){var t=this.components.add({type:"rectangle",x:0,y:0,w:this.get("w"),h:this.get("h"),fillStyle:this.get("bgColor"),lineWidth:this.get("containerBorderWidth"),zIndex:-1}),e=this.get("xPadding"),n=this.get("yPadding"),r=this.get("numHundreds"),i=this.get("numTens"),o=this.get("numOnes"),s=this.getBaseBlockComponents(r,i,o,"static",e,n);if(s.length>0){var a=_.maxBy(s,function(t){return t.x+t.w}),l=a.x+a.w;if(l>this.get("w")-this.get("containerBorderWidth"))throw"The static base blocks are "+(l-this.get("w")+this.get("containerBorderWidth"))+" pixels too wide.";e=l+this.get("staticToManipulativePadding"),this.set({xPadding:e}),this.components.addComponents(s)}if(this.get("inputControl")){var h=this.get("answers")[this.get("answerIndex")-1]||[],c=this.getBaseBlockComponents(h[0],h[1],h[2],"manipulative",e,n);if(c.length>0){var a=_.maxBy(c,function(t){return t.x+t.w}),l=a.x+a.w;if(l>this.get("w")-this.get("containerBorderWidth"))throw"The base blocks from the expected answer are "+(l-this.get("w")+this.get("containerBorderWidth"))+" pixels too wide."}}this.set({container:t})},getBaseBlockComponents:function(t,e,n,r,i,o){for(var s="static"===r?this.get("staticColor"):this.get("manipulativeColor"),a=Controller.ManipulativeDraggableBaseBlockModel.prototype.defaults.hundredsBlockWidthHeight,l=Controller.ManipulativeDraggableBaseBlockModel.prototype.defaults.tensBlockWidthHeight,h=Controller.ManipulativeDraggableBaseBlockModel.prototype.defaults.onesBlockWidthHeight,c=this.get("paddingSameElement"),u=this.get("paddingDiffElement"),d=[],p=0;p<t;p++){var f=(10*a+c)*Math.floor(p/3),g=(10*a+c)*(p%3);d.push({type:"grid",x:i+f,y:o+g,w:10*a,h:10*a,numRows:10,numColumns:10,displayBorder:!0,fillStyle:s,kind:r,value:100,index:0})}t&&(i+=f+10*a+u);for(var p=0,m=[];p<e;p++){var f=(5*l+6*c)*Math.floor(p/15)+(l+c)*(p%5),g=(10*l+c)*Math.floor(p/5%3);m.push(f),d.push({type:"grid",x:i+f,y:o+g,w:l,h:10*l,numRows:10,numColumns:1,displayBorder:!0,fillStyle:s,kind:r,value:10,index:1})}e&&(i+=_.maxBy(m)+l+u);for(var p=0,m=[];p<n;p++){var f=(h+c)*(p%5),g=(h+c)*Math.floor(p/5);m.push(f),d.push({type:"grid",x:i+f,y:o+g,w:h,h:h,numRows:1,numColumns:1,displayBorder:!0,fillStyle:s,kind:r,value:1,index:2})}return n&&(i+=_.maxBy(m)+h),d},selectBaseBlock:function(t,e,n){var r=this.components.getNearestComponent(t,e,function(t){return"manipulative"===t.get("kind")});this.set({selectedBaseBlock:r})},dragToRemoveBaseBlock:function(t,e,n){var r=this.get("selectedBaseBlock"),i=this.get("container");if(r){var o=n.normalizeManipulative(r.get("x"),r.get("y"));r.destroy(),this.collection.manipulatives.addManipulative("baseBlocks",r.get("value"),o.x,o.y,!0),this.unset("selectedBaseBlock"),i.set({strokeStyle:this.get("containerBorderColor")}),this.components.trigger("render")}},dropToAddBaseBlock:function(t,e,n){if(n&&n.manipulative){var r=n.manipulative;if("draggableBaseBlock"===r.get("type")){var i=n.normalizeControl(r.get("x"),r.get("y")),o=this.get("containerBorderWidth"),s=Controller.Math.intersect({type:"rectangle",x:0,y:0,w:this.get("w"),h:this.get("h")},{type:"rectangle",x:i.x,y:i.y,w:r.get("w"),h:r.get("h")});if(s){var a,l;r.get("value")%10===0?(a=10,l=r.get("value")/10):(a=r.get("value")%10,l=1);var t,e;t=i.x<o?o:i.x+r.get("w")>this.get("w")-o?this.get("w")-o-r.get("w"):i.x,e=i.y<o?o:i.y+r.get("h")>this.get("h")-o?this.get("h")-o-r.get("h"):i.y;var h=this.get("container"),c=3-r.get("value").toString().length;h.set({strokeStyle:this.get("containerBorderColor")}),this.components.add({type:"grid",x:t,y:e,w:r.get("w"),h:r.get("h"),numRows:r.get("numRows"),numColumns:r.get("numColumns"),displayBorder:!0,fillStyle:this.get("manipulativeColor"),kind:"manipulative",value:r.get("value"),index:c},{silent:!0}),r.destroy(),this.components.trigger("render")}}}},isValid:function(){return this.components.some(function(t){return"manipulative"===t.get("kind")})},isCorrect:function(t){var e=t[this.get("answerIndex")-1],n=this.getFormattedInput();if(1===this.get("inputControl"))return _.isEqual(this.getFormattedInput(),e);if(2===this.get("inputControl")){for(var r=0,i=0,o=0;o<n.length;o++)r+=100*e[o]/Math.pow(10,o),i+=100*n[o]/Math.pow(10,o);return r===i}},getFormattedInput:function(){var t=this.components.filter(function(t){return"manipulative"===t.get("kind")}),e=[];return e[0]=_.filter(t,function(t){return 100===t.get("value")}).length,e[1]=_.filter(t,function(t){return 10===t.get("value")}).length,e[2]=_.filter(t,function(t){return 1===t.get("value")}).length,e},getInput:function(){var t=this.components.filter(function(t){return"manipulative"===t.get("kind")});return t.map(function(t){return{x:t.get("x"),y:t.get("y"),value:t.get("value"),index:t.get("index")}})},setInput:function(t){this.components.removeComponents(this.components.filter(function(t){return"manipulative"===t.get("kind")}),{silent:!0});var e=t[this.get("answerIndex")-1];e.forEach(function(t){100===t.value?(t.w=10*Controller.ManipulativeDraggableBaseBlockModel.prototype.defaults.hundredsBlockWidthHeight,t.h=t.w,t.numRows=10,t.numColumns=10):10===t.value?(t.w=Controller.ManipulativeDraggableBaseBlockModel.prototype.defaults.tensBlockWidthHeight,t.h=10*Controller.ManipulativeDraggableBaseBlockModel.prototype.defaults.tensBlockWidthHeight,t.numRows=10,t.numColumns=1):(t.w=Controller.ManipulativeDraggableBaseBlockModel.prototype.defaults.onesBlockWidthHeight,t.h=t.w,t.numRows=1,t.numColumns=1),t.type="grid",t.displayBorder=!0,t.fillStyle=this.get("manipulativeColor"),t.kind="manipulative"}.bind(this)),this.components.addComponents(e)},displayAnswer:function(t){this.components.removeComponents(this.components.filter(function(t){return"manipulative"===t.get("kind")}),{silent:!0}),this.collection.manipulatives.eraseAllManipulatives();var e=t[this.get("answerIndex")-1],n=this.get("xPadding"),r=this.get("yPadding"),i=this.getBaseBlockComponents(e[0],e[1],e[2],"manipulative",n,r);this.components.addComponents(i,{silent:!0}),this.displayResult(t)},displayResult:function(t){if(1===this.get("inputControl")){var e=this.components.filter(function(t){return"manipulative"===t.get("kind")}),n=t[this.get("answerIndex")-1].slice();e.forEach(function(t){var e=n[t.get("index")]>0;n[t.get("index")]--,t.set({borderLineWidth:3,borderStrokeStyle:e?this.get("correctColor"):this.get("incorrectColor")})}.bind(this))}else if(2===this.get("inputControl")){var r=this.get("container");r.set({strokeStyle:this.isCorrect(t)?this.get("correctColor"):this.get("incorrectColor")})}this.components.trigger("render")}})}(),Controller.ManipulativeBaseBlocksContainerView=Controller.CanvasControlView.extend({initialize:function(t){this.model.isInputControl()&&(this.canvasEvents={mousedown:"selectBaseBlock",mousemove:"dragToRemoveBaseBlock",mouseup:"dropToAddBaseBlock"}),Controller.CanvasControlView.prototype.initialize.apply(this,t)}}),Controller.ManipulativeBaseBlocksTableModel=function(){"use strict";return Controller.CanvasControlModel.extend({parse:function(t){var e=t.value;return e&&(e=e.replace(/([^,\]\[]+)/g,function(t){return t=t.trim(),"''"===t.replace(/ /g,"")?'""':(t=t.substring(t.startsWith("'")?1:0,t.endsWith("'")?t.length-1:t.length),isNaN(t)&&"true"!==t&&"false"!==t?'"'+t+'"':t)}),e=JSON.parse("["+e+"]"),t.numHundreds=e[0]||0,t.numTens=e[1]||0,t.numOnes=e[2]||0,t.counter=e[3]||!1),Controller.CanvasControlModel.prototype.parse.call(this,t)},defaults:{staticColor:Controller.COLORS.lightorange,manipulativeColor:Controller.COLORS.blue,bgColor:Controller.COLORS.white,titleBlockColor:Controller.COLORS.lightyellow,paddingSameElement:8,paddingBetweenTableAndBlocks:4,titleBlockHeight:30,correctColor:Controller.COLORS.correctColor,incorrectColor:Controller.COLORS.incorrectColor,inputControl:0,answerIndex:1},setup:function(){var t=this.get("numHundreds"),e=this.get("numTens"),n=this.get("numOnes"),r=this.get("answers")[this.get("answerIndex")-1]?this.get("answers")[this.get("answerIndex")-1]:[],i=r[0]?r[0]:0,o=r[1]?r[1]:0,s=(r[2]?r[2]:0,this.get("titleBlockHeight")),a=(this.get("titleBlockColor"),this.get("paddingBetweenTableAndBlocks")),l=0,h=s+a,c=this.getHundredsBlockComponents(t,0,"static",l+a,h),u=this.getHundredsBlockComponents(i,t,"manipulative",l+a,h),d=c.concat(u),p=_.maxBy(d,function(t){return t.x+t.w})||{x:0,w:0},f=10*Controller.ManipulativeDraggableBaseBlockModel.prototype.defaults.hundredsBlockWidthHeight,g=_.maxBy([f+a,p.x+p.w-l])+a;l+=g;var m=this.getTensBlockComponents(e,0,"static",l+a,h),x=this.getTensBlockComponents(o,e,"manipulative",l+a,h),y=m.concat(x),v=_.maxBy(y,function(t){return t.x+t.w})||{x:0,w:0},C=10*Controller.ManipulativeDraggableBaseBlockModel.prototype.defaults.hundredsBlockWidthHeight,w=_.maxBy([C+a,v.x+v.w-l])+a;l+=w;var b=this.getOnesBlockComponents(n,0,"static",l+a,h),M=5*Controller.ManipulativeDraggableBaseBlockModel.prototype.defaults.onesBlockWidthHeight+32+2*a;if(l+=M,l>this.get("w"))throw"The base blocks from the expected answer are "+(l-this.get("w"))+" pixels too wide.";var S=(this.get("w")-l)/2;this.components.each(function(t){t.set({x:t.get("x")+S})}),c.forEach(function(t){t.x+=S}),m.forEach(function(t){t.x+=S}),b.forEach(function(t){t.x+=S}),this.components.addComponents(c),this.components.addComponents(m),this.components.addComponents(b);for(var E=[],I=[g,w,M],N=[100,10,1],O=["Hundreds","Tens","Ones"],T=S,P=0;P<I.length;P++)E.push({x:T,y:h-a,w:I[P],h:this.get("h")-s,container:N[P],index:P,xBaseBlocks:T+a,yBaseBlocks:h}),this.components.add({type:"rectangle",x:T,y:0,w:I[P],h:s,fillStyle:this.get("titleBlockColor"),zIndex:-2,lineWidth:1}),this.components.add({type:"text",x:T+I[P]/2,y:s/2,textFont:"Roboto",text:O[P],zIndex:-1}),this.components.add({type:"rectangle",x:T,y:h-a,w:I[P],h:this.get("h")-h+a,fillStyle:this.get("bgColor"),zIndex:-2,lineWidth:1}),T+=I[P];var A=this.components.add({type:"rectangle",x:S,y:s,w:l,h:this.get("h")-s,fillStyle:"",lineWidth:0,zIndex:5});this.set({containers:E,borderContainer:A})},getHundredsBlockComponents:function(t,e,n,r,i){for(var o="static"===n?this.get("staticColor"):this.get("manipulativeColor"),s=Controller.ManipulativeDraggableBaseBlockModel.prototype.defaults.hundredsBlockWidthHeight,a=this.get("paddingSameElement"),l=[],h=e;h<e+t;h++){var c=(10*s+a)*Math.floor(h/3),u=(10*s+a)*(h%3);l.push({type:"grid",x:r+c,y:i+u,w:10*s,h:10*s,numRows:10,numColumns:10,displayBorder:!0,fillStyle:o,kind:n,value:100,container:100,index:0})}return l},getTensBlockComponents:function(t,e,n,r,i){for(var o="static"===n?this.get("staticColor"):this.get("manipulativeColor"),s=Controller.ManipulativeDraggableBaseBlockModel.prototype.defaults.tensBlockWidthHeight,a=this.get("paddingSameElement"),l=[],h=e;h<e+t;h++){var c=(5*s+6*a)*Math.floor(h/15)+(s+a)*(h%5),u=(10*s+a)*Math.floor(h/5%3);l.push({type:"grid",x:r+c,y:i+u,w:s,h:10*s,numRows:10,numColumns:1,displayBorder:!0,fillStyle:o,kind:n,value:10,container:10,index:1})}return l},getOnesBlockComponents:function(t,e,n,r,i){for(var o="static"===n?this.get("staticColor"):this.get("manipulativeColor"),s=Controller.ManipulativeDraggableBaseBlockModel.prototype.defaults.onesBlockWidthHeight,a=this.get("paddingSameElement"),l=[],h=e;h<e+t;h++){var c=(s+a)*(h%5),u=(s+a)*Math.floor(h/5);l.push({type:"grid",x:r+c,y:i+u,w:s,h:s,numRows:1,numColumns:1,displayBorder:!0,fillStyle:o,kind:n,value:1,container:1,index:2})}return l},selectBaseBlock:function(t,e,n){var r=this.components.getNearestComponent(t,e,function(t){return"manipulative"===t.get("kind")});this.set({selectedBaseBlock:r})},dragToRemoveBaseBlock:function(t,e,n){var r=this.get("selectedBaseBlock"),i=this.get("borderContainer");if(r){var o=n.normalizeManipulative(r.get("x"),r.get("y"));r.destroy(),this.collection.manipulatives.addManipulative("baseBlocks",r.get("value"),o.x,o.y,!0),this.unset("selectedBaseBlock"),i.set({lineWidth:0})}this.components.trigger("render")},dropToAddBaseBlock:function(t,e,n){if(n&&n.manipulative){var r=n.manipulative;if("draggableBaseBlock"===r.get("type")){var i=n.normalizeControl(r.get("x"),r.get("y")),o=this.get("containers"),s=_.maxBy(o,function(t){return t.overlappingArea=Controller.Math.overlappingArea({type:"rectangle",x:t.x,y:t.y,w:t.w,h:t.h},{type:"rectangle",x:i.x,y:i.y,w:r.get("w"),h:r.get("h")}),t.overlappingArea});if(s.overlappingArea>0){var t,e;t=i.x<s.x?s.x:i.x+r.get("w")>s.x+s.w?s.x+s.w-r.get("w"):i.x,e=i.y<s.y?s.y:i.y+r.get("h")>s.y+s.h?s.y+s.h-r.get("h"):i.y;var a=this.get("borderContainer");a.set({lineWidth:0}),this.components.add({type:"grid",x:t,y:e,w:r.get("w"),h:r.get("h"),numRows:r.get("numRows"),numColumns:r.get("numColumns"),displayBorder:!0,fillStyle:this.get("manipulativeColor"),kind:"manipulative",value:r.get("value"),container:s.container,index:s.index}),r.destroy()}}}},hasNestedArray:function(t){return _.isArray(t)&&!_.every(t,function(t){return!_.isArray(t)})},isValid:function(){return this.components.some(function(t){return"manipulative"===t.get("kind")})},isCorrect:function(t){var e=t[this.get("answerIndex")-1],n=this.getFormattedInput(),r=this.hasNestedArray(n);if(r)return!1;if(1===this.get("inputControl"))return _.isEqual(n,e);if(2===this.get("inputControl")){for(var i=0,o=0,s=0;s<n.length;s++)i+=100*e[s]/Math.pow(10,s),o+=100*n[s]/Math.pow(10,s);return i===o}},getFormattedInput:function(){var t=this.components.filter(function(t){return"manipulative"===t.get("kind")}),e=[],n=[100,10,1],r=_.some(t,function(t){return t.get("value")!==t.get("container")});if(r)for(var i=0;i<n.length;i++){var o=_.filter(t,function(t){return t.get("container")===n[i]});e[i]=[];for(var s=0;s<n.length;s++)e[i][s]=_.filter(o,function(t){return t.get("value")===n[s]}).length}else for(var i=0;i<n.length;i++)e[i]=_.filter(t,function(t){return t.get("value")===n[i]}).length;return e},getInput:function(){var t=this.components.filter(function(t){return"manipulative"===t.get("kind")});return t.map(function(t){return{x:t.get("x"),y:t.get("y"),value:t.get("value"),container:t.get("container"),index:t.get("index")}})},setInput:function(t){this.components.removeComponents(this.components.filter(function(t){return"manipulative"===t.get("kind")}),{silent:!0});var e=t[this.get("answerIndex")-1];e.forEach(function(t){100===t.value?(t.w=10*Controller.ManipulativeDraggableBaseBlockModel.prototype.defaults.hundredsBlockWidthHeight,t.h=t.w,t.numRows=10,t.numColumns=10):10===t.value?(t.w=Controller.ManipulativeDraggableBaseBlockModel.prototype.defaults.tensBlockWidthHeight,t.h=10*Controller.ManipulativeDraggableBaseBlockModel.prototype.defaults.tensBlockWidthHeight,t.numRows=10,t.numColumns=1):(t.w=Controller.ManipulativeDraggableBaseBlockModel.prototype.defaults.onesBlockWidthHeight,t.h=t.w,t.numRows=1,t.numColumns=1),t.type="grid",t.displayBorder=!0,t.fillStyle=this.get("manipulativeColor"),t.kind="manipulative"}.bind(this)),this.components.addComponents(e)},displayAnswer:function(t){this.components.removeComponents(this.components.filter(function(t){return"manipulative"===t.get("kind")}),{silent:!0}),this.collection.manipulatives.eraseAllManipulatives();var e,n,r,i=t[this.get("answerIndex")-1],o=this.get("numHundreds"),s=this.get("numTens"),a=this.get("numOnes");this.hasNestedArray(i)?(e=i[0][0]?i[0][0]:0,n=i[1][1]?i[1][1]:0,r=i[2][2]?i[2][2]:0):(e=i[0]?i[0]:0,n=i[1]?i[1]:0,r=i[2]?i[2]:0);var l=this.get("containers"),h=this.getHundredsBlockComponents(e,o,"manipulative",l[0].xBaseBlocks,l[0].yBaseBlocks),c=this.getTensBlockComponents(n,s,"manipulative",l[1].xBaseBlocks,l[1].yBaseBlocks),u=this.getOnesBlockComponents(r,a,"manipulative",l[2].xBaseBlocks,l[2].yBaseBlocks);this.get("borderContainer");this.components.addComponents(h,{silent:!0}),this.components.addComponents(c,{silent:!0}),this.components.addComponents(u,{silent:!0}),this.displayResult(t)},displayResult:function(t){if(1===this.get("inputControl")){var e=this.components.filter(function(t){return"manipulative"===t.get("kind")}),n=t[this.get("answerIndex")-1].slice();e.forEach(function(t){var e=t.get("value")!==t.get("container"),r=!e&&n[t.get("index")]>0;e||n[t.get("index")]--,t.set({borderLineWidth:3,borderStrokeStyle:r?this.get("correctColor"):this.get("incorrectColor")})}.bind(this))}else if(2===this.get("inputControl")){var r=this.get("borderContainer");r.set({strokeStyle:this.isCorrect(t)?this.get("correctColor"):this.get("incorrectColor"),lineWidth:4})}this.components.trigger("render")}})}(),Controller.ManipulativeBaseBlocksTableView=Controller.CanvasControlView.extend({initialize:function(t){this.model.isInputControl()&&(this.canvasEvents={mousedown:"selectBaseBlock",mousemove:"dragToRemoveBaseBlock",mouseup:"dropToAddBaseBlock"}),Controller.CanvasControlView.prototype.initialize.apply(this,t)}}),Controller.TensFrameModel=function(){"use strict";return Controller.CanvasControlModel.extend({parse:function(t){var e=t.value.replace(/\+/g,"").replace(/([^,\]\[]+)/g,function(t){return t=t.trim(),"''"===t?'""':(t=t.substring(t.startsWith("'")?1:0,t.endsWith("'")?t.length-1:t.length),isNaN(t)&&"true"!==t&&"false"!==t?'"'+t+'"':t)});return e=JSON.parse("["+e+"]"),t.countersSet=e[0]||[],Controller.CanvasControlModel.prototype.parse.call(this,t)},defaults:{counterDiameter:Controller.CanvasCounterModel.prototype.defaults.w,frameWidth:500,frameHeight:200,framePadding:30,assignedColors:{green:"lightgreen",orange:"lightorange",red:"lightred",pink:"lightpink"},fillerColor:Controller.COLORS.darkgrey,correctColor:Controller.COLORS.correctColor,incorrectColor:Controller.COLORS.incorrectColor,inputControl:0,answerIndex:1},setup:function(){var t=this.getCountersArray(this.get("countersSet"));if(t.length>20)throw"Cannot display "+t.length+" counters in two tens frames.";if(this.get("inputControl"))for(;t.length%10!==0||0===t.length;)t.push("blank");var e,n=this.get("counterDiameter"),r=this.components.add({type:"grid",x:0,y:0,w:this.get("frameWidth"),h:this.get("frameHeight"),numRows:2,numColumns:5,lineWidth:5});t.length>10&&(e=this.components.add({type:"grid",x:0,y:this.get("frameHeight")+this.get("framePadding"),w:this.get("frameWidth"),h:this.get("frameHeight"),numRows:2,numColumns:5,lineWidth:5}));for(var i=1;i<=t.length;i++){var o,s=i>10?e.getInputCellCenterCanvasCoord(i-10):r.getInputCellCenterCanvasCoord(i),a=this.get("inputControl")&&"blank"===t[i-1],l=a?n+9:n;o=a?this.get("fillerColor"):this.get("assignedColors")[t[i-1]]?this.get("assignedColors")[t[i-1]]:t[i-1],("blank"!==t[i-1]||a)&&this.components.add({type:"counter",x:s.x-l/2,y:s.y-l/2,w:l,h:l,cellNum:i,fillStyle:a?this.get("fillerColor"):Controller.COLORS[o],color:t[i-1],opacity:a?.2:1,"class":a?"fillerCounter":"valueCounter"})}var h=r.get("x")+r.get("w"),c=e?e.get("y")+e.get("h"):r.get("y")+r.get("h"),u=(this.get("w")-h)/2,d=(this.get("h")-c)/2;this.components.each(function(t){t.set({x:t.get("x")+u,y:t.get("y")+d})}),this.get("inputControl")&&this.set({frameOne:r,frameTwo:e})},getCountersArray:function(t,e){for(var n=0,r=[];n<t.length;n++)for(var i=t[n].split(" ")[1],o=parseInt(t[n]),s=0;s<o;s++)r.push(i);return r},getEmptyCells:function(){for(var t=this.get("frameTwo"),e=[],n=t?20:10,r=this.components.filter(function(t){return"valueCounter"===t.get("class")||"manipulativeCounter"===t.get("class")}),i=1;i<=n;i++){
var o=_.some(r,function(t){return t.get("cellNum")===i});o||e.push(i)}return e},selectCounter:function(t,e,n){var r=this.components.getNearestComponent(t,e,function(t){return"manipulativeCounter"===t.get("class")});this.set({selectedCounter:r})},dragToRemoveCounter:function(t,e,n){var r=this.get("selectedCounter");if(r){var i=n.normalizeManipulative(r.get("x"),r.get("y"));r.destroy(),this.collection.manipulatives.addManipulative("counters",r.get("color"),i.x,i.y,!0),this.unset("selectedCounter")}},dropToAddCounter:function(t,e,n){if(n&&n.manipulative){var r=n.manipulative;if("counter"===r.get("type")){var i=n.normalizeControl(r.get("x"),r.get("y")),o=this.getEmptyCells(),s=this.components.filter(function(t){return"fillerCounter"===t.get("class")&&_.includes(o,t.get("cellNum"))}),a=this.get("frameOne"),l=this.get("frameTwo"),h=_.minBy(s,function(t){return Controller.Math.euclideanDistance(i.x+r.get("w")/2,i.y+r.get("w")/2,t.get("x")+t.get("w")/2,t.get("y")+t.get("w")/2)}),c=Controller.Math.intersect({type:"circle",x:i.x+r.get("w")/2,y:i.y+r.get("w")/2,w:r.get("w"),h:r.get("h")},{type:"circle",x:h.get("x")+h.get("w")/2,y:h.get("y")+h.get("w")/2,w:h.get("w"),h:h.get("h")});if(c){var u=h.get("cellNum"),d=u>10?l.getInputCellCenterCanvasCoord(u-10):a.getInputCellCenterCanvasCoord(u);this.components.add({type:"counter",x:d.x-r.get("w")/2,y:d.y-r.get("h")/2,cellNum:u,fillStyle:r.get("fillStyle"),color:r.get("color"),"class":"manipulativeCounter"}),r.destroy()}}}},isValid:function(){return this.components.some(function(t){return"manipulativeCounter"===t.get("class")})},isCorrect:function(t){for(var e=this.getCountersArray(this.getInput()),n=this.getCountersArray(t[this.get("answerIndex")-1]);e.length<n.length;)e.push("blank");for(;n.length<e.length;)n.push("blank");return 2===this.get("inputControl")&&(e=_.sortBy(e),n=_.sortBy(n)),_.isEqual(e,n)},getInput:function(){for(var t=this.components.filter(function(t){return"manipulativeCounter"===t.get("class")}),e=_.sortBy(t.concat(this.getEmptyCells()),function(t){return _.isNumber(t)?t:t.get("cellNum")}),n=0;n<e.length;n++)e[n]=_.isNumber(e[n])?"blank":e[n].get("color");for(var r=[],i=0;i<e.length;){for(var o=1,s=e[i];i+o<e.length&&s===e[i+o];)o++;i+=o,"blank"===s&&i===e.length||r.push(o+" "+s)}return r},setInput:function(t){this.components.removeComponents(this.components.filter(function(t){return"manipulativeCounter"===t.get("class")}),{silent:!0}),this.collection.manipulatives.eraseAllManipulatives();for(var e=this.get("counterDiameter"),n=this.get("frameOne"),r=this.get("frameTwo"),i=this.getEmptyCells(),o=this.getCountersArray(t[this.get("answerIndex")-1]),s=0;s<Math.min(i.length,o.length);s++){var a=i[s],l=a>10?r.getInputCellCenterCanvasCoord(a-10):n.getInputCellCenterCanvasCoord(a),h=this.get("assignedColors")[o[s]]?this.get("assignedColors")[o[s]]:o[s];"blank"!==o[s]&&this.components.add({type:"counter",x:l.x-e/2,y:l.y-e/2,cellNum:a,fillStyle:Controller.COLORS[h],color:o[s],"class":"manipulativeCounter"},{silent:!0})}this.components.trigger("render")},displayAnswer:function(t){this.setInput(t),this.displayResult(t)},displayResult:function(t){var e=this.components.filter(function(t){return"manipulativeCounter"===t.get("class")}),n=this.getCountersArray(t[this.get("answerIndex")-1]);if(1===this.get("inputControl")){var r=_.sortBy(e.concat(this.getEmptyCells()),function(t){return _.isNumber(t)?t:t.get("cellNum")});_.forEach(r,function(t,e){if(!_.isNumber(t)){var r=t.get("color")===n[e];t.set({lineWidth:8,strokeStyle:r?this.get("correctColor"):this.get("incorrectColor")})}}.bind(this))}else 2===this.get("inputControl")&&(e=_.sortBy(e,function(t){return t.get("cellNum")}),e.forEach(function(t){var e=n.indexOf(t.get("color")),r=e!==-1;t.set({lineWidth:8,strokeStyle:r?this.get("correctColor"):this.get("incorrectColor")}),r&&n.splice(e,1)}.bind(this)));this.components.trigger("render")}})}(),Controller.TensFrameView=Controller.CanvasControlView.extend({initialize:function(t){this.model.isInputControl()&&(this.canvasEvents={mousedown:"selectCounter",mousemove:"dragToRemoveCounter",mouseup:"dropToAddCounter"}),Controller.CanvasControlView.prototype.initialize.apply(this,t)}}),Controller.ShapesGraphModel=Controller.CanvasControlModel.extend({parse:function(t){t.axesFlag=t.axesFlag||!1,t.requiredShape=t.requiredShape||0,t.matchValue=t.matchValue||0,t.shapeToRender=t.shapeToRender||[];var e=this.collection.answers;return t.answerShape=e[0]||[],t.answerShapeType=e[1]||this.whatShapeIsIt(e[0]),t.currentShape=[],t.currentShapeType="",Controller.CanvasControlModel.prototype.parse.call(this,t)},defaults:{quadrants:1,textBoxCount:1,inputControl:0,gridIncrement:1,labelIncrement:1,answerIndex:1,renderValues:{axisStrokeStyle:Controller.COLORS.charcoal,gridStrokeStyle:Controller.COLORS.blue,axisLabelsFillStyle:Controller.COLORS.charcoal,textColor:Controller.COLORS.white,pointColor:Controller.COLORS.orange,maxCoords:10,shapeColor:Controller.COLORS.orange}},setRenderValues:function(t){var e,n=this.get("renderValues")||{};e=_.assign(n,t),this.set("renderValues",e)},setup:function(){var t=this.get("renderValues"),e=t.maxCoords;axisStrokeStyle=t.axisStrokeStyle,gridStrokeStyle=t.gridStrokeStyle,axisLabelsFillStyle=t.axisLabelsFillStyle,textColor=t.textColor,pointColor=t.pointColor,m=t.shapeColor;var n=this.get("w"),r=this.get("h"),i=Math.min(n,r),o=this.get("axesFlag")?1:0,s=i/(10*e/2),a=(i-o)/(e+2.5),l=(e+1)*a,h=i-o-a,c=this.get("axesFlag")?a:a/2,u=this.get("axesFlag")?r/2+i/2-a:r/2+i/2-a/2,d=a/2,p=a/5;this.components.add({type:"rectangle",x:c-a,y:u-h,w:i,h:i,fillStyle:Controller.COLORS.white,lineWidth:0});var f=this.components.add({type:"grid",x:c,y:u-l,w:l,h:l,strokeStyle:gridStrokeStyle,numRows:e+1,numColumns:e+1,lineWidth:1});if(this.get("axesFlag")){this.axisArrows(c+l,u,c+h,u,s),this.axisArrows(c,u-l,c,u-h,s),this.components.add({type:"line","class":"yAxis",xStart:c,yStart:u,xEnd:c,yEnd:u-h,strokeStyle:axisStrokeStyle,lineWidth:2}),this.components.add({type:"line","class":"xAxis",xStart:c,yStart:u,xEnd:c+h,yEnd:u,strokeStyle:axisStrokeStyle,lineWidth:2}),this.axisLabels(c-a/3,u+a/3,d,"0"),this.axisLabels(c+l+a/3,u+a/2,d,"x"),this.axisLabels(c-a/2,u-l-a/3,d,"y");for(var g=1;g<e+1;g++)this.axisLabels(c+g*this.get("gridIncrement")*a,u+a/2,d,g*this.get("labelIncrement")),this.axisLabels(c-a/2,u-g*this.get("gridIncrement")*a,d,g*this.get("labelIncrement"))}var m=[];t.width=n,t.height=r,t.boxWidthHeight=a,t.xOrigin=c,t.yOrigin=u,t.pointRadius=p,t.totalLength=i,this.setRenderValues(t),this.set({grid:f}),this.isInputControl()&&(this.set({pointsArray:[]}),this.set({shapeNum:0}),this.set({pointNum:0}),this.drawUndoButton()),!this.isInputControl()&&this.get("shapeToRender")&&this.drawShape(this.get("shapeToRender"),!0)},getCanvasCoord:function(t,e){return t.getCanvasCoords({gridIncrement:this.get("gridIncrement"),labelIncrement:this.get("labelIncrement"),gridCoord:e,quadrants:this.get("quadrants"),xStart:0,yStart:0})},getGridCoord:function(t){var e=t.grid,n=t.point,r=t.xOrigin,i=t.yOrigin,o=t.boxWidthHeight;return e.getGridCoords({gridIncrement:this.get("gridIncrement"),labelIncrement:this.get("labelIncrement"),canvasCoord:n,quadrants:this.get("quadrants"),xOrigin:r,yOrigin:i,boxWidthHeight:o})},drawPoint:function(t,e,n,r,i){var i=i||Controller.COLORS.charcoal;this.components.add({type:"circle","class":"point",x:t,y:e,r:n,fillStyle:r,strokeStyle:i,lineWidth:2})},connectPoints:function(t,e,n,r,i,o){var s=[],a="",o=o||Controller.COLORS.charcoal;this.components.add({type:"line","class":"connectingLine",xStart:t,yStart:e,xEnd:n,yEnd:r,strokeStyle:o,lineWidth:5,lineStyle:a,lineStyleAttributes:s}),this.components.add({type:"line","class":"connectingLine",xStart:t,yStart:e,xEnd:n,yEnd:r,strokeStyle:i,lineWidth:2,lineStyle:a,lineStyleAttributes:s})},drawShape:function(t,e,n,r){var i=this.get("renderValues");shapeColor=i.pointColor,grid=i.grid,canvasShape=t.map(function(t){return[this.getCanvasCoord(grid,t[0]).x,this.getCanvasCoord(grid,t[1]).y]}.bind(this)),e&&this.components.add({type:"shape",coordinates:canvasShape,fillStyle:shapeColor,lineWidth:0,strokeStyle:"",bgTransparency:.2}),canvasShape.map(function(t,e,n){var i=(this.get("renderValues").pointRadius,n[(e+1)%n.length]),o=t[0],s=t[1],a=i[0],l=i[1];this.connectPoints(o,s,a,l,shapeColor,r)}.bind(this)),canvasShape.map(function(t){var e=t[0],n=t[1];this.drawPoint(e,n,pointRadius,shapeColor,r)}.bind(this))},axisLabels:function(t,e,n,r){this.components.add({type:"text",text:r,x:t,y:e,textFont:"Roboto",textSize:n+"px",strokeStyle:Controller.COLORS.charcoal,lineWidth:1})},axisArrows:function(t,e,n,r,i){this.components.add({type:"arrow",xStart:t,yStart:e,xEnd:n,yEnd:r,strokeStyle:this.get("renderValues").axisStrokeStyle,lineWidth:2,arrowWidth:i})},drawUndoButton:function(t){var e=this.get("renderValues"),n=e.xOrigin,r=e.totalLength,i=e.boxWidthHeight,o=e.width,r=e.totalLength,s=e.yOrigin;this.components.remove(this.components.find(function(t){return"undo"===t.get("class")})),t="undefined"!=typeof t||this.undoActivated();var a=this.components.add({type:"undo_button","class":"undo",x:n+r-i+(o-r)/2,y:s-r/2+i,outlineWidth:3,r:(o-r)/3,enabled:t});this.set({undoButton:a})},undoActivated:function(){return this.components.find(function(t){return"point"===t.get("class")})},mutatePointsObjToPlainArray:function(t){return t.map(function(t){return[Math.abs(t.xGrid),Math.abs(t.yGrid)]})},setShapeValues:function(t){this.set("currentShape",this.mutatePointsObjToPlainArray(t));var e=this.get("currentShape");this.set("currentShapeType",this.whatShapeIsIt(e)),this.set("currentShapePerimeter",this.findPerimeter(e)),this.set("currentShapeArea",this.findArea(e))},buttonClick:function(t,e){var n=this.get("renderValues"),r=(n.width,n.height,n.xOrigin),i=n.yOrigin,o=(n.totalLength,n.boxWidthHeight),s=n.shapeColor,a=n.maxCoords,l=n.pointRadius,h=this.get("grid"),c=this.getGridCoord({grid:h,point:{x:t,y:e},xOrigin:r,yOrigin:i,boxWidthHeight:o});c.x=Math.round(c.x),c.y=Math.round(c.y);var u=this.components.getNearestComponent(this.getCanvasCoord(h,c.x).x,this.getCanvasCoord(h,c.y).y,function(t){return"point"===t.get("class")},1),d=this.components.getNearestComponent(t,e,function(t){return"undo"===t.get("class")},10);if(this.isInputControl()){var p=this.get("pointsArray"),f=this.get("shapeNum"),g=this.get("pointNum"),m=function(){this.drawUndoButton(),this.set({pointNum:g}),this.set({shapeNum:f}),this.set({pointsArray:p})};if(d&&(f>0||g>0)&&this.isInputControl()){var x,y=[];return 0===g?(f-=1,g=p.length-1,y.push(this.components.filter(function(t){return"connectingLine"===t.get("class")&&t.get("pointNum")===g&&t.get("shapeNum")===f})),g++,x=this.components.find(function(t){return"point"===t.get("class")&&0===t.get("pointNum")&&t.get("shapeNum")===f}),x.set({shapeClosed:!1}),p[0].shapeClosed=!1):(y.push(this.components.find(function(t){return"point"===t.get("class")&&t.get("pointNum")===g-1})),y.push(this.components.filter(function(t){return"connectingLine"===t.get("class")&&t.get("pointNum")===g-2})),g--,p.splice(g,1)),this.components.removeComponents(y),void m.bind(this)()}if(f>=1)return;if(0===p.length&&Math.abs(c.x)<=a+1&&Math.abs(c.y)<=a+1&&c.x>=0&&c.y>=0)return p[g]={type:"circle","class":"point",shapeNum:f,pointNum:g,xGrid:c.x,yGrid:c.y,x:this.getCanvasCoord(h,c.x).x,y:this.getCanvasCoord(h,c.y).y,r:l,fillStyle:s,lineWidth:2},this.components.add(p[g]),g++,void m.bind(this)();if(!u||u.get("shapeNum")!==f&&Math.abs(c.x)<=a+1&&Math.abs(c.y)<=a+1&&c.x>=0&&c.y>=0){var v=this.components.find(function(t){return"point"===t.get("class")&&t.get("pointNum")===g-1&&t.get("shapeNum")===f});this.components.remove(v,{silent:!0});var C=[];return C.push({type:"line","class":"connectingLine",shapeNum:f,pointNum:g-1,xStart:this.getCanvasCoord(h,p[g-1].xGrid).x,yStart:this.getCanvasCoord(h,p[g-1].yGrid).y,xEnd:this.getCanvasCoord(h,c.x).x,yEnd:this.getCanvasCoord(h,c.y).y,strokeStyle:Controller.COLORS.charcoal,lineWidth:5},{type:"line","class":"connectingLine",shapeNum:f,pointNum:g-1,xStart:this.getCanvasCoord(h,p[g-1].xGrid).x,yStart:this.getCanvasCoord(h,p[g-1].yGrid).y,xEnd:this.getCanvasCoord(h,c.x).x,yEnd:this.getCanvasCoord(h,c.y).y,strokeStyle:s,lineWidth:2}),p[g]={type:"circle","class":"point",shapeNum:f,pointNum:g,xGrid:c.x,yGrid:c.y,x:this.getCanvasCoord(h,c.x).x,y:this.getCanvasCoord(h,c.y).y,r:l,fillStyle:s,lineWidth:2},this.components.addComponents([C,v,p[g]]),g++,void m.bind(this)()}if(u&&0===u.get("pointNum")&&u.get("shapeNum")===f&&p.length>2){var x=this.components.find(function(t){return"point"===t.get("class")&&0===t.get("pointNum")&&t.get("shapeNum")===f}),w=this.components.find(function(t){return"point"===t.get("class")&&t.get("pointNum")===p.length-1&&t.get("shapeNum")===f});this.components.removeComponents([x,w],{silent:!0});var C=[];return C.push({type:"line","class":"connectingLine",shapeNum:f,pointNum:p.length-1,xStart:this.getCanvasCoord(h,c.x).x,yStart:this.getCanvasCoord(h,c.y).y,xEnd:this.getCanvasCoord(h,p[p.length-1].xGrid).x,yEnd:this.getCanvasCoord(h,p[p.length-1].yGrid).y,strokeStyle:Controller.COLORS.charcoal,lineWidth:5},{type:"line","class":"connectingLine",shapeNum:f,pointNum:p.length-1,xStart:this.getCanvasCoord(h,c.x).x,yStart:this.getCanvasCoord(h,c.y).y,xEnd:this.getCanvasCoord(h,p[p.length-1].xGrid).x,yEnd:this.getCanvasCoord(h,p[p.length-1].yGrid).y,strokeStyle:s,lineWidth:2}),p[0]={type:"circle","class":"point",shapeNum:f,pointNum:0,shapeClosed:!0,xGrid:x.get("xGrid"),yGrid:x.get("yGrid"),x:x.get("x"),y:x.get("y"),r:l,fillStyle:s,lineWidth:2},this.components.addComponents([C,p[0],w]),f++,g=0,m.bind(this)(),void this.setShapeValues(this.get("pointsArray"))}0===p.length&&p.splice(f,1)}},findAngle:function(t,e,n){var r=this.findLengthOfLine(t,e),i=this.findLengthOfLine(e,n),o=this.findLengthOfLine(t,n),s=Math.acos((i*i+r*r-o*o)/(2*i*r));return s=Math.round(180*s/Math.PI)},findLengthOfLine:function(t,e){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))},findSlopeOfLine:function(t,e){var n=(e[1]-t[1])/(e[0]-t[0]);return n===1/0||n===-(1/0)?Math.abs(n):n},calculateSideLengths:function(t){return t.map(function(t,e,n){var r=n[(e+1)%n.length];return this.findLengthOfLine(t,r)}.bind(this))},findPerimeter:function(t){var e=this.calculateSideLengths(t);return e.reduce(function(t,e){return t+e})},findArea:function(t){for(var e=0,n=0;n<t.length;n++){var r=(n+1)%t.length;e+=t[n][0]*t[r][1],e-=t[n][1]*t[r][0]}return Math.abs(e/2)},parseRedundantShapes:function(t,e){return"rectangle"===e&&"square"===t?"rectangle":"parallelogram"===e&&"rhombus"===t?"parallelogram":"rhombus"===e&&"square"===t?"rhombus":t},shapeCallbackHelper:function(t,e,n,r){var i=r[(n+1)%r.length],o=r[(n+2)%r.length];switch(t){case"angle":return this.findAngle(e,i,o);case"acuteAngle":return this.findAngle(e,i,o)<90;case"obtuseAngle":return this.findAngle(e,i,o)>90;case"rightAngle":return 90===this.findAngle(e,i,o);case"lengthOfSide":return this.findLengthOfLine(e,i,o);case"slope":return this.findSlopeOfLine(e,i);case"similarSlope":if(this.findSlopeOfLine(e,i)!==this.findSlopeOfLine(i,o))return i;break;default:return!0}},reduceShape:function(t){return t.map(this.shapeCallbackHelper.bind(this,"similarSlope"),this).filter(function(t){return void 0!==t})},isShapeRegular:function(t){var e=this.calculateSideLengths(t);return _.every(e,function(t){return t===e[0]})},isShapeTriangle:function(t){return 3===t.length},isShapeTriangleEquilateral:function(t){return this.isShapeTriangle(t)&&this.isShapeRegular(t)},isShapeTriangleAcute:function(t){var e=t.every(this.shapeCallbackHelper.bind(this,"acuteAngle"),this);return this.isShapeTriangle(t)&&e},isShapeTriangleObtuse:function(t){var e=t.some(this.shapeCallbackHelper.bind(this,"obtuseAngle"),this);return this.isShapeTriangle(t)&&e},isShapeTriangleRight:function(t){var e=t.some(this.shapeCallbackHelper.bind(this,"rightAngle"),this);return this.isShapeTriangle(t)&&e},isShapeTriangleScalene:function(t){var e=t.map(this.shapeCallbackHelper.bind(this,"angle"),this);return this.isShapeTriangle(t)&&3===_.uniq(e).length},isShapeTriangleIsosceles:function(t){var e=t.map(this.shapeCallbackHelper.bind(this,"lengthOfSide"),this);return this.isShapeTriangle(t)&&(2===_.uniq(e).length||this.isShapeRegular(t))},checkTriangleType:function(t,e){var n;switch(e){case"triangleEquilateral":n=this.isShapeTriangleEquilateral(t);break;case"triangleAcute":n=this.isShapeTriangleAcute(t);break;case"triangleObtuse":n=this.isShapeTriangleObtuse(t);break;case"triangleRight":n=this.isShapeTriangleRight(t);break;case"triangleScalene":n=this.isShapeTriangleScalene(t);break;case"triangleIsosceles":n=this.isShapeTriangleIsosceles(t);break;default:n=!1}return n},isShapeRectangle:function(t){if(4===t.length)return t.every(this.shapeCallbackHelper.bind(this,"rightAngle"),this)},isShapeParallelogram:function(t){if(4===t.length){var e=t.map(this.shapeCallbackHelper.bind(this,"slope"),this);this.findSlopeOfLine(t[0],t[1]),this.findSlopeOfLine(t[1],t[2]),this.findSlopeOfLine(t[2],t[3]),this.findSlopeOfLine(t[3],t[0]);return e[0]===e[2]&&e[1]===e[3]}},isShapeTrapezoid:function(t){if(4===t.length){var e=this.findSlopeOfLine(t[0],t[1]),n=this.findSlopeOfLine(t[1],t[2]),r=this.findSlopeOfLine(t[2],t[3]),i=this.findSlopeOfLine(t[3],t[0]);return e===r||n===i}},isShapeValid:function(t){function e(t,e,n){var r=(n[1]-t[1])*(e[0]-t[0]),i=(e[1]-t[1])*(n[0]-t[0]);return r>=i?"counterclockwise":r<=i?"clockwise":void 0}function n(t,n,r,i){var o=e(t,n,r),s=e(t,n,i),a=e(r,i,t),l=e(r,i,n);if(o!==s&&a!==l)return!0}var r,i,o,s,a=this.reduceShape(t),l=a.length;for(r=0;r<l;r++){i=(r+1)%l;for(var o=0;o<l;o++)if(s=(o+1)%l,4===_.uniq([r,i,o,s]).length&&n(a[r],a[i],a[o],a[s]))return!1}return!0},isValid:function(){return this.get("pointsArray")[0].shapeClosed&&this.isShapeValid(this.get("currentShape"))},whatShapeIsIt:function(t){var e=this.reduceShape(t);if(this.isShapeValid(e))return this.isShapeTriangle(e)?"triangle":this.isShapeRectangle(e)?this.isShapeRegular(e)?"square":"rectangle":this.isShapeParallelogram(e)?this.isShapeRegular(e)?"rhombus":"parallelogram":this.isShapeTrapezoid(e)?"trapezoid":"notInList"},isCorrect:function(t){var e,n,r,i=this.get("requiredShape"),o=this.get("matchValue"),s=this.get("answerShape"),a=this.get("answerShapeType"),l=this.reduceShape(this.get("currentShape")),h=this.whatShapeIsIt(l);if(this.isInputControl())return 0===i?e=!0:1===i?(h=this.parseRedundantShapes(h,a),r=this.checkTriangleType(l,a),e=r||h===a):2===i&&(e=l.length===s.length),0===o?n=!0:1===o?n=this.findPerimeter(l)===this.findPerimeter(s):2===o?n=this.findArea(l)===this.findArea(s):3===o&&(n=this.findPerimeter(l)===this.findPerimeter(s)&&this.findArea(l)===this.findArea(s)),e&&n},disableInput:function(){var t=this.get("renderValues");t.width,t.xOrigin,t.yOrigin,t.totalLength,t.boxWidthHeight,this.get("grid");this.components.remove(this.components.find(function(t){return"undo"===t.get("class")})),this.drawUndoButton(),Controller.CanvasControlModel.prototype.disableInput.call(this)},enableInput:function(){this.undoActivated()&&this.drawUndoButton(!0),Controller.CanvasControlModel.prototype.enableInput.call(this)},getData:function(t){var e=this.get("answerIndex")||1;return t[e-1]},getInput:function(){for(var t=this.get("pointsArray"),e=[],n=0;n<t.length;n++)e[n]=[t[n].xGrid,t[n].yGrid],this.isInputControl()&&n===t.length-1&&(t[0].shapeClosed||e.push("shapeIsNotClosed"));return console.log(e),e},setInput:function(t){if(this.isInputControl()){var e,t=this.getData(t),n=[],r=[],i=[],o=(t.length,t.length),s=this.get("grid");"shapeIsNotClosed"===t[t.length-1]?(e=!1,t.splice(t.length-1,1)):e=!0,this.components.removeComponents(this.components.filter(function(t){return"point"===t.get("class")||"connectingLine"===t.get("class")}),{silent:!0}),r=[];for(var a=0;a<o;a++)i.push({type:"line","class":"connectingLine",shapeNum:0,pointNum:a,xStart:this.getCanvasCoord(s,t[a][0]).x,yStart:this.getCanvasCoord(s,t[a][1]).y,xEnd:this.getCanvasCoord(s,t[(a+1)%o][0]).x,yEnd:this.getCanvasCoord(s,t[(a+1)%o][1]).y,strokeStyle:Controller.COLORS.charcoal,lineWidth:5},{type:"line","class":"connectingLine",shapeNum:0,pointNum:a,xStart:this.getCanvasCoord(s,t[a][0]).x,yStart:this.getCanvasCoord(s,t[a][1]).y,xEnd:this.getCanvasCoord(s,t[(a+1)%o][0]).x,yEnd:this.getCanvasCoord(s,t[(a+1)%o][1]).y,strokeStyle:this.get("renderValues").shapeColor,lineWidth:2}),n.push({type:"circle","class":"point",shapeNum:0,pointNum:a,xGrid:t[a][0],yGrid:t[a][1],x:this.getCanvasCoord(s,t[a][0]).x,y:this.getCanvasCoord(s,t[a][1]).y,r:this.get("renderValues").pointRadius,fillStyle:this.get("renderValues").shapeColor,lineWidth:2}),a===o-1&&(n[n.length-1-a].shapeClosed=!0),r[a]=n[n.length-1];this.isInputControl()&&!e&&(i.splice(i.length-2,2),n[n.length-t.length].shapeClosed=e,r[0].shapeClosed=e),this.components.addComponents([i,n]),this.set({pointsArray:r}),console.log(r),this.set({shapeNum:0}),this.set({pointNum:e?a+1:a}),this.setShapeValues(this.get("pointsArray"))}this.drawUndoButton()},displayAnswer:function(t){var e=t[0],n=this.components.filter(function(t){return"connectingLine"===t.get("class")||"point"===t.get("class")});this.components.removeComponents(n),this.setInput(e),this.drawShape(e,!0,this.get("renderValues").pointColor,Controller.COLORS.correctColor)},displayResult:function(t){var e=this.isCorrect(t)?Controller.COLORS.correctColor:Controller.COLORS.incorrectColor;shapeComponents=this.components.filter(function(t){return"connectingLine"===t.get("class")||"point"===t.get("class")}),alteredComponents=shapeComponents.map(function(t){return t.set("strokeStyle",e),t}),alteredLines=alteredComponents.filter(function(t){return"connectingLine"===t.get("class")}),alteredPoints=alteredComponents.filter(function(t){return"point"===t.get("class")}),finalPoint=this.components.find(function(t){return"point"===t.get("class")&&t.get("pointNum")===alteredPoints.length-1}),this.components.removeComponents(shapeComponents),this.components.addComponents([alteredLines,alteredPoints,finalPoint])}}),Controller.ShapesGraphView=Controller.CanvasControlView.extend({initialize:function(t){this.model.isInputControl()&&(this.canvasEvents={click:"buttonClick"}),Controller.CanvasControlView.prototype.initialize.apply(this,t)}}),Controller.IntegerTilesModel=function(){"use strict";return Controller.CanvasControlModel.extend({loadAssets:function(){var t=new FontFaceObserver("FontAwesome");return t.load("").then(function(){this.trigger("loaded-assets")}.bind(this))["catch"](function(t){throw this.trigger("loaded-assets"),t}.bind(this))},parse:function(t){var e=t.value.replace(/\+/g,"").replace(/([^,\]\[]+)/g,function(t){return t=t.trim(),"''"===t?'""':(t=t.substring(t.startsWith("'")?1:0,t.endsWith("'")?t.length-1:t.length),isNaN(t)&&"true"!==t&&"false"!==t?'"'+t+'"':t)}),e=JSON.parse("["+e+"]");return 1===_.last(e)||_.last(e)===!0?(t.isRandom=!0,e.pop()):0===_.last(e)||_.last(e)===!1?(t.isRandom=!1,e.pop()):t.isRandom=!1,t.tilesSets=this._getTilesSetsWithProperties(e,t.isRandom),Controller.CanvasControlModel.prototype.parse.call(this,t)},_getTilesSetsWithProperties:function(t,e){return _.map(t,function(t){if(_.isNumber(t[t.length-2]))var n=t[t.length-2],r="max"===_.last(t)?1/0:_.last(t),i=t.slice(0,t.length-2);else if(_.isNumber(_.last(t)))var n=_.last(t),r=0,i=t.slice(0,t.length-1);else{var n="max";r=0,i=t}for(var o=0,s=[];o<i.length;o++)for(var a=i[o].split(" ")[1],l=parseInt(t[o]),h=0;h<l;h++)s.push(a);return e&&(s=_.shuffle(s),r=0),{tiles:s,numColumns:n,numGroups:r}})},defaults:{ySpacingSamePair:10,ySpacingNewPair:10,ySpacingNewArray:16,yContainerPadding:3,xSpacing:10,xContainerPadding:2},setup:function(){var t=this.get("tilesSets"),e=Controller.CanvasIntegerTileModel.prototype.defaults.w,n=Controller.CanvasIntegerTileModel.prototype.defaults.h,r=this.get("ySpacingSamePair"),i=this.get("ySpacingNewPair"),o=this.get("ySpacingNewArray"),s=this.get("yContainerPadding"),a=this.get("xSpacing"),l=this.get("xContainerPadding");t.forEach(function(t,h){var c=t.tiles,u=t.numColumns;if("max"===u){u=0;for(var d=a+2*l,p=e;p<=this.get("w");)u++,p+=e+d}for(var f=0,g=0;g<c.length;g++)g>0&&g/u%2===0?f+=n+2*s+i:g/u%2===1&&(f+=n+r),this.components.add({type:"integer_tile",x:(2*l+a+e)*(g%u),y:f,sign:c[g],tileIndex:g,setIndex:h});f+=n+2*s+o;var m=t.numGroups;if(0!==m&&c.length>u){for(var g=0,x=[];g<c.length;g+=u)x.push(c.slice(g,g+u));for(var y=Math.ceil(c.length/u),v=(y-y%2)/2,g=0,C=[];g<v;g++)for(var w=x[2*g],b=x[2*g+1],M=0;M<b.length;M++){var S=g*u*2+M;w[M]!==b[M]&&C.push(S)}for(var E=this.components.filter(function(t){return _.some(C,function(e){return t.get("tileIndex")===e&&t.get("setIndex")===h})}.bind(this)),g=0;g<Math.min(m,C.length);g++){var I=E[g];this.components.add({type:"outline",x:I.get("x")-l,y:I.get("y")-s,w:e+2*l,h:2*n+r+2*s,lineStyle:"dashed",dashAttributes:[8.4,7.4],dashOffset:3,lineWidth:2})}}}.bind(this)),this._centerAndValidateCoordinates()},_centerAndValidateCoordinates:function(){var t=_.minBy(this.components.map(function(t){return t.get("x")})),e=_.maxBy(this.components.map(function(t){return t.get("x")+t.get("w")||t.get("diameter")})),n=e-t,r=_.minBy(this.components.map(function(t){return t.get("y")})),i=_.maxBy(this.components.map(function(t){return t.get("y")+t.get("h")||t.get("diameter")})),o=i-r;if(n>this.get("w")||o>this.get("h"))throw new Error("The control specified is too large for this window size.");this.components.each(function(e){e.set({x:e.get("x")+(this.get("w")-n)/2-t,y:e.get("y")+(this.get("h")-o)/2-r})}.bind(this))}})}(),Controller.IntegerTilesView=Controller.CanvasControlView.extend({initialize:function(t){Controller.CanvasControlView.prototype.initialize.apply(this,t)}}),Controller.DigitalClockModel=function(){"use strict";return Controller.CanvasControlModel.extend({parse:function(t){var e=JSON.parse("["+t.value+"]");return t.hour=e[0]||12,t.minute=e[1]||0,Controller.CanvasControlModel.prototype.parse.call(this,t)},defaults:{frameColor:Controller.COLORS.darkgrey,bgColor:Controller.COLORS.darknavy,textColor:Controller.COLORS.green},setup:function(){var t,e,n,r,i=this.get("hour"),o=("0"+this.get("minute")%60).slice(-2);this.get("w")/this.get("h")>=2?(e=this.get("h"),t=2*e,n=(this.get("w")-t)/2,r=0):(t=this.get("w"),e=t/2,n=0,r=(this.get("h")-e)/2),this.components.add({type:"rectangle",x:n,y:r,w:t,h:e,lineWidth:0,fillStyle:this.get("frameColor")}),this.components.add({type:"rectangle",x:n+25*t/314,y:r+25*e/157,w:t-50*t/314,h:e-50*e/157,lineWidth:0,fillStyle:this.get("bgColor")});var s=70,a=314,l=s*t/a+"px",h=19;this.components.add({type:"text",x:n+t/2,y:r+e/2,textSize:l,text:":",textColor:this.get("textColor")}),this.components.add({type:"text",x:n+t/2-h*t/a,y:r+e/2,textSize:l,text:i,textColor:this.get("textColor"),textAlign:"right"}),this.components.add({type:"text",x:n+t/2+h*t/a,y:r+e/2,textSize:l,text:o,textColor:this.get("textColor"),textAlign:"left"})}})}(),Controller.DigitalClockView=Controller.CanvasControlView.extend({initialize:function(t){Controller.CanvasControlView.prototype.initialize.apply(this,t)}}),Controller.ControlsCollection=Backbone.Collection.extend({initialize:function(t,e){e&&e.selector&&(this.selector=e.selector),this.manipulatives=new Controller.Manipulatives,this.listenTo(this,"reset",this.removePrevious),this.listenTo(this,"reset",this.loadResources),this.listenTo(this,"reset",function(){this.forEach(function(t){t.trigger("add")})}.bind(this)),this.listenTo(this,"remove",this.hideModel)},removePrevious:function(t,e){e.previousModels.forEach(function(t){t.trigger("remove")})},parse:function(t){return this.type=t.type,this.questionID=t.questionID,this.answers=t.answers,t.manipulatives&&!_.isEmpty(t.manipulatives)&&(this.manipulatives.mQuestion=!0),t.controls},setMenuManipulatives:function(t){this.manipulatives.setMenuManipulatives(t)},eraseAllManipulatives:function(){this.manipulatives.eraseAllManipulatives()},setHintTemplates:function(t){this.hintTemplates=t},getHintTemplateAtIndex:function(t){var e=this.hintTemplates;if(_.isArray(e))return e[t]},model:function(t,e){e.parse=!0;try{return Controller.CONTROL_TYPES[t.type]?new Controller.CONTROL_TYPES[t.type].model(t,e):(console.warn("No model defined for control of type "+t.type),new Controller.CONTROL_TYPES.control.model(t,e))}catch(n){return console.warn("A value string of "+t.value+" could not be handled for controls of type "+t.type+". Removing contents from this control."),console.error(n),t.type="textBlock",t.value='<span style="color:#AAA">'+t.value+"<span>",t.align=1,new Controller.CONTROL_TYPES.textBlock.model(t,e)}},hideModel:function(t){t.trigger("hide")},loadResources:function(){var t,e,n=this,r=!0,i=0,o=function(){r||0!==i||n.loadAssets()},s=function(){i--,o()},a=[];this.forEach(function(n){if(t=n.getResources())for(var r=0,o=t.length;r<o;r++)e=t[r],a.indexOf(e)===-1&&(i++,a.push(e),n.listenTo(n,"loaded-resource",s),n.loadResource(e))}),r=!1,o()},loadAssets:function(){var t=this,e=this.length,n=function(){0===e&&t.trigger("load-complete")},r=function(){e--,n()};this.forEach(function(t){t.once("loaded-assets",r),t.loadAssets()}),0===this.length&&n()},isValid:function(){return this.every(function(t){return!t.isInputControl()||t.isValid()===!0})},isCorrect:function(){var t=this.answers;return this.every(function(e){return!e.isInputControl()||e.isCorrect(t)===!0})},getInput:function(){var t,e,n,r=[];return this.forEach(function(i){i.isInputControl()&&(t=i.getInput(),void 0!==t&&(e=t.answerIndex||i.get("answerIndex"),n=t.answerSubIndex||i.get("answerSubIndex"),t=t.input||t,n?(r[e-1]=r[e-1]||[],r[e-1][n-1]=t):r[e-1]=t))}),$.extend(!0,[],r)},setInput:function(t){this.forEach(function(e){e.isInputControl()&&e.setInput(t)})},enableInput:function(){this.forEach(function(t){t.enableInput()})},disableInput:function(){this.forEach(function(t){t.disableInput()})},displayAnswer:function(){var t=this.answers;this.forEach(function(e){e.isInputControl()&&e.displayAnswer(t)})},displayResult:function(){var t=this.answers;this.forEach(function(e){e.isInputControl()&&e.displayResult(t)})},displayUnchangedHighlights:function(t){this.forEach(function(e){e.isInputControl()&&!e.hasInputChanged(t)&&e.displayHighlight(t)})},hasChangedIncorrect:function(t){var e=this.answers;return this.every(function(n){return!n.isInputControl()||(n.isCorrect(e)||n.hasInputChanged(t))})},setSelectOptions:function(t){_.isUndefined(t.splitTestingSignature)||(this.splitTestingSignature=t.splitTestingSignature)},addStudentErrorBubbles:function(t,e,n){this.forEach(function(r){var i=_.filter(t,function(t){return t.answerIndex===r.get("answerIndex")});if(i.length){var o=n[r.get("answerIndex")-1];r.addStudentErrorBubble(i,e,o)}}),this.openInitialStudentErrorBubble()},clearStudentErrorBubbles:function(){this.forEach(function(t){t&&t.removeStudentErrorBubble()})},openInitialStudentErrorBubble:function(){var t=this.find(function(t){return"studentErrorBubble"===t.get("type")});t&&t.automaticallyShowStudentErrorBubbleOnce()}}),Controller.ControlsView=Backbone.View.extend({className:"controls",initialize:function(){var t=$(this.collection.selector),e=t.width(),n=t.height();e&&n&&(this.$el.css({position:"relative",top:"50%",left:"50%","-webkit-transform":"translate(-50%, -50%)",transform:"translateY(-50%, -50%)"}),t.html('<div style="width:80%; height:100%; float:left"></div><div class="side-panel" style="width:20%; height:100%; float:left;"></div>'),t.children().first().html(this.$el)),this.manipulativesView=new Controller.ManipulativesView({collection:this.collection.manipulatives,selector:this.collection.selector}),this.listenTo(this.collection,"add",this.addToCollection),this.listenTo(this.collection,"remove",this.removeFromCollection),this.listenTo(this.collection,"load-complete",this.render),this.views=[]},render:function(){this.$el.empty(),this.views=[],this.collection.forEach(this.addControl.bind(this)),this.setTextBoxTabIndexes(),this.setDimentions(),this.resize()},addControl:function(t){var e;try{Controller.CONTROL_TYPES[t.get("type")]?e=new(Controller.CONTROL_TYPES[t.get("type")].view)({
model:t}):(console.warn("No view defined for control of type "+t.get("type")),e=new Controller.CONTROL_TYPES.control.view({model:t}))}catch(n){console.log(t)}e.render(),this.$el.append(e.el),this.views.push(e),e.postRender()},addToCollection:function(t){t&&this.addControl(t),this.setTextBoxTabIndexes(),this.setDimentions(),this.resize()},removeFromCollection:function(t){this.setTextBoxTabIndexes(),this.setDimentions(),this.resize()},setDimentions:function(){this.resetScaleDimensions(),this.$el.css({width:this.getWidth(),height:this.getHeight(),borderWidth:this.getVerticalPadding()+"px "+this.getHorizontalPadding()+"px",borderColor:"transparent",borderStyle:"solid",boxSizing:"content-box"})},resetScaleDimensions:function(){var t=1,e="translate(-50%, -50%) scale("+t+","+t+")";this.$el.css({borderWidth:"0px","-webkit-transform":e,transform:e})},setTextBoxTabIndexes:function(){var t,e=this.$("textarea.control"),n=1,r=this.getWidth();e=_.sortBy(e,function(e){return t=e.getBoundingClientRect(),t.top+t.left/r}),_.each(e,function(t){t.tabIndex=n,n++}),Controller.isIE()?this.$("textarea.control[tabIndex=1]").prop("readOnly",!1).trigger("qi-focus"):this.$("textarea.control[tabIndex=1]").prop("readOnly",!0).trigger("qi-focus")},getWidth:function(){return _.maxBy(this.views.map(function(t){return t.getAbsoluteWidth()}))},getHeight:function(){return _.maxBy(this.views.map(function(t){return t.getAbsoluteHeight()}))},getVerticalPadding:function(){var t=this.el.getBoundingClientRect().width/this.el.offsetWidth,e={width:this.getWidth(),height:this.getHeight(),offsetTop:this.$el.offset().top/t+parseInt(this.$el.css("borderTopWidth")),offsetLeft:this.$el.offset().left/t+parseInt(this.$el.css("borderLeftWidth")),scale:t};return _.maxBy(this.views.map(function(t){return _.isFunction(t.getVerticalPadding)?t.getVerticalPadding(e):0}))},getHorizontalPadding:function(){var t=this.el.getBoundingClientRect().width/this.el.offsetWidth,e={width:this.getWidth(),height:this.getHeight(),offsetTop:this.$el.offset().top/t+parseInt(this.$el.css("borderTopWidth")),offsetLeft:this.$el.offset().left/t+parseInt(this.$el.css("borderLeftWidth")),scale:this.el.getBoundingClientRect().width/this.el.offsetWidth};return _.maxBy(this.views.map(function(t){return _.isFunction(t.getHorizontalPadding)?t.getHorizontalPadding(e):0}))},focusTextBox:function(t){var e=this.$("textarea.control[tabindex = "+t+"]");e&&(Controller.isIE()?$(e).prop("readOnly",!1).trigger("qi-focus"):$(e).prop("readOnly",!0).trigger("qi-focus"))},getFocusedTextBox:function(){return _.first(this.$("textarea.control.focus"))},focusNextTextBox:function(){var t,e=this.getFocusedTextBox(),n=this.$("textarea.control").not(".focus");_.isEmpty(n)||(t=_.find(n,function(t){return t.tabIndex===e.tabIndex+1}),t?$(t).trigger("qi-focus").prop("readOnly",!1).focus():this.$("textarea.control[tabIndex=1]").trigger("qi-focus").prop("readOnly",!1).focus())},getDimensions:function(){var t=this.$el.width(),e=this.$el.height();return{width:t,height:e}},resize:function(t){var e=$(this.collection.selector),n=.8*e.width()||.8*$(window).width()*.8,r=e.height()||$(window).height(),i=.2*e.width()||.2*$(window).width(),o=r,s=this.$el.outerWidth(),a=this.$el.outerHeight(),t=t||_.minBy([n/s,r/a,i/250,o/460,2]),l="translate(-50%, -50%) scale("+t+","+t+")";this.$el.css({"-webkit-transform":l,transform:l}),this.collection.scale=t,this.manipulativesView.resize(t)},clear:function(){this.views=null,this.manipulativesView.clear(),this.collection.reset(),this.$el.empty(),this.remove()}}),Controller.CONTROL_TYPES={textBlock:{model:Controller.TextBlockModel,view:Controller.TextBlockView},textBox:{model:Controller.TextBoxModel,view:Controller.TextBoxView},image:{model:Controller.PictureModel,view:Controller.PictureView},table:{model:Controller.TableModel,view:Controller.TableView},dropDown:{model:Controller.DropDownModel,view:Controller.DropDownView},_sortingChart:{model:Controller.SortingChartModel,view:Controller.SortingChartView},interactiveClock:{model:Controller.InteractiveClockModel,view:Controller.InteractiveClockView},hintBubble:{model:Controller.HintBubbleModel,view:Controller.HintBubbleView},studentErrorBubble:{model:Controller.StudentErrorBubbleModel,view:Controller.StudentErrorBubbleView},imageSubtraction:{model:Controller.ImageSubtractionModel,view:Controller.ImageSubtractionView},grid:{model:Controller.GridModel,view:Controller.GridView},pictograph:{model:Controller.PictographModel,view:Controller.PictographView},groupCreator:{model:Controller.MultiplicationGridModel,view:Controller.MultiplicationGridView},clock:{model:Controller.ClockModel,view:Controller.ClockView},placeValueChart:{model:Controller.PlaceValueChartModel,view:Controller.PlaceValueChartView},numberLine:{model:Controller.NumberLineModel,view:Controller.NumberLineView},graph:{model:Controller.GraphModel,view:Controller.GraphView},polygon:{model:Controller.PolygonModel,view:Controller.PolygonView},spinner:{model:Controller.SpinnerModel,view:Controller.SpinnerView},coin:{model:Controller.CoinModel,view:Controller.CoinView},angle:{model:Controller.AngleModel,view:Controller.AngleView},addingSequence:{model:Controller.AddingSequenceModel,view:Controller.AddingSequenceView},thermometer:{model:Controller.ThermometerModel,view:Controller.ThermometerView},linePlot:{model:Controller.LinePlotModel,view:Controller.LinePlotView},baseBlocks:{model:Controller.BaseBlocksModel,view:Controller.BaseBlocksView},numberSequence:{model:Controller.NumberSequenceModel,view:Controller.NumberSequenceView},threeDeeShape:{model:Controller.ThreeDeeShapeModel,view:Controller.ThreeDeeShapeView},fractions:{model:Controller.FractionsModel,view:Controller.FractionsView},net:{model:Controller.NetModel,view:Controller.NetView},decimalChart:{model:Controller.DecimalChartModel,view:Controller.DecimalChartView},fractionCircle:{model:Controller.FractionCircleModel,view:Controller.FractionCircleView},hundredsChart:{model:Controller.HundredsChartModel,view:Controller.HundredsChartView},integerTiles:{model:Controller.IntegerTilesModel,view:Controller.IntegerTilesView},fractionStripManip:{model:Controller.ManipulativeFractionStripsModel,view:Controller.ManipulativeFractionStripsView},clickableFractionCircle:{model:Controller.ClickableFractionCircleModel,view:Controller.ClickableFractionCircleView},coordinatePlane:{model:Controller.CoordinatePlaneModel,view:Controller.CoordinatePlaneView},shapesGraph:{model:Controller.ShapesGraphModel,view:Controller.ShapesGraphView},barGraph:{model:Controller.BarGraphModel,view:Controller.BarGraphView},scatterPlot:{model:Controller.ScatterPlotModel,view:Controller.ScatterPlotView},orderedCounters:{model:Controller.OrderedCountersModel,view:Controller.OrderedCountersView},unorderedCounters:{model:Controller.UnorderedCountersModel,view:Controller.UnorderedCountersView},tensFrame:{model:Controller.TensFrameModel,view:Controller.TensFrameView},interactiveFractionStrips:{model:Controller.InteractiveFractionStripsModel,view:Controller.InteractiveFractionStripsView},fractionStripManip:{model:Controller.ManipulativeFractionStripsModel,view:Controller.ManipulativeFractionStripsView},clickableFractionCircle:{model:Controller.ClickableFractionCircleModel,view:Controller.ClickableFractionCircleView},baseBlocksContainerManip:{model:Controller.ManipulativeBaseBlocksContainerModel,view:Controller.ManipulativeBaseBlocksContainerView},baseBlocksTableManip:{model:Controller.ManipulativeBaseBlocksTableModel,view:Controller.ManipulativeBaseBlocksTableView},digitalClock:{model:Controller.DigitalClockModel,view:Controller.DigitalClockView},control:{model:Controller.BaseControlModel,view:Controller.BaseControlView}},Controller.VERSION="edu-controls-2-2-12",Controller.IMAGE_PATH=Controller.DEV_MODE?"assets/images/":"https://prodigy.blob.core.windows.net/"+Controller.VERSION+"/images/",Controller.USEIMAGE_PATH="https://prodigy.blob.core.windows.net/prodigy-0-0-1/images/",Controller.DEPLOY_PATH="https://s3.amazonaws.com/prodigy-assets/education/skills/prod/b47b674f96/",Controller.TEMPLATE_TYPE={question:0,hint:1,answer:2},Controller._initialize=function(){var t="Pictograph Fix & Effectiveness Tracking",e=window.location.href.indexOf("education-macaron")!==-1,n="https://prodigy.blob.core.windows.net/"+Controller.VERSION;if(console.log("%c %c %c Macaron v"+Controller.VERSION.replace("edu-controls-","").replace(/-/g,".")+(t?" | "+t:"")+" %c %c ","background: #FCC","background: #FBB","background: #FAA; color: #FFF","background: #FBB","background: #FCC"),!e)for(var r=["https://fonts.googleapis.com/css?family=Roboto:400,700,400italic",n+"/controls.css"],i=0;i<r.length;i++)$("<link>",{rel:"stylesheet",type:"text/css",href:r[i]}).appendTo("head")},Controller._initialize(),Controller._isCssLoaded=function(){var t=document.styleSheets,e=["https://fonts.googleapis.com/css?family=Roboto:400,700,400italic","https://prodigy.blob.core.windows.net/"+Controller.VERSION+"/controls.css"];return _.every(e,function(e){for(var n=0;n<t.length;n++)if(t[n].href===e)return!0;return!1})},Controller.ManipulativeModel=Controller.CanvasComponentModel.extend({}),Controller.ManipulativeView=Controller.CanvasComponentView.extend({initialize:function(t){this.context=t.context},render:function(){if(this.model.get("fillStyle")&&(this.context.fillStyle=this.model.get("fillStyle"),this.context.fill()),this.model.get("lineWidth")>0){switch(this.context.save(),this.context.strokeStyle=this.model.get("strokeStyle"),this.context.lineWidth=this.model.get("lineWidth"),this.model.get("lineStyle")){case"dashed":this.context.setLineDash(this.model.get("lineStyleAttributes"))}this.context.stroke(),this.context.restore()}}}),Controller.ManipulativeBaseBlockModel=Controller.CanvasComponentModel.extend({parse:function(t){var e=t.scale?t.scale:1;return t.value%10===0?(t.numRows=10,t.numColumns=t.value/10):(t.numRows=t.value%10,t.numColumns=1),t.w=15*t.numColumns*e,t.h=15*t.numRows*e,t},defaults:{fillStyle:Controller.COLORS.lightorange,strokeStyle:Controller.COLORS.charcoal,lineWidth:1,displayBorder:!0},click:function(t,e,n){var r=this.get("value");if(r>1){for(var i=10===r?0:Math.floor(r/10),o=10===r?10:r%10,t=Math.min(this.get("x"),n.w-25*i+10),e=Math.min(this.get("y"),n.h-25*o+10),s=0;s<i;s++)this.collection.add({type:"baseBlock",x:t,y:e,value:10},{silent:!0}),t+=25;for(var s=0;s<o;s++)this.collection.add({type:"baseBlock",x:t,y:e,value:1},{silent:!0}),e+=25;this.destroy()}},_getAvailableCoordinates:function(t,e,n,r){var i=t.x,o=t.y,s=this.cid;if(1!==r){for(var i=t.x,a=e.w-1.5*r;i<a;){var l=this.collection.filter(function(t){var e="baseBlock"===t.get("type")&&_.isUndefined(t.get("mlimit"))&&t.cid!==n&&t.cid!==s&&t.get("x")===i&&t.get("y")===o;return e});if(_.isEmpty(l))return{x:i,y:o};var h=_.maxBy(l,function(t){return t.get("w")});i+=h.get("w")+10}return null}for(var c=e.h-15,a=e.w-15;i<a&&o<c;){var l=this.collection.filter(function(t){var e="baseBlock"===t.get("type")&&_.isUndefined(t.get("mlimit"))&&t.cid!==n&&t.cid!==s&&t.get("x")===i&&t.get("y")===o;return e});if(_.isEmpty(l))return{x:i,y:o};var h=_.maxBy(l,function(t){return t.get("w")});h.get("value")<10?o+=h.get("h")+10:i+=h.get("w")+10}},drop:function(t,e,n){var r=this.cid,i=this.attributes,o=this.collection.one(function(t){return"baseBlock"===t.get("type")&&_.isUndefined(t.get("mlimit"))&&t.cid!==r&&Controller.Math.intersect({type:"rectangle",x:i.x,y:i.y,w:i.w,h:i.h},{type:"rectangle",x:t.get("x"),y:t.get("y"),w:t.get("w"),h:t.get("h")})});if(o){for(var s,a=o.get("value")+this.get("value"),l=a%10,h=a%100-l,c=a-h-l,t=o.get("x"),e=o.get("y"),u=[],d=0;d<c;d+=100){if(s=this._getAvailableCoordinates({x:t,y:e},n,o.cid,100),!s)return;t=s.x,e=s.y,u.push({type:"baseBlock",x:t,y:e,value:100}),t+=160}if(h>0){if(s=this._getAvailableCoordinates({x:t,y:e},n,o.cid,h),!s)return;t=s.x,e=s.y,u.push({type:"baseBlock",x:t,y:e,value:h}),t+=1.5*h+10}if(c||h||!l)for(var d=0;d<l;d++){if(s=this._getAvailableCoordinates({x:t,y:e},n,o.cid,1),!s)return;t=s.x,e=s.y,u.push({type:"baseBlock",x:t,y:e,value:1}),e+=25}else{if(s=this._getAvailableCoordinates({x:t,y:e},n,o.cid,1),!s)return;t=s.x,e=s.y,u.push({type:"baseBlock",x:t,y:e,value:l})}for(var d=0;d<u.length;d++)this.collection.add(u[d],{silent:!0});o.destroy(),this.destroy()}}}),Controller.ManipulativeCoinModel=Controller.CanvasComponentModel.extend({parse:function(t){return t.source="http://prodigy.blob.core.windows.net/"+Controller.VERSION+"/images/manipulatives/coins/"+t.currency+"/"+t.value+"-front.png",t.alternateSource="http://prodigy.blob.core.windows.net/"+Controller.VERSION+"/images/manipulatives/coins/"+t.currency+"/"+t.value+"-back.png",t},initialize:function(){function t(t){var n=t.target;n.onload=null,e.get("w")||e.get("h")?(e.set({w:Math.max(e.get("w"),n.width),h:Math.max(e.get("h"),n.height)}),e.trigger("render")):e.set({w:n.width,h:n.height})}var e=this,n=new Image,r=new Image;n.onload=t,n.src=e.get("source"),r.onload=t,r.src=e.get("alternateSource"),e.set({image:n}),e.set({alternateImage:r})},distance:function(t,e){var n=Math.min(this.get("w"),this.get("h"))/2,r=this.get("x")+this.get("w")/2,i=this.get("y")+this.get("h")/2;return Math.max(Controller.Math.euclideanDistance(t,e,r,i)-n,0)},click:function(){var t=this.get("alternateImage");this.set({alternateImage:this.get("image")}),this.set({image:t}),this.trigger("render")}}),Controller.ManipulativeCoinView=Controller.CanvasComponentView.extend({render:function(){this.model.get("image")&&this.context.drawImage(this.model.get("image"),this.model.get("x"),this.model.get("y"),this.model.get("w"),this.model.get("h"))}}),Controller.ManipulativeCounterModel=Controller.CanvasComponentModel.extend({defaults:{strokeStyle:Controller.COLORS.charcoal,lineWidth:0,x:0,y:0,w:75,h:75},distance:function(t,e){var n=Math.min(this.get("w"),this.get("h"))/2,r=this.get("x")+this.get("w")/2,i=this.get("y")+this.get("h")/2;return Math.max(Controller.Math.euclideanDistance(t,e,r,i)-n,0)},click:function(){var t=this.get("alternateFillStyle");this.set({alternateFillStyle:this.get("fillStyle")}),this.set({fillStyle:t}),this.trigger("render")}}),Controller.ManipulativeCounterView=Controller.CanvasComponentView.extend({render:function(){this.context.beginPath();var t=Math.min(this.model.get("w"),this.model.get("h"))/2,e=this.model.get("x")+this.model.get("w")/2,n=this.model.get("y")+this.model.get("h")/2;this.context.arc(e,n,t,0,2*Math.PI),Controller.CanvasComponentView.prototype.render.apply(this)}}),Controller.ManipulativeFractionModel=Controller.CanvasFractionModel.extend({drop:function(){var t=this.attributes,e=this.collection.one(function(e){return"fractionContainer"===e.get("type")&&_.isUndefined(e.get("mlimit"))&&Controller.Math.intersect({type:"rectangle",x:t.x,y:t.y,w:t.w,h:t.h},{type:"rectangle",x:e.get("x"),y:e.get("y"),w:e.get("w"),h:e.get("h")})});e&&e.addFraction(this)}}),Controller.ManipulativeFractionContainerModel=Controller.CanvasFractionContainerModel.extend({addFraction:function(t){if(this._remainingSpace=_.isUndefined(this._remainingSpace)?this.get("w")-2*this.get("lineWidth"):this._remainingSpace,t.get("w")<=this._remainingSpace){t._containerId=this.cid,t.set({x:this.get("x")+this.get("w")-this._remainingSpace-this.get("lineWidth"),y:this.get("y")+1}),this._remainingSpace-=t.get("w"),0===this._remainingSpace&&this.set({strokeStyle:Controller.COLORS.darkgreen});var e=this.collection;e.remove(this,{silent:!0}),e.add(this,{silent:!0}),e.trigger("render")}},translate:function(t,e){for(var n=this.cid,r=this.collection.filter(function(t){return"fraction"===t.get("type")&&t._containerId===n}),i=0;i<r.length;i++){var o=r[i];o.translate(t,e),this.collection.remove(o,{silent:!0}),this.collection.add(o,{silent:!0})}Controller.CanvasFractionContainerModel.prototype.translate.call(this,t,e)},click:function(t,e,n){var r=this.cid,i=this.collection.getNearestManipulative(t,e,function(t){return"fraction"===t.get("type")&&t._containerId===r});i&&(i._containerId=void 0,i.get("y")+50+i.get("h")<n.h?i.translate(0,50):i.translate(0,-50),this.collection.remove(i,{silent:!0}),this.collection.add(i,{silent:!0}),this.collection.each(function(t){"fraction"===t.get("type")&&t._containerId===r&&t.get("x")>i.get("x")&&t.translate(-i.get("w"),0)}),this._remainingSpace+=i.get("w"),this.set({strokeStyle:Controller.CanvasFractionContainerModel.prototype.defaults.strokeStyle}),this.collection.trigger("render"))},drop:function(t,e,n){var r=this.cid,i=this.attributes,o=this.collection.one(function(t){return"fractionContainer"===t.get("type")&&_.isUndefined(t.get("mlimit"))&&t.cid!==r&&Controller.Math.intersect({type:"rectangle",x:i.x,y:i.y,w:i.w,h:i.h},{type:"rectangle",x:t.get("x"),y:t.get("y"),w:t.get("w"),h:t.get("h")})});if(o){var s,t=o.get("x"),e=o.get("y")+50;do s=this.collection.getNearestManipulative(t,e,function(n){return"fractionContainer"===n.get("type")&&_.isUndefined(n.get("mlimit"))&&n.get("x")===t&&n.get("y")===e},1),s&&(e=s.get("y")+50);while(e<n.h&&s);if(e+this.get("h")<n.h){this.translate(t-this.get("x"),e-this.get("y"));var a=this.collection;a.remove(this,{silent:!0}),a.add(this,{silent:!0}),this.collection.trigger("render")}}},erase:function(){var t=this.cid;this.collection.eraseManipulatives(this.collection.filter(function(e){return"fraction"===e.get("type")&&e._containerId===t}))}}),Controller.ManipulativeDraggableBaseBlockModel=Controller.CanvasComponentModel.extend({parse:function(t){return t.value%10===0?(t.numRows=10,t.numColumns=t.value/10):(t.numRows=t.value%10,t.numColumns=1),100===t.value?(t.w=90,t.h=90):10===t.value?(t.w=10.5,t.h=105):(t.w=21,t.h=21),t},defaults:{fillStyle:Controller.COLORS.lightorange,strokeStyle:Controller.COLORS.charcoal,lineWidth:1,displayBorder:!0,hundredsBlockWidthHeight:9,tensBlockWidthHeight:10.5,onesBlockWidthHeight:21}}),Controller.MANIPULATIVES={baseBlock:{model:Controller.ManipulativeBaseBlockModel,view:Controller.CanvasGridView},draggableBaseBlock:{model:Controller.ManipulativeDraggableBaseBlockModel,view:Controller.CanvasGridView},coin:{model:Controller.ManipulativeCoinModel,view:Controller.ManipulativeCoinView},counter:{model:Controller.ManipulativeCounterModel,view:Controller.CanvasCounterView},fraction:{model:Controller.ManipulativeFractionModel,view:Controller.CanvasFractionView},fractionContainer:{model:Controller.ManipulativeFractionContainerModel,view:Controller.CanvasRectangleView},manipulative:{model:Controller.BaseManipulativeModel,view:Controller.BaseManipulativeView}},Controller.MANIPULATIVE_DATA={baseblocks:{100:{type:"baseBlock",value:100,mx:5,y:5},10:{type:"baseBlock",value:10,mx:5,y:170},1:{type:"baseBlock",value:1,mx:5,y:340}},baseBlocks:{100:{type:"draggableBaseBlock",value:100,mx:5,y:5,scale:.6,fillStyle:Controller.COLORS.blue},10:{type:"draggableBaseBlock",value:10,mx:5,y:115,scale:.7,fillStyle:Controller.COLORS.blue},1:{type:"draggableBaseBlock",value:1,mx:5,y:240,scale:1.4,fillStyle:Controller.COLORS.blue}},"coins-cad":{200:{type:"coin",currency:"cad",value:200,mx:5,y:5},100:{type:"coin",currency:"cad",value:100,mx:10,y:90},25:{type:"coin",currency:"cad",value:25,mx:12,y:170},10:{type:"coin",currency:"cad",value:10,mx:20,y:245},5:{type:"coin",currency:"cad",value:5,mx:15,y:300}},"coins-usd":{25:{type:"coin",currency:"usd",value:25,mx:5,y:5},10:{type:"coin",currency:"usd",value:10,mx:18,y:91},5:{type:"coin",currency:"usd",value:5,mx:12,y:150},1:{type:"coin",currency:"usd",value:1,mx:15,y:220}},counters:{blue:{type:"counter",color:"blue",fillStyle:Controller.COLORS.blue,alternateFillStyle:Controller.COLORS.lightnavy,mx:5,y:5},green:{type:"counter",color:"green",fillStyle:Controller.COLORS.lightgreen,alternateFillStyle:Controller.COLORS.darkgreen,mx:5,y:90},orange:{type:"counter",color:"orange",fillStyle:Controller.COLORS.lightorange,alternateFillStyle:Controller.COLORS.lightbrown,mx:5,y:175},red:{type:"counter",color:"red",fillStyle:Controller.COLORS.lightred,alternateFillStyle:Controller.COLORS.darkred,mx:5,y:260},purple:{type:"counter",color:"purple",fillStyle:Controller.COLORS.purple,alternateFillStyle:Controller.COLORS.darkpurple,mx:5,y:345}},fractions:{1:{type:"fraction",denominator:1,mx:5,y:5},2:{type:"fraction",denominator:2,mx:5,y:50},3:{type:"fraction",denominator:3,mx:5,y:95},4:{type:"fraction",denominator:4,mx:5,y:140},5:{type:"fraction",denominator:5,mx:5,y:185},6:{type:"fraction",denominator:6,mx:5,y:230},8:{type:"fraction",denominator:8,mx:5,y:275},10:{type:"fraction",denominator:10,mx:5,y:320},12:{type:"fraction",denominator:12,mx:5,y:365},c:{type:"fractionContainer",mx:0,y:410}}},Controller.Manipulatives=Backbone.Collection.extend({initialize:function(t,e){this.listenTo(this,"reset",this.loadAssets)},addManipulative:function(t,e,n,r,i){var o=$.extend({x:n},Controller.MANIPULATIVE_DATA[t][e]);o.y=r,i="undefined"==typeof i||i,i===!0?this._selected=this.add(o):this.add(o)},setMenuManipulatives:function(t){var e,n,r,i,o=[],s=[];_.each(t,function(t,a){if(Controller.MANIPULATIVE_DATA[a]){if(_.each(t,function(t){e=t.indexOf(":"),e!==-1?(n=t.substr(0,e),r=parseInt(t.substr(e+1))):(n=t,r=Number.POSITIVE_INFINITY),Controller.MANIPULATIVE_DATA[a][n]?(s.push($.extend({mlimit:r},Controller.MANIPULATIVE_DATA[a][n])),o.push(n)):"*"===n?i=r:console.warn('[Manipulative Error] "'+n+'" is not a valid key for '+a+" manipulatives. Valid keys include: "+_.keys(Controller.MANIPULATIVE_DATA[a]))}),i){var l=_.difference(_.keys(Controller.MANIPULATIVE_DATA[a]),o);_.each(l,function(t){s.push($.extend({mlimit:i},Controller.MANIPULATIVE_DATA[a][t]))})}}else console.warn('[Manipulatives Error] "'+a+'" is not a valid manipulative type. Valid types include: '+_.keys(Controller.MANIPULATIVE_DATA))});for(var a=this.filter(function(t){return!_.isUndefined(t.get("mlimit"))}),l=0;l<a.length;l++)a[l].destroy();for(var l=0;l<s.length;l++)this.add(s[l],{parse:!0,silent:!0});this.trigger("reset"),this._menuManipulatives=t},model:function(t,e){e.parse=!0;var n=Controller.MANIPULATIVES[t.type];return n&&_.isFunction(n.model)?new Controller.MANIPULATIVES[t.type].model(t,e):void console.warn("No model defined for manipulative of type "+t.type)},loadAssets:function(){var t=this,e=this.length,n=function(){0===e&&t.trigger("load-complete")},r=function(){e--,n()};this.forEach(function(t){t.once("loaded-assets",r),t.loadAssets()}),0===this.length&&n()},removeManipulatives:function(t,e){for(var n=0;n<t.length;n++)this.remove(t[n],{silent:!0});e&&e.silent||this.trigger("remove")},addManipulatives:function(t,e){for(var n=0;n<t.length;n++)this.add(t[n],{silent:!0});e&&e.silent||this.trigger("add")},eraseManipulatives:function(t){for(var e=0;e<t.length;e++){var n=this.find(function(n){return _.isFinite(n.get("mlimit"))&&_.every(t[e].attributes,function(t,e){return"x"===e||"y"===e||n.get(e)===t})});n&&n.set({mlimit:n.get("mlimit")+1}),this.remove(t[e],{silent:!0}),t[e].destroy()}this.trigger("render")},eraseAllManipulatives:function(){this.reset(),this.setMenuManipulatives(this._menuManipulatives)},getNearestManipulative:function(t,e,n,r){r=_.isNumber(r)?r:30;var i=r,o=[];return this.each(function(r){_.isFunction(n)&&!n(r)||(r.distance(t,e)<i?(i=r.distance(t,e),o=[r]):r.distance(t,e)===i&&o.push(r))}),i<r?o.pop():null},one:function(t){var e=this.filter(t);if(1===e.length)return e[0]}}),Controller.ManipulativesView=Backbone.View.extend({tagName:"canvas",className:"manipulatives",initialize:function(t){this.views=[],this.scale=1,this.collection.selector=t.selector;var e=$(this.collection.selector);this.el.width=e.width(),this.el.height=e.height(),this.$el.css({position:"relative",width:"100%",height:"100%","-webkit-transform":"translateY(-100%)","-moz-transform":"translateY(-100%)","-ms-transform":"translateY(-100%)",transform:"translateY(-100%)"}),e.append(this.$el),this.listenTo(this.collection,"add",this.addManipulative),this.listenTo(this.collection,"reset",this.resize),this.listenTo(this.collection,"render",this.render),this.listenTo(this.collection,"destroy",this.render)},events:{touchstart:"touchstart",touchmove:"touchmove",touchend:"touchend",mousedown:"mousedown",mousemove:"mousemove",mouseup:"mouseup"},touchstart:function(t){t.preventDefault(),this.mousedown(t.originalEvent.touches[0],!0)},touchmove:function(t){t.preventDefault(),t=t.originalEvent.touches[0];var e=this.$el.offset(),n=e.left,r=e.left+this.el.width,i=e.top,o=e.top+this.el.height;n<t.pageX&&t.pageX<r&&i<t.pageY&&t.pageY<o?this.mousemove(t,!0):this.mouseup(t,!0)},touchend:function(t){t.preventDefault(),this.mouseup(t.originalEvent.changedTouches[0]),!0},mousedown:function(t,e){var n=this.$el.position(),r=t.pageX/this.scale-n.left,i=t.pageY/this.scale-n.top;if(this.collection._selected=this.collection.getNearestManipulative(r,i,null,Math.max(t.radiusX||1,t.radiusY||1)),this._x=r,this._y=i,this.collection._selected){this.collection._selected=this.collection.get({cid:this.collection._selected._containerId})||this.collection._selected,this._dragged=!1,this._dragCoordinates={x:r,y:i};var o,s=this.collection._selected.get("mlimit");void 0!==s?s>0?(this.collection._selected.set({mlimit:s-1}),o=this.collection._selected.clone(),o.unset("mlimit"),this.collection.add(o),this.collection._selected=o):this.collection._selected=void 0:(this.collection.remove(this.collection._selected,{silent:!0}),this.collection.add(this.collection._selected,{silent:!0}),this.collection.trigger("render"))}else this.simulateControlEvent("mousedown",t,void 0,e?30:1)},mousemove:function(t,e){if(this.collection._selected){var n=this.$el.position(),r=t.pageX/this.scale-n.left,i=t.pageY/this.scale-n.top;this._x===r&&this._y===i||(this._dragged?(this.collection._selected.translate(r-this._x,i-this._y),this.collection.remove(this.collection._selected,{silent:!0}),this.collection.add(this.collection._selected,{silent:!0}),this.render(),this._x=r,this._y=i):(Math.abs(this._dragCoordinates.x-r)>5||Math.abs(this._dragCoordinates.y-i)>5)&&(this._dragged=!0))}else this.simulateControlEvent("mousemove",t,void 0,e?30:1)},mouseup:function(t,e){if(this.collection._selected){var n=this.collection._selected.get("x")+this.collection._selected.get("w"),r=.8*this.el.width/this.scale;if(n>r)_.isFunction(this.collection._selected.erase)&&this.collection._selected.erase(),this.collection.eraseManipulatives([this.collection._selected]);else{this.$el.hasClass("tutorial-advance")&&this.$el.trigger("tutorial-advance");var i=this.collection._selected.get("x"),o=this.collection._selected.get("y"),s=this.collection._selected.get("h"),a=this.el.height/this.scale;(i<0||o<0||o+s>a)&&(this.collection._selected.translate(Math.max(0,i)-i,Math.max(0,Math.min(o,a-s))-o),this.collection.remove(this.collection._selected,{silent:!0}),this.collection.add(this.collection._selected,{silent:!0}),this.render());var l=this.$el.position(),i=t.pageX/this.scale-l.left,o=t.pageY/this.scale-l.top;this.collection.mQuestion?this.simulateControlEvent("mouseup",t,{manipulative:this.collection._selected,dragged:this._dragged},Number.POSITIVE_INFINITY):!this._dragged&&_.isFunction(this.collection._selected.click)?this.collection._selected.click(i,o,{w:.8*this.el.width/this.scale,h:this.el.height/this.scale}):this._dragged&&_.isFunction(this.collection._selected.drop)&&this.collection._selected.drop(i,o,{w:.8*this.el.width/this.scale,h:this.el.height/this.scale})}this.collection._selected=void 0}else this.simulateControlEvent("mouseup",t,void 0,e?30:1)},simulateControlEvent:function(t,e,n,r){Controller.simulateEvent({type:t,event:e,data:n,selector:this.collection.selector,maxDistance:r})},render:function(t){var e=this.el.getContext("2d");for(e.clearRect(0,0,this.el.width/this.scale,this.el.height/this.scale);this.views.length>0;)this.views.pop().remove();this.collection.forEach(this.addManipulative.bind(this))},resize:function(t){t=_.isNumber(t)?t:this.scale,this.scale=t||this.scale||1;var e=this.$el.width();this.collection.each(function(n){_.isUndefined(n.get("mlimit"))||n.set({x:n.get("mx")+.8*e/t})}),this.el.width=e,this.el.height=this.$el.height();var n=this.el.getContext("2d");n.setTransform(this.scale,0,0,this.scale,0,0),this.render()},addManipulative:function(t){var e=this.el.getContext("2d"),n=Controller.MANIPULATIVES[t.get("type")];if(n&&_.isFunction(n.view)){var r=new n.view({context:e,model:t});0!==t.get("mlimit")&&r.render(),this.views.push(r)}else console.warn("The view constructor was invalid for the manipulative of type "+t.get("type")),console.log(t)},remove:function(arguments){for(;this.views.length>0;)this.views.pop().remove();Backbone.View.prototype.remove.apply(this,arguments)},clear:function(){this.collection.reset(),this.$el.empty(),this.remove()}});